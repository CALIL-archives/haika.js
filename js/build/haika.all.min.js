/*! haika.js 29-09-2014 */
function sprintf(){var a=sprintf.arguments,b=a.length;if(0==b)return"";var c,d,e,f="",g=a[0],h=g.length;c=0;for(var i,j,k=1,l=0,m=0;h>m;m++){var n=g.charAt(m);switch(l){case 0:"%"==n?(i=n,l=1,j=""):f+=n;break;case 1:if("%"==n){f+=n,l=0;break}switch(k>=b&&(a[b++]=""),d=0,e=-1,n){case"-":c|=1,l=1;break;case"+":c|=2,l=1;break;case"0":c|=4,l=2;break;case" ":c|=8,l=1;break;case"#":c|=16,l=1;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":d=parseInt(n),l=2;break;case"-":c=1,l=2;break;case".":d="",e=0,l=3;break;case"d":f+=toInteger(a[k],c,d,e),k++,l=0;break;case"f":f+=toFloatingPoint(a[k],c,d,6),k++,l=0;break;case"e":f+=toExponential(a[k],c,d,6,"e"),k++,l=0;break;case"E":f+=toExponential(a[k],c,d,6,"E"),k++,l=0;break;case"s":f+=a[k],k++,l=0;break;default:f+=j+n,l=0}break;case 2:switch(n){case".":e=0,l=3;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":d=10*d+parseInt(n),l=2;break;case"d":f+=toInteger(a[k],c,d,e),k++,l=0;break;case"f":f+=toFloatingPoint(a[k],c,d,6),k++,l=0;break;case"e":f+=toExponential(a[k],c,d,6,"e"),k++,l=0;break;case"E":f+=toExponential(a[k],c,d,6,"E"),k++,l=0;break;case"s":f+=toFormatString(a[k],d,e),k++,l=0;break;default:f+=j+n,l=0}break;case 3:switch(n){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e=10*e+parseInt(n);break;case"d":f+=toInteger(a[k],c,d,e),k++,l=0;break;case"f":f+=toFloatingPoint(a[k],c,d,e),k++,l=0;break;case"e":f+=toExponential(a[k],c,d,e,"e"),k++,l=0;break;case"E":f+=toExponential(a[k],c,d,e,"E"),k++,l=0;break;case"s":f+=toFormatString(a[k],d,e),k++,l=0;break;default:f+=j+n,l=0}break;default:return"error"}l&&(j+=n)}return f}function toInteger(a,b,c,d){"number"!=typeof a&&("string"==typeof a?(a=parseFloat(a),isNaN(a)&&(a=0)):a=0);var e=a.toString();if(a>-1&&1>a)e="0";else{0>a&&(e=e.substring(1));var f=e.indexOf("e");if(-1!=f){var g=parseInt(e.substring(f+2)),h=e.indexOf(".");for(-1==h?(e=e.substring(0,f)+"000000000000000000000",g-=21):(e=e.substring(0,h)+e.substring(h+1,f)+"00000",g-=e.length-h);g;g--)e+="0"}else{var h=e.indexOf(".");-1!=h&&(e=e.substring(0,h))}}var i=e.length;if(d>i){for(var j="0",k=d-i;k;k--)e=j+e;i=d}return ProcFlag(e,b,c-i,a>=0)}function toFloatingPoint(a,b,c,d){"number"!=typeof a&&("string"==typeof a?(a=parseFloat(a),isNaN(a)&&(a=0)):a=0);var e=a>=0;return e||(a=-a),str=toFloatingPoint2(a,b,d),ProcFlag(str,b,c-str.length,e)}function toFloatingPoint2(a,b,c){var d=a.toString(),e=d.indexOf("e");if(-1!=e){var f=parseInt(d.substring(e+1));if(f>0){var g=d.indexOf(".");for(-1==g?(d=d.substring(0,e)+"000000000000000000000",f-=21):(d=d.charAt(0)+d.substring(2,e)+"00000",f-=d.length-1);f;f--)d+="0"}else{var h=f+c;if(-1>h)d="0";else if(h>=0){d=d.substring(0,e);var g=d.indexOf(".");for(-1!=g&&(d=d.charAt(0)+d.substring(2,e)),d="000000"+d,f+=7;f;f++)d="0"+d;d="0."+d}else{var i=parseFloat(d.substring(0,e));if(i>5){d="0.00000";for(var j=f+7;j;j++)d+="0";d+="1"}else d="0"}}}var k=d.length,g=d.indexOf(".");if(-1!=g){var l=k-g-1;if(l>c){var i=parseFloat(d.charAt(g+c+1)+"."+d.substring(g+c+2));if(i>5){var j;if(1>a){for(j=2;"0"==d.charAt(j);)j++;i=(parseInt(d.substring(j,c+2))+1).toString(),d=i.length>c+2-j?2==j?"1."+i.substring(1):d.substring(0,j-1)+i:d.substring(0,j)+i}else i=(parseInt(d.substring(0,g)+d.substring(g+1,g+c+1))+1).toString(),d=i.length>g+c?i.substring(0,g+1)+"."+i.substring(g+1):i.substring(0,g)+"."+i.substring(g)}else d=d.substring(0,c?g+c+1:g)}else if(c>l)for(var j=c-l;j;j--)d+="0"}else if(c){d+=".0";for(var j=c-1;j;j--)d+="0"}return d}function toExponential(a,b,c,d,e){"number"!=typeof a&&("string"==typeof a?(a=parseFloat(a),isNaN(a)&&(a=0)):a=0);var f=a>=0;f||(a=-a);var g,h=a.toString(),i=h.indexOf("."),j=h.indexOf("e"),k=((-1!=j)<<1)+(-1!=i);if(0==k)(g=h.length-1)&&(h=h.charAt(0)+"."+h.substring(i=1));else if(1==k)if(a>10)g=i-1,h=h.substring(0,1)+"."+h.substring(1,i)+h.substring(i+1),i=1;else if(a>1)g=0;else{for(var l=2;;l++)if("0"!=h.charAt(l)){g=1-l,h=h.charAt(l)+"."+h.substring(l+1);break}i=1}else g=parseInt(h.substring(j+1)),h=h.substring(0,j);return h=toFloatingPoint2(parseFloat(h),b,d),h+=g>=0?e+(10>g?"+0":"+")+g:e+(g>-10?"-0"+-g:g),h=ProcFlag(h,b,c-h.length,f)}function toFormatString(a,b,c){"string"!=typeof a&&(a=a.toString());var d=a.length;if(c>=0&&d>c&&(a=a.substring(0,c),d=c),b>d)for(var e=" ",f=b-d;f;f--)a=e+a;return a}function ProcFlag(a,b,c,d){var e=1&b,f=2&b,g=8&b;if(g&&c--,c-=!d+f>0,(4&b)>0&&!e){if(c>0)for(var h="0",i=c;i;i--)a=h+a;d?f&&(a="+"+a):a="-"+a}else{d?f&&(a="+"+a):a="-"+a;var h=" ";if(c>0){var h=" ";if(e)for(var i=c;i;i--)a+=h;else for(var i=c;i;i--)a=h+a}}return g&&(a=" "+a),a}function initAligningGuidelines(a){function b(a){d(a.x+.5,a.y1>a.y2?a.y2:a.y1,a.x+.5,a.y2>a.y1?a.y2:a.y1)}function c(a){d(a.x1>a.x2?a.x2:a.x1,a.y+.5,a.x2>a.x1?a.x2:a.x1,a.y+.5)}function d(a,b,c,d){f.save(),f.setLineDash([4,4]),f.lineWidth=i,f.strokeStyle=j,f.beginPath(),f.moveTo(Math.floor(a)+.5,Math.floor(b)+.5),f.lineTo(Math.floor(c)+.5,Math.floor(d)+.5),f.stroke(),f.restore()}function e(a,b){a=Math.round(a),b=Math.round(b);for(var c=a-h,d=a+h;d>=c;c++)if(c===b)return!0;return!1}var f=a.getSelectionContext(),g=5,h=4,i=1,j="rgb(0,255,0)",k=[],l=[];a.on("object:moving",function(b){var c=b.target,d=a.getObjects(),f=c.getCenterPoint(),h=f.x,i=f.y,j=c.getBoundingRectHeight(),m=c.getBoundingRectWidth(),n=!1,o=!1,p=a._currentTransform;if(p){l.length=0,k.length=0;for(var q=d.length;q--;)if(d[q]!==c){var r=d[q].getCenterPoint(),s=r.x,t=r.y,u=d[q].getBoundingRectHeight(),v=d[q].getBoundingRectWidth();if(e(s-v/2,h-m/2)&&(o=!0,k.push({x:s-v/2,y1:i>t?t-u/2-g:t+u/2+g,y2:i>t?i+j/2+g:i-j/2-g}),c.setPositionByOrigin(new fabric.Point(s-v/2+m/2,i),p.originX,p.originY)),e(s+v/2,h+m/2)&&(o=!0,k.push({x:s+v/2,y1:i>t?t-u/2-g:t+u/2+g,y2:i>t?i+j/2+g:i-j/2-g}),c.setPositionByOrigin(new fabric.Point(s+v/2-m/2,i),p.originX,p.originY)),e(t-u/2,i-j/2)){n=!0;for(var w={y:t-u/2,x1:h>s?s-v/2-g:s+v/2+g,x2:h>s?h+m/2+g:h-m/2-g},x=!0,y=l.length;y--;)w.y==l[y].y&&(Math.abs(l[y].x2-l[y].x1)>Math.abs(w.x2-w.x1)?Math.abs(l[y].x2-l[y].x1)-Math.abs(w.x2-w.x1)>5&&l.splice(y,1):x=!1);x&&(l.push(w),c.setPositionByOrigin(new fabric.Point(h,t-u/2+j/2),p.originX,p.originY))}e(t+u/2,i+j/2)&&(n=!0,l.push({y:t+u/2,x1:h>s?s-v/2-g:s+v/2+g,x2:h>s?h+m/2+g:h-m/2-g}),c.setPositionByOrigin(new fabric.Point(h,t+u/2-j/2),p.originX,p.originY))}n||(l.length=0),o||(k.length=0)}}),a.on("before:render",function(){a.clearContext(a.contextTop)}),a.on("after:render",function(){for(var a=k.length;a--;)b(k[a]);for(var a=l.length;a--;)c(l[a])}),a.on("mouse:up",function(){k.length=l.length=0,a.renderAll()})}!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.proj4=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a,b,d){if(!(this instanceof c))return new c(a,b,d);if(Array.isArray(a))this.x=a[0],this.y=a[1],this.z=a[2]||0;else if("object"==typeof a)this.x=a.x,this.y=a.y,this.z=a.z||0;else if("string"==typeof a&&"undefined"==typeof b){var e=a.split(",");this.x=parseFloat(e[0],10),this.y=parseFloat(e[1],10),this.z=parseFloat(e[2],10)||0}else this.x=a,this.y=b,this.z=d||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var d=a("mgrs");c.fromMGRS=function(a){return new c(d.toPoint(a))},c.prototype.toMGRS=function(a){return d.forward([this.x,this.y],a)},b.exports=c},{mgrs:66}],2:[function(a,b){function c(a,b){if(!(this instanceof c))return new c(a);b=b||function(a){if(a)throw a};var f=d(a);if("object"!=typeof f)return void b(a);var h=g(f),i=c.projections.get(h.projName);i?(e(this,h),e(this,i),this.init(),b(null,this)):b(a)}var d=a("./parseCode"),e=a("./extend"),f=a("./projections"),g=a("./deriveConstants");c.projections=f,c.projections.start(),b.exports=c},{"./deriveConstants":32,"./extend":33,"./parseCode":36,"./projections":38}],3:[function(a,b){b.exports=function(a,b,c){var d,e,f,g=c.x,h=c.y,i=c.z||0;for(f=0;3>f;f++)if(!b||2!==f||void 0!==c.z)switch(0===f?(d=g,e="x"):1===f?(d=h,e="y"):(d=i,e="z"),a.axis[f]){case"e":c[e]=d;break;case"w":c[e]=-d;break;case"n":c[e]=d;break;case"s":c[e]=-d;break;case"u":void 0!==c[e]&&(c.z=d);break;case"d":void 0!==c[e]&&(c.z=-d);break;default:return null}return c}},{}],4:[function(a,b){var c=Math.PI/2,d=a("./sign");b.exports=function(a){return Math.abs(a)<c?a:a-d(a)*Math.PI}},{"./sign":21}],5:[function(a,b){var c=2*Math.PI,d=a("./sign");b.exports=function(a){return Math.abs(a)<Math.PI?a:a-d(a)*c}},{"./sign":21}],6:[function(a,b){b.exports=function(a){return Math.abs(a)>1&&(a=a>1?1:-1),Math.asin(a)}},{}],7:[function(a,b){b.exports=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))}},{}],8:[function(a,b){b.exports=function(a){return.375*a*(1+.25*a*(1+.46875*a))}},{}],9:[function(a,b){b.exports=function(a){return.05859375*a*a*(1+.75*a)}},{}],10:[function(a,b){b.exports=function(a){return a*a*a*(35/3072)}},{}],11:[function(a,b){b.exports=function(a,b,c){var d=b*c;return a/Math.sqrt(1-d*d)}},{}],12:[function(a,b){b.exports=function(a,b,c,d,e){var f,g;f=a/b;for(var h=0;15>h;h++)if(g=(a-(b*f-c*Math.sin(2*f)+d*Math.sin(4*f)-e*Math.sin(6*f)))/(b-2*c*Math.cos(2*f)+4*d*Math.cos(4*f)-6*e*Math.cos(6*f)),f+=g,Math.abs(g)<=1e-10)return f;return 0/0}},{}],13:[function(a,b){var c=Math.PI/2;b.exports=function(a,b){var d=1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a));if(Math.abs(Math.abs(b)-d)<1e-6)return 0>b?-1*c:c;for(var e,f,g,h,i=Math.asin(.5*b),j=0;30>j;j++)if(f=Math.sin(i),g=Math.cos(i),h=a*f,e=Math.pow(1-h*h,2)/(2*g)*(b/(1-a*a)-f/(1-h*h)+.5/a*Math.log((1-h)/(1+h))),i+=e,Math.abs(e)<=1e-10)return i;return 0/0}},{}],14:[function(a,b){b.exports=function(a,b,c,d,e){return a*e-b*Math.sin(2*e)+c*Math.sin(4*e)-d*Math.sin(6*e)}},{}],15:[function(a,b){b.exports=function(a,b,c){var d=a*b;return c/Math.sqrt(1-d*d)}},{}],16:[function(a,b){var c=Math.PI/2;b.exports=function(a,b){for(var d,e,f=.5*a,g=c-2*Math.atan(b),h=0;15>=h;h++)if(d=a*Math.sin(g),e=c-2*Math.atan(b*Math.pow((1-d)/(1+d),f))-g,g+=e,Math.abs(e)<=1e-10)return g;return-9999}},{}],17:[function(a,b){var c=1,d=.25,e=.046875,f=.01953125,g=.01068115234375,h=.75,i=.46875,j=.013020833333333334,k=.007120768229166667,l=.3645833333333333,m=.005696614583333333,n=.3076171875;b.exports=function(a){var b=[];b[0]=c-a*(d+a*(e+a*(f+a*g))),b[1]=a*(h-a*(e+a*(f+a*g)));var o=a*a;return b[2]=o*(i-a*(j+a*k)),o*=a,b[3]=o*(l-a*m),b[4]=o*a*n,b}},{}],18:[function(a,b){var c=a("./pj_mlfn"),d=1e-10,e=20;b.exports=function(a,b,f){for(var g=1/(1-b),h=a,i=e;i;--i){var j=Math.sin(h),k=1-b*j*j;if(k=(c(h,j,Math.cos(h),f)-a)*k*Math.sqrt(k)*g,h-=k,Math.abs(k)<d)return h}return h}},{"./pj_mlfn":19}],19:[function(a,b){b.exports=function(a,b,c,d){return c*=b,b*=b,d[0]*a-c*(d[1]+b*(d[2]+b*(d[3]+b*d[4])))}},{}],20:[function(a,b){b.exports=function(a,b){var c;return a>1e-7?(c=a*b,(1-a*a)*(b/(1-c*c)-.5/a*Math.log((1-c)/(1+c)))):2*b}},{}],21:[function(a,b){b.exports=function(a){return 0>a?-1:1}},{}],22:[function(a,b){b.exports=function(a,b){return Math.pow((1-a)/(1+a),b)}},{}],23:[function(a,b){b.exports=function(a){var b={x:a[0],y:a[1]};return a.length>2&&(b.z=a[2]),a.length>3&&(b.m=a[3]),b}},{}],24:[function(a,b){var c=Math.PI/2;b.exports=function(a,b,d){var e=a*d,f=.5*a;return e=Math.pow((1-e)/(1+e),f),Math.tan(.5*(c-b))/e}},{}],25:[function(a,b,c){c.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},c.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},c.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},c.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},c.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},c.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},c.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},c.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},c.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},c.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},c.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},c.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},c.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},c.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},c.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},c.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(a,b,c){c.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},c.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},c.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},c.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},c.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},c.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},c.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},c.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},c.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},c.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},c.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},c.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},c.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},c.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},c.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},c.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},c.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},c.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},c.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},c.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},c.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},c.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},c.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},c.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},c.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},c.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},c.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},c.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},c.hough={a:6378270,rf:297,ellipseName:"Hough"},c.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},c.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},c.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},c.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},c.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},c.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},c.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},c.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},c.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},c.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},c.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},c.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},c.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},c.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(a,b,c){c.greenwich=0,c.lisbon=-9.131906111111,c.paris=2.337229166667,c.bogota=-74.080916666667,c.madrid=-3.687938888889,c.rome=12.452333333333,c.bern=7.439583333333,c.jakarta=106.807719444444,c.ferro=-17.666666666667,c.brussels=4.367975,c.stockholm=18.058277777778,c.athens=23.7163375,c.oslo=10.722916666667},{}],28:[function(a,b){function c(a,b,c){var d;return Array.isArray(c)?(d=g(a,b,c),3===c.length?[d.x,d.y,d.z]:[d.x,d.y]):g(a,b,c)}function d(a){return a instanceof f?a:a.oProj?a.oProj:f(a)}function e(a,b,e){a=d(a);var f,g=!1;return"undefined"==typeof b?(b=a,a=h,g=!0):("undefined"!=typeof b.x||Array.isArray(b))&&(e=b,b=a,a=h,g=!0),b=d(b),e?c(a,b,e):(f={forward:function(d){return c(a,b,d)},inverse:function(d){return c(b,a,d)}},g&&(f.oProj=b),f)}var f=a("./Proj"),g=a("./transform"),h=f("WGS84");b.exports=e},{"./Proj":2,"./transform":64}],29:[function(a,b){var c=Math.PI/2,d=1,e=2,f=3,g=4,h=5,i=484813681109536e-20,j=1.0026,k=.3826834323650898,l=function(a){if(!(this instanceof l))return new l(a);if(this.datum_type=g,a){if(a.datumCode&&"none"===a.datumCode&&(this.datum_type=h),a.datum_params){for(var b=0;b<a.datum_params.length;b++)a.datum_params[b]=parseFloat(a.datum_params[b]);(0!==a.datum_params[0]||0!==a.datum_params[1]||0!==a.datum_params[2])&&(this.datum_type=d),a.datum_params.length>3&&(0!==a.datum_params[3]||0!==a.datum_params[4]||0!==a.datum_params[5]||0!==a.datum_params[6])&&(this.datum_type=e,a.datum_params[3]*=i,a.datum_params[4]*=i,a.datum_params[5]*=i,a.datum_params[6]=a.datum_params[6]/1e6+1)}this.datum_type=a.grids?f:this.datum_type,this.a=a.a,this.b=a.b,this.es=a.es,this.ep2=a.ep2,this.datum_params=a.datum_params,this.datum_type===f&&(this.grids=a.grids)}};l.prototype={compare_datums:function(a){return this.datum_type!==a.datum_type?!1:this.a!==a.a||Math.abs(this.es-a.es)>5e-11?!1:this.datum_type===d?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]:this.datum_type===e?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]&&this.datum_params[3]===a.datum_params[3]&&this.datum_params[4]===a.datum_params[4]&&this.datum_params[5]===a.datum_params[5]&&this.datum_params[6]===a.datum_params[6]:this.datum_type===f||a.datum_type===f?this.nadgrids===a.nadgrids:!0},geodetic_to_geocentric:function(a){var b,d,e,f,g,h,i,j=a.x,k=a.y,l=a.z?a.z:0,m=0;if(-c>k&&k>-1.001*c)k=-c;else if(k>c&&1.001*c>k)k=c;else if(-c>k||k>c)return null;return j>Math.PI&&(j-=2*Math.PI),g=Math.sin(k),i=Math.cos(k),h=g*g,f=this.a/Math.sqrt(1-this.es*h),b=(f+l)*i*Math.cos(j),d=(f+l)*i*Math.sin(j),e=(f*(1-this.es)+l)*g,a.x=b,a.y=d,a.z=e,m},geocentric_to_geodetic:function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=1e-12,u=t*t,v=30,w=a.x,x=a.y,y=a.z?a.z:0;if(o=!1,b=Math.sqrt(w*w+x*x),d=Math.sqrt(w*w+x*x+y*y),b/this.a<t){if(o=!0,q=0,d/this.a<t)return r=c,void(s=-this.b)}else q=Math.atan2(x,w);e=y/d,f=b/d,g=1/Math.sqrt(1-this.es*(2-this.es)*f*f),j=f*(1-this.es)*g,k=e*g,p=0;do p++,i=this.a/Math.sqrt(1-this.es*k*k),s=b*j+y*k-i*(1-this.es*k*k),h=this.es*i/(i+s),g=1/Math.sqrt(1-h*(2-h)*f*f),l=f*(1-h)*g,m=e*g,n=m*j-l*k,j=l,k=m;while(n*n>u&&v>p);return r=Math.atan(m/Math.abs(l)),a.x=q,a.y=r,a.z=s,a},geocentric_to_geodetic_noniter:function(a){var b,d,e,f,g,h,i,l,m,n,o,p,q,r,s,t,u,v=a.x,w=a.y,x=a.z?a.z:0;if(v=parseFloat(v),w=parseFloat(w),x=parseFloat(x),u=!1,0!==v)b=Math.atan2(w,v);else if(w>0)b=c;else if(0>w)b=-c;else if(u=!0,b=0,x>0)d=c;else{if(!(0>x))return d=c,void(e=-this.b);d=-c}return g=v*v+w*w,f=Math.sqrt(g),h=x*j,l=Math.sqrt(h*h+g),n=h/l,p=f/l,o=n*n*n,i=x+this.b*this.ep2*o,t=f-this.a*this.es*p*p*p,m=Math.sqrt(i*i+t*t),q=i/m,r=t/m,s=this.a/Math.sqrt(1-this.es*q*q),e=r>=k?f/r-s:-k>=r?f/-r-s:x/q+s*(this.es-1),u===!1&&(d=Math.atan(q/r)),a.x=b,a.y=d,a.z=e,a},geocentric_to_wgs84:function(a){if(this.datum_type===d)a.x+=this.datum_params[0],a.y+=this.datum_params[1],a.z+=this.datum_params[2];else if(this.datum_type===e){var b=this.datum_params[0],c=this.datum_params[1],f=this.datum_params[2],g=this.datum_params[3],h=this.datum_params[4],i=this.datum_params[5],j=this.datum_params[6],k=j*(a.x-i*a.y+h*a.z)+b,l=j*(i*a.x+a.y-g*a.z)+c,m=j*(-h*a.x+g*a.y+a.z)+f;a.x=k,a.y=l,a.z=m}},geocentric_from_wgs84:function(a){if(this.datum_type===d)a.x-=this.datum_params[0],a.y-=this.datum_params[1],a.z-=this.datum_params[2];else if(this.datum_type===e){var b=this.datum_params[0],c=this.datum_params[1],f=this.datum_params[2],g=this.datum_params[3],h=this.datum_params[4],i=this.datum_params[5],j=this.datum_params[6],k=(a.x-b)/j,l=(a.y-c)/j,m=(a.z-f)/j;a.x=k+i*l-h*m,a.y=-i*k+l+g*m,a.z=h*k-g*l+m}}},b.exports=l},{}],30:[function(a,b){var c=1,d=2,e=3,f=5,g=6378137,h=.006694379990141316;b.exports=function(a,b,i){function j(a){return a===c||a===d}var k,l,m;if(a.compare_datums(b))return i;if(a.datum_type===f||b.datum_type===f)return i;var n=a.a,o=a.es,p=b.a,q=b.es,r=a.datum_type;if(r===e)if(0===this.apply_gridshift(a,0,i))a.a=g,a.es=h;else{if(!a.datum_params)return a.a=n,a.es=a.es,i;for(k=1,l=0,m=a.datum_params.length;m>l;l++)k*=a.datum_params[l];if(0===k)return a.a=n,a.es=a.es,i;r=a.datum_params.length>3?d:c}return b.datum_type===e&&(b.a=g,b.es=h),(a.es!==b.es||a.a!==b.a||j(r)||j(b.datum_type))&&(a.geodetic_to_geocentric(i),j(a.datum_type)&&a.geocentric_to_wgs84(i),j(b.datum_type)&&b.geocentric_from_wgs84(i),b.geocentric_to_geodetic(i)),b.datum_type===e&&this.apply_gridshift(b,1,i),a.a=n,a.es=o,b.a=p,b.es=q,i}},{}],31:[function(a,b){function c(a){var b=this;if(2===arguments.length)c[a]="+"===arguments[1][0]?e(arguments[1]):f(arguments[1]);else if(1===arguments.length)return Array.isArray(a)?a.map(function(a){Array.isArray(a)?c.apply(b,a):c(a)}):void("string"==typeof a||("EPSG"in a?c["EPSG:"+a.EPSG]=a:"ESRI"in a?c["ESRI:"+a.ESRI]=a:"IAU2000"in a?c["IAU2000:"+a.IAU2000]=a:console.log(a)))}var d=a("./global"),e=a("./projString"),f=a("./wkt");d(c),b.exports=c},{"./global":34,"./projString":37,"./wkt":65}],32:[function(a,b){var c=a("./constants/Datum"),d=a("./constants/Ellipsoid"),e=a("./extend"),f=a("./datum"),g=1e-10,h=.16666666666666666,i=.04722222222222222,j=.022156084656084655;b.exports=function(a){if(a.datumCode&&"none"!==a.datumCode){var b=c[a.datumCode];b&&(a.datum_params=b.towgs84?b.towgs84.split(","):null,a.ellps=b.ellipse,a.datumName=b.datumName?b.datumName:a.datumCode)}if(!a.a){var k=d[a.ellps]?d[a.ellps]:d.WGS84;e(a,k)}return a.rf&&!a.b&&(a.b=(1-1/a.rf)*a.a),(0===a.rf||Math.abs(a.a-a.b)<g)&&(a.sphere=!0,a.b=a.a),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=(a.a2-a.b2)/a.a2,a.e=Math.sqrt(a.es),a.R_A&&(a.a*=1-a.es*(h+a.es*(i+a.es*j)),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=0),a.ep2=(a.a2-a.b2)/a.b2,a.k0||(a.k0=1),a.axis||(a.axis="enu"),a.datum=f(a),a}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":29,"./extend":33}],33:[function(a,b){b.exports=function(a,b){a=a||{};var c,d;if(!b)return a;for(d in b)c=b[d],void 0!==c&&(a[d]=c);return a}},{}],34:[function(a,b){b.exports=function(a){a("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),a("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),a("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),a("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),a["EPSG:3785"]=a["EPSG:3857"],a.GOOGLE=a["EPSG:3857"],a["EPSG:900913"]=a["EPSG:3857"],a["EPSG:102113"]=a["EPSG:3857"]}},{}],35:[function(a,b){var c=a("./core");c.defaultDatum="WGS84",c.Proj=a("./Proj"),c.WGS84=new c.Proj("WGS84"),c.Point=a("./Point"),c.toPoint=a("./common/toPoint"),c.defs=a("./defs"),c.transform=a("./transform"),c.mgrs=a("mgrs"),c.version=a("../package.json").version,a("./includedProjections")(c),b.exports=c},{"../package.json":67,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":28,"./defs":31,"./includedProjections":"gWUPNW","./transform":64,mgrs:66}],36:[function(a,b){function c(a){return"string"==typeof a}function d(a){return a in h}function e(a){var b=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return b.reduce(function(b,c){return b+1+a.indexOf(c)},0)}function f(a){return"+"===a[0]}function g(a){return c(a)?d(a)?h[a]:e(a)?i(a):f(a)?j(a):void 0:a}var h=a("./defs"),i=a("./wkt"),j=a("./projString");b.exports=g},{"./defs":31,"./projString":37,"./wkt":65}],37:[function(a,b){var c=.017453292519943295,d=a("./constants/PrimeMeridian");b.exports=function(a){var b={},e={};a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).forEach(function(a){var b=a.split("=");b.push(!0),e[b[0].toLowerCase()]=b[1]});var f,g,h,i={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a,10)},lat_0:function(a){b.lat0=a*c},lat_1:function(a){b.lat1=a*c},lat_2:function(a){b.lat2=a*c},lat_ts:function(a){b.lat_ts=a*c},lon_0:function(a){b.long0=a*c},lon_1:function(a){b.long1=a*c},lon_2:function(a){b.long2=a*c},alpha:function(a){b.alpha=parseFloat(a)*c},lonc:function(a){b.longc=a*c},x_0:function(a){b.x0=parseFloat(a,10)},y_0:function(a){b.y0=parseFloat(a,10)},k_0:function(a){b.k0=parseFloat(a,10)},k:function(a){b.k0=parseFloat(a,10)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=a.split(",").map(function(a){return parseFloat(a,10)})},to_meter:function(a){b.to_meter=parseFloat(a,10)},from_greenwich:function(a){b.from_greenwich=a*c},pm:function(a){b.from_greenwich=(d[a]?d[a]:parseFloat(a,10))*c},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){var c="ewnsud";3===a.length&&-1!==c.indexOf(a.substr(0,1))&&-1!==c.indexOf(a.substr(1,1))&&-1!==c.indexOf(a.substr(2,1))&&(b.axis=a)}};for(f in e)g=e[f],f in i?(h=i[f],"function"==typeof h?h(g):b[h]=g):b[f]=g;return"string"==typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase()),b}},{"./constants/PrimeMeridian":27}],38:[function(a,b,c){function d(a,b){var c=g.length;return a.names?(g[c]=a,a.names.forEach(function(a){f[a.toLowerCase()]=c}),this):(console.log(b),!0)}var e=[a("./projections/merc"),a("./projections/longlat")],f={},g=[];c.add=d,c.get=function(a){if(!a)return!1;var b=a.toLowerCase();return"undefined"!=typeof f[b]&&g[f[b]]?g[f[b]]:void 0},c.start=function(){e.forEach(d)}},{"./projections/longlat":50,"./projections/merc":51}],39:[function(a,b,c){var d=1e-10,e=a("../common/msfnz"),f=a("../common/qsfnz"),g=a("../common/adjust_lon"),h=a("../common/asinz");c.init=function(){Math.abs(this.lat1+this.lat2)<d||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=e(this.e3,this.sin_po,this.cos_po),this.qs1=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=e(this.e3,this.sin_po,this.cos_po),this.qs2=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=f(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>d?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},c.forward=function(a){var b=a.x,c=a.y;this.sin_phi=Math.sin(c),this.cos_phi=Math.cos(c);var d=f(this.e3,this.sin_phi,this.cos_phi),e=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,h=this.ns0*g(b-this.long0),i=e*Math.sin(h)+this.x0,j=this.rh-e*Math.cos(h)+this.y0;return a.x=i,a.y=j,a},c.inverse=function(a){var b,c,d,e,f,h;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,this.ns0>=0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1),e=0,0!==b&&(e=Math.atan2(d*a.x,d*a.y)),d=b*this.ns0/this.a,this.sphere?h=Math.asin((this.c-d*d)/(2*this.ns0)):(c=(this.c-d*d)/this.ns0,h=this.phi1z(this.e3,c)),f=g(e/this.ns0+this.long0),a.x=f,a.y=h,a},c.phi1z=function(a,b){var c,e,f,g,i,j=h(.5*b);if(d>a)return j;for(var k=a*a,l=1;25>=l;l++)if(c=Math.sin(j),e=Math.cos(j),f=a*c,g=1-f*f,i=.5*g*g/e*(b/(1-k)-c/g+.5/a*Math.log((1-f)/(1+f))),j+=i,Math.abs(i)<=1e-7)return j;return null},c.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],40:[function(a,b,c){var d=a("../common/adjust_lon"),e=Math.PI/2,f=1e-10,g=a("../common/mlfn"),h=a("../common/e0fn"),i=a("../common/e1fn"),j=a("../common/e2fn"),k=a("../common/e3fn"),l=a("../common/gN"),m=a("../common/asinz"),n=a("../common/imlfn");c.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},c.forward=function(a){var b,c,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=a.x,I=a.y,J=Math.sin(a.y),K=Math.cos(a.y),L=d(H-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=f?(a.x=this.x0+this.a*(e-I)*Math.sin(L),a.y=this.y0-this.a*(e-I)*Math.cos(L),a):Math.abs(this.sin_p12+1)<=f?(a.x=this.x0+this.a*(e+I)*Math.sin(L),a.y=this.y0+this.a*(e+I)*Math.cos(L),a):(B=this.sin_p12*J+this.cos_p12*K*Math.cos(L),z=Math.acos(B),A=z/Math.sin(z),a.x=this.x0+this.a*A*K*Math.sin(L),a.y=this.y0+this.a*A*(this.cos_p12*J-this.sin_p12*K*Math.cos(L)),a):(b=h(this.es),c=i(this.es),m=j(this.es),n=k(this.es),Math.abs(this.sin_p12-1)<=f?(o=this.a*g(b,c,m,n,e),p=this.a*g(b,c,m,n,I),a.x=this.x0+(o-p)*Math.sin(L),a.y=this.y0-(o-p)*Math.cos(L),a):Math.abs(this.sin_p12+1)<=f?(o=this.a*g(b,c,m,n,e),p=this.a*g(b,c,m,n,I),a.x=this.x0+(o+p)*Math.sin(L),a.y=this.y0+(o+p)*Math.cos(L),a):(q=J/K,r=l(this.a,this.e,this.sin_p12),s=l(this.a,this.e,J),t=Math.atan((1-this.es)*q+this.es*r*this.sin_p12/(s*K)),u=Math.atan2(Math.sin(L),this.cos_p12*Math.tan(t)-this.sin_p12*Math.cos(L)),C=0===u?Math.asin(this.cos_p12*Math.sin(t)-this.sin_p12*Math.cos(t)):Math.abs(Math.abs(u)-Math.PI)<=f?-Math.asin(this.cos_p12*Math.sin(t)-this.sin_p12*Math.cos(t)):Math.asin(Math.sin(L)*Math.cos(t)/Math.sin(u)),v=this.e*this.sin_p12/Math.sqrt(1-this.es),w=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es),x=v*w,y=w*w,D=C*C,E=D*C,F=E*C,G=F*C,z=r*C*(1-D*y*(1-y)/6+E/8*x*(1-2*y)+F/120*(y*(4-7*y)-3*v*v*(1-7*y))-G/48*x),a.x=this.x0+z*Math.sin(u),a.y=this.y0+z*Math.cos(u),a))},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;if(this.sphere){if(b=Math.sqrt(a.x*a.x+a.y*a.y),b>2*e*this.a)return;return c=b/this.a,o=Math.sin(c),p=Math.cos(c),q=this.long0,Math.abs(b)<=f?r=this.lat0:(r=m(p*this.sin_p12+a.y*o*this.cos_p12/b),s=Math.abs(this.lat0)-e,q=d(Math.abs(s)<=f?this.lat0>=0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*o,b*this.cos_p12*p-a.y*this.sin_p12*o))),a.x=q,a.y=r,a}return t=h(this.es),u=i(this.es),v=j(this.es),w=k(this.es),Math.abs(this.sin_p12-1)<=f?(x=this.a*g(t,u,v,w,e),b=Math.sqrt(a.x*a.x+a.y*a.y),y=x-b,r=n(y/this.a,t,u,v,w),q=d(this.long0+Math.atan2(a.x,-1*a.y)),a.x=q,a.y=r,a):Math.abs(this.sin_p12+1)<=f?(x=this.a*g(t,u,v,w,e),b=Math.sqrt(a.x*a.x+a.y*a.y),y=b-x,r=n(y/this.a,t,u,v,w),q=d(this.long0+Math.atan2(a.x,a.y)),a.x=q,a.y=r,a):(b=Math.sqrt(a.x*a.x+a.y*a.y),B=Math.atan2(a.x,a.y),z=l(this.a,this.e,this.sin_p12),C=Math.cos(B),D=this.e*this.cos_p12*C,E=-D*D/(1-this.es),F=3*this.es*(1-E)*this.sin_p12*this.cos_p12*C/(1-this.es),G=b/z,H=G-E*(1+E)*Math.pow(G,3)/6-F*(1+3*E)*Math.pow(G,4)/24,I=1-E*H*H/2-G*H*H*H/6,A=Math.asin(this.sin_p12*Math.cos(H)+this.cos_p12*Math.sin(H)*C),q=d(this.long0+Math.asin(Math.sin(B)*Math.sin(H)/Math.cos(A))),r=Math.atan((1-this.es*I*this.sin_p12/Math.sin(A))*Math.tan(A)/(1-this.es)),a.x=q,a.y=r,a)},c.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],41:[function(a,b,c){var d=a("../common/mlfn"),e=a("../common/e0fn"),f=a("../common/e1fn"),g=a("../common/e2fn"),h=a("../common/e3fn"),i=a("../common/gN"),j=a("../common/adjust_lon"),k=a("../common/adjust_lat"),l=a("../common/imlfn"),m=Math.PI/2,n=1e-10;
c.init=function(){this.sphere||(this.e0=e(this.es),this.e1=f(this.es),this.e2=g(this.es),this.e3=h(this.es),this.ml0=this.a*d(this.e0,this.e1,this.e2,this.e3,this.lat0))},c.forward=function(a){var b,c,e=a.x,f=a.y;if(e=j(e-this.long0),this.sphere)b=this.a*Math.asin(Math.cos(f)*Math.sin(e)),c=this.a*(Math.atan2(Math.tan(f),Math.cos(e))-this.lat0);else{var g=Math.sin(f),h=Math.cos(f),k=i(this.a,this.e,g),l=Math.tan(f)*Math.tan(f),m=e*Math.cos(f),n=m*m,o=this.es*h*h/(1-this.es),p=this.a*d(this.e0,this.e1,this.e2,this.e3,f);b=k*m*(1-n*l*(1/6-(8-l+8*o)*n/120)),c=p-this.ml0+k*g/h*n*(.5+(5-l+6*o)*n/24)}return a.x=b+this.x0,a.y=c+this.y0,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,d=a.x/this.a,e=a.y/this.a;if(this.sphere){var f=e+this.lat0;b=Math.asin(Math.sin(f)*Math.cos(d)),c=Math.atan2(Math.tan(d),Math.cos(f))}else{var g=this.ml0/this.a+e,h=l(g,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(h)-m)<=n)return a.x=this.long0,a.y=m,0>e&&(a.y*=-1),a;var o=i(this.a,this.e,Math.sin(h)),p=o*o*o/this.a/this.a*(1-this.es),q=Math.pow(Math.tan(h),2),r=d*this.a/o,s=r*r;b=h-o*Math.tan(h)/p*r*r*(.5-(1+3*q)*r*r/24),c=r*(1-s*(q/3+(1+3*q)*q*s/15))/Math.cos(h)}return a.x=j(c+this.long0),a.y=k(b),a},c.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/qsfnz"),f=a("../common/msfnz"),g=a("../common/iqsfnz");c.init=function(){this.sphere||(this.k0=f(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},c.forward=function(a){var b,c,f=a.x,g=a.y,h=d(f-this.long0);if(this.sphere)b=this.x0+this.a*h*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(g)/Math.cos(this.lat_ts);else{var i=e(this.e,Math.sin(g));b=this.x0+this.a*this.k0*h,c=this.y0+this.a*i*.5/this.k0}return a.x=b,a.y=c,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c;return this.sphere?(b=d(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=g(this.e,2*a.y*this.k0/this.a),b=d(this.long0+a.x/(this.a*this.k0))),a.x=b,a.y=c,a},c.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],43:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/adjust_lat");c.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},c.forward=function(a){var b=a.x,c=a.y,f=d(b-this.long0),g=e(c-this.lat0);return a.x=this.x0+this.a*f*this.rc,a.y=this.y0+this.a*g,a},c.inverse=function(a){var b=a.x,c=a.y;return a.x=d(this.long0+(b-this.x0)/(this.a*this.rc)),a.y=e(this.lat0+(c-this.y0)/this.a),a},c.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],44:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/msfnz"),i=a("../common/mlfn"),j=a("../common/adjust_lon"),k=a("../common/adjust_lat"),l=a("../common/imlfn"),m=1e-10;c.init=function(){Math.abs(this.lat1+this.lat2)<m||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=h(this.e,this.sinphi,this.cosphi),this.ml1=i(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<m?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=h(this.e,this.sinphi,this.cosphi),this.ml2=i(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=i(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},c.forward=function(a){var b,c=a.x,d=a.y;if(this.sphere)b=this.a*(this.g-d);else{var e=i(this.e0,this.e1,this.e2,this.e3,d);b=this.a*(this.g-e)}var f=this.ns*j(c-this.long0),g=this.x0+b*Math.sin(f),h=this.y0+this.rh-b*Math.cos(f);return a.x=g,a.y=h,a},c.inverse=function(a){a.x-=this.x0,a.y=this.rh-a.y+this.y0;var b,c,d,e;this.ns>=0?(c=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(c=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var f=0;if(0!==c&&(f=Math.atan2(b*a.x,b*a.y)),this.sphere)return e=j(this.long0+f/this.ns),d=k(this.g-c/this.a),a.x=e,a.y=d,a;var g=this.g-c/this.a;return d=l(g,this.e0,this.e1,this.e2,this.e3),e=j(this.long0+f/this.ns),a.x=e,a.y=d,a},c.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],45:[function(a,b,c){var d=Math.PI/4,e=a("../common/srat"),f=Math.PI/2,g=20;c.init=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0);b*=b,this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a),this.C=Math.sqrt(1+this.es*b*b/(1-this.es)),this.phic0=Math.asin(a/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+d)/(Math.pow(Math.tan(.5*this.lat0+d),this.C)*e(this.e*a,this.ratexp))},c.forward=function(a){var b=a.x,c=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*c+d),this.C)*e(this.e*Math.sin(c),this.ratexp))-f,a.x=this.C*b,a},c.inverse=function(a){for(var b=1e-14,c=a.x/this.C,h=a.y,i=Math.pow(Math.tan(.5*h+d)/this.K,1/this.C),j=g;j>0&&(h=2*Math.atan(i*e(this.e*Math.sin(a.y),-.5*this.e))-f,!(Math.abs(h-a.y)<b));--j)a.y=h;return j?(a.x=c,a.y=h,a):null},c.names=["gauss"]},{"../common/srat":22}],46:[function(a,b,c){var d=a("../common/adjust_lon"),e=1e-10,f=a("../common/asinz");c.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},c.forward=function(a){var b,c,f,g,h,i,j,k,l=a.x,m=a.y;return f=d(l-this.long0),b=Math.sin(m),c=Math.cos(m),g=Math.cos(f),i=this.sin_p14*b+this.cos_p14*c*g,h=1,i>0||Math.abs(i)<=e?(j=this.x0+this.a*h*c*Math.sin(f)/i,k=this.y0+this.a*h*(this.cos_p14*b-this.sin_p14*c*g)/i):(j=this.x0+this.infinity_dist*c*Math.sin(f),k=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*c*g)),a.x=j,a.y=k,a},c.inverse=function(a){var b,c,e,g,h,i;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(b=Math.sqrt(a.x*a.x+a.y*a.y))?(g=Math.atan2(b,this.rc),c=Math.sin(g),e=Math.cos(g),i=f(e*this.sin_p14+a.y*c*this.cos_p14/b),h=Math.atan2(a.x*c,b*this.cos_p14*e-a.y*this.sin_p14*c),h=d(this.long0+h)):(i=this.phic0,h=0),a.x=h,a.y=i,a},c.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],47:[function(a,b,c){var d=a("../common/adjust_lon");c.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},c.forward=function(a){var b,c,e,f,g,h,i,j=a.x,k=a.y,l=d(j-this.long0);return b=Math.pow((1+this.e*Math.sin(k))/(1-this.e*Math.sin(k)),this.alfa*this.e/2),c=2*(Math.atan(this.k*Math.pow(Math.tan(k/2+this.s45),this.alfa)/b)-this.s45),e=-l*this.alfa,f=Math.asin(Math.cos(this.ad)*Math.sin(c)+Math.sin(this.ad)*Math.cos(c)*Math.cos(e)),g=Math.asin(Math.cos(c)*Math.sin(e)/Math.cos(f)),h=this.n*g,i=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(f/2+this.s45),this.n),a.y=i*Math.cos(h)/1,a.x=i*Math.sin(h)/1,this.czech||(a.y*=-1,a.x*=-1),a},c.inverse=function(a){var b,c,d,e,f,g,h,i,j=a.x;a.x=a.y,a.y=j,this.czech||(a.y*=-1,a.x*=-1),g=Math.sqrt(a.x*a.x+a.y*a.y),f=Math.atan2(a.y,a.x),e=f/Math.sin(this.s0),d=2*(Math.atan(Math.pow(this.ro0/g,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),b=Math.asin(Math.cos(this.ad)*Math.sin(d)-Math.sin(this.ad)*Math.cos(d)*Math.cos(e)),c=Math.asin(Math.cos(d)*Math.sin(e)/Math.cos(b)),a.x=this.long0-c/this.alfa,h=b,i=0;var k=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.e/2))-this.s45),Math.abs(h-a.y)<1e-10&&(i=1),h=a.y,k+=1;while(0===i&&15>k);return k>=15?null:a},c.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],48:[function(a,b,c){var d=Math.PI/2,e=Math.PI/4,f=1e-10,g=a("../common/qsfnz"),h=a("../common/adjust_lon");c.S_POLE=1,c.N_POLE=2,c.EQUIT=3,c.OBLIQ=4,c.init=function(){var a=Math.abs(this.lat0);if(this.mode=Math.abs(a-d)<f?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(a)<f?this.EQUIT:this.OBLIQ,this.es>0){var b;switch(this.qp=g(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=g(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},c.forward=function(a){var b,c,i,j,k,l,m,n,o,p,q=a.x,r=a.y;if(q=h(q-this.long0),this.sphere){if(k=Math.sin(r),p=Math.cos(r),i=Math.cos(q),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c=this.mode===this.EQUIT?1+p*i:1+this.sinph0*k+this.cosph0*p*i,f>=c)return null;c=Math.sqrt(2/c),b=c*p*Math.sin(q),c*=this.mode===this.EQUIT?k:this.cosph0*k-this.sinph0*p*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(r+this.phi0)<f)return null;c=e-.5*r,c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c)),b=c*Math.sin(q),c*=i}}else{switch(m=0,n=0,o=0,i=Math.cos(q),j=Math.sin(q),k=Math.sin(r),l=g(this.e,k),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=l/this.qp,n=Math.sqrt(1-m*m)),this.mode){case this.OBLIQ:o=1+this.sinb1*m+this.cosb1*n*i;break;case this.EQUIT:o=1+n*i;break;case this.N_POLE:o=d+r,l=this.qp-l;break;case this.S_POLE:o=r-d,l=this.qp+l}if(Math.abs(o)<f)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:o=Math.sqrt(2/o),c=this.mode===this.OBLIQ?this.ymf*o*(this.cosb1*m-this.sinb1*n*i):(o=Math.sqrt(2/(1+n*i)))*m*this.ymf,b=this.xmf*o*n*j;break;case this.N_POLE:case this.S_POLE:l>=0?(b=(o=Math.sqrt(l))*j,c=i*(this.mode===this.S_POLE?o:-o)):b=c=0}}return a.x=this.a*b+this.x0,a.y=this.a*c+this.y0,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,e,g,i,j,k,l=a.x/this.a,m=a.y/this.a;if(this.sphere){var n,o=0,p=0;if(n=Math.sqrt(l*l+m*m),c=.5*n,c>1)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=Math.sin(c),o=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(n)<=f?0:Math.asin(m*p/n),l*=p,m=o*n;break;case this.OBLIQ:c=Math.abs(n)<=f?this.phi0:Math.asin(o*this.sinph0+m*p*this.cosph0/n),l*=p*this.cosph0,m=(o-Math.sin(c)*this.sinph0)*n;break;case this.N_POLE:m=-m,c=d-c;break;case this.S_POLE:c-=d}b=0!==m||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,m):0}else{if(k=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,m*=this.dd,j=Math.sqrt(l*l+m*m),f>j)return a.x=0,a.y=this.phi0,a;g=2*Math.asin(.5*j/this.rq),e=Math.cos(g),l*=g=Math.sin(g),this.mode===this.OBLIQ?(k=e*this.sinb1+m*g*this.cosb1/j,i=this.qp*k,m=j*this.cosb1*e-m*this.sinb1*g):(k=m*g/j,i=this.qp*k,m=j*e)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(m=-m),i=l*l+m*m,!i)return a.x=0,a.y=this.phi0,a;k=1-i/this.qp,this.mode===this.S_POLE&&(k=-k)}b=Math.atan2(l,m),c=this.authlat(Math.asin(k),this.apa)}return a.x=h(this.long0+b),a.y=c,a},c.P00=.3333333333333333,c.P01=.17222222222222222,c.P02=.10257936507936508,c.P10=.06388888888888888,c.P11=.0664021164021164,c.P20=.016415012942191543,c.authset=function(a){var b,c=[];return c[0]=a*this.P00,b=a*a,c[0]+=b*this.P01,c[1]=b*this.P10,b*=a,c[0]+=b*this.P02,c[1]+=b*this.P11,c[2]=b*this.P20,c},c.authlat=function(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)},c.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],49:[function(a,b,c){var d=1e-10,e=a("../common/msfnz"),f=a("../common/tsfnz"),g=Math.PI/2,h=a("../common/sign"),i=a("../common/adjust_lon"),j=a("../common/phi2z");c.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<d)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var b=Math.sin(this.lat1),c=Math.cos(this.lat1),g=e(this.e,b,c),h=f(this.e,this.lat1,b),i=Math.sin(this.lat2),j=Math.cos(this.lat2),k=e(this.e,i,j),l=f(this.e,this.lat2,i),m=f(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>d?Math.log(g/k)/Math.log(h/l):b,isNaN(this.ns)&&(this.ns=b),this.f0=g/(this.ns*Math.pow(h,this.ns)),this.rh=this.a*this.f0*Math.pow(m,this.ns),this.title||(this.title="Lambert Conformal Conic")}},c.forward=function(a){var b=a.x,c=a.y;Math.abs(2*Math.abs(c)-Math.PI)<=d&&(c=h(c)*(g-2*d));var e,j,k=Math.abs(Math.abs(c)-g);if(k>d)e=f(this.e,c,Math.sin(c)),j=this.a*this.f0*Math.pow(e,this.ns);else{if(k=c*this.ns,0>=k)return null;j=0}var l=this.ns*i(b-this.long0);return a.x=this.k0*j*Math.sin(l)+this.x0,a.y=this.k0*(this.rh-j*Math.cos(l))+this.y0,a},c.inverse=function(a){var b,c,d,e,f,h=(a.x-this.x0)/this.k0,k=this.rh-(a.y-this.y0)/this.k0;this.ns>0?(b=Math.sqrt(h*h+k*k),c=1):(b=-Math.sqrt(h*h+k*k),c=-1);var l=0;if(0!==b&&(l=Math.atan2(c*h,c*k)),0!==b||this.ns>0){if(c=1/this.ns,d=Math.pow(b/(this.a*this.f0),c),e=j(this.e,d),-9999===e)return null}else e=-g;return f=i(l/this.ns+this.long0),a.x=f,a.y=e,a},c.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],50:[function(a,b,c){function d(a){return a}c.init=function(){},c.forward=d,c.inverse=d,c.names=["longlat","identity"]},{}],51:[function(a,b,c){var d=a("../common/msfnz"),e=Math.PI/2,f=1e-10,g=57.29577951308232,h=a("../common/adjust_lon"),i=Math.PI/4,j=a("../common/tsfnz"),k=a("../common/phi2z");c.init=function(){var a=this.b/this.a;this.es=1-a*a,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):d(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},c.forward=function(a){var b=a.x,c=a.y;if(c*g>90&&-90>c*g&&b*g>180&&-180>b*g)return null;var d,k;if(Math.abs(Math.abs(c)-e)<=f)return null;if(this.sphere)d=this.x0+this.a*this.k0*h(b-this.long0),k=this.y0+this.a*this.k0*Math.log(Math.tan(i+.5*c));else{var l=Math.sin(c),m=j(this.e,c,l);d=this.x0+this.a*this.k0*h(b-this.long0),k=this.y0-this.a*this.k0*Math.log(m)}return a.x=d,a.y=k,a},c.inverse=function(a){var b,c,d=a.x-this.x0,f=a.y-this.y0;if(this.sphere)c=e-2*Math.atan(Math.exp(-f/(this.a*this.k0)));else{var g=Math.exp(-f/(this.a*this.k0));if(c=k(this.e,g),-9999===c)return null}return b=h(this.long0+d/(this.a*this.k0)),a.x=b,a.y=c,a},c.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],52:[function(a,b,c){var d=a("../common/adjust_lon");c.init=function(){},c.forward=function(a){var b=a.x,c=a.y,e=d(b-this.long0),f=this.x0+this.a*e,g=this.y0+this.a*Math.log(Math.tan(Math.PI/4+c/2.5))*1.25;return a.x=f,a.y=g,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b=d(this.long0+a.x/this.a),c=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=b,a.y=c,a},c.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],53:[function(a,b,c){var d=a("../common/adjust_lon"),e=1e-10;c.init=function(){},c.forward=function(a){for(var b=a.x,c=a.y,f=d(b-this.long0),g=c,h=Math.PI*Math.sin(c),i=0;!0;i++){var j=-(g+Math.sin(g)-h)/(1+Math.cos(g));if(g+=j,Math.abs(j)<e)break}g/=2,Math.PI/2-Math.abs(c)<e&&(f=0);var k=.900316316158*this.a*f*Math.cos(g)+this.x0,l=1.4142135623731*this.a*Math.sin(g)+this.y0;return a.x=k,a.y=l,a},c.inverse=function(a){var b,c;a.x-=this.x0,a.y-=this.y0,c=a.y/(1.4142135623731*this.a),Math.abs(c)>.999999999999&&(c=.999999999999),b=Math.asin(c);var e=d(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));e<-Math.PI&&(e=-Math.PI),e>Math.PI&&(e=Math.PI),c=(2*b+Math.sin(2*b))/Math.PI,Math.abs(c)>1&&(c=1);var f=Math.asin(c);return a.x=e,a.y=f,a},c.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],54:[function(a,b,c){var d=484813681109536e-20;c.iterations=1,c.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},c.forward=function(a){var b,c=a.x,e=a.y,f=e-this.lat0,g=c-this.long0,h=f/d*1e-5,i=g,j=1,k=0;for(b=1;10>=b;b++)j*=h,k+=this.A[b]*j;var l,m,n=k,o=i,p=1,q=0,r=0,s=0;for(b=1;6>=b;b++)l=p*n-q*o,m=q*n+p*o,p=l,q=m,r=r+this.B_re[b]*p-this.B_im[b]*q,s=s+this.B_im[b]*p+this.B_re[b]*q;return a.x=s*this.a+this.x0,a.y=r*this.a+this.y0,a},c.inverse=function(a){var b,c,e,f=a.x,g=a.y,h=f-this.x0,i=g-this.y0,j=i/this.a,k=h/this.a,l=1,m=0,n=0,o=0;for(b=1;6>=b;b++)c=l*j-m*k,e=m*j+l*k,l=c,m=e,n=n+this.C_re[b]*l-this.C_im[b]*m,o=o+this.C_im[b]*l+this.C_re[b]*m;for(var p=0;p<this.iterations;p++){var q,r,s=n,t=o,u=j,v=k;for(b=2;6>=b;b++)q=s*n-t*o,r=t*n+s*o,s=q,t=r,u+=(b-1)*(this.B_re[b]*s-this.B_im[b]*t),v+=(b-1)*(this.B_im[b]*s+this.B_re[b]*t);s=1,t=0;var w=this.B_re[1],x=this.B_im[1];for(b=2;6>=b;b++)q=s*n-t*o,r=t*n+s*o,s=q,t=r,w+=b*(this.B_re[b]*s-this.B_im[b]*t),x+=b*(this.B_im[b]*s+this.B_re[b]*t);var y=w*w+x*x;n=(u*w+v*x)/y,o=(v*w-u*x)/y}var z=n,A=o,B=1,C=0;for(b=1;9>=b;b++)B*=z,C+=this.D[b]*B;var D=this.lat0+C*d*1e5,E=this.long0+A;return a.x=E,a.y=D,a},c.names=["New_Zealand_Map_Grid","nzmg"]},{}],55:[function(a,b,c){var d=a("../common/tsfnz"),e=a("../common/adjust_lon"),f=a("../common/phi2z"),g=Math.PI/2,h=Math.PI/4,i=1e-10;c.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),c=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-c*c);var f=d(this.e,this.lat0,a),g=this.bl/b*Math.sqrt((1-this.es)/(1-c*c));1>g*g&&(g=1);var h,i;if(isNaN(this.longc)){var j=d(this.e,this.lat1,Math.sin(this.lat1)),k=d(this.e,this.lat2,Math.sin(this.lat2));this.el=this.lat0>=0?(g+Math.sqrt(g*g-1))*Math.pow(f,this.bl):(g-Math.sqrt(g*g-1))*Math.pow(f,this.bl);var l=Math.pow(j,this.bl),m=Math.pow(k,this.bl);h=this.el/l,i=.5*(h-1/h);var n=(this.el*this.el-m*l)/(this.el*this.el+m*l),o=(m-l)/(m+l),p=e(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(n*Math.tan(.5*this.bl*p)/o)/this.bl,this.long0=e(this.long0);var q=e(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*q)/i),this.alpha=Math.asin(g*Math.sin(this.gamma0))}else h=this.lat0>=0?g+Math.sqrt(g*g-1):g-Math.sqrt(g*g-1),this.el=h*Math.pow(f,this.bl),i=.5*(h-1/h),this.gamma0=Math.asin(Math.sin(this.alpha)/g),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:this.lat0>=0?this.al/this.bl*Math.atan2(Math.sqrt(g*g-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(g*g-1),Math.cos(this.alpha))},c.forward=function(a){var b,c,f,j=a.x,k=a.y,l=e(j-this.long0);if(Math.abs(Math.abs(k)-g)<=i)f=k>0?-1:1,c=this.al/this.bl*Math.log(Math.tan(h+f*this.gamma0*.5)),b=-1*f*g*this.al/this.bl;else{var m=d(this.e,k,Math.sin(k)),n=this.el/Math.pow(m,this.bl),o=.5*(n-1/n),p=.5*(n+1/n),q=Math.sin(this.bl*l),r=(o*Math.sin(this.gamma0)-q*Math.cos(this.gamma0))/p;c=Math.abs(Math.abs(r)-1)<=i?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-r)/(1+r))/this.bl,b=Math.abs(Math.cos(this.bl*l))<=i?this.al*this.bl*l:this.al*Math.atan2(o*Math.cos(this.gamma0)+q*Math.sin(this.gamma0),Math.cos(this.bl*l))/this.bl}return this.no_rot?(a.x=this.x0+b,a.y=this.y0+c):(b-=this.uc,a.x=this.x0+c*Math.cos(this.alpha)+b*Math.sin(this.alpha),a.y=this.y0+b*Math.cos(this.alpha)-c*Math.sin(this.alpha)),a},c.inverse=function(a){var b,c;this.no_rot?(c=a.y-this.y0,b=a.x-this.x0):(c=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var d=Math.exp(-1*this.bl*c/this.al),h=.5*(d-1/d),j=.5*(d+1/d),k=Math.sin(this.bl*b/this.al),l=(k*Math.cos(this.gamma0)+h*Math.sin(this.gamma0))/j,m=Math.pow(this.el/Math.sqrt((1+l)/(1-l)),1/this.bl);return Math.abs(l-1)<i?(a.x=this.long0,a.y=g):Math.abs(l+1)<i?(a.x=this.long0,a.y=-1*g):(a.y=f(this.e,m),a.x=e(this.long0-Math.atan2(h*Math.cos(this.gamma0)-k*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a},c.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],56:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/adjust_lon"),i=a("../common/adjust_lat"),j=a("../common/mlfn"),k=1e-10,l=a("../common/gN"),m=20;c.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.ml0=this.a*j(this.e0,this.e1,this.e2,this.e3,this.lat0)},c.forward=function(a){var b,c,d,e=a.x,f=a.y,g=h(e-this.long0);if(d=g*Math.sin(f),this.sphere)Math.abs(f)<=k?(b=this.a*g,c=-1*this.a*this.lat0):(b=this.a*Math.sin(d)/Math.tan(f),c=this.a*(i(f-this.lat0)+(1-Math.cos(d))/Math.tan(f)));else if(Math.abs(f)<=k)b=this.a*g,c=-1*this.ml0;else{var m=l(this.a,this.e,Math.sin(f))/Math.tan(f);b=m*Math.sin(d),c=this.a*j(this.e0,this.e1,this.e2,this.e3,f)-this.ml0+m*(1-Math.cos(d))}return a.x=b+this.x0,a.y=c+this.y0,a},c.inverse=function(a){var b,c,d,e,f,g,i,l,n;if(d=a.x-this.x0,e=a.y-this.y0,this.sphere)if(Math.abs(e+this.a*this.lat0)<=k)b=h(d/this.a+this.long0),c=0;else{g=this.lat0+e/this.a,i=d*d/this.a/this.a+g*g,l=g;var o;for(f=m;f;--f)if(o=Math.tan(l),n=-1*(g*(l*o+1)-l-.5*(l*l+i)*o)/((l-g)/o-1),l+=n,Math.abs(n)<=k){c=l;break}b=h(this.long0+Math.asin(d*Math.tan(l)/this.a)/Math.sin(c))}else if(Math.abs(e+this.ml0)<=k)c=0,b=h(this.long0+d/this.a);else{g=(this.ml0+e)/this.a,i=d*d/this.a/this.a+g*g,l=g;var p,q,r,s,t;for(f=m;f;--f)if(t=this.e*Math.sin(l),p=Math.sqrt(1-t*t)*Math.tan(l),q=this.a*j(this.e0,this.e1,this.e2,this.e3,l),r=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),s=q/this.a,n=(g*(p*s+1)-s-.5*p*(s*s+i))/(this.es*Math.sin(2*l)*(s*s+i-2*g*s)/(4*p)+(g-s)*(p*r-2/Math.sin(2*l))-r),l-=n,Math.abs(n)<=k){c=l;break}p=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c),b=h(this.long0+Math.asin(d*p/this.a)/Math.sin(c))}return a.x=b,a.y=c,a},c.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],57:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/adjust_lat"),f=a("../common/pj_enfn"),g=20,h=a("../common/pj_mlfn"),i=a("../common/pj_inv_mlfn"),j=Math.PI/2,k=1e-10,l=a("../common/asinz");c.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=f(this.es)},c.forward=function(a){var b,c,e=a.x,f=a.y;if(e=d(e-this.long0),this.sphere){if(this.m)for(var i=this.n*Math.sin(f),j=g;j;--j){var l=(this.m*f+Math.sin(f)-i)/(this.m+Math.cos(f));if(f-=l,Math.abs(l)<k)break}else f=1!==this.n?Math.asin(this.n*Math.sin(f)):f;b=this.a*this.C_x*e*(this.m+Math.cos(f)),c=this.a*this.C_y*f}else{var m=Math.sin(f),n=Math.cos(f);c=this.a*h(f,m,n,this.en),b=this.a*e*n/Math.sqrt(1-this.es*m*m)}return a.x=b,a.y=c,a},c.inverse=function(a){var b,c,f,g;return a.x-=this.x0,f=a.x/this.a,a.y-=this.y0,b=a.y/this.a,this.sphere?(b/=this.C_y,f/=this.C_x*(this.m+Math.cos(b)),this.m?b=l((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=l(Math.sin(b)/this.n)),f=d(f+this.long0),b=e(b)):(b=i(a.y/this.a,this.es,this.en),g=Math.abs(b),j>g?(g=Math.sin(b),c=this.long0+a.x*Math.sqrt(1-this.es*g*g)/(this.a*Math.cos(b)),f=d(c)):j>g-k&&(f=this.long0)),a.x=f,a.y=b,a},c.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],58:[function(a,b,c){c.init=function(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),c=this.a,d=this.rf,e=1/d,f=2*e-Math.pow(e,2),g=this.e=Math.sqrt(f);this.R=this.k0*c*Math.sqrt(1-f)/(1-f*Math.pow(b,2)),this.alpha=Math.sqrt(1+f/(1-f)*Math.pow(Math.cos(a),4)),this.b0=Math.asin(b/this.alpha);var h=Math.log(Math.tan(Math.PI/4+this.b0/2)),i=Math.log(Math.tan(Math.PI/4+a/2)),j=Math.log((1+g*b)/(1-g*b));this.K=h-this.alpha*i+this.alpha*g/2*j},c.forward=function(a){var b=Math.log(Math.tan(Math.PI/4-a.y/2)),c=this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))),d=-this.alpha*(b+c)+this.K,e=2*(Math.atan(Math.exp(d))-Math.PI/4),f=this.alpha*(a.x-this.lambda0),g=Math.atan(Math.sin(f)/(Math.sin(this.b0)*Math.tan(e)+Math.cos(this.b0)*Math.cos(f))),h=Math.asin(Math.cos(this.b0)*Math.sin(e)-Math.sin(this.b0)*Math.cos(e)*Math.cos(f));return a.y=this.R/2*Math.log((1+Math.sin(h))/(1-Math.sin(h)))+this.y0,a.x=this.R*g+this.x0,a},c.inverse=function(a){for(var b=a.x-this.x0,c=a.y-this.y0,d=b/this.R,e=2*(Math.atan(Math.exp(c/this.R))-Math.PI/4),f=Math.asin(Math.cos(this.b0)*Math.sin(e)+Math.sin(this.b0)*Math.cos(e)*Math.cos(d)),g=Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*Math.tan(e))),h=this.lambda0+g/this.alpha,i=0,j=f,k=-1e3,l=0;Math.abs(j-k)>1e-7;){if(++l>20)return;i=1/this.alpha*(Math.log(Math.tan(Math.PI/4+f/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(j))/2)),k=j,j=2*Math.atan(Math.exp(i))-Math.PI/2}return a.x=h,a.y=j,a},c.names=["somerc"]},{}],59:[function(a,b,c){var d=Math.PI/2,e=1e-10,f=a("../common/sign"),g=a("../common/msfnz"),h=a("../common/tsfnz"),i=a("../common/phi2z"),j=a("../common/adjust_lon");c.ssfn_=function(a,b,c){return b*=c,Math.tan(.5*(d+a))*Math.pow((1-b)/(1+b),.5*c)},c.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=e&&(this.k0=.5*(1+f(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=e&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=e&&(this.k0=.5*this.cons*g(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/h(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=g(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-d,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},c.forward=function(a){var b,c,f,g,i,k,l=a.x,m=a.y,n=Math.sin(m),o=Math.cos(m),p=j(l-this.long0);return Math.abs(Math.abs(l-this.long0)-Math.PI)<=e&&Math.abs(m+this.lat0)<=e?(a.x=0/0,a.y=0/0,a):this.sphere?(b=2*this.k0/(1+this.sinlat0*n+this.coslat0*o*Math.cos(p)),a.x=this.a*b*o*Math.sin(p)+this.x0,a.y=this.a*b*(this.coslat0*n-this.sinlat0*o*Math.cos(p))+this.y0,a):(c=2*Math.atan(this.ssfn_(m,n,this.e))-d,g=Math.cos(c),f=Math.sin(c),Math.abs(this.coslat0)<=e?(i=h(this.e,m*this.con,this.con*n),k=2*this.a*this.k0*i/this.cons,a.x=this.x0+k*Math.sin(l-this.long0),a.y=this.y0-this.con*k*Math.cos(l-this.long0),a):(Math.abs(this.sinlat0)<e?(b=2*this.a*this.k0/(1+g*Math.cos(p)),a.y=b*f):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*f+this.cosX0*g*Math.cos(p))),a.y=b*(this.cosX0*f-this.sinX0*g*Math.cos(p))+this.y0),a.x=b*g*Math.sin(p)+this.x0,a))},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,f,g,h,k=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){var l=2*Math.atan(k/(.5*this.a*this.k0));return b=this.long0,c=this.lat0,e>=k?(a.x=b,a.y=c,a):(c=Math.asin(Math.cos(l)*this.sinlat0+a.y*Math.sin(l)*this.coslat0/k),b=j(Math.abs(this.coslat0)<e?this.lat0>0?this.long0+Math.atan2(a.x,-1*a.y):this.long0+Math.atan2(a.x,a.y):this.long0+Math.atan2(a.x*Math.sin(l),k*this.coslat0*Math.cos(l)-a.y*this.sinlat0*Math.sin(l))),a.x=b,a.y=c,a)}if(Math.abs(this.coslat0)<=e){if(e>=k)return c=this.lat0,b=this.long0,a.x=b,a.y=c,a;a.x*=this.con,a.y*=this.con,f=k*this.cons/(2*this.a*this.k0),c=this.con*i(this.e,f),b=this.con*j(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else g=2*Math.atan(k*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,e>=k?h=this.X0:(h=Math.asin(Math.cos(g)*this.sinX0+a.y*Math.sin(g)*this.cosX0/k),b=j(this.long0+Math.atan2(a.x*Math.sin(g),k*this.cosX0*Math.cos(g)-a.y*this.sinX0*Math.sin(g)))),c=-1*i(this.e,Math.tan(.5*(d+h)));return a.x=b,a.y=c,a},c.names=["stere"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],60:[function(a,b,c){var d=a("./gauss"),e=a("../common/adjust_lon");c.init=function(){d.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},c.forward=function(a){var b,c,f,g;return a.x=e(a.x-this.long0),d.forward.apply(this,[a]),b=Math.sin(a.y),c=Math.cos(a.y),f=Math.cos(a.x),g=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*c*f),a.x=g*c*Math.sin(a.x),a.y=g*(this.cosc0*b-this.sinc0*c*f),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a},c.inverse=function(a){var b,c,f,g,h;if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,h=Math.sqrt(a.x*a.x+a.y*a.y)){var i=2*Math.atan2(h,this.R2);b=Math.sin(i),c=Math.cos(i),g=Math.asin(c*this.sinc0+a.y*b*this.cosc0/h),f=Math.atan2(a.x*b,h*this.cosc0*c-a.y*this.sinc0*b)}else g=this.phic0,f=0;return a.x=f,a.y=g,d.inverse.apply(this,[a]),a.x=e(a.x+this.long0),a},c.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":45}],61:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/mlfn"),i=a("../common/adjust_lon"),j=Math.PI/2,k=1e-10,l=a("../common/sign"),m=a("../common/asinz");
c.init=function(){this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.ml0=this.a*h(this.e0,this.e1,this.e2,this.e3,this.lat0)},c.forward=function(a){var b,c,d,e=a.x,f=a.y,g=i(e-this.long0),j=Math.sin(f),k=Math.cos(f);if(this.sphere){var l=k*Math.sin(g);if(Math.abs(Math.abs(l)-1)<1e-10)return 93;c=.5*this.a*this.k0*Math.log((1+l)/(1-l)),b=Math.acos(k*Math.cos(g)/Math.sqrt(1-l*l)),0>f&&(b=-b),d=this.a*this.k0*(b-this.lat0)}else{var m=k*g,n=Math.pow(m,2),o=this.ep2*Math.pow(k,2),p=Math.tan(f),q=Math.pow(p,2);b=1-this.es*Math.pow(j,2);var r=this.a/Math.sqrt(b),s=this.a*h(this.e0,this.e1,this.e2,this.e3,f);c=this.k0*r*m*(1+n/6*(1-q+o+n/20*(5-18*q+Math.pow(q,2)+72*o-58*this.ep2)))+this.x0,d=this.k0*(s-this.ml0+r*p*n*(.5+n/24*(5-q+9*o+4*Math.pow(o,2)+n/30*(61-58*q+Math.pow(q,2)+600*o-330*this.ep2))))+this.y0}return a.x=c,a.y=d,a},c.inverse=function(a){var b,c,d,e,f,g,h=6;if(this.sphere){var n=Math.exp(a.x/(this.a*this.k0)),o=.5*(n-1/n),p=this.lat0+a.y/(this.a*this.k0),q=Math.cos(p);b=Math.sqrt((1-q*q)/(1+o*o)),f=m(b),0>p&&(f=-f),g=0===o&&0===q?this.long0:i(Math.atan2(o,q)+this.long0)}else{var r=a.x-this.x0,s=a.y-this.y0;for(b=(this.ml0+s/this.k0)/this.a,c=b,e=0;d=(b+this.e1*Math.sin(2*c)-this.e2*Math.sin(4*c)+this.e3*Math.sin(6*c))/this.e0-c,c+=d,!(Math.abs(d)<=k);e++)if(e>=h)return 95;if(Math.abs(c)<j){var t=Math.sin(c),u=Math.cos(c),v=Math.tan(c),w=this.ep2*Math.pow(u,2),x=Math.pow(w,2),y=Math.pow(v,2),z=Math.pow(y,2);b=1-this.es*Math.pow(t,2);var A=this.a/Math.sqrt(b),B=A*(1-this.es)/b,C=r/(A*this.k0),D=Math.pow(C,2);f=c-A*v*D/B*(.5-D/24*(5+3*y+10*w-4*x-9*this.ep2-D/30*(61+90*y+298*w+45*z-252*this.ep2-3*x))),g=i(this.long0+C*(1-D/6*(1+2*y+w-D/20*(5-2*w+28*y-3*x+8*this.ep2+24*z)))/u)}else f=j*l(s),g=this.long0}return a.x=g,a.y=f,a},c.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],62:[function(a,b,c){var d=.017453292519943295,e=a("./tmerc");c.dependsOn="tmerc",c.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*d,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,e.init.apply(this),this.forward=e.forward,this.inverse=e.inverse)},c.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":61}],63:[function(a,b,c){var d=a("../common/adjust_lon"),e=Math.PI/2,f=1e-10,g=a("../common/asinz");c.init=function(){this.R=this.a},c.forward=function(a){var b,c,h=a.x,i=a.y,j=d(h-this.long0);Math.abs(i)<=f&&(b=this.x0+this.R*j,c=this.y0);var k=g(2*Math.abs(i/Math.PI));(Math.abs(j)<=f||Math.abs(Math.abs(i)-e)<=f)&&(b=this.x0,c=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*k):this.y0+Math.PI*this.R*-Math.tan(.5*k));var l=.5*Math.abs(Math.PI/j-j/Math.PI),m=l*l,n=Math.sin(k),o=Math.cos(k),p=o/(n+o-1),q=p*p,r=p*(2/n-1),s=r*r,t=Math.PI*this.R*(l*(p-s)+Math.sqrt(m*(p-s)*(p-s)-(s+m)*(q-s)))/(s+m);0>j&&(t=-t),b=this.x0+t;var u=m+p;return t=Math.PI*this.R*(r*u-l*Math.sqrt((s+m)*(m+1)-u*u))/(s+m),c=i>=0?this.y0+t:this.y0-t,a.x=b,a.y=c,a},c.inverse=function(a){var b,c,e,g,h,i,j,k,l,m,n,o,p;return a.x-=this.x0,a.y-=this.y0,n=Math.PI*this.R,e=a.x/n,g=a.y/n,h=e*e+g*g,i=-Math.abs(g)*(1+h),j=i-2*g*g+e*e,k=-2*i+1+2*g*g+h*h,p=g*g/k+(2*j*j*j/k/k/k-9*i*j/k/k)/27,l=(i-j*j/3/k)/k,m=2*Math.sqrt(-l/3),n=3*p/l/m,Math.abs(n)>1&&(n=n>=0?1:-1),o=Math.acos(n)/3,c=a.y>=0?(-m*Math.cos(o+Math.PI/3)-j/3/k)*Math.PI:-(-m*Math.cos(o+Math.PI/3)-j/3/k)*Math.PI,b=Math.abs(e)<f?this.long0:d(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(e*e-g*g)+h*h))/2/e),a.x=b,a.y=c,a},c.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],64:[function(a,b){var c=.017453292519943295,d=57.29577951308232,e=1,f=2,g=a("./datum_transform"),h=a("./adjust_axis"),i=a("./Proj"),j=a("./common/toPoint");b.exports=function k(a,b,l){function m(a,b){return(a.datum.datum_type===e||a.datum.datum_type===f)&&"WGS84"!==b.datumCode}var n;return Array.isArray(l)&&(l=j(l)),a.datum&&b.datum&&(m(a,b)||m(b,a))&&(n=new i("WGS84"),k(a,n,l),a=n),"enu"!==a.axis&&h(a,!1,l),"longlat"===a.projName?(l.x*=c,l.y*=c):(a.to_meter&&(l.x*=a.to_meter,l.y*=a.to_meter),a.inverse(l)),a.from_greenwich&&(l.x+=a.from_greenwich),l=g(a.datum,b.datum,l),b.from_greenwich&&(l.x-=b.from_greenwich),"longlat"===b.projName?(l.x*=d,l.y*=d):(b.forward(l),b.to_meter&&(l.x/=b.to_meter,l.y/=b.to_meter)),"enu"!==b.axis&&h(b,!0,l),l}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":30}],65:[function(a,b){function c(a,b,c){a[b]=c.map(function(a){var b={};return d(a,b),b}).reduce(function(a,b){return i(a,b)},{})}function d(a,b){var e;return Array.isArray(a)?(e=a.shift(),"PARAMETER"===e&&(e=a.shift()),void(1===a.length?Array.isArray(a[0])?(b[e]={},d(a[0],b[e])):b[e]=a[0]:a.length?"TOWGS84"===e?b[e]=a:(b[e]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(e)>-1?(b[e]={name:a[0].toLowerCase(),convert:a[1]},3===a.length&&(b[e].auth=a[2])):"SPHEROID"===e?(b[e]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(b[e].auth=a[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(e)>-1?(a[0]=["name",a[0]],c(b,e,a)):a.every(function(a){return Array.isArray(a)})?c(b,e,a):d(a,b[e])):b[e]=!0)):void(b[a]=!0)}function e(a,b){var c=b[0],d=b[1];!(c in a)&&d in a&&(a[c]=a[d],3===b.length&&(a[c]=b[2](a[c])))}function f(a){return a*h}function g(a){function b(b){var c=a.to_meter||1;return parseFloat(b,10)*c}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):a.projName="object"==typeof a.PROJECTION?Object.keys(a.PROJECTION)[0]:a.PROJECTION,a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&(a.to_meter=parseFloat(a.UNIT.convert,10))),a.GEOGCS&&(a.datumCode=a.GEOGCS.DATUM?a.GEOGCS.DATUM.name.toLowerCase():a.GEOGCS.name.toLowerCase(),"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===a.datumCode||"new_zealand_1949"===a.datumCode)&&(a.datumCode="nzgd49"),"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84"),"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6)),"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8)),~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72"),a.GEOGCS.DATUM&&a.GEOGCS.DATUM.SPHEROID&&(a.ellps=a.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=a.GEOGCS.DATUM.SPHEROID.a,a.rf=parseFloat(a.GEOGCS.DATUM.SPHEROID.rf,10))),a.b&&!isFinite(a.b)&&(a.b=a.a);var c=function(b){return e(a,b)},d=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",f],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",f],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",f],["lat0","latitude_of_origin",f],["lat0","standard_parallel_1",f],["lat1","standard_parallel_1",f],["lat2","standard_parallel_2",f],["alpha","azimuth",f],["srsCode","name"]];d.forEach(c),a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==a.PROJECTION||(a.long0=a.longc)}var h=.017453292519943295,i=a("./extend");b.exports=function(a,b){var c=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]')),e=c.shift(),f=c.shift();c.unshift(["name",f]),c.unshift(["type",e]),c.unshift("output");var h={};return d(c,h),g(h.output),i(b,h.output)}},{"./extend":33}],66:[function(a,b,c){function d(a){return a*(Math.PI/180)}function e(a){return 180*(a/Math.PI)}function f(a){var b,c,e,f,g,i,j,k,l,m=a.lat,n=a.lon,o=6378137,p=.00669438,q=.9996,r=d(m),s=d(n);l=Math.floor((n+180)/6)+1,180===n&&(l=60),m>=56&&64>m&&n>=3&&12>n&&(l=32),m>=72&&84>m&&(n>=0&&9>n?l=31:n>=9&&21>n?l=33:n>=21&&33>n?l=35:n>=33&&42>n&&(l=37)),b=6*(l-1)-180+3,k=d(b),c=p/(1-p),e=o/Math.sqrt(1-p*Math.sin(r)*Math.sin(r)),f=Math.tan(r)*Math.tan(r),g=c*Math.cos(r)*Math.cos(r),i=Math.cos(r)*(s-k),j=o*((1-p/4-3*p*p/64-5*p*p*p/256)*r-(3*p/8+3*p*p/32+45*p*p*p/1024)*Math.sin(2*r)+(15*p*p/256+45*p*p*p/1024)*Math.sin(4*r)-35*p*p*p/3072*Math.sin(6*r));var t=q*e*(i+(1-f+g)*i*i*i/6+(5-18*f+f*f+72*g-58*c)*i*i*i*i*i/120)+5e5,u=q*(j+e*Math.tan(r)*(i*i/2+(5-f+9*g+4*g*g)*i*i*i*i/24+(61-58*f+f*f+600*g-330*c)*i*i*i*i*i*i/720));return 0>m&&(u+=1e7),{northing:Math.round(u),easting:Math.round(t),zoneNumber:l,zoneLetter:h(m)}}function g(a){var b=a.northing,c=a.easting,d=a.zoneLetter,f=a.zoneNumber;if(0>f||f>60)return null;var h,i,j,k,l,m,n,o,p,q,r=.9996,s=6378137,t=.00669438,u=(1-Math.sqrt(1-t))/(1+Math.sqrt(1-t)),v=c-5e5,w=b;"N">d&&(w-=1e7),o=6*(f-1)-180+3,h=t/(1-t),n=w/r,p=n/(s*(1-t/4-3*t*t/64-5*t*t*t/256)),q=p+(3*u/2-27*u*u*u/32)*Math.sin(2*p)+(21*u*u/16-55*u*u*u*u/32)*Math.sin(4*p)+151*u*u*u/96*Math.sin(6*p),i=s/Math.sqrt(1-t*Math.sin(q)*Math.sin(q)),j=Math.tan(q)*Math.tan(q),k=h*Math.cos(q)*Math.cos(q),l=s*(1-t)/Math.pow(1-t*Math.sin(q)*Math.sin(q),1.5),m=v/(i*r);var x=q-i*Math.tan(q)/l*(m*m/2-(5+3*j+10*k-4*k*k-9*h)*m*m*m*m/24+(61+90*j+298*k+45*j*j-252*h-3*k*k)*m*m*m*m*m*m/720);x=e(x);var y=(m-(1+2*j+k)*m*m*m/6+(5-2*k+28*j-3*k*k+8*h+24*j*j)*m*m*m*m*m/120)/Math.cos(q);y=o+e(y);var z;if(a.accuracy){var A=g({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber});z={top:A.lat,right:A.lon,bottom:x,left:y}}else z={lat:x,lon:y};return z}function h(a){var b="Z";return 84>=a&&a>=72?b="X":72>a&&a>=64?b="W":64>a&&a>=56?b="V":56>a&&a>=48?b="U":48>a&&a>=40?b="T":40>a&&a>=32?b="S":32>a&&a>=24?b="R":24>a&&a>=16?b="Q":16>a&&a>=8?b="P":8>a&&a>=0?b="N":0>a&&a>=-8?b="M":-8>a&&a>=-16?b="L":-16>a&&a>=-24?b="K":-24>a&&a>=-32?b="J":-32>a&&a>=-40?b="H":-40>a&&a>=-48?b="G":-48>a&&a>=-56?b="F":-56>a&&a>=-64?b="E":-64>a&&a>=-72?b="D":-72>a&&a>=-80&&(b="C"),b}function i(a,b){var c=""+a.easting,d=""+a.northing;return a.zoneNumber+a.zoneLetter+j(a.easting,a.northing,a.zoneNumber)+c.substr(c.length-5,b)+d.substr(d.length-5,b)}function j(a,b,c){var d=k(c),e=Math.floor(a/1e5),f=Math.floor(b/1e5)%20;return l(e,f,d)}function k(a){var b=a%q;return 0===b&&(b=q),b}function l(a,b,c){var d=c-1,e=r.charCodeAt(d),f=s.charCodeAt(d),g=e+a-1,h=f+b,i=!1;g>x&&(g=g-x+t-1,i=!0),(g===u||u>e&&g>u||(g>u||u>e)&&i)&&g++,(g===v||v>e&&g>v||(g>v||v>e)&&i)&&(g++,g===u&&g++),g>x&&(g=g-x+t-1),h>w?(h=h-w+t-1,i=!0):i=!1,(h===u||u>f&&h>u||(h>u||u>f)&&i)&&h++,(h===v||v>f&&h>v||(h>v||v>f)&&i)&&(h++,h===u&&h++),h>w&&(h=h-w+t-1);var j=String.fromCharCode(g)+String.fromCharCode(h);return j}function m(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b,c=a.length,d=null,e="",f=0;!/[A-Z]/.test(b=a.charAt(f));){if(f>=2)throw"MGRSPoint bad conversion from: "+a;e+=b,f++}var g=parseInt(e,10);if(0===f||f+3>c)throw"MGRSPoint bad conversion from: "+a;var h=a.charAt(f++);if("A">=h||"B"===h||"Y"===h||h>="Z"||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+a;d=a.substring(f,f+=2);for(var i=k(g),j=n(d.charAt(0),i),l=o(d.charAt(1),i);l<p(h);)l+=2e6;var m=c-f;if(m%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var q,r,s,t,u,v=m/2,w=0,x=0;return v>0&&(q=1e5/Math.pow(10,v),r=a.substring(f,f+v),w=parseFloat(r)*q,s=a.substring(f+v),x=parseFloat(s)*q),t=w+j,u=x+l,{easting:t,northing:u,zoneLetter:h,zoneNumber:g,accuracy:q}}function n(a,b){for(var c=r.charCodeAt(b-1),d=1e5,e=!1;c!==a.charCodeAt(0);){if(c++,c===u&&c++,c===v&&c++,c>x){if(e)throw"Bad character: "+a;c=t,e=!0}d+=1e5}return d}function o(a,b){if(a>"V")throw"MGRSPoint given invalid Northing "+a;for(var c=s.charCodeAt(b-1),d=0,e=!1;c!==a.charCodeAt(0);){if(c++,c===u&&c++,c===v&&c++,c>w){if(e)throw"Bad character: "+a;c=t,e=!0}d+=1e5}return d}function p(a){var b;switch(a){case"C":b=11e5;break;case"D":b=2e6;break;case"E":b=28e5;break;case"F":b=37e5;break;case"G":b=46e5;break;case"H":b=55e5;break;case"J":b=64e5;break;case"K":b=73e5;break;case"L":b=82e5;break;case"M":b=91e5;break;case"N":b=0;break;case"P":b=8e5;break;case"Q":b=17e5;break;case"R":b=26e5;break;case"S":b=35e5;break;case"T":b=44e5;break;case"U":b=53e5;break;case"V":b=62e5;break;case"W":b=7e6;break;case"X":b=79e5;break;default:b=-1}if(b>=0)return b;throw"Invalid zone letter: "+a}var q=6,r="AJSAJS",s="AFAFAF",t=65,u=73,v=79,w=86,x=90;c.forward=function(a,b){return b=b||5,i(f({lat:a[1],lon:a[0]}),b)},c.inverse=function(a){var b=g(m(a.toUpperCase()));return[b.left,b.bottom,b.right,b.top]},c.toPoint=function(a){var b=c.inverse(a);return[(b[2]+b[0])/2,(b[3]+b[1])/2]}},{}],67:[function(a,b){b.exports={name:"proj4",version:"2.1.2",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(a,b){b.exports=a("gWUPNW")},{}],gWUPNW:[function(a,b){var c=[a("./lib/projections/tmerc"),a("./lib/projections/utm"),a("./lib/projections/sterea"),a("./lib/projections/stere"),a("./lib/projections/somerc"),a("./lib/projections/omerc"),a("./lib/projections/lcc"),a("./lib/projections/krovak"),a("./lib/projections/cass"),a("./lib/projections/laea"),a("./lib/projections/aea"),a("./lib/projections/gnom"),a("./lib/projections/cea"),a("./lib/projections/eqc"),a("./lib/projections/poly"),a("./lib/projections/nzmg"),a("./lib/projections/mill"),a("./lib/projections/sinu"),a("./lib/projections/moll"),a("./lib/projections/eqdc"),a("./lib/projections/vandg"),a("./lib/projections/aeqd")];b.exports=function(a){c.forEach(function(b){a.Proj.projections.add(b)})}},{"./lib/projections/aea":39,"./lib/projections/aeqd":40,"./lib/projections/cass":41,"./lib/projections/cea":42,"./lib/projections/eqc":43,"./lib/projections/eqdc":44,"./lib/projections/gnom":46,"./lib/projections/krovak":47,"./lib/projections/laea":48,"./lib/projections/lcc":49,"./lib/projections/mill":52,"./lib/projections/moll":53,"./lib/projections/nzmg":54,"./lib/projections/omerc":55,"./lib/projections/poly":56,"./lib/projections/sinu":57,"./lib/projections/somerc":58,"./lib/projections/stere":59,"./lib/projections/sterea":60,"./lib/projections/tmerc":61,"./lib/projections/utm":62,"./lib/projections/vandg":63}]},{},[35])(35)}),!function(){!function(){var a=!1,b=/xyz/.test(function(){postMessage("xyz")})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}(),function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.Event.prototype,window.CustomEvent=a}(),function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();var a=function(a){if(a.constructor&&!a.hasOwnProperty("constructor")&&!a.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1;var b;for(b in a);return void 0===b||a.hasOwnProperty(b)},b=function(c){var d,e,f;for(e=1;e<arguments.length;e++){d=arguments[e];for(f in d)d[f]&&a(d[f])?(c[f]=c[f]||{},b(c[f],d[f])):c[f]=d[f]}return c},c=function(a,b){if(a){var c;if("undefined"!=typeof a.length){for(c=0;c<a.length;c++)if(b(c,a[c])===!1)return}else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)return}},d=function(a,b){var c=document.createEvent("HTMLEvents");c.initEvent(b,!0,!0),a.dispatchEvent(c)},e=function(a,b){var c=new CustomEvent(b,{bubbles:!0,cancelable:!0});a.dispatchEvent(c)},f=function(a,c){c=b({},f.defaults.options,c||{}),this.element=a,this.options=c,this.init()};f.prototype={init:function(){var a=this;this.ready=!1;var b=f.defaults.themes[this.options.theme||f.defaults.theme];if(!b)throw"Unknown theme "+(this.options.theme||f.defaults.theme);this.schema=this.options.schema,this.theme=new b,this.template=this.options.template,this.uuid=0,this.__data={};var c=f.defaults.iconlibs[this.options.iconlib||f.defaults.iconlib];c&&(this.iconlib=new c),this.root_container=this.theme.getContainer(),this.element.appendChild(this.root_container),this.validator=new f.Validator(this.schema,{ajax:this.options.ajax,refs:this.options.refs,no_additional_properties:this.options.no_additional_properties,required_by_default:this.options.required_by_default}),this.validator.ready(function(b){if(!a.ready){a.schema=b;var c=a.getEditorClass(a.schema);a.root=a.createEditor(c,{jsoneditor:a,schema:a.schema,container:a.root_container,required:!0}),a.options.startval&&a.root.setValue(a.options.startval),a.validation_results=a.validator.validate(a.root.getValue()),a.root.showValidationErrors(a.validation_results),a.ready=!0,requestAnimationFrame(function(){a.validation_results=a.validator.validate(a.root.getValue()),a.root.showValidationErrors(a.validation_results),a.trigger("ready"),a.trigger("change")})}})},getValue:function(){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before getting the value";return this.root.getValue()},setValue:function(a){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before setting the value";return this.root.setValue(a),this},validate:function(a){if(!this.ready)throw"JSON Editor not ready yet.  Listen for 'ready' event before validating";return 1===arguments.length?this.validator.validate(a):this.validation_results},destroy:function(){this.destroyed||this.ready&&(this.schema=null,this.options=null,this.root.destroy(),this.root=null,this.root_container=null,this.validator=null,this.validation_results=null,this.theme=null,this.iconlib=null,this.template=null,this.__data=null,this.ready=!1,this.element.innerHTML="",this.destroyed=!0)},on:function(a,b){this.callbacks=this.callbacks||{},this.callbacks[a]=this.callbacks[a]||[],this.callbacks[a].push(b)},off:function(a,b){if(a&&b){this.callbacks=this.callbacks||{},this.callbacks[a]=this.callbacks[a]||[];for(var c=[],d=0;d<this.callbacks[a].length;d++)this.callbacks[a][d]!==b&&c.push(this.callbacks[a][d]);this.callbacks[a]=c}else a?(this.callbacks=this.callbacks||{},this.callbacks[a]=[]):this.callbacks={}},trigger:function(a){if(this.callbacks&&this.callbacks[a]&&this.callbacks[a].length)for(var b=0;b<this.callbacks[a].length;b++)this.callbacks[a][b]()},getEditorClass:function(a){var b;if(c(f.defaults.resolvers,function(c,d){var e=d(a);return e&&f.defaults.editors[e]?(b=e,!1):void 0}),!b)throw"Unknown editor for schema "+JSON.stringify(a);if(!f.defaults.editors[b])throw"Unknown editor "+b;return f.defaults.editors[b]},createEditor:function(a,c){return c=b({},a.options||{},c),new a(c)},onChange:function(){if(this.ready&&!this.firing_change){this.firing_change=!0;var a=this;requestAnimationFrame(function(){a.firing_change=!1,a.validation_results=a.validator.validate(a.root.getValue()),a.root.showValidationErrors(a.validation_results),a.trigger("change")})}},compileTemplate:function(a,b){b=b||f.defaults.template;var c;if("string"==typeof b){if(!f.defaults.templates[b])throw"Unknown template engine "+b;if(c=f.defaults.templates[b](),!c)throw"Template engine "+b+" missing required library."}else c=b;if(!c)throw"No template engine set";if(!c.compile)throw"Invalid template engine set";return c.compile(a)},_data:function(a,b,c){if(3!==arguments.length)return a.hasAttribute("data-jsoneditor-"+b)?this.__data[a.getAttribute("data-jsoneditor-"+b)]:null;var d;a.hasAttribute("data-jsoneditor-"+b)?d=a.getAttribute("data-jsoneditor-"+b):(d=this.uuid++,a.setAttribute("data-jsoneditor-"+b,d)),this.__data[d]=c},registerEditor:function(a){return this.editors=this.editors||{},this.editors[a.path]=a,this},unregisterEditor:function(a){return this.editors=this.editors||{},this.editors[a.path]=null,this},getEditor:function(a){return this.editors?this.editors[a]:void 0},watch:function(a,b){return this.watchlist=this.watchlist||{},this.watchlist[a]=this.watchlist[a]||[],this.watchlist[a].push(b),this},unwatch:function(a,b){if(!this.watchlist||!this.watchlist[a])return this;if(!b)return this.watchlist[a]=null,this;for(var c=[],d=0;d<this.watchlist[a].length;d++)this.watchlist[a][d]!==b&&c.push(this.watchlist[a][d]);return this.watchlist[a]=c.length?c:null,this},notifyWatchers:function(a){if(!this.watchlist||!this.watchlist[a])return this;for(var b=0;b<this.watchlist[a].length;b++)this.watchlist[a][b]()},isEnabled:function(){return!this.root||this.root.isEnabled()},enable:function(){this.root.enable()},disable:function(){this.root.disable()}},f.defaults={themes:{},templates:{},iconlibs:{},editors:{},resolvers:[],custom_validators:[]},f.Validator=Class.extend({init:function(a,b){this.original_schema=a,this.options=b||{},this.refs=this.options.refs||{},this.ready_callbacks=[],this.options.ready&&this.ready(this.options.ready),this.getRefs()},ready:function(a){return this.is_ready?a.apply(this,[this.expanded]):this.ready_callbacks.push(a),this},getRefs:function(){var a=this;this._getRefs(this.original_schema,function(b){a.schema=b,a.expanded=a.expandSchema(a.schema),a.is_ready=!0,c(a.ready_callbacks,function(b,c){c.apply(a,[a.expanded])})})},_getRefs:function(a,d,e,f){var g=this,h=a===this.original_schema;e=e||"#";var i,j,k,l;if(a=b({},a),a.definitions&&(h||f)){var m=a.definitions;delete a.definitions,i=j=0,k=function(a){if(j>=i){if(l)return;l=!0,g._getRefs(a,d,e)}},c(m,function(){i++}),i?c(m,function(b,c){g._getRefs(c,function(c){g.refs[e+"/definitions/"+b]=c,j++,k(a)},e+"/definitions/"+b,!0)}):k(a)}else if(a.$ref){var n=a.$ref;if(delete a.$ref,g.refs[n]&&g.refs[n]instanceof Array)g.refs[n].push(function(){a=b({},g.refs[n],a),d(a)});else if(g.refs[n])a=b({},g.refs[n],a),d(a);else{if(!g.options.ajax)throw"Must set ajax option to true to load external url "+n;var o=new XMLHttpRequest;o.open("GET",n,!0),o.onreadystatechange=function(){if(4==o.readyState){if(200===o.status){var f=JSON.parse(o.responseText);return g.refs[n]=[],void g._getRefs(f,function(e){var f=g.refs[n];g.refs[n]=e,a=b({},g.refs[n],a),d(a),c(f,function(a,b){b()})},e)}throw"Failed to fetch ref via ajax- "+n}},o.send()}}else i=j=0,k=function(a){if(j>=i){if(l)return;l=!0,d(a)}},c(a,function(a,b){"object"==typeof b&&b&&b instanceof Array?c(b,function(a,b){"object"!=typeof b||!b||b instanceof Array||i++}):"object"==typeof b&&b&&i++}),i?c(a,function(b,d){"object"==typeof d&&d&&d instanceof Array?c(d,function(c,d){"object"!=typeof d||!d||d instanceof Array||g._getRefs(d,function(d){a[b][c]=d,j++,k(a)},e+"/"+b+"/"+c)}):"object"==typeof d&&d&&g._getRefs(d,function(c){a[b]=c,j++,k(a)},e+"/"+b)}):k(a)},validate:function(a){return this._validateSchema(this.schema,a)},_validateSchema:function(a,d,e){var g,h,i,j=[],k=JSON.stringify(d);if(e=e||"root",a=b({},a),a.required&&a.required===!0){if("undefined"==typeof d)return j.push({path:e,property:"required",message:"Property must be set"}),j}else if("undefined"==typeof d){if(!this.options.required_by_default)return j;j.push({path:e,property:"required",message:"Property must be set"})}if(a.enum){for(g=!1,h=0;h<a.enum.length;h++)k===JSON.stringify(a.enum[h])&&(g=!0);g||j.push({path:e,property:"enum",message:"Value must be one of the enumerated values"})}if(a.extends)for(h=0;h<a.extends.length;h++)j=j.concat(this._validateSchema(a.extends[h],d,e));if(a.allOf)for(h=0;h<a.allOf.length;h++)j=j.concat(this._validateSchema(a.allOf[h],d,e));if(a.anyOf){for(g=!1,h=0;h<a.anyOf.length;h++)if(!this._validateSchema(a.anyOf[h],d,e).length){g=!0;break}g||j.push({path:e,property:"anyOf",message:"Value must validate against at least one of the provided schemas"})}if(a.oneOf){g=0;var l=[];for(h=0;h<a.oneOf.length;h++){var m=this._validateSchema(a.oneOf[h],d,e);for(m.length||g++,i=0;i<m.length;i++)m[i].path=e+".oneOf["+h+"]"+m[i].path.substr(e.length);l=l.concat(m)}1!==g&&(j.push({path:e,property:"oneOf",message:"Value must validate against exactly one of the provided schemas. It currently validates against "+g+" of the schemas."}),j=j.concat(l))}if(a.not&&(this._validateSchema(a.not,d,e).length||j.push({path:e,property:"not",message:"Value must not validate against the provided schema"})),a.type)if(a.type instanceof Array){for(g=!1,h=0;h<a.type.length;h++)if(this._checkType(a.type[h],d)){g=!0;break}g||j.push({path:e,property:"type",message:"Value must be one of the provided types"})}else this._checkType(a.type,d)||j.push({path:e,property:"type",message:"Value must be of type "+a.type});if(a.disallow)if(a.disallow instanceof Array){for(g=!0,h=0;h<a.disallow.length;h++)if(this._checkType(a.disallow[h],d)){g=!1;break}g||j.push({path:e,property:"disallow",message:"Value must not be one of the provided disallowed types"})}else this._checkType(a.disallow,d)&&j.push({path:e,property:"disallow",message:"Value must not be of type "+a.disallow});if("number"==typeof d)(a.multipleOf||a.divisibleBy)&&(g=d/(a.multipleOf||a.divisibleBy),g!==Math.floor(g)&&j.push({path:e,property:a.multipleOf?"multipleOf":"divisibleBy",message:"Value must be a multiple of "+(a.multipleOf||a.divisibleBy)})),a.maximum&&(a.exclusiveMaximum&&d>=a.maximum?j.push({path:e,property:"maximum",message:"Value must be less than "+a.maximum}):!a.exclusiveMaximum&&d>a.maximum&&j.push({path:e,property:"maximum",message:"Value must be at most "+a.maximum})),a.minimum&&(a.exclusiveMinimum&&d<=a.minimum?j.push({path:e,property:"minimum",message:"Value must be greater than "+a.minimum}):!a.exclusiveMinimum&&d<a.minimum&&j.push({path:e,property:"minimum",message:"Value must be at least "+a.minimum}));else if("string"==typeof d)a.maxLength&&(d+"").length>a.maxLength&&j.push({path:e,property:"maxLength",message:"Value must be at most "+a.maxLength+" characters long"}),a.minLength&&(d+"").length<a.minLength&&j.push({path:e,property:"minLength",message:"Value must be at least "+a.minLength+" characters long"}),a.pattern&&(new RegExp(a.pattern).test(d)||j.push({path:e,property:"pattern",message:"Value must match the provided pattern"}));else if("object"==typeof d&&null!==d&&d instanceof Array){if(a.items)if(a.items instanceof Array)for(h=0;h<d.length;h++)if(a.items[h])j=j.concat(this._validateSchema(a.items[h],d[h],e+"."+h));else{if(a.additionalItems===!0)break;if(!a.additionalItems){if(a.additionalItems===!1){j.push({path:e,property:"additionalItems",message:"No additional items allowed in this array"});break}break}j=j.concat(this._validateSchema(a.additionalItems,d[h],e+"."+h))}else for(h=0;h<d.length;h++)j=j.concat(this._validateSchema(a.items,d[h],e+"."+h));if(a.maxItems&&d.length>a.maxItems&&j.push({path:e,property:"maxItems",message:"Value must have at most "+a.maxItems+" items"}),a.minItems&&d.length<a.minItems&&j.push({path:e,property:"minItems",message:"Value must have at least "+a.minItems+" items"}),a.uniqueItems){var n={};for(h=0;h<d.length;h++){if(g=JSON.stringify(d[h]),n[g]){j.push({path:e,property:"uniqueItems",message:"Array must have unique items"});break}n[g]=!0}}}else if("object"==typeof d&&null!==d){if(a.maxProperties){g=0;for(h in d)d.hasOwnProperty(h)&&g++;g>a.maxProperties&&j.push({path:e,property:"maxProperties",message:"Object must have at most "+a.maxProperties+" properties"})}if(a.minProperties){g=0;for(h in d)d.hasOwnProperty(h)&&g++;g<a.minProperties&&j.push({path:e,property:"minProperties",message:"Object must have at least "+a.minProperties+" properties"})}if(a.required&&a.required instanceof Array)for(h=0;h<a.required.length;h++)"undefined"==typeof d[a.required[h]]&&j.push({path:e,property:"required",message:"Object is missing the required property "+a.required[h]});var o={};if(a.properties)for(h in a.properties)a.properties.hasOwnProperty(h)&&(o[h]=!0,j=j.concat(this._validateSchema(a.properties[h],d[h],e+"."+h)));if(a.patternProperties)for(h in a.patternProperties)if(a.patternProperties.hasOwnProperty(h)){var p=new RegExp(h);for(i in d)d.hasOwnProperty(i)&&p.test(i)&&(o[i]=!0,j=j.concat(this._validateSchema(a.patternProperties[h],d[i],e+"."+i)))}if("undefined"!=typeof a.additionalProperties||!this.options.no_additional_properties||a.oneOf||a.anyOf||(a.additionalProperties=!1),"undefined"!=typeof a.additionalProperties)for(h in d)if(d.hasOwnProperty(h)&&!o[h]){if(!a.additionalProperties){j.push({path:e,property:"additionalProperties",message:"No additional properties allowed, but property "+h+" is set"});break}if(a.additionalProperties===!0)break;j=j.concat(this._validateSchema(a.additionalProperties,d[h],e+"."+h))}if(a.dependencies)for(h in a.dependencies)if(a.dependencies.hasOwnProperty(h)&&"undefined"!=typeof d[h])if(a.dependencies[h]instanceof Array)for(i=0;i<a.dependencies[h].length;i++)"undefined"==typeof d[a.dependencies[h][i]]&&j.push({path:e,property:"dependencies",message:"Must have property "+a.dependencies[h][i]});else j=j.concat(this._validateSchema(a.dependencies[h],d,e))}return c(f.defaults.custom_validators,function(b,c){j=j.concat(c(a,d,e))}),j},_checkType:function(a,b){return"string"==typeof a?"string"===a?"string"==typeof b:"number"===a?"number"==typeof b:"integer"===a?"number"==typeof b&&b===Math.floor(b):"boolean"===a?"boolean"==typeof b:"array"===a?b instanceof Array:"object"===a?null!==b&&!(b instanceof Array)&&"object"==typeof b:"null"===a?null===b:!0:!this._validateSchema(a,b).length},expandSchema:function(a){var d,e=this,f=a;if("object"==typeof a.type&&(a.type instanceof Array?c(a.type,function(b,c){"object"==typeof c&&(a.type[b]=e.expandSchema(c))}):a.type=e.expandSchema(a.type)),"object"==typeof a.disallow&&(a.disallow instanceof Array?c(a.disallow,function(b,c){"object"==typeof c&&(a.disallow[b]=e.expandSchema(c))}):a.disallow=e.expandSchema(a.disallow)),a.anyOf&&c(a.anyOf,function(b,c){a.anyOf[b]=e.expandSchema(c)}),a.dependencies&&c(a.dependencies,function(b,c){"object"!=typeof c||c instanceof Array||(a.dependencies[b]=e.expandSchema(c))}),a.items&&(a.items instanceof Array?c(a.items,function(b,c){"object"==typeof c&&(a.items[b]=e.expandSchema(c))}):a.items=e.expandSchema(a.items)),a.properties&&c(a.properties,function(b,c){"object"!=typeof c||c instanceof Array||(a.properties[b]=e.expandSchema(c))}),a.patternProperties&&c(a.patternProperties,function(b,c){"object"!=typeof c||c instanceof Array||(a.patternProperties[b]=e.expandSchema(c))}),a.not&&(a.not=this.expandSchema(a.not)),a.additionalProperties&&"object"==typeof a.additionalProperties&&(a.additionalProperties=e.expandSchema(a.additionalProperties)),a.additionalItems&&"object"==typeof a.additionalItems&&(a.additionalItems=e.expandSchema(a.additionalItems)),a.allOf){for(d=0;d<a.allOf.length;d++)f=this.extend(f,this.expandSchema(a.allOf[d]));
delete f.allOf}if(a.extends){if(a.extends instanceof Array)for(d=0;d<a.extends.length;d++)f=this.extend(f,this.expandSchema(a.extends[d]));else f=this.extend(f,this.expandSchema(a.extends));delete f.extends}if(a.oneOf){var g=b({},f);for(delete g.oneOf,d=0;d<a.oneOf.length;d++)f.oneOf[d]=this.extend(this.expandSchema(a.oneOf[d]),g)}return f},extend:function(a,d){a=b({},a),d=b({},d);var e=this,f={};return c(a,function(a,b){"undefined"!=typeof d[a]?"required"===a&&"object"==typeof b&&b instanceof Array?f.required=b.concat(d[a]).reduce(function(a,b){return a.indexOf(b)<0&&a.push(b),a},[]):"type"===a?("object"!=typeof b&&(b=[b]),"object"!=typeof d.type&&(d.type=[d.type]),f.type=b.filter(function(a){return-1!==d.type.indexOf(a)}),1===f.type.length&&"string"==typeof f.type[0]&&(f.type=f.type[0])):f[a]="object"==typeof b&&b instanceof Array?b.filter(function(b){return-1!==d[a].indexOf(b)}):"object"==typeof b&&null!==b?e.extend(b,d[a]):b:f[a]=b}),c(d,function(b,c){"undefined"==typeof a[b]&&(f[b]=c)}),f}}),f.AbstractEditor=Class.extend({fireChangeHeaderEvent:function(){e(this.container,"change_header_text")},onChildEditorChange:function(){this.watch_listener&&(this.watch_listener(),this.jsoneditor.notifyWatchers(this.path),this.parent?this.parent.onChildEditorChange(this):this.jsoneditor.onChange())},register:function(){this.jsoneditor.registerEditor(this)},unregister:function(){this.jsoneditor&&this.jsoneditor.unregisterEditor(this)},getNumColumns:function(){return 12},init:function(a){var c=this;if(this.container=a.container,this.jsoneditor=a.jsoneditor,this.theme=this.jsoneditor.theme,this.template_engine=this.jsoneditor.template,this.iconlib=this.jsoneditor.iconlib,this.options=b({},this.options||{},a.schema.options||{},a),this.schema=this.options.schema,a.path||this.schema.id||(this.schema.id="root"),this.path=a.path||"root",this.formname=a.formname||this.path.replace(/\.([^.]+)/g,"[$1]"),this.jsoneditor.options.form_name_root&&(this.formname=this.formname.replace(/^root\[/,this.jsoneditor.options.form_name_root+"[")),this.schema.id&&this.container.setAttribute("data-schemaid",this.schema.id),this.schema.type&&"string"==typeof this.schema.type&&this.container.setAttribute("data-schematype",this.schema.type),this.container.setAttribute("data-schemapath",this.path),this.jsoneditor._data(this.container,"editor",this),this.key=this.path.split(".").pop(),this.parent=a.parent,this.link_watchers=[],this.register(),this.watched={},this.schema.vars&&(this.schema.watch=this.schema.vars),this.watched_values={},this.watch_listener=function(){c.refreshWatchedFieldValues()&&c.onWatchedFieldChange()},this.schema.watch){var d,e,f,g,h;for(var i in this.schema.watch)if(this.schema.watch.hasOwnProperty(i)){if(d=this.schema.watch[i],d instanceof Array?e=[d[0]].concat(d[1].split(".")):(e=d.split("."),c.theme.closest(c.container,'[data-schemaid="'+e[0]+'"]')||e.unshift("#")),f=e.shift(),"#"===f&&(f=c.jsoneditor.schema.id||"root"),g=c.theme.closest(c.container,'[data-schemaid="'+f+'"]'),!g)throw"Could not find ancestor node with id "+f;h=g.getAttribute("data-schemapath")+"."+e.join("."),c.jsoneditor.watch(h,c.watch_listener),c.watched[i]=h}}if(this.schema.headerTemplate&&(this.header_template=this.jsoneditor.compileTemplate(this.schema.headerTemplate,this.template_engine)),this.build(),!this.no_link_holder&&(this.link_holder=this.theme.getLinksHolder(),this.container.appendChild(this.link_holder),this.schema.links))for(var j=0;j<this.schema.links.length;j++)this.addLink(this.getLink(this.schema.links[j]));this.setValue(this.getDefault(),!0),this.updateHeaderText(),this.watch_listener()},getButton:function(a,b,c){var d="json-editor-btn-"+b;b=this.iconlib?this.iconlib.getIcon(b):null,!b&&c&&(a=c,c=null);var e=this.theme.getButton(a,b,c);return e.className+=" "+d+" ",e},setButtonText:function(a,b,c,d){return c=this.iconlib?this.iconlib.getIcon(c):null,!c&&d&&(b=d,d=null),this.theme.setButtonText(a,b,c,d)},addLink:function(a){this.link_holder&&this.link_holder.appendChild(a)},getLink:function(a){var b,c,d=a.mediaType||"application/javascript",e=d.split("/")[0],f=this.jsoneditor.compileTemplate(a.href,this.template_engine);if("image"===e){b=this.theme.getBlockLinkHolder(),c=document.createElement("a"),c.setAttribute("target","_blank");var g=document.createElement("img");this.theme.createImageLink(b,c,g),this.link_watchers.push(function(b){var d=f(b);c.setAttribute("href",d),c.setAttribute("title",a.rel||d),g.setAttribute("src",d)})}else if(["audio","video"].indexOf(e)>=0){b=this.theme.getBlockLinkHolder(),c=this.theme.getBlockLink(),c.setAttribute("target","_blank");var h=document.createElement(e);h.setAttribute("controls","controls"),this.theme.createMediaLink(b,c,h),this.link_watchers.push(function(b){var d=f(b);c.setAttribute("href",d),c.textContent=a.rel||d,h.setAttribute("src",d)})}else b=this.theme.getBlockLink(),b.setAttribute("target","_blank"),b.textContent=a.rel,this.link_watchers.push(function(c){var d=f(c);b.setAttribute("href",d),b.textContent=a.rel||d});return b},refreshWatchedFieldValues:function(){if(this.watched_values){var a={},b=!1,c=this;if(this.watched){var d,e;for(var f in this.watched)this.watched.hasOwnProperty(f)&&(e=c.jsoneditor.getEditor(this.watched[f]),d=e?e.getValue():null,c.watched_values[f]!==d&&(b=!0),a[f]=d)}return a.self=this.getValue(),this.watched_values.self!==a.self&&(b=!0),this.watched_values=a,b}},getWatchedFieldValues:function(){return this.watched_values},updateHeaderText:function(){this.header&&(this.header.textContent=this.getHeaderText())},getHeaderText:function(a){return this.header_text?this.header_text:a?this.schema.title:this.getTitle()},onWatchedFieldChange:function(){var a;if(this.header_template){a=b(this.getWatchedFieldValues(),{key:this.key,i:this.key,title:this.getTitle()});var c=this.header_template(a);c!==this.header_text&&(this.header_text=c,this.updateHeaderText(),this.fireChangeHeaderEvent())}if(this.link_watchers.length){a=this.getWatchedFieldValues();for(var d=0;d<this.link_watchers.length;d++)this.link_watchers[d](a)}},build:function(){},isValid:function(a){a()},setValue:function(a){this.value=a},getValue:function(){return this.value},refreshValue:function(){},getChildEditors:function(){return!1},destroy:function(){var a=this;this.unregister(this),c(this.watched,function(b,c){a.jsoneditor.unwatch(c,a.watch_listener)}),this.watched=null,this.watched_values=null,this.watch_listener=null,this.header_text=null,this.header_template=null,this.value=null,this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.jsoneditor=null,this.schema=null,this.path=null,this.key=null,this.parent=null},isRequired:function(){return"undefined"!=typeof this.options.required?this.options.required:"boolean"==typeof this.schema.required?this.schema.required:this.jsoneditor.options.required_by_default?!0:!1},getDefault:function(){return this.schema.default||null},getTheme:function(){return this.theme},getSchema:function(){return this.schema},getContainer:function(){return this.container},getTitle:function(){return this.schema.title||this.key},getPath:function(){return this.path},getParent:function(){return this.parent},enable:function(){this.addremove&&(this.addremove.style.opacity=""),this.disabled=!1},disable:function(){this.addremove&&(this.addremove.style.opacity=".6"),this.disabled=!0},isEnabled:function(){return!this.disabled},getOption:function(a,b){return"undefined"!=typeof this.options[a]?this.options[a]:b},getDisplayText:function(a){var b=[],d={};c(a,function(a,b){b.title&&(d[b.title]=d[b.title]||0,d[b.title]++),b.description&&(d[b.description]=d[b.description]||0,d[b.description]++),b.format&&(d[b.format]=d[b.format]||0,d[b.format]++),b.type&&(d[b.type]=d[b.type]||0,d[b.type]++)}),c(a,function(a,c){var e;e="string"==typeof c?c:c.title&&d[c.title]<=1?c.title:c.format&&d[c.format]<=1?c.format:c.type&&d[c.type]<=1?c.type:c.description&&d[c.description]<=1?c.descripton:c.title?c.title:c.format?c.format:c.type?c.type:c.description?c.description:JSON.stringify(c).length<50?JSON.stringify(c):"type",b.push(e)});var e={};return c(b,function(a,c){e[c]=e[c]||0,e[c]++,d[c]>1&&(b[a]=c+" "+e[c])}),b},showValidationErrors:function(){}}),f.defaults.editors.null=f.AbstractEditor.extend({getValue:function(){return null},setValue:function(){this.jsoneditor.notifyWatchers(this.path)},getNumColumns:function(){return 2}}),f.defaults.editors.string=f.AbstractEditor.extend({getDefault:function(){return this.schema.default||""},register:function(){this._super(),this.input&&this.input.setAttribute("name",this.formname)},unregister:function(){this._super(),this.input&&this.input.removeAttribute("name")},setValue:function(a,b,c){var d=this;if((!this.template||c)&&(a=a||"","object"==typeof a&&(a=JSON.stringify(a)),"string"!=typeof a&&(a=""+a),a!==this.serialized)){var e=this.sanitize(a);if(this.select_options&&this.select_options.indexOf(e)<0&&(e=this.select_options[0]),this.input.value!==e){this.input.value=e,this.sceditor_instance?this.sceditor_instance.val(e):this.epiceditor?this.epiceditor.importFile(null,e):this.ace_editor&&this.ace_editor.setValue(e);var f=c||this.getValue()!==a;this.refreshValue(),f&&(d.parent?d.parent.onChildEditorChange(d):d.jsoneditor.onChange()),this.watch_listener(),this.jsoneditor.notifyWatchers(this.path)}}},removeProperty:function(){this._super(),this.input.style.display="none",this.description&&(this.description.style.display="none"),this.theme.disableLabel(this.label)},addProperty:function(){this._super(),this.input.style.display="",this.description&&(this.description.style.display=""),this.theme.enableLabel(this.label)},getNumColumns:function(){var a,b=Math.ceil(this.getTitle().length/5);return a="textarea"===this.input_type?6:["text","email"].indexOf(this.input_type)>=0?4:2,Math.min(12,Math.max(b,a))},build:function(){var a,c=this;if(this.getOption("compact",!1)||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.format=this.schema.format,!this.format&&this.schema.media&&this.schema.media.type&&(this.format=this.schema.media.type.replace(/(^(application|text)\/(x-)?(script\.)?)|(-source$)/g,"")),this.schema.enum)this.input_type="select",this.select_options=this.schema.enum,this.input=this.theme.getSelectInput(this.select_options);else if(this.schema.enumSource){if(this.input_type="select",this.input=this.theme.getSelectInput([]),this.enumSource=[],this.schema.enumSource instanceof Array)for(a=0;a<this.schema.enumSource.length;a++)this.enumSource[a]="string"==typeof this.schema.enumSource[a]?{source:this.schema.enumSource[a]}:this.schema.enumSource[a]instanceof Array?this.schema.enumSource[a]:b({},this.schema.enumSource[a]);else this.enumSource=this.schema.enumValue?[{source:this.schema.enumSource,value:this.schema.enumValue}]:[{source:this.schema.enumSource}];for(a=0;a<this.enumSource.length;a++)this.enumSource[a]&&(this.enumSource[a].value=this.jsoneditor.compileTemplate(this.enumSource[a].value,this.template_engine)),this.enumSource[a].title&&(this.enumSource[a].title=this.jsoneditor.compileTemplate(this.enumSource[a].title,this.template_engine)),this.enumSource[a].fillter&&(this.enumSource[a].filter=this.jsoneditor.compileTemplate(this.enumSource[a].filter,this.template_engine))}else if(this.format)if("textarea"===this.format)this.input_type="textarea",this.input=this.theme.getTextareaInput();else if("range"===this.format){this.input_type="range";var d=this.schema.minimum||0,e=this.schema.maximum||Math.max(100,d+1),f=1;this.schema.multipleOf&&(d%this.schema.multipleOf&&(d=Math.ceil(d/this.schema.multipleOf)*this.schema.multipleOf),e%this.schema.multipleOf&&(e=Math.floor(e/this.schema.multipleOf)*this.schema.multipleOf),f=this.schema.multipleOf),this.input=this.theme.getRangeInput(d,e,f)}else["actionscript","batchfile","bbcode","c","c++","cpp","coffee","csharp","css","dart","django","ejs","erlang","golang","handlebars","haskell","haxe","html","ini","jade","java","javascript","json","less","lisp","lua","makefile","markdown","matlab","mysql","objectivec","pascal","perl","pgsql","php","python","r","ruby","sass","scala","scss","smarty","sql","stylus","svg","twig","vbscript","xml","yaml"].indexOf(this.format)>=0?(this.input_type=this.format,this.source_code=!0,this.input=this.theme.getTextareaInput()):(this.input_type=this.format,this.input=this.theme.getFormInputField(this.input_type));else this.input_type="text",this.input=this.theme.getFormInputField(this.input_type);"undefined"!=typeof this.schema.maxLength&&this.input.setAttribute("maxlength",this.schema.maxLength),"undefined"!=typeof this.schema.pattern?this.input.setAttribute("pattern",this.schema.pattern):"undefined"!=typeof this.schema.minLength&&this.input.setAttribute("pattern",".{"+this.schema.minLength+",}"),this.getOption("compact")&&this.container.setAttribute("class",this.container.getAttribute("class")+" compact"),(this.schema.readOnly||this.schema.readonly||this.schema.template)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener("change",function(a){if(a.preventDefault(),a.stopPropagation(),c.schema.template)return void(this.value=c.value);var b=this.value,d=c.sanitize(b);b!==d&&(this.value=d),c.refreshValue(),c.watch_listener(),c.jsoneditor.notifyWatchers(c.path),c.parent?c.parent.onChildEditorChange(c):c.jsoneditor.onChange()}),this.format&&this.input.setAttribute("data-schemaformat",this.format),this.control=this.getTheme().getFormControl(this.label,this.input,this.description),this.container.appendChild(this.control),"select"===this.input_type&&window.$&&$.fn&&$.fn.select2&&$(this.input).select2(),requestAnimationFrame(function(){c.input.parentNode&&c.afterInputReady()}),this.register(),this.schema.template?(this.template=this.jsoneditor.compileTemplate(this.schema.template,this.template_engine),this.refreshValue(),this.jsoneditor.notifyWatchers(this.path)):(this.refreshValue(),this.jsoneditor.notifyWatchers(this.path))},enable:function(){this.always_disabled||(this.input.disabled=!1),this._super()},disable:function(){this.input.disabled=!0,this._super()},afterInputReady:function(){var a,c=this;if(this.source_code)if(this.options.wysiwyg&&["html","bbcode"].indexOf(this.input_type)>=0&&window.$&&$.fn&&$.fn.sceditor)a=b({},{plugins:"html"===c.input_type?"xhtml":"bbcode",emoticonsEnabled:!1,width:"100%",height:300},f.plugins.sceditor),$(c.input).sceditor(a),c.sceditor_instance=$(c.input).sceditor("instance"),c.sceditor_instance.blur(function(){var a=$("<div>"+c.sceditor_instance.val()+"</div>");$("#sceditor-start-marker,#sceditor-end-marker,.sceditor-nlf",a).remove(),c.input.value=a.html(),c.value=c.input.value,c.parent?c.parent.onChildEditorChange(c):c.jsoneditor.onChange(),c.jsoneditor.notifyWatchers(c.path)});else if("markdown"===this.input_type&&window.EpicEditor)this.epiceditor_container=document.createElement("div"),this.input.parentNode.insertBefore(this.epiceditor_container,this.input),this.input.style.display="none",a=b({},f.plugins.epiceditor,{container:this.epiceditor_container,clientSideStorage:!1}),this.epiceditor=new EpicEditor(a).load(),this.epiceditor.importFile(null,this.getValue()),this.epiceditor.on("update",function(){var a=c.epiceditor.exportFile();c.input.value=a,c.value=a,c.parent?c.parent.onChildEditorChange(c):c.jsoneditor.onChange(),c.jsoneditor.notifyWatchers(c.path)});else if(window.ace){var d=this.input_type;("cpp"===d||"c++"===d||"c"===d)&&(d="c_cpp"),this.ace_container=document.createElement("div"),this.ace_container.style.width="100%",this.ace_container.style.position="relative",this.ace_container.style.height="400px",this.input.parentNode.insertBefore(this.ace_container,this.input),this.input.style.display="none",this.ace_editor=ace.edit(this.ace_container),this.ace_editor.setValue(this.getValue()),f.plugins.ace.theme&&this.ace_editor.setTheme("ace/theme/"+f.plugins.ace.theme),d=ace.require("ace/mode/"+d),d&&this.ace_editor.getSession().setMode(new d.Mode),this.ace_editor.on("change",function(){var a=c.ace_editor.getValue();c.input.value=a,c.refreshValue(),c.parent?c.parent.onChildEditorChange(c):c.jsoneditor.onChange(),c.jsoneditor.notifyWatchers(c.path)})}c.theme.afterInputReady(c.input)},refreshValue:function(){this.value=this.input.value,"string"!=typeof this.value&&(this.value=""),this.serialized=this.value},destroy:function(){this.sceditor_instance?this.sceditor_instance.destroy():this.epiceditor?this.epiceditor.unload():this.ace_editor&&this.ace_editor.destroy(),this.template=null,this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this._super()},sanitize:function(a){return a},onWatchedFieldChange:function(){var a,b;if(this.template&&(a=this.getWatchedFieldValues(),this.setValue(this.template(a),!1,!0)),this.enumSource){a=this.getWatchedFieldValues();for(var c=[],d=[],e=0;e<this.enumSource.length;e++)if(this.enumSource[e]instanceof Array)c=c.concat(this.enumSource[e]),d=d.concat(this.enumSource[e]);else if(a[this.enumSource[e].source]){var f=a[this.enumSource[e].source];if(this.enumSource[e].slice&&(f=Array.prototype.slice.apply(f,this.enumSource[e].slice)),this.enumSource[e].filter){var g=[];for(b=0;b<f.length;b++)filter({i:b,item:f[b]})&&g.push(f[b]);f=g}var h=[],i=[];for(b=0;b<f.length;b++){var j=f[b];i[b]=this.enumSource[e].value?this.enumSource[e].value({i:b,item:j}):f[b],h[b]=this.enumSource[e].title?this.enumSource[e].title({i:b,item:j}):i[b]}c=c.concat(i),d=d.concat(h)}this.theme.setSelectOptions(this.input,c,d),this.select_options=c,-1!==c.indexOf(this.value)?this.input.value=this.value:(this.input.value=c[0],this.value=c[0]||"",this.parent?this.parent.onChildEditorChange(this):this.jsoneditor.onChange(),this.jsoneditor.notifyWatchers(this.path))}this._super()},showValidationErrors:function(a){var b=this,d=[];c(a,function(a,c){c.path===b.path&&d.push(c.message)}),d.length?this.theme.addInputError(this.input,d.join(". ")+"."):this.theme.removeInputError(this.input)}}),f.defaults.editors.number=f.defaults.editors.string.extend({getDefault:function(){return this.schema.default||0},sanitize:function(a){return(a+"").replace(/[^0-9\.\-]/g,"")},getNumColumns:function(){return 2},getValue:function(){return 1*this.value}}),f.defaults.editors.integer=f.defaults.editors.number.extend({sanitize:function(a){return a+="",a.replace(/[^0-9\-]/g,"")},getNumColumns:function(){return 2}}),f.defaults.editors.object=f.AbstractEditor.extend({getDefault:function(){return b({},this.schema.default||{})},getChildEditors:function(){return this.editors},register:function(){if(this._super(),this.editors)for(var a in this.editors)this.editors.hasOwnProperty(a)&&this.editors[a].register()},unregister:function(){if(this._super(),this.editors)for(var a in this.editors)this.editors.hasOwnProperty(a)&&this.editors[a].unregister()},getNumColumns:function(){return Math.max(Math.min(12,this.maxwidth),3)},enable:function(){if(this.editjson_button&&(this.editjson_button.disabled=!1),this.addproperty_button&&(this.addproperty_button.disabled=!1),this._super(),this.editors)for(var a in this.editors)this.editors.hasOwnProperty(a)&&this.editors[a].enable()},disable:function(){if(this.editjson_button&&(this.editjson_button.disabled=!0),this.addproperty_button&&(this.addproperty_button.disabled=!0),this.hideEditJSON(),this._super(),this.editors)for(var a in this.editors)this.editors.hasOwnProperty(a)&&this.editors[a].disable()},layoutEditors:function(){var a,b,d=this;if(this.row_container){var e;if("grid"===this.format){var f=[];for(c(this.editors,function(a,b){if(!b.property_removed){for(var c=!1,d=b.options.hidden?0:b.getNumColumns(),e=b.options.hidden?0:b.container.offsetHeight,g=0;g<f.length;g++)f[g].width+d<=12&&(!e||.5*f[g].minh<e&&2*f[g].maxh>e)&&(c=g);c===!1&&(f.push({width:0,minh:999999,maxh:0,editors:[]}),c=f.length-1),f[c].editors.push({key:a,width:d,height:e}),f[c].width+=d,f[c].minh=Math.min(f[c].minh,e),f[c].maxh=Math.max(f[c].maxh,e)}}),a=0;a<f.length;a++)if(f[a].width<12){var g=!1,h=0;for(b=0;b<f[a].editors.length;b++)g===!1?g=b:f[a].editors[b].width>f[a].editors[g].width&&(g=b),f[a].editors[b].width*=12/f[a].width,f[a].editors[b].width=Math.floor(f[a].editors[b].width),h+=f[a].editors[b].width;12>h&&(f[a].editors[g].width+=12-h),f[a].width=12}if(this.layout===JSON.stringify(f))return!1;for(this.layout=JSON.stringify(f),e=document.createElement("div"),a=0;a<f.length;a++){var i=this.theme.getGridRow();for(e.appendChild(i),b=0;b<f[a].editors.length;b++){var j=this.editors[f[a].editors[b].key];j.options.hidden?j.container.style.display="none":this.theme.setGridColumnSize(j.container,f[a].editors[b].width),i.appendChild(j.container)}}}else e=document.createElement("div"),c(this.editors,function(a,b){if(!b.property_removed){var c=d.theme.getGridRow();e.appendChild(c),b.options.hidden?b.container.style.display="none":d.theme.setGridColumnSize(b.container,12),c.appendChild(b.container)}});this.row_container.innerHTML="",this.row_container.appendChild(e)}},build:function(){this.editors={};var a=this;if(this.format=this.getOption("layout")||this.getOption("object_layout")||this.schema.format||this.jsoneditor.options.object_layout||"normal",this.schema.properties=this.schema.properties||{},this.minwidth=0,this.maxwidth=0,this.getOption("table_row",!1))this.editor_holder=this.container,c(this.schema.properties,function(b,c){var d=a.jsoneditor.getEditorClass(c,a.jsoneditor),e=a.editor_holder.appendChild(a.getTheme().getTableCell());a.editors[b]=a.jsoneditor.createEditor(d,{jsoneditor:a.jsoneditor,schema:c,container:e,path:a.path+"."+b,parent:a,compact:!0,required:!0});var f=a.editors[b].options.hidden?0:a.editors[b].getNumColumns();a.minwidth+=f,a.maxwidth+=f,a.editors[b].options.hidden&&(e.style.display="none")}),this.no_link_holder=!0;else{if(this.getOption("table",!1))throw"Not supported yet";this.header=document.createElement("span"),this.header.textContent=this.getTitle(),this.title=this.getTheme().getHeader(this.header),this.container.appendChild(this.title),this.container.style.position="relative",this.editjson_holder=this.theme.getModal(),this.editjson_textarea=this.theme.getTextareaInput(),this.editjson_textarea.style.height="170px",this.editjson_textarea.style.width="300px",this.editjson_textarea.style.display="block",this.editjson_save=this.getButton("Save","save","Save"),this.editjson_save.addEventListener("click",function(){a.saveJSON()}),this.editjson_cancel=this.getButton("Cancel","cancel","Cancel"),this.editjson_cancel.addEventListener("click",function(){a.hideEditJSON()}),this.editjson_holder.appendChild(this.editjson_textarea),this.editjson_holder.appendChild(this.editjson_save),this.editjson_holder.appendChild(this.editjson_cancel),this.addproperty_holder=this.theme.getModal(),this.addproperty_list=document.createElement("div"),this.addproperty_list.style.width="295px",this.addproperty_list.style.maxHeight="160px",this.addproperty_list.style.padding="5px 0",this.addproperty_list.style.overflowY="auto",this.addproperty_list.style.overflowX="hidden",this.addproperty_list.style.paddingLeft="5px",this.addproperty_add=this.getButton("add","add","add"),this.addproperty_input=this.theme.getFormInputField("text"),this.addproperty_input.setAttribute("placeholder","Property name..."),this.addproperty_input.style.width="220px",this.addproperty_input.style.marginBottom="0",this.addproperty_input.style.display="inline-block",this.addproperty_add.addEventListener("click",function(){if(a.addproperty_input.value){if(a.editors[a.addproperty_input.value])return void alert("there is already a property with that name");a.addObjectProperty(a.addproperty_input.value),a.addPropertyCheckbox(a.addproperty_input.value),a.editors[a.addproperty_input.value]&&a.editors[a.addproperty_input.value].disable()}}),this.addproperty_holder.appendChild(this.addproperty_list),this.addproperty_holder.appendChild(this.addproperty_input),this.addproperty_holder.appendChild(this.addproperty_add);var b=document.createElement("div");b.style.clear="both",this.addproperty_holder.appendChild(b),this.schema.description&&(this.description=this.getTheme().getDescription(this.schema.description),this.container.appendChild(this.description)),this.error_holder=document.createElement("div"),this.container.appendChild(this.error_holder),this.editor_holder=this.getTheme().getIndentedPanel(),this.editor_holder.style.paddingBottom="0",this.container.appendChild(this.editor_holder),this.row_container=this.theme.getGridContainer(),this.editor_holder.appendChild(this.row_container),c(this.schema.properties,function(b,c){var d=a.jsoneditor.getEditorClass(c,a.jsoneditor),e=a.getTheme().getGridColumn();a.row_container.appendChild(e);var f;a.schema.required&&a.schema.required instanceof Array&&(f=a.schema.required.indexOf(b)>=0),a.editors[b]=a.jsoneditor.createEditor(d,{jsoneditor:a.jsoneditor,schema:c,container:e,path:a.path+"."+b,parent:a,required:f}),a.minwidth=Math.max(a.minwidth,a.editors[b].getNumColumns()),a.maxwidth+=a.editors[b].getNumColumns()}),this.title_controls=this.getTheme().getHeaderButtonHolder(),this.editjson_controls=this.getTheme().getHeaderButtonHolder(),this.addproperty_controls=this.getTheme().getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.title.appendChild(this.editjson_controls),this.title.appendChild(this.addproperty_controls),this.collapsed=!1,this.toggle_button=this.getButton("","collapse","Collapse"),this.title_controls.appendChild(this.toggle_button),this.toggle_button.addEventListener("click",function(){a.collapsed?(a.editor_holder.style.display="",a.collapsed=!1,a.setButtonText(a.toggle_button,"","collapse","Collapse")):(a.editor_holder.style.display="none",a.collapsed=!0,a.setButtonText(a.toggle_button,"","expand","Expand"))}),this.options.collapsed&&d(this.toggle_button,"click"),this.schema.options&&"undefined"!=typeof this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none"),this.editjson_button=this.getButton("JSON","edit","Edit JSON"),this.editjson_button.addEventListener("click",function(){a.toggleEditJSON()}),this.editjson_controls.appendChild(this.editjson_button),this.editjson_controls.appendChild(this.editjson_holder),this.schema.options&&"undefined"!=typeof this.schema.options.disable_edit_json?this.schema.options.disable_edit_json&&(this.editjson_button.style.display="none"):this.jsoneditor.options.disable_edit_json&&(this.editjson_button.style.display="none"),this.addproperty_button=this.getButton("Properties","edit","Object Properties"),this.addproperty_button.addEventListener("click",function(){a.toggleAddProperty()}),this.addproperty_controls.appendChild(this.addproperty_button),this.addproperty_controls.appendChild(this.addproperty_holder),this.refreshAddProperties()}var e={},f=Object.keys(this.editors);f=f.sort(function(b,c){var d=a.editors[b].schema.propertyOrder,e=a.editors[c].schema.propertyOrder;return"number"!=typeof d&&(d=1e3),"number"!=typeof e&&(e=1e3),d-e});for(var g=0;g<f.length;g++)e[f[g]]=this.editors[f[g]];this.editors=e,this.getOption("table_row",!1)?(this.editor_holder=this.container,c(this.editors,function(b,c){a.editor_holder.appendChild(c.container)})):(this.layoutEditors(),this.layoutEditors()),this.jsoneditor.notifyWatchers(this.path)},showEditJSON:function(){this.editjson_holder&&(this.hideAddProperty(),this.editjson_holder.style.left=this.editjson_button.offsetLeft+"px",this.editjson_holder.style.top=this.editjson_button.offsetTop+this.editjson_button.offsetHeight+"px",this.editjson_textarea.value=JSON.stringify(this.getValue(),null,2),this.disable(),this.editjson_holder.style.display="",this.editjson_button.disabled=!1,this.editing_json=!0)},hideEditJSON:function(){this.editjson_holder&&this.editing_json&&(this.editjson_holder.style.display="none",this.enable(),this.editing_json=!1)},saveJSON:function(){if(this.editjson_holder)try{var a=JSON.parse(this.editjson_textarea.value);this.setValue(a),this.hideEditJSON()}catch(b){throw alert("invalid JSON"),b}},toggleEditJSON:function(){this.editing_json?this.hideEditJSON():this.showEditJSON()},addPropertyCheckbox:function(a){var b=this.editors[a];if(b){var c,d,e,f=this;return c=f.theme.getCheckbox(),c.style.width="auto",d=f.theme.getCheckboxLabel(a),e=f.theme.getFormControl(d,c),e.style.paddingBottom=e.style.marginBottom=e.style.paddingTop=e.style.marginTop=0,e.style.height="auto",f.addproperty_list.appendChild(e),c.checked=!b.property_removed,b.isRequired()&&(c.disabled=!0),c.addEventListener("change",function(){c.checked?f.addObjectProperty(a):f.removeObjectProperty(a)}),c}},showAddProperty:function(){if(this.addproperty_holder){this.hideEditJSON(),this.addproperty_holder.style.left=this.addproperty_button.offsetLeft+"px",this.addproperty_holder.style.top=this.addproperty_button.offsetTop+this.addproperty_button.offsetHeight+"px",this.addproperty_list.innerHTML="";var a=this;this.addproperty_checkboxes={},c(this.editors,function(b){a.addproperty_checkboxes[b]=a.addPropertyCheckbox(b)}),this.disable(),this.adding_property=!0,this.addproperty_button.disabled=!1,this.addproperty_holder.style.display="",this.refreshAddProperties()}},hideAddProperty:function(){this.addproperty_holder&&this.adding_property&&(this.addproperty_holder.style.display="none",this.enable(),this.adding_property=!1)},toggleAddProperty:function(){this.adding_property?this.hideAddProperty():this.showAddProperty()},removeObjectProperty:function(a){this.editors[a]&&(this.editors[a].property_removed=!0,this.editors[a].unregister(),this.refreshValue(),this.layoutEditors(),this.jsoneditor.notifyWatchers(this.path),this.parent?this.parent.onChildEditorChange(this):this.jsoneditor.onChange())},addObjectProperty:function(a){var d=this;if(this.editors[a]){if(!this.editors[a].property_removed)return;this.editors[a].property_removed=!1,this.editors[a].register(),this.jsoneditor.notifyWatchers(this.editors[a].path)}else{var e={},f=!1;d.schema.patternProperties&&c(d.schema.patternProperties,function(c,d){var g=new RegExp(c);g.test(a)&&(f=!0,e=b(e,d))}),f||"object"!=typeof d.schema.additionalProperties||(e=b(e,d.schema.additionalProperties));var g=d.jsoneditor.getEditorClass(e,d.jsoneditor),h=d.getTheme().getChildEditorHolder();d.editor_holder.appendChild(h),d.editors[a]=d.jsoneditor.createEditor(g,{jsoneditor:d.jsoneditor,schema:e,container:h,path:d.path+"."+a,parent:d,required:!1}),d.editors[a].not_core=!0}d.refreshValue(),d.jsoneditor.notifyWatchers(d.path),d.parent?d.parent.onChildEditorChange(d):d.jsoneditor.onChange(),d.layoutEditors()},onChildEditorChange:function(a){this.refreshValue(),this._super(a)},canHaveAdditionalProperties:function(){return this.schema.additionalProperties!==!1&&!this.jsoneditor.options.no_additional_properties},destroy:function(){c(this.editors,function(a,b){b.destroy()}),this.editor_holder.innerHTML="",this.title&&this.title.parentNode.removeChild(this.title),this.error_holder&&this.error_holder.parentNode.removeChild(this.error_holder),this.editors=null,this.editor_holder.parentNode.removeChild(this.editor_holder),this.editor_holder=null,this._super()},refreshValue:function(){this.value={},this.serialized="";var a=this,b=0,d=!1,e=this.editors;c(this.editors,function(a,b){b.property_removed&&b.not_core&&(e={},d=!0)}),c(this.editors,function(c,f){if(f.property_removed){if(!f.not_core&&d)e[c]=f;else if(f.not_core){var g=f.container;f.destroy(),g.parentNode&&g.parentNode.removeChild(g)}}else d&&(e[c]=f),b++,a.value[c]=f.getValue()}),this.editors=e,this.adding_property&&this.refreshAddProperties()},refreshAddProperties:function(){if(this.options.disable_properties||this.jsoneditor.options.disable_properties)return void(this.addproperty_controls.style.display="none");
var a,b=!1,c=!1,d=0,e=!1;for(a in this.editors)this.editors.hasOwnProperty(a)&&(this.editors[a].property_removed||d++);b=this.canHaveAdditionalProperties()&&!("undefined"!=typeof this.schema.maxProperties&&d>=this.schema.maxProperties);for(a in this.editors)this.editors.hasOwnProperty(a)&&(this.editors[a].isRequired()?this.addproperty_checkboxes&&this.addproperty_checkboxes[a]&&(this.addproperty_checkboxes[a].disabled=!0):"undefined"!=typeof this.schema.minProperties&&d<=this.schema.minProperties?this.addproperty_checkboxes&&this.addproperty_checkboxes[a]?(this.addproperty_checkboxes[a].disabled=this.addproperty_checkboxes[a].checked,this.addproperty_checkboxes[a].checked||(e=!0)):this.editors[a].property_removed&&b&&(e=!0):this.editors[a].property_removed?this.addproperty_checkboxes&&this.addproperty_checkboxes[a]?b?(this.addproperty_checkboxes[a].disabled=!1,e=!0):this.addproperty_checkboxes[a].disabled=!0:b&&(e=!0):(this.addproperty_checkboxes&&this.addproperty_checkboxes[a]&&(this.addproperty_checkboxes[a].disabled=!1),e=!0,c=!0));if(this.canHaveAdditionalProperties()&&(e=!0),this.addproperty_checkboxes)for(a in this.addproperty_checkboxes)this.addproperty_checkboxes.hasOwnProperty(a)&&(this.editors[a]||(e=!0,this.addproperty_checkboxes[a].disabled=!b&&!c));e?this.canHaveAdditionalProperties()?this.addproperty_add.disabled=b?!1:!0:(this.addproperty_add.style.display="none",this.addproperty_input.style.display="none"):(this.hideAddProperty(),this.addproperty_controls.style.display="none")},setValue:function(a,b){var d=this;a=a||{},("object"!=typeof a||a instanceof Array)&&(a={}),c(this.editors,function(c,e){if("undefined"!=typeof a[c])e.property_removed&&d.addObjectProperty(c),e.setValue(a[c],b);else{if(!b&&!e.property_removed&&!e.isRequired())return void d.removeObjectProperty(c);e.setValue(e.getDefault(),b)}}),this.canHaveAdditionalProperties()&&c(a,function(a,c){d.editors[a]||(d.addObjectProperty(a),d.editors[a]&&d.editors[a].setValue(c,b))}),this.refreshValue(),this.jsoneditor.notifyWatchers(this.path)},showValidationErrors:function(a){var b=this,d=[],e=[];c(a,function(a,c){c.path===b.path?d.push(c):e.push(c)}),this.error_holder&&(d.length?(this.error_holder.innerHTML="",this.error_holder.style.display="",c(d,function(a,c){b.error_holder.appendChild(b.theme.getErrorMessage(c.message))})):this.error_holder.style.display="none"),this.getOption("table_row")&&(d.length?this.theme.addTableRowError(this.container):this.theme.removeTableRowError(this.container)),c(this.editors,function(a,b){b.showValidationErrors(e)})}}),f.defaults.editors.array=f.AbstractEditor.extend({getDefault:function(){return this.schema.default||[]},register:function(){if(this._super(),this.rows)for(var a=0;a<this.rows.length;a++)this.rows[a].register()},unregister:function(){if(this._super(),this.rows)for(var a=0;a<this.rows.length;a++)this.rows[a].unregister()},getNumColumns:function(){var a=this.getItemInfo(0);return this.tabs_holder?Math.max(Math.min(12,a.width+2),4):a.width},addProperty:function(){this._super(),this.row_holder.style.display="",this.tabs_holder&&(this.tabs_holder.style.display=""),this.collapsed||(this.controls.style.display=""),this.title_controls.style.display="",this.theme.enableHeader(this.title)},removeProperty:function(){this._super(),this.row_holder.style.display="none",this.tabs_holder&&(this.tabs_holder.style.display="none"),this.controls.style.display="none",this.title_controls.style.display="none",this.theme.disableHeader(this.title)},enable:function(){if(this.add_row_button&&(this.add_row_button.disabled=!1),this.remove_all_rows_button&&(this.remove_all_rows_button.disabled=!1),this.delete_last_row_button&&(this.delete_last_row_button.disabled=!1),this.rows)for(var a=0;a<this.rows.length;a++)this.rows[a].enable(),this.rows[a].moveup_button&&(this.rows[a].moveup_button.disabled=!1),this.rows[a].movedown_button&&(this.rows[a].movedown_button.disabled=!1),this.rows[a].delete_button&&(this.rows[a].delete_button.disabled=!1);this._super()},disable:function(){if(this.add_row_button&&(this.add_row_button.disabled=!0),this.remove_all_rows_button&&(this.remove_all_rows_button.disabled=!0),this.delete_last_row_button&&(this.delete_last_row_button.disabled=!0),this.rows)for(var a=0;a<this.rows.length;a++)this.rows[a].disable(),this.rows[a].moveup_button&&(this.rows[a].moveup_button.disabled=!0),this.rows[a].movedown_button&&(this.rows[a].movedown_button.disabled=!0),this.rows[a].delete_button&&(this.rows[a].delete_button.disabled=!0);this._super()},build:function(){this.rows=[],this.row_cache=[];var a=this;this.hide_delete_buttons=this.options.disable_array_delete||this.jsoneditor.options.disable_array_delete,this.hide_move_buttons=this.options.disable_array_reorder||this.jsoneditor.options.disable_array_reorder,this.hide_add_button=this.options.disable_array_add||this.jsoneditor.options.disable_array_add,this.getOption("compact",!1)?(this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls),this.row_holder=document.createElement("div"),this.panel.appendChild(this.row_holder)):(this.header=document.createElement("span"),this.header.textContent=this.getTitle(),this.title=this.theme.getHeader(this.header),this.container.appendChild(this.title),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.container.appendChild(this.description)),this.error_holder=document.createElement("div"),this.container.appendChild(this.error_holder),"tabs"===this.schema.format?(this.controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.controls),this.tabs_holder=this.theme.getTabHolder(),this.container.appendChild(this.tabs_holder),this.row_holder=this.theme.getTabContentHolder(this.tabs_holder),this.active_tab=null):(this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.row_holder=document.createElement("div"),this.panel.appendChild(this.row_holder),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls))),this.row_holder.addEventListener("change_header_text",function(){a.refreshTabs(!0)}),this.addControls(),this.jsoneditor.notifyWatchers(this.path)},onChildEditorChange:function(a){this.refreshValue(),this._super(a)},getItemTitle:function(){return this.schema.items&&this.schema.items.title||"item"},getItemSchema:function(a){return this.schema.items instanceof Array?a>=this.schema.items.length?this.schema.additionalItems===!0?{}:this.schema.additionalItems?b({},this.schema.additionalItems):void 0:b({},this.schema.items[a]):this.schema.items?b({},this.schema.items):{}},getItemInfo:function(a){var b=this.getItemSchema(a);this.item_info=this.item_info||{};var c=JSON.stringify(b);if("undefined"!=typeof this.item_info[c])return this.item_info[c];var d=document.createElement("div");this.container.appendChild(d),d.addEventListener("change_header_text",function(a){a.preventDefault(),a.stopPropagation()});var e=this.jsoneditor.getEditorClass(b,this.jsoneditor);return e=this.jsoneditor.createEditor(e,{jsoneditor:this.jsoneditor,schema:b,container:d,path:this.path+"."+a,parent:this,required:!0}),this.item_info[c]={child_editors:e.getChildEditors()?!0:!1,title:b.title||"item",width:e.getNumColumns(),"default":e.getDefault()},e.destroy(),d.parentNode&&d.parentNode.removeChild(d),this.item_info[c]},getElementEditor:function(a){var b=this.getItemInfo(a),c=this.getItemSchema(a);c.title=b.title+" "+a;var d,e=this.jsoneditor.getEditorClass(c,this.jsoneditor);d=this.tabs_holder?this.theme.getTabContent():b.child_editors?this.theme.getChildEditorHolder():this.theme.getIndentedPanel(),this.row_holder.appendChild(d);var f=this.jsoneditor.createEditor(e,{jsoneditor:this.jsoneditor,schema:c,container:d,path:this.path+"."+a,parent:this,required:!0});return f.title_controls||(f.array_controls=this.theme.getButtonHolder(),d.appendChild(f.array_controls)),f},destroy:function(){this.empty(!0),this.title&&this.title.parentNode.removeChild(this.title),this.description&&this.description.parentNode.removeChild(this.description),this.row_holder&&this.row_holder.parentNode.removeChild(this.row_holder),this.controls&&this.controls.parentNode.removeChild(this.controls),this.panel&&this.panel.parentNode.removeChild(this.panel),this.rows=this.row_cache=this.title=this.description=this.row_holder=this.panel=this.controls=null,this._super()},empty:function(a){if(this.rows){var b=this;c(this.rows,function(c,d){a&&(d.tab&&d.tab.parentNode&&d.tab.parentNode.removeChild(d.tab),b.destroyRow(d,!0),b.row_cache[c]=null),b.rows[c]=null}),b.rows=[],a&&(b.row_cache=[])}},destroyRow:function(a,b){var c=a.container;b?(a.destroy(),c.parentNode&&c.parentNode.removeChild(c),a.tab&&a.tab.parentNode&&a.tab.parentNode.removeChild(a.tab)):(a.tab&&(a.tab.style.display="none"),c.style.display="none",a.unregister())},getMax:function(){return this.schema.items instanceof Array&&this.schema.additionalItems===!1?Math.min(this.schema.items.length,this.schema.maxItems||1/0):this.schema.maxItems||1/0},refreshTabs:function(a){var b=this;c(this.rows,function(c,d){d.tab&&(a?d.tab_text.textContent=d.getHeaderText():d.tab===b.active_tab?(b.theme.markTabActive(d.tab),d.container.style.display=""):(b.theme.markTabInactive(d.tab),d.container.style.display="none"))})},setValue:function(a,b){a=a||[],a instanceof Array||(a=[a]);var d=JSON.stringify(a);if(d!==this.serialized){if(this.schema.minItems)for(;a.length<this.schema.minItems;)a.push(this.getItemInfo(a.length).default);this.getMax()&&a.length>this.getMax()&&(a=a.slice(0,this.getMax()));var e=this;c(a,function(a,b){e.rows[a]?e.rows[a].setValue(b):e.row_cache[a]?(e.rows[a]=e.row_cache[a],e.rows[a].setValue(b),e.rows[a].container.style.display="",e.rows[a].tab&&(e.rows[a].tab.style.display=""),e.rows[a].register()):e.addRow(b)});for(var f=a.length;f<e.rows.length;f++)e.destroyRow(e.rows[f]),e.rows[f]=null;e.rows=e.rows.slice(0,a.length);var g=null;c(e.rows,function(a,b){return b.tab===e.active_tab?(g=b.tab,!1):void 0}),!g&&e.rows.length&&(g=e.rows[0].tab),e.active_tab=g,e.refreshValue(b),e.refreshTabs(),e.jsoneditor.notifyWatchers(e.path)}},refreshValue:function(a){var b=this,d=this.value?this.value.length:0;if(this.value=[],c(this.rows,function(a,c){b.value[a]=c.getValue()}),d!==this.value.length||a){var e=this.schema.minItems&&this.schema.minItems>=this.rows.length;c(this.rows,function(a,c){c.movedown_buttons&&(c.movedown_button.style.display=a===b.rows.length-1?"none":""),c.delete_button&&(c.delete_button.style.display=e?"none":""),b.value[a]=c.getValue()});var f=!1;this.value.length?1===this.value.length?(this.remove_all_rows_button.style.display="none",e||this.hide_delete_buttons?this.delete_last_row_button.style.display="none":(this.delete_last_row_button.style.display="",f=!0)):e||this.hide_delete_buttons?(this.delete_last_row_button.style.display="none",this.remove_all_rows_button.style.display="none"):(this.delete_last_row_button.style.display="",this.remove_all_rows_button.style.display="",f=!0):(this.delete_last_row_button.style.display="none",this.remove_all_rows_button.style.display="none"),this.getMax()&&this.getMax()<=this.rows.length||this.hide_add_button?this.add_row_button.style.display="none":(this.add_row_button.style.display="",f=!0),this.controls.style.display=!this.collapsed&&f?"":"none"}},addRow:function(a){var b=this,d=this.rows.length;b.rows[d]=this.getElementEditor(d),b.row_cache[d]=b.rows[d],b.tabs_holder&&(b.rows[d].tab_text=document.createElement("span"),b.rows[d].tab_text.textContent=b.rows[d].getHeaderText(),b.rows[d].tab=b.theme.getTab(b.rows[d].tab_text),b.rows[d].tab.addEventListener("click",function(a){b.active_tab=b.rows[d].tab,b.refreshTabs(),a.preventDefault(),a.stopPropagation()}),b.theme.addTab(b.tabs_holder,b.rows[d].tab));var e=b.rows[d].title_controls||b.rows[d].array_controls;b.hide_delete_buttons||(b.rows[d].delete_button=this.getButton(b.getItemTitle(),"delete","Delete "+b.getItemTitle()),b.rows[d].delete_button.className+=" delete",b.rows[d].delete_button.setAttribute("data-i",d),b.rows[d].delete_button.addEventListener("click",function(){var a=1*this.getAttribute("data-i"),d=b.getValue(),e=[],f=null;c(d,function(c,d){return c===a?void(b.rows[c].tab===b.active_tab&&(b.rows[c+1]?f=b.rows[c+1].tab:c&&(f=b.rows[c-1].tab))):void e.push(d)}),b.setValue(e),f&&(b.active_tab=f,b.refreshTabs()),b.parent?b.parent.onChildEditorChange(b):b.jsoneditor.onChange()}),e&&e.appendChild(b.rows[d].delete_button)),d&&!b.hide_move_buttons&&(b.rows[d].moveup_button=this.getButton("","moveup","Move up"),b.rows[d].moveup_button.className+=" moveup",b.rows[d].moveup_button.setAttribute("data-i",d),b.rows[d].moveup_button.addEventListener("click",function(){var a=1*this.getAttribute("data-i");if(!(0>=a)){var c=b.getValue(),d=c[a-1];c[a-1]=c[a],c[a]=d,b.setValue(c),b.active_tab=b.rows[a-1].tab,b.refreshTabs(),b.parent?b.parent.onChildEditorChange(b):b.jsoneditor.onChange()}}),e&&e.appendChild(b.rows[d].moveup_button)),b.hide_move_buttons||(b.rows[d].movedown_button=this.getButton("","movedown","Move down"),b.rows[d].movedown_button.className+=" movedown",b.rows[d].movedown_button.setAttribute("data-i",d),b.rows[d].movedown_button.addEventListener("click",function(){var a=1*this.getAttribute("data-i"),c=b.getValue();if(!(a>=c.length-1)){var d=c[a+1];c[a+1]=c[a],c[a]=d,b.setValue(c),b.active_tab=b.rows[a+1].tab,b.refreshTabs(),b.parent?b.parent.onChildEditorChange(b):b.jsoneditor.onChange()}}),e&&e.appendChild(b.rows[d].movedown_button)),a&&b.rows[d].setValue(a),b.refreshTabs()},addControls:function(){var a=this;this.collapsed=!1,this.toggle_button=this.getButton("","collapse","Collapse"),this.title_controls.appendChild(this.toggle_button);var b=a.row_holder.style.display,c=a.controls.style.display;this.toggle_button.addEventListener("click",function(){a.collapsed?(a.collapsed=!1,a.panel&&(a.panel.style.display=""),a.row_holder.style.display=b,a.tabs_holder&&(a.tabs_holder.style.display=""),a.controls.style.display=c,a.setButtonText(this,"","collapse","Collapse")):(a.collapsed=!0,a.row_holder.style.display="none",a.tabs_holder&&(a.tabs_holder.style.display="none"),a.controls.style.display="none",a.panel&&(a.panel.style.display="none"),a.setButtonText(this,"","expand","Expand"))}),this.options.collapsed&&d(this.toggle_button,"click"),this.schema.options&&"undefined"!=typeof this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none"),this.add_row_button=this.getButton(this.getItemTitle(),"add","Add "+this.getItemTitle()),this.add_row_button.addEventListener("click",function(){var b=a.rows.length;a.row_cache[b]?(a.rows[b]=a.row_cache[b],a.rows[b].container.style.display="",a.rows[b].tab&&(a.rows[b].tab.style.display=""),a.rows[b].register()):a.addRow(),a.active_tab=a.rows[b].tab,a.refreshTabs(),a.refreshValue(),a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange(),a.jsoneditor.notifyWatchers(a.path)}),a.controls.appendChild(this.add_row_button),this.delete_last_row_button=this.getButton("Last "+this.getItemTitle(),"delete","Delete Last "+this.getItemTitle()),this.delete_last_row_button.addEventListener("click",function(){var b=a.getValue(),c=null;a.rows.length>1&&a.rows[a.rows.length-1].tab===a.active_tab&&(c=a.rows[a.rows.length-2].tab),b.pop(),a.setValue(b),c&&(a.active_tab=c,a.refreshTabs()),a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange()}),a.controls.appendChild(this.delete_last_row_button),this.remove_all_rows_button=this.getButton("All","delete","Delete All"),this.remove_all_rows_button.addEventListener("click",function(){a.setValue([]),a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange()}),a.controls.appendChild(this.remove_all_rows_button),a.tabs&&(this.add_row_button.style.width="100%",this.add_row_button.style.textAlign="left",this.add_row_button.style.marginBottom="3px",this.delete_last_row_button.style.width="100%",this.delete_last_row_button.style.textAlign="left",this.delete_last_row_button.style.marginBottom="3px",this.remove_all_rows_button.style.width="100%",this.remove_all_rows_button.style.textAlign="left",this.remove_all_rows_button.style.marginBottom="3px")},showValidationErrors:function(a){var b=this,d=[],e=[];c(a,function(a,c){c.path===b.path?d.push(c):e.push(c)}),this.error_holder&&(d.length?(this.error_holder.innerHTML="",this.error_holder.style.display="",c(d,function(a,c){b.error_holder.appendChild(b.theme.getErrorMessage(c.message))})):this.error_holder.style.display="none"),c(this.rows,function(a,b){b.showValidationErrors(e)})}}),f.defaults.editors.table=f.defaults.editors.array.extend({addProperty:function(){this._super(),this.value.length&&(this.table.style.display="")},removeProperty:function(){this._super(),this.table.style.display="none"},register:function(){if(this._super(),this.rows)for(var a=0;a<this.rows.length;a++)this.rows[a].register()},unregister:function(){if(this._super(),this.rows)for(var a=0;a<this.rows.length;a++)this.rows[a].unregister()},getNumColumns:function(){return Math.max(Math.min(12,this.width),3)},build:function(){this.rows=[];var a=this;this.schema.items=this.schema.items||[],this.hide_delete_buttons=this.options.disable_array_delete||this.jsoneditor.options.disable_array_delete,this.hide_move_buttons=this.options.disable_array_reorder||this.jsoneditor.options.disable_array_reorder,this.hide_add_button=this.options.disable_array_add||this.jsoneditor.options.disable_array_add,this.table=this.theme.getTable(),this.container.appendChild(this.table),this.thead=this.theme.getTableHead(),this.table.appendChild(this.thead),this.header_row=this.theme.getTableRow(),this.thead.appendChild(this.header_row),this.row_holder=this.theme.getTableBody(),this.table.appendChild(this.row_holder);var b=this.getElementEditor(0,!0);this.item_default=b.getDefault(),this.item_title=this.schema.items.title||"row",this.width=b.getNumColumns(),b.getChildEditors()&&(this.item_has_child_editors=!0),this.getOption("compact",!1)?(this.panel=document.createElement("div"),this.container.appendChild(this.panel)):(this.title=this.theme.getHeader(this.getTitle()),this.container.appendChild(this.title),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.panel.appendChild(this.description)),this.error_holder=document.createElement("div"),this.panel.appendChild(this.error_holder)),this.panel.appendChild(this.table),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls),this.item_has_child_editors?c(b.getChildEditors(),function(b,c){var d=a.theme.getTableHeaderCell(c.getTitle());c.options.hidden&&(d.style.display="none"),a.header_row.appendChild(d)}):a.header_row.appendChild(a.theme.getTableHeaderCell(this.item_title)),b.destroy(),this.row_holder.innerHTML="",this.controls_header_cell=a.theme.getTableHeaderCell(" "),a.header_row.appendChild(this.controls_header_cell),this.addControls(),this.jsoneditor.notifyWatchers(this.path)},onChildEditorChange:function(){this.refreshValue(),this._super()},getItemDefault:function(){return b({},{"default":this.item_default}).default},getItemTitle:function(){return this.item_title},getElementEditor:function(a,c){var d=b({},this.schema.items),e=this.jsoneditor.getEditorClass(d,this.jsoneditor),f=this.row_holder.appendChild(this.theme.getTableRow()),g=f;this.item_has_child_editors||(g=this.theme.getTableCell(),f.appendChild(g)),c&&g.addEventListener("change_header_text",function(a){a.preventDefault(),a.stopPropagation()});var h=this.jsoneditor.createEditor(e,{jsoneditor:this.jsoneditor,schema:d,container:g,path:this.path+"."+a,parent:this,compact:!0,table_row:!0});return h.controls_cell=f.appendChild(this.theme.getTableCell()),h.row=f,h.table_controls=this.theme.getButtonHolder(),h.controls_cell.appendChild(h.table_controls),h.table_controls.style.margin=0,h.table_controls.style.padding=0,h},destroy:function(){this.innerHTML="",this.title&&this.title.parentNode.removeChild(this.title),this.description&&this.description.parentNode.removeChild(this.description),this.row_holder&&this.row_holder.parentNode&&this.row_holder.parentNode.removeChild(this.row_holder),this.table.parentNode.removeChild(this.table),this.panel&&this.panel.parentNode.removeChild(this.panel),this.rows=this.title=this.description=this.row_holder=this.table=this.panel=null,this._super()},empty:function(){if(this.rows){var a=this;c(this.rows,function(b,c){a.item_has_child_editors||c.row.parentNode.removeChild(c.row),c.destroy(),a.rows[b]=null}),a.rows=[]}},setValue:function(a,b){if(a=a||[],this.schema.minItems)for(;a.length<this.schema.minItems;)a.push(this.getItemDefault());this.schema.maxItems&&a.length>this.schema.maxItems&&(a=a.slice(0,this.schema.maxItems));var d=JSON.stringify(a);if(d!==this.serialized){var e=!1,f=this;c(a,function(a,b){f.rows[a]?f.rows[a].setValue(b):(f.addRow(b),e=!0)});for(var g=a.length;g<f.rows.length;g++){var h=f.rows[g].container;f.item_has_child_editors||f.rows[g].row.parentNode.removeChild(f.rows[g].row),f.rows[g].destroy(),h.parentNode&&h.parentNode.removeChild(h),f.rows[g]=null,e=!0}f.rows=f.rows.slice(0,a.length),f.refreshValue(),(e||b)&&f.refreshRowButtons(),f.jsoneditor.notifyWatchers(f.path)}},refreshRowButtons:function(){var a=this,b=this.schema.minItems&&this.schema.minItems>=this.rows.length,d=!1;c(this.rows,function(c,e){e.movedown_button&&(c===a.rows.length-1?e.movedown_button.style.display="none":(d=!0,e.movedown_button.style.display="")),e.delete_button&&(b?e.delete_button.style.display="none":(d=!0,e.delete_button.style.display="")),e.moveup_button&&(d=!0)}),c(this.rows,function(a,b){b.controls_cell.style.display=d?"":"none"}),this.controls_header_cell.style.display=d?"":"none";var e=!1;this.value.length?1===this.value.length||this.hide_delete_buttons?(this.table.style.display="",this.remove_all_rows_button.style.display="none",b||this.hide_delete_buttons?this.delete_last_row_button.style.display="none":(this.delete_last_row_button.style.display="",e=!0)):(this.table.style.display="",b||this.hide_delete_buttons?(this.delete_last_row_button.style.display="none",this.remove_all_rows_button.style.display="none"):(this.delete_last_row_button.style.display="",this.remove_all_rows_button.style.display="",e=!0)):(this.delete_last_row_button.style.display="none",this.remove_all_rows_button.style.display="none",this.table.style.display="none"),this.schema.maxItems&&this.schema.maxItems<=this.rows.length||this.hide_add_button?this.add_row_button.style.display="none":(this.add_row_button.style.display="",e=!0),this.controls.style.display=e?"":"none"},refreshValue:function(){var a=this;this.value=[],c(this.rows,function(b,c){a.value[b]=c.getValue()}),this.serialized=JSON.stringify(this.value)},addRow:function(a){var b=this,d=this.rows.length;b.rows[d]=this.getElementEditor(d);var e=b.rows[d].table_controls;this.hide_delete_buttons||(b.rows[d].delete_button=this.getButton("","delete","Delete"),b.rows[d].delete_button.className+=" delete",b.rows[d].delete_button.setAttribute("data-i",d),b.rows[d].delete_button.addEventListener("click",function(){var a=1*this.getAttribute("data-i"),d=b.getValue(),e=[];c(d,function(b,c){b!==a&&e.push(c)}),b.setValue(e),b.parent?b.parent.onChildEditorChange(b):b.jsoneditor.onChange()}),e.appendChild(b.rows[d].delete_button)),d&&!this.hide_move_buttons&&(b.rows[d].moveup_button=this.getButton("","moveup","Move up"),b.rows[d].moveup_button.className+=" moveup",b.rows[d].moveup_button.setAttribute("data-i",d),b.rows[d].moveup_button.addEventListener("click",function(){var a=1*this.getAttribute("data-i");if(!(0>=a)){var c=b.getValue(),d=c[a-1];c[a-1]=c[a],c[a]=d,b.setValue(c),b.parent?b.parent.onChildEditorChange(b):b.jsoneditor.onChange()}}),e.appendChild(b.rows[d].moveup_button)),this.hide_move_buttons||(b.rows[d].movedown_button=this.getButton("","movedown","Move down"),b.rows[d].movedown_button.className+=" movedown",b.rows[d].movedown_button.setAttribute("data-i",d),b.rows[d].movedown_button.addEventListener("click",function(){var a=1*this.getAttribute("data-i"),c=b.getValue();if(!(a>=c.length-1)){var d=c[a+1];c[a+1]=c[a],c[a]=d,b.setValue(c),b.parent?b.parent.onChildEditorChange(b):b.jsoneditor.onChange()}}),e.appendChild(b.rows[d].movedown_button)),a&&b.rows[d].setValue(a),b.jsoneditor.notifyWatchers(b.path)},addControls:function(){var a=this;this.collapsed=!1,this.toggle_button=this.getButton("","collapse","Collapse"),this.title_controls.appendChild(this.toggle_button),this.toggle_button.addEventListener("click",function(b){b.preventDefault(),b.stopPropagation(),a.collapsed?(a.collapsed=!1,a.panel.style.display="",a.setButtonText(this,"","collapse","Collapse")):(a.collapsed=!0,a.panel.style.display="none",a.setButtonText(this,"","expand","Expand"))}),this.options.collapsed&&d(this.toggle_button,"click"),this.schema.options&&"undefined"!=typeof this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display="none"):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display="none"),this.add_row_button=this.getButton(this.getItemTitle(),"add","Add "+this.getItemTitle()),this.add_row_button.addEventListener("click",function(b){b.preventDefault(),b.stopPropagation(),a.addRow(),a.refreshValue(),a.refreshRowButtons(),a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange()}),a.controls.appendChild(this.add_row_button),this.delete_last_row_button=this.getButton("Last "+this.getItemTitle(),"delete","Delete Last "+this.getItemTitle()),this.delete_last_row_button.addEventListener("click",function(b){b.preventDefault(),b.stopPropagation();var c=a.getValue();c.pop(),a.setValue(c),a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange()}),a.controls.appendChild(this.delete_last_row_button),this.remove_all_rows_button=this.getButton("All","delete","Delete All"),this.remove_all_rows_button.addEventListener("click",function(b){b.preventDefault(),b.stopPropagation(),a.setValue([]),a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange()}),a.controls.appendChild(this.remove_all_rows_button)}}),f.defaults.editors.multiple=f.AbstractEditor.extend({getDefault:function(){return this.schema.default||null},register:function(){if(this.editors){for(var a=0;a<this.editors.length;a++)this.editors[a]&&this.editors[a].unregister();this.editors[this.type]&&this.editors[this.type].register()}this._super()},getNumColumns:function(){return Math.max(this.editors[this.type].getNumColumns(),4)},enable:function(){if(this.editors)for(var a=0;a<this.editors.length;a++)this.editors[a]&&this.editors[a].enable();this.switcher.disabled=!1,this._super()},disable:function(){if(this.editors)for(var a=0;a<this.editors.length;a++)this.editors[a]&&this.editors[a].disable();this.switcher.disabled=!0,this._super()},unregister:function(){if(this._super(),this.editors)for(var a=0;a<this.editors.length;a++)this.editors[a]&&this.editors[a].unregister()},switchEditor:function(a){var b=this;this.editors[a]||this.buildChildEditor(a),b.type=a,b.register();var d=b.getValue();c(b.editors,function(a,c){c&&(b.type===a?(c.setValue(d,!0),c.container.style.display=""):c.container.style.display="none")}),b.refreshValue(),b.parent?b.parent.onChildEditorChange(b):b.jsoneditor.onChange()},buildChildEditor:function(a){var c=this,d=this.types[a],e=c.theme.getChildEditorHolder();c.editor_holder.appendChild(e);var f;"string"==typeof d?(f=b({},c.schema),f.type=d):(f=b({},c.schema,d),d.required&&d.required instanceof Array&&c.schema.required&&c.schema.required instanceof Array&&(f.required=c.schema.required.concat(d.required)));var g=c.jsoneditor.getEditorClass(f,c.jsoneditor);c.editors[a]=c.jsoneditor.createEditor(g,{jsoneditor:c.jsoneditor,schema:f,container:e,path:c.path,parent:c,required:!0}),c.editors[a].header&&(c.editors[a].header.style.display="none"),c.editors[a].option=c.switcher_options[a],e.addEventListener("change_header_text",function(){c.refreshHeaderText()}),a!==c.type&&(e.style.display="none")},build:function(){var a=this,d=this.container;if(this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.container.appendChild(this.header),this.types=[],this.schema.oneOf)this.oneOf=!0,this.types=this.schema.oneOf,delete this.schema.oneOf;else{if(this.schema.type&&"any"!==this.schema.type)this.types=this.schema.type instanceof Array?this.schema.type:[this.schema.type];else if(this.types=["string","number","integer","boolean","object","array","null"],this.schema.disallow){var e=this.schema.disallow;"object"==typeof schema.disallow&&schema.disallow instanceof Array||(e=[this.schema.disallow]);var g=[];c(this.types,function(a,b){-1===e.indexOf(b)&&g.push(b)}),this.types=g}delete this.schema.type}this.display_text=this.getDisplayText(this.types),this.switcher=this.theme.getSwitcher(this.display_text),d.appendChild(this.switcher),this.switcher.addEventListener("change",function(b){b.preventDefault(),b.stopPropagation(),a.switchEditor(a.display_text.indexOf(this.value))}),this.switcher.style.marginBottom=0,this.switcher.style.width="auto",this.switcher.style.display="inline-block",this.switcher.style.marginLeft="5px",this.editor_holder=document.createElement("div"),d.appendChild(this.editor_holder),this.type=0,this.editors=[],this.validators=[],this.switcher_options=this.theme.getSwitcherOptions(this.switcher),c(this.types,function(c,d){a.editors[c]=!1;var e;"string"==typeof d?(e=b({},a.schema),e.type=d):(e=b({},a.schema,d),d.required&&d.required instanceof Array&&a.schema.required&&a.schema.required instanceof Array&&(e.required=a.schema.required.concat(d.required))),a.validators[c]=new f.Validator(e,{required_by_default:a.jsoneditor.options.required_by_default,no_additional_properties:a.jsoneditor.options.no_additional_properties})}),this.switchEditor(0),this.refreshValue(),this.refreshHeaderText(),this.register()},onChildEditorChange:function(){this.editors[this.type]&&(this.refreshHeaderText(),this.refreshValue()),this._super()},refreshHeaderText:function(){var a=[];c(this.validators,function(b,c){a.push(c.schema)});var b=this.getDisplayText(a);c(this.switcher_options,function(a,c){c.textContent=b[a]})},refreshValue:function(){this.value=this.editors[this.type].getValue()},setValue:function(a,b){var d=this;c(this.validators,function(b,c){return c.validate(a).length?void 0:(d.type=b,d.switcher.value=d.display_text[b],!1)}),this.switchEditor(this.type),this.editors[this.type].setValue(a,b),this.refreshValue(),this.jsoneditor.notifyWatchers(this.path)},destroy:function(){c(this.editors,function(a,b){b&&b.destroy()}),this.editor_holder.parentNode.removeChild(this.editor_holder),this.switcher.parentNode.removeChild(this.switcher),this._super()},showValidationErrors:function(a){var d=this;this.oneOf?c(this.editors,function(e,f){if(f){var g=d.path+".oneOf["+e+"]",h=[];c(a,function(a,c){if(c.path.substr(0,g.length)===g){var e=b({},c);e.path=d.path+e.path.substr(g.length),h.push(e)}}),f.showValidationErrors(h)}}):c(this.editors,function(b,c){c&&c.showValidationErrors(a)})}}),f.defaults.editors.enum=f.AbstractEditor.extend({getDefault:function(){return this.schema.enum[0]},addProperty:function(){this._super(),this.display_area.style.display="",this.theme.enableHeader(this.title)},removeProperty:function(){this._super(),this.display_area.style.display="none",this.theme.disableHeader(this.title)},getNumColumns:function(){return 4},build:function(){this.getContainer(),this.title=this.header=this.label=this.getTheme().getFormInputLabel(this.getTitle()),this.container.appendChild(this.title),this.options.enum_titles=this.options.enum_titles||[],this.enum=this.schema.enum,this.selected=0,this.select_options=[],this.html_values=[];
for(var a=this,b=0;b<this.enum.length;b++)this.select_options[b]=this.options.enum_titles[b]||"Value "+(b+1),this.html_values[b]=this.getHTML(this.enum[b]);this.switcher=this.theme.getSwitcher(this.select_options),this.container.appendChild(this.switcher),this.switcher.style.width="auto",this.switcher.style.display="inline-block",this.switcher.style.marginLeft="5px",this.switcher.style.marginBottom=0,this.display_area=this.theme.getIndentedPanel(),this.display_area.style.paddingTop=0,this.display_area.style.paddingBottom=0,this.container.appendChild(this.display_area),this.switcher.addEventListener("change",function(){a.selected=a.select_options.indexOf(this.value),a.value=a.enum[a.selected],a.refreshValue(),a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange()}),this.value=this.enum[0],this.refreshValue(),this.jsoneditor.notifyWatchers(this.path),1===this.enum.length&&(this.switcher.style.display="none")},refreshValue:function(){var a=this;a.selected=-1;var b=JSON.stringify(this.value);return c(this.enum,function(c,d){return b===JSON.stringify(d)?(a.selected=c,!1):void 0}),a.selected<0?void a.setValue(a.enum[0]):(this.switcher.value=this.select_options[this.selected],void(this.display_area.innerHTML=this.html_values[this.selected]))},enable:function(){this.always_disabled||(this.switcher.disabled=!1),this._super()},disable:function(){this.switcher.disabled=!0,this._super()},getHTML:function(a){var b=this;if(null===a)return"<em>null</em>";if("object"==typeof a){var d="";return c(a,function(c,e){var f=b.getHTML(e);a instanceof Array||(f="<div><em>"+c+"</em>: "+f+"</div>"),d+="<li>"+f+"</li>"}),d=a instanceof Array?"<ol>"+d+"</ol>":"<ul style='margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;'>"+d+"</ul>"}return"boolean"==typeof a?a?"true":"false":"string"==typeof a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):a},setValue:function(a){this.value!==a&&(this.value=a,this.refreshValue(),this.jsoneditor.notifyWatchers(this.path))},destroy:function(){this.display_area.parentNode.removeChild(this.display_area),this.title.parentNode.removeChild(this.title),this.switcher.parentNode.removeChild(this.switcher),this._super()}}),f.defaults.editors.select=f.AbstractEditor.extend({getDefault:function(){return this.schema.default||""},setValue:function(a){a=this.typecast(a||"");var b=a;this.enum_values.indexOf(b)<0&&(b=this.enum_values[0]),this.value!==b&&(this.input.value=this.enum_options[this.enum_values.indexOf(b)],this.value=b,this.jsoneditor.notifyWatchers(this.path))},register:function(){this._super(),this.input&&this.input.setAttribute("name",this.formname)},unregister:function(){this._super(),this.input&&this.input.removeAttribute("name")},getNumColumns:function(){for(var a=this.getTitle().length,b=0;b<this.enum_options.length;b++)a=Math.max(a,this.enum_options[b].length+4);return Math.min(12,Math.max(a/7,2))},typecast:function(a){return"boolean"===this.schema.type?!!a:"number"===this.schema.type?1*a:"integer"===this.schema.type?Math.floor(1*a):""+a},getValue:function(){return this.value},removeProperty:function(){this._super(),this.input.style.display="none",this.description&&(this.description.style.display="none"),this.theme.disableLabel(this.label)},addProperty:function(){this._super(),this.input.style.display="",this.description&&(this.description.style.display=""),this.theme.enableLabel(this.label)},build:function(){var a=this;if(this.getOption("compact",!1)||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.input_type="select",this.enum_options=[],this.enum_values=[],this.enum_display=[],this.schema.enum)c(this.schema.enum,function(b,c){a.enum_options[b]=""+c,a.enum_display[b]=""+c,a.enum_values[b]=a.typecast(c)});else{if("boolean"!==this.schema.type)throw"'select' editor requires the enum property to be set.";a.enum_display=["true","false"],a.enum_options=["1",""],a.enum_values=[!0,!1]}this.getOption("compact")&&this.container.setAttribute("class",this.container.getAttribute("class")+" compact"),this.input=this.theme.getSelectInput(this.enum_options),this.theme.setSelectOptions(this.input,this.enum_options,this.enum_display),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener("change",function(b){b.preventDefault(),b.stopPropagation();var c=this.value,d=c;-1===a.enum_options.indexOf(c)&&(d=a.enum_options[0]),a.value=a.enum_values[a.enum_options.indexOf(c)],a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange(),a.jsoneditor.notifyWatchers(a.path)}),this.control=this.getTheme().getFormControl(this.label,this.input,this.description),this.container.appendChild(this.control),this.value=this.enum_values[0],window.$&&$.fn&&$.fn.select2&&this.enum_options.length>2&&$(this.input).select2(),this.register(),a.theme.afterInputReady(a.input),this.jsoneditor.notifyWatchers(this.path)},enable:function(){this.always_disabled||(this.input.disabled=!1),this._super()},disable:function(){this.input.disabled=!0,this._super()},destroy:function(){this.label&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode.removeChild(this.description),this.input.parentNode.removeChild(this.input),this._super()}}),f.defaults.editors.multiselect=f.AbstractEditor.extend({getDefault:function(){return[]},build:function(){var a,b=this;this.getOption("compact",!1)||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.select_options={},this.select_values={};var c=this.schema.items.enum||[],d=[];for(a=0;a<c.length;a++)this.sanitize(c[a])===c[a]&&(d.push(c[a]+""),this.select_values[c[a]+""]=c[a]);if(!this.schema.format&&d.length<8||"checkbox"===this.schema.format){for(this.input_type="checkboxes",this.inputs={},this.controls={},a=0;a<d.length;a++){this.inputs[d[a]]=this.theme.getCheckbox(),this.select_options[d[a]]=this.inputs[d[a]];var e=this.theme.getCheckboxLabel(d[a]);this.controls[d[a]]=this.theme.getFormControl(e,this.inputs[d[a]])}this.control=this.theme.getMultiCheckboxHolder(this.controls,this.label,this.description)}else{for(this.input_type="select",this.input=this.theme.getSelectInput(d),this.input.multiple=!0,this.input.size=Math.min(10,d.length),a=0;a<d.length;a++)this.select_options[d[a]]=this.input.children[a];(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.control=this.getTheme().getFormControl(this.label,this.input,this.description)}this.container.appendChild(this.control),this.control.addEventListener("change",function(c){c.preventDefault(),c.stopPropagation();var e=[];for(a=0;a<d.length;a++)(b.select_options[d[a]].selected||b.select_options[d[a]].checked)&&e.push(b.select_values[d[a]]);b.updateValue(e),b.parent?b.parent.onChildEditorChange(b):b.jsoneditor.onChange(),b.jsoneditor.notifyWatchers(b.path)})},setValue:function(a){var b;for(a=a||[],"object"!=typeof a?a=[a]:a instanceof Array||(a=[]),b=0;b<a.length;b++)"string"!=typeof a[b]&&(a[b]+="");for(b in this.select_options)this.select_options.hasOwnProperty(b)&&(this.select_options[b]["select"===this.input_type?"selected":"checked"]=-1!==a.indexOf(b));this.updateValue(a)&&(this.parent?this.onChildEditorChange(this):this.jsoneditor.onChange()),this.jsoneditor.notifyWatchers(this.path)},register:function(){this._super(),this.input&&this.input.setAttribute("name",this.formname)},unregister:function(){this._super(),this.input&&this.input.removeAttribute("name")},getNumColumns:function(){var a=this.getTitle().length;for(var b in this.select_values)this.select_values.hasOwnProperty(b)&&(a=Math.max(a,(this.select_values[b]+"").length+4));return Math.min(12,Math.max(a/7,2))},updateValue:function(a){for(var b=!1,c=[],d=0;d<a.length;d++)if(this.select_options[a[d]+""]){var e=this.sanitize(this.select_values[a[d]]);c.push(e),e!==a[d]&&(b=!0)}else b=!0;return this.value=c,b},sanitize:function(a){return"number"===this.schema.items.type?1*a:"integer"===this.schema.items.type?Math.floor(1*a):""+a},enable:function(){if(!this.always_disabled)if(this.input)this.input.disabled=!1;else if(this.inputs)for(var a in this.inputs)this.inputs.hasOwnProperty(a)&&(this.inputs[a].disabled=!1);this._super()},disable:function(){if(this.input)this.input.disabled=!0;else if(this.inputs)for(var a in this.inputs)this.inputs.hasOwnProperty(a)&&(this.inputs[a].disabled=!0);this._super()}}),f.defaults.editors.base64=f.AbstractEditor.extend({getDefault:function(){return this.schema.default||""},getNumColumns:function(){return 4},build:function(){var a=this;if(this.title=this.header=this.label=this.getTheme().getFormInputLabel(this.getTitle()),this.input=this.theme.getFormInputField("hidden"),this.container.appendChild(this.input),!this.schema.readOnly&&!this.schema.readonly){if(!window.FileReader)throw"FileReader required for base64 editor";this.uploader=this.theme.getFormInputField("file"),this.uploader.addEventListener("change",function(b){if(b.preventDefault(),b.stopPropagation(),this.files&&this.files.length){var c=new FileReader;c.onload=function(b){a.value=b.target.result,a.refreshPreview(),a.watch_listener(),a.jsoneditor.notifyWatchers(a.path),a.parent?a.parent.onChildEditorChange(a):a.jsoneditor.onChange(),c=null},c.readAsDataURL(this.files[0])}})}this.preview=this.theme.getFormInputDescription(this.schema.description),this.container.appendChild(this.preview),this.control=this.getTheme().getFormControl(this.label,this.uploader||this.input,this.preview),this.container.appendChild(this.control),this.register()},refreshPreview:function(){if(this.last_preview!==this.value&&(this.last_preview=this.value,this.preview.innerHTML="",this.value)){var a=this.value.match(/^data:([^;,]+)[;,]/);if(a&&(a=a[1]),a){if(this.preview.innerHTML="<strong>Type:</strong> "+a+", <strong>Size:</strong> "+Math.floor((this.value.length-this.value.split(",")[0].length-1)/1.33333)+" bytes","image"===a.substr(0,5)){this.preview.innerHTML+="<br>";var b=document.createElement("img");b.style.maxWidth="100%",b.style.maxHeight="100px",b.src=this.value,this.preview.appendChild(b)}}else this.preview.innerHTML="<em>Invalid data URI</em>"}},enable:function(){this.uploader&&(this.uploader.disabled=!1),this._super()},disable:function(){this.uploader&&(this.uploader.disabled=!0),this._super()},setValue:function(a){this.value!==a&&(this.value=a,this.input.value=this.value,this.refreshPreview(),this.watch_listener(),this.jsoneditor.notifyWatchers(this.path))},destroy:function(){this.preview.parentNode.removeChild(this.preview),this.title.parentNode.removeChild(this.title),this.input.parentNode.removeChild(this.input),this.uploader&&this.uploader.parentNode.removeChild(this.uploader),this._super()}}),f.AbstractTheme=Class.extend({getContainer:function(){return document.createElement("div")},getFloatRightLinkHolder:function(){var a=document.createElement("div");return a.style=a.style||{},a.style.float="right",a.style["margin-left"]="10px",a},getModal:function(){var a=document.createElement("div");return a.style.backgroundColor="white",a.style.border="1px solid black",a.style.boxShadow="3px 3px black",a.style.position="absolute",a.style.zIndex="10",a.style.display="none",a},getGridContainer:function(){var a=document.createElement("div");return a},getGridRow:function(){var a=document.createElement("div");return a.className="row",a},getGridColumn:function(){var a=document.createElement("div");return a},setGridColumnSize:function(){},getLink:function(a){var b=document.createElement("a");return b.setAttribute("href","#"),b.appendChild(document.createTextNode(a)),b},disableHeader:function(a){a.style.color="#ccc"},disableLabel:function(a){a.style.color="#ccc"},enableHeader:function(a){a.style.color=""},enableLabel:function(a){a.style.color=""},getFormInputLabel:function(a){var b=document.createElement("label");return b.appendChild(document.createTextNode(a)),b},getCheckboxLabel:function(a){var b=this.getFormInputLabel(a);return b.style.fontWeight="normal",b},getHeader:function(a){var b=document.createElement("h3");return"string"==typeof a?b.textContent=a:b.appendChild(a),b},getCheckbox:function(){var a=this.getFormInputField("checkbox");return a.style.display="inline-block",a.style.width="auto",a},getMultiCheckboxHolder:function(a,b,c){var d=document.createElement("div");b&&(b.style.display="block",d.appendChild(b));for(var e in a)a.hasOwnProperty(e)&&(a[e].style.display="inline-block",a[e].style.marginRight="20px",d.appendChild(a[e]));return c&&d.appendChild(c),d},getSelectInput:function(a){var b=document.createElement("select");return a&&this.setSelectOptions(b,a),b},getSwitcher:function(a){var b=this.getSelectInput(a);return b.style.backgroundColor="transparent",b.style.height="auto",b.style.fontStyle="italic",b.style.fontWeight="normal",b.style.padding="0 0 0 3px",b},getSwitcherOptions:function(a){return a.getElementsByTagName("option")},setSwitcherOptions:function(a,b,c){this.setSelectOptions(a,b,c)},setSelectOptions:function(a,b,c){c=c||[],a.innerHTML="";for(var d=0;d<b.length;d++){var e=document.createElement("option");e.setAttribute("value",b[d]),e.textContent=c[d]||b[d],a.appendChild(e)}},getTextareaInput:function(){var a=document.createElement("textarea");return a.style=a.style||{},a.style.width="100%",a.style.height="300px",a.style.boxSizing="border-box",a},getRangeInput:function(a,b,c){var d=this.getFormInputField("range");return d.setAttribute("min",a),d.setAttribute("max",b),d.setAttribute("step",c),d},getFormInputField:function(a){var b=document.createElement("input");return b.setAttribute("type",a),b},afterInputReady:function(){},getFormControl:function(a,b,c){var d=document.createElement("div");return d.className="form-control",a&&d.appendChild(a),"checkbox"===b.type?a.insertBefore(b,a.firstChild):d.appendChild(b),c&&d.appendChild(c),d},getIndentedPanel:function(){var a=document.createElement("div");return a.style=a.style||{},a.style.paddingLeft="10px",a.style.marginLeft="10px",a.style.borderLeft="1px solid #ccc",a},getChildEditorHolder:function(){return document.createElement("div")},getDescription:function(a){var b=document.createElement("p");return b.appendChild(document.createTextNode(a)),b},getCheckboxDescription:function(a){return this.getDescription(a)},getFormInputDescription:function(a){return this.getDescription(a)},getHeaderButtonHolder:function(){return this.getButtonHolder()},getButtonHolder:function(){return document.createElement("div")},getButton:function(a,b,c){var d=document.createElement("button");return this.setButtonText(d,a,b,c),d},setButtonText:function(a,b,c,d){a.innerHTML="",c&&(a.appendChild(c),a.innerHTML+=" "),a.appendChild(document.createTextNode(b)),d&&a.setAttribute("title",d)},getTable:function(){return document.createElement("table")},getTableRow:function(){return document.createElement("tr")},getTableHead:function(){return document.createElement("thead")},getTableBody:function(){return document.createElement("tbody")},getTableHeaderCell:function(a){var b=document.createElement("th");return b.textContent=a,b},getTableCell:function(){var a=document.createElement("td");return a},getErrorMessage:function(a){var b=document.createElement("p");return b.style=b.style||{},b.style.color="red",b.appendChild(document.createTextNode(a)),b},addInputError:function(){},removeInputError:function(){},addTableRowError:function(){},removeTableRowError:function(){},getTabHolder:function(){var a=document.createElement("div");return a.innerHTML="<div style='float: left; width: 130px;' class='tabs'></div><div class='content' style='margin-left: 130px;'></div><div style='clear:both;'></div>",a},applyStyles:function(a,b){a.style=a.style||{};for(var c in b)b.hasOwnProperty(c)&&(a.style[c]=b[c])},closest:function(a,b){for(var c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector;a&&a!==document;)try{var d=c.bind(a);if(d(b))return a;a=a.parentNode}catch(e){return!1}return!1},getTab:function(a){var b=document.createElement("div");return b.appendChild(a),b.style=b.style||{},this.applyStyles(b,{border:"1px solid #ccc",borderWidth:"1px 0 1px 1px",textAlign:"center",lineHeight:"30px",borderRadius:"5px",borderBottomRightRadius:0,borderTopRightRadius:0,fontWeight:"bold",cursor:"pointer"}),b},getTabContentHolder:function(a){return a.children[1]},getTabContent:function(){return this.getIndentedPanel()},markTabActive:function(a){this.applyStyles(a,{opacity:1,background:"white"})},markTabInactive:function(a){this.applyStyles(a,{opacity:.5,background:""})},addTab:function(a,b){a.children[0].appendChild(b)},getBlockLink:function(){var a=document.createElement("a");return a.style.display="block",a},getBlockLinkHolder:function(){var a=document.createElement("div");return a},getLinksHolder:function(){var a=document.createElement("div");return a},createMediaLink:function(a,b,c){a.appendChild(b),c.style.width="100%",a.appendChild(c)},createImageLink:function(a,b,c){a.appendChild(b),b.appendChild(c)}}),f.defaults.themes.bootstrap2=f.AbstractTheme.extend({getRangeInput:function(a,b,c){return this._super(a,b,c)},getGridContainer:function(){var a=document.createElement("div");return a.className="container-fluid",a},getGridRow:function(){var a=document.createElement("div");return a.className="row-fluid",a},getFormInputLabel:function(a){var b=this._super(a);return b.style.display="inline-block",b.style.fontWeight="bold",b},setGridColumnSize:function(a,b){a.className="span"+b},getSelectInput:function(a){var b=this._super(a);return b.style.width="auto",b.style.maxWidth="98%",b},getFormInputField:function(a){var b=this._super(a);return b.style.width="98%",b},afterInputReady:function(a){a.controlgroup||(a.controlgroup=this.closest(a,".control-group"),a.controls=this.closest(a,".controls"),this.closest(a,".compact")&&(a.controlgroup.className=a.controlgroup.className.replace(/control-group/g,"").replace(/[ ]{2,}/g," "),a.controls.className=a.controlgroup.className.replace(/controls/g,"").replace(/[ ]{2,}/g," "),a.style.marginBottom=0))},getIndentedPanel:function(){var a=document.createElement("div");return a.className="well well-small",a},getFormInputDescription:function(a){var b=document.createElement("p");return b.className="help-inline",b.textContent=a,b},getFormControl:function(a,b,c){var d=document.createElement("div");d.className="control-group";var e=document.createElement("div");return e.className="controls",a&&"checkbox"===b.getAttribute("type")?(d.appendChild(e),a.className+=" checkbox",a.appendChild(b),e.appendChild(a),e.style.height="30px"):(a&&(a.className+=" control-label",d.appendChild(a)),e.appendChild(b),d.appendChild(e)),c&&e.appendChild(c),d},getHeaderButtonHolder:function(){var a=this.getButtonHolder();return a.style.marginLeft="10px",a},getButtonHolder:function(){var a=document.createElement("div");return a.className="btn-group",a},getButton:function(a,b,c){var d=this._super(a,b,c);return d.className+=" btn btn-default",d},getTable:function(){var a=document.createElement("table");return a.className="table table-bordered",a.style.width="auto",a.style.maxWidth="none",a},addInputError:function(a,b){a.controlgroup&&a.controls&&(a.controlgroup.className+=" error",a.errmsg?a.errmsg.style.display="":(a.errmsg=document.createElement("p"),a.errmsg.className="help-block errormsg",a.controls.appendChild(a.errmsg)),a.errmsg.textContent=b)},removeInputError:function(a){a.errmsg&&(a.errmsg.style.display="none",a.controlgroup.className=a.controlgroup.className.replace(/\s?error/g,""))},getTabHolder:function(){var a=document.createElement("div");return a.className="tabbable tabs-left",a.innerHTML="<ul class='nav nav-tabs span2' style='margin-right: 0;'></ul><div class='tab-content span10' style='overflow:visible;'></div>",a},getTab:function(a){var b=document.createElement("li"),c=document.createElement("a");return c.setAttribute("href","#"),c.appendChild(a),b.appendChild(c),b},getTabContentHolder:function(a){return a.children[1]},getTabContent:function(){var a=document.createElement("div");return a.className="tab-pane active",a},markTabActive:function(a){a.className+=" active"},markTabInactive:function(a){a.className=a.className.replace(/\s?active/g,"")},addTab:function(a,b){a.children[0].appendChild(b)}}),f.defaults.themes.bootstrap3=f.AbstractTheme.extend({getSelectInput:function(a){var b=this._super(a);return b.className+="form-control",b},setGridColumnSize:function(a,b){a.className="col-md-"+b},afterInputReady:function(a){a.controlgroup||(a.controlgroup=this.closest(a,".form-group"),this.closest(a,".compact")&&(a.controlgroup.style.marginBottom=0))},getTextareaInput:function(){var a=document.createElement("textarea");return a.className="form-control",a},getRangeInput:function(a,b,c){return this._super(a,b,c)},getFormInputField:function(a){var b=this._super(a);return"checkbox"!==a&&(b.className+="form-control"),b},getFormControl:function(a,b,c){var d=document.createElement("div");return a&&"checkbox"===b.type?(d.className+=" checkbox",a.appendChild(b),a.style.fontSize="14px",d.style.marginTop="0",d.appendChild(a)):(d.className+=" form-group",a&&(a.className+=" control-label",d.appendChild(a)),d.appendChild(b)),c&&d.appendChild(c),d},getIndentedPanel:function(){var a=document.createElement("div");return a.className="well well-sm",a},getFormInputDescription:function(a){var b=document.createElement("p");return b.className="help-block",b.textContent=a,b},getHeaderButtonHolder:function(){var a=this.getButtonHolder();return a.style.marginLeft="10px",a},getButtonHolder:function(){var a=document.createElement("div");return a.className="btn-group",a},getButton:function(a,b,c){var d=this._super(a,b,c);return d.className+="btn btn-default",d},getTable:function(){var a=document.createElement("table");return a.className="table table-bordered",a.style.width="auto",a.style.maxWidth="none",a},addInputError:function(a,b){a.controlgroup&&(a.controlgroup.className+=" has-error",a.errmsg?a.errmsg.style.display="":(a.errmsg=document.createElement("p"),a.errmsg.className="help-block errormsg",a.controlgroup.appendChild(a.errmsg)),a.errmsg.textContent=b)},removeInputError:function(a){a.errmsg&&(a.errmsg.style.display="none",a.controlgroup.className=a.controlgroup.className.replace(/\s?has-error/g,""))},getTabHolder:function(){var a=document.createElement("div");return a.innerHTML="<div class='tabs list-group col-md-2'></div><div class='col-md-10'></div>",a.className="rows",a},getTab:function(a){var b=document.createElement("a");return b.className="list-group-item",b.setAttribute("href","#"),b.appendChild(a),b},markTabActive:function(a){a.className+=" active"},markTabInactive:function(a){a.className=a.className.replace(/\s?active/g,"")}}),f.defaults.themes.foundation=f.AbstractTheme.extend({getChildEditorHolder:function(){var a=document.createElement("div");return a.style.marginBottom="15px",a},getSelectInput:function(a){var b=this._super(a);return b.style.minWidth="none",b.style.padding="5px",b.style.marginTop="3px",b},getSwitcher:function(a){var b=this._super(a);return b.style.paddingRight="8px",b},afterInputReady:function(a){this.closest(a,".compact")&&(a.style.marginBottom=0),a.group=this.closest(a,".form-control")},getFormInputLabel:function(a){var b=this._super(a);return b.style.display="inline-block",b},getFormInputField:function(a){var b=this._super(a);return b.style.width="100%",b.style.marginBottom="checkbox"===a?"0":"12px",b},getFormInputDescription:function(a){var b=document.createElement("p");return b.textContent=a,b.style.marginTop="-10px",b.style.fontStyle="italic",b},getIndentedPanel:function(){var a=document.createElement("div");return a.className="panel",a},getHeaderButtonHolder:function(){var a=this.getButtonHolder();return a.style.display="inline-block",a.style.marginLeft="10px",a.style.verticalAlign="middle",a},getButtonHolder:function(){var a=document.createElement("div");return a.className="button-group",a},getButton:function(a,b,c){var d=this._super(a,b,c);return d.className+=" small button",d},addInputError:function(a,b){a.group&&(a.group.className+=" error",a.errmsg?a.errmsg.style.display="":(a.insertAdjacentHTML("afterend",'<small class="errormsg"></small>'),a.errmsg=a.parentNode.getElementsByClassName("errormsg")[0]),a.errmsg.textContent=b)},removeInputError:function(a){a.errmsg&&(a.group.className=a.group.className.replace(/ error/g,""),a.errmsg.style.display="none")}}),f.defaults.themes.foundation3=f.defaults.themes.foundation.extend({getHeaderButtonHolder:function(){var a=this._super();return a.style.fontSize=".6em",a},getFormInputLabel:function(a){var b=this._super(a);return b.style.fontWeight="bold",b},getTabHolder:function(){var a=document.createElement("div");return a.className="row",a.innerHTML="<dl class='tabs vertical two columns'></dl><div class='tabs-content ten columns'></div>",a},setGridColumnSize:function(a,b){var c=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve"];a.className="columns "+c[b]},getTab:function(a){var b=document.createElement("dd"),c=document.createElement("a");return c.setAttribute("href","#"),c.appendChild(a),b.appendChild(c),b},getTabContentHolder:function(a){return a.children[1]},getTabContent:function(){var a=document.createElement("div");return a.className="content active",a.style.paddingLeft="5px",a},markTabActive:function(a){a.className+=" active"},markTabInactive:function(a){a.className=a.className.replace(/\s*active/g,"")},addTab:function(a,b){a.children[0].appendChild(b)}}),f.defaults.themes.foundation4=f.defaults.themes.foundation.extend({getHeaderButtonHolder:function(){var a=this._super();return a.style.fontSize=".6em",a},setGridColumnSize:function(a,b){a.className="columns large-"+b},getFormInputDescription:function(a){var b=this._super(a);return b.style.fontSize=".8rem",b},getFormInputLabel:function(a){var b=this._super(a);return b.style.fontWeight="bold",b}}),f.defaults.themes.foundation5=f.defaults.themes.foundation.extend({getFormInputDescription:function(a){var b=this._super(a);return b.style.fontSize=".8rem",b},setGridColumnSize:function(a,b){a.className="columns medium-"+b},getButton:function(a,b,c){var d=this._super(a,b,c);return d.className=d.className.replace(/\s*small/g,"")+" tiny",d},getTabHolder:function(){var a=document.createElement("div");return a.innerHTML="<dl class='tabs vertical'></dl><div class='tabs-content'></div>",a},getTab:function(a){var b=document.createElement("dd"),c=document.createElement("a");return c.setAttribute("href","#"),c.appendChild(a),b.appendChild(c),b},getTabContentHolder:function(a){return a.children[1]},getTabContent:function(){var a=document.createElement("div");return a.className="content active",a.style.paddingLeft="5px",a},markTabActive:function(a){a.className+=" active"},markTabInactive:function(a){a.className=a.className.replace(/\s*active/g,"")},addTab:function(a,b){a.children[0].appendChild(b)}}),f.defaults.themes.html=f.AbstractTheme.extend({getFormInputLabel:function(a){var b=this._super(a);return b.style.display="block",b.style.marginBottom="3px",b.style.fontWeight="bold",b},getFormInputDescription:function(a){var b=this._super(a);return b.style.fontSize=".8em",b.style.margin=0,b.style.display="inline-block",b.style.fontStyle="italic",b},getIndentedPanel:function(){var a=this._super();return a.style.border="1px solid #ddd",a.style.padding="5px",a.style.margin="5px",a.style.borderRadius="3px",a},getChildEditorHolder:function(){var a=this._super();return a.style.marginBottom="8px",a},getHeaderButtonHolder:function(){var a=this.getButtonHolder();return a.style.display="inline-block",a.style.marginLeft="10px",a.style.fontSize=".8em",a.style.verticalAlign="middle",a},getTable:function(){var a=this._super();return a.style.borderBottom="1px solid #ccc",a.style.marginBottom="5px",a},addInputError:function(a,b){if(a.style.borderColor="red",a.errmsg)a.errmsg.style.display="block";else{var c=this.closest(a,".form-control");a.errmsg=document.createElement("div"),a.errmsg.setAttribute("class","errmsg"),a.errmsg.style=a.errmsg.style||{},a.errmsg.style.color="red",c.appendChild(a.errmsg)}a.errmsg.innerHTML="",a.errmsg.appendChild(document.createTextNode(b))},removeInputError:function(a){a.style.borderColor="",a.errmsg&&(a.errmsg.style.display="none")}}),f.defaults.themes.jqueryui=f.AbstractTheme.extend({getTable:function(){var a=this._super();return a.setAttribute("cellpadding",5),a.setAttribute("cellspacing",0),a},getTableHeaderCell:function(a){var b=this._super(a);return b.className="ui-state-active",b.style.fontWeight="bold",b},getTableCell:function(){var a=this._super();return a.className="ui-widget-content",a},getHeaderButtonHolder:function(){var a=this.getButtonHolder();return a.style.marginLeft="10px",a.style.fontSize=".6em",a.style.display="inline-block",a},getFormInputDescription:function(a){var b=this.getDescription(a);return b.style.marginLeft="10px",b.style.display="inline-block",b},getFormControl:function(a,b,c){var d=this._super(a,b,c);return"checkbox"===b.type?(d.style.lineHeight="25px",d.style.padding="3px 0"):d.style.padding="4px 0 8px 0",d},getDescription:function(a){var b=document.createElement("span");return b.style.fontSize=".8em",b.style.fontStyle="italic",b.textContent=a,b},getButtonHolder:function(){var a=document.createElement("div");return a.className="ui-buttonset",a.style.fontSize=".7em",a},getFormInputLabel:function(a){var b=document.createElement("label");return b.style.fontWeight="bold",b.style.display="block",b.textContent=a,b},getButton:function(a,b,c){var d=document.createElement("button");d.className="ui-button ui-widget ui-state-default ui-corner-all",b&&!a?(d.className+=" ui-button-icon-only",b.className+=" ui-button-icon-primary ui-icon-primary",d.appendChild(b)):b?(d.className+=" ui-button-text-icon-primary",b.className+=" ui-button-icon-primary ui-icon-primary",d.appendChild(b)):d.className+=" ui-button-text-only";var e=document.createElement("span");return e.className="ui-button-text",e.textContent=a||c||".",d.appendChild(e),d.setAttribute("title",c),d},setButtonText:function(a,b,c,d){a.innerHTML="",a.className="ui-button ui-widget ui-state-default ui-corner-all",c&&!b?(a.className+=" ui-button-icon-only",c.className+=" ui-button-icon-primary ui-icon-primary",a.appendChild(c)):c?(a.className+=" ui-button-text-icon-primary",c.className+=" ui-button-icon-primary ui-icon-primary",a.appendChild(c)):a.className+=" ui-button-text-only";var e=document.createElement("span");e.className="ui-button-text",e.textContent=b||d||".",a.appendChild(e),a.setAttribute("title",d)},getIndentedPanel:function(){var a=document.createElement("div");return a.className="ui-widget-content ui-corner-all",a.style.padding="1em 1.4em",a.style.marginBottom="20px",a},afterInputReady:function(a){a.controls||(a.controls=this.closest(a,".form-control"))},addInputError:function(a,b){a.controls&&(a.errmsg?a.errmsg.style.display="":(a.errmsg=document.createElement("div"),a.errmsg.className="ui-state-error",a.controls.appendChild(a.errmsg)),a.errmsg.textContent=b)},removeInputError:function(a){a.errmsg&&(a.errmsg.style.display="none")},markTabActive:function(a){a.className=a.className.replace(/\s*ui-widget-header/g,"")+" ui-state-active"},markTabInactive:function(a){a.className=a.className.replace(/\s*ui-state-active/g,"")+" ui-widget-header"}}),f.AbstractIconLib=Class.extend({mapping:{collapse:"",expand:"","delete":"",edit:"",add:"",cancel:"",save:"",moveup:"",movedown:""},icon_prefix:"",getIconClass:function(a){return this.mapping[a]?this.icon_prefix+this.mapping[a]:null},getIcon:function(a){var b=this.getIconClass(a);if(!b)return null;var c=document.createElement("i");return c.className=b,c}}),f.defaults.iconlibs.bootstrap2=f.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-up","delete":"trash",edit:"pencil",add:"plus",cancel:"ban-circle",save:"ok",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"icon-"}),f.defaults.iconlibs.bootstrap3=f.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-right","delete":"remove",edit:"pencil",add:"plus",cancel:"floppy-remove",save:"floppy-saved",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"glyphicon glyphicon-"}),f.defaults.iconlibs.fontawesome3=f.AbstractIconLib.extend({mapping:{collapse:"chevron-down",expand:"chevron-right","delete":"remove",edit:"pencil",add:"plus",cancel:"ban-circle",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"icon-"}),f.defaults.iconlibs.fontawesome4=f.AbstractIconLib.extend({mapping:{collapse:"caret-square-o-down",expand:"caret-square-o-right","delete":"times",edit:"pencil",add:"plus",cancel:"ban",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"fa fa-"}),f.defaults.iconlibs.foundation2=f.AbstractIconLib.extend({mapping:{collapse:"minus",expand:"plus","delete":"remove",edit:"edit",add:"add-doc",cancel:"error",save:"checkmark",moveup:"up-arrow",movedown:"down-arrow"},icon_prefix:"foundicon-"}),f.defaults.iconlibs.foundation3=f.AbstractIconLib.extend({mapping:{collapse:"minus",expand:"plus","delete":"x",edit:"pencil",add:"page-add",cancel:"x-circle",save:"save",moveup:"arrow-up",movedown:"arrow-down"},icon_prefix:"fi-"}),f.defaults.iconlibs.jqueryui=f.AbstractIconLib.extend({mapping:{collapse:"triangle-1-s",expand:"triangle-1-e","delete":"trash",edit:"pencil",add:"plusthick",cancel:"closethick",save:"disk",moveup:"arrowthick-1-n",movedown:"arrowthick-1-s"},icon_prefix:"ui-icon ui-icon-"}),f.defaults.templates.default=function(){var a=function(d){var e={};
return c(d,function(d,f){if("object"==typeof f&&null!==f){var g={};c(f,function(a,b){g[d+"."+a]=b}),b(e,a(g))}else e[d]=f}),e};return{compile:function(b){return function(d){var e=a(d),f=b+"";return c(e,function(a,b){f=f.replace(new RegExp("{{\\s*"+a+"\\s*}}","g"),b)}),f}}}},f.defaults.templates.ejs=function(){return window.EJS?{compile:function(a){var b=new EJS({text:a});return function(a){return b.render(a)}}}:!1},f.defaults.templates.handlebars=function(){return window.Handlebars},f.defaults.templates.hogan=function(){return window.Hogan?{compile:function(a){var b=Hogan.compile(a);return function(a){return b.render(a)}}}:!1},f.defaults.templates.markup=function(){return window.Mark&&window.Mark.up?{compile:function(a){return function(b){return Mark.up(a,b)}}}:!1},f.defaults.templates.mustache=function(){return window.Mustache?{compile:function(a){return function(b){return Mustache.render(a,b)}}}:!1},f.defaults.templates.swig=function(){return window.swig},f.defaults.templates.underscore=function(){return window._?{compile:function(a){return function(b){return _.template(a,b)}}}:!1},f.defaults.theme="html",f.defaults.template="default",f.defaults.options={},f.plugins={ace:{theme:""},epiceditor:{},sceditor:{}};for(var g in f.defaults.editors)f.defaults.editors.hasOwnProperty(g)&&(f.defaults.editors[g].options=f.defaults.editors.options||{});f.defaults.resolvers.unshift(function(a){return"string"!=typeof a.type?"multiple":void 0}),f.defaults.resolvers.unshift(function(a){return"string"==typeof a.type?a.type:void 0}),f.defaults.resolvers.unshift(function(a){return"boolean"===a.type?"select":void 0}),f.defaults.resolvers.unshift(function(a){return"any"===a.type?"multiple":void 0}),f.defaults.resolvers.unshift(function(a){return"string"===a.type&&a.media&&"base64"===a.media.binaryEncoding?"base64":void 0}),f.defaults.resolvers.unshift(function(a){return"array"==a.type&&"table"==a.format?"table":void 0}),f.defaults.resolvers.unshift(function(a){if(a.enum){if("array"===a.type||"object"===a.type)return"enum";if("number"===a.type||"integer"===a.type||"string"===a.type)return"select"}}),f.defaults.resolvers.unshift(function(a){return"array"===a.type&&a.items&&!(a.items instanceof Array)&&a.uniqueItems&&a.items.enum&&["string","number","integer"].indexOf(a.items.type)>=0?"multiselect":void 0}),f.defaults.resolvers.unshift(function(a){return a.oneOf?"multiple":void 0}),(window.jQuery||window.Zepto)&&(window.$=window.$||{},$.jsoneditor=f.defaults,(window.jQuery||window.Zepto).fn.jsoneditor=function(a){var b=this,c=this.data("jsoneditor");if("value"===a){if(!c)throw"Must initialize jsoneditor before getting/setting the value";if(!(arguments.length>1))return c.getValue();c.setValue(arguments[1])}else{if("validate"===a){if(!c)throw"Must initialize jsoneditor before validating";return arguments.length>1?c.validate(arguments[1]):c.validate()}"destroy"===a?c&&(c.destroy(),this.data("jsoneditor",null)):(c&&c.destroy(),c=new f(this.get(0),a),this.data("jsoneditor",c),c.on("change",function(){b.trigger("change")}),c.on("ready",function(){b.trigger("ready")}))}return this}),window.JSONEditor=f}(),!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.11",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b)["offsetParent"in a.fn?"offsetParent":"parent"]();return c.length||(c=a("body")),parseInt(c.css("fontSize"),10)},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),function(a,b){"function"==typeof define&&define.amd?define(b):a.Dragdealer=b()}(this,function(){var a=function(a,b){this.bindMethods(),this.options=this.applyDefaults(b||{}),this.wrapper=this.getWrapperElement(a),this.wrapper&&(this.handle=this.getHandleElement(this.wrapper,this.options.handleClass),this.handle&&(this.init(),this.bindEventListeners()))};a.prototype={defaults:{disabled:!1,horizontal:!0,vertical:!1,slide:!0,steps:0,snap:!1,loose:!1,speed:.1,xPrecision:0,yPrecision:0,handleClass:"handle"},init:function(){this.value={prev:[-1,-1],current:[this.options.x||0,this.options.y||0],target:[this.options.x||0,this.options.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.change=[0,0],this.stepRatios=this.calculateStepRatios(),this.activity=!1,this.dragging=!1,this.tapping=!1,this.reflow(),this.options.disabled&&this.disable()},applyDefaults:function(a){for(var b in this.defaults)a.hasOwnProperty(b)||(a[b]=this.defaults[b]);return a},getWrapperElement:function(a){return"string"==typeof a?document.getElementById(a):a},getHandleElement:function(a,b){var c,d=a.getElementsByTagName("div"),e=new RegExp("(^|\\s)"+b+"(\\s|$)");for(c=0;c<d.length;c++)if(e.test(d[c].className))return d[c]},calculateStepRatios:function(){var a=[];if(this.options.steps>1)for(var b=0;b<=this.options.steps-1;b++)a[b]=b/(this.options.steps-1);return a},setWrapperOffset:function(){this.offset.wrapper=h.get(this.wrapper)},calculateBounds:function(){var a={top:this.options.top||0,bottom:-(this.options.bottom||0)+this.wrapper.offsetHeight,left:this.options.left||0,right:-(this.options.right||0)+this.wrapper.offsetWidth};return a.availWidth=a.right-a.left-this.handle.offsetWidth,a.availHeight=a.bottom-a.top-this.handle.offsetHeight,a},calculateValuePrecision:function(){var a=this.options.xPrecision||Math.abs(this.bounds.availWidth),b=this.options.yPrecision||Math.abs(this.bounds.availHeight);return[a?1/a:0,b?1/b:0]},bindMethods:function(){this.onHandleMouseDown=b(this.onHandleMouseDown,this),this.onHandleTouchStart=b(this.onHandleTouchStart,this),this.onDocumentMouseMove=b(this.onDocumentMouseMove,this),this.onWrapperTouchMove=b(this.onWrapperTouchMove,this),this.onWrapperMouseDown=b(this.onWrapperMouseDown,this),this.onWrapperTouchStart=b(this.onWrapperTouchStart,this),this.onDocumentMouseUp=b(this.onDocumentMouseUp,this),this.onDocumentTouchEnd=b(this.onDocumentTouchEnd,this),this.onHandleClick=b(this.onHandleClick,this),this.onWindowResize=b(this.onWindowResize,this)},bindEventListeners:function(){c(this.handle,"mousedown",this.onHandleMouseDown),c(this.handle,"touchstart",this.onHandleTouchStart),c(document,"mousemove",this.onDocumentMouseMove),c(this.wrapper,"touchmove",this.onWrapperTouchMove),c(this.wrapper,"mousedown",this.onWrapperMouseDown),c(this.wrapper,"touchstart",this.onWrapperTouchStart),c(document,"mouseup",this.onDocumentMouseUp),c(document,"touchend",this.onDocumentTouchEnd),c(this.handle,"click",this.onHandleClick),c(window,"resize",this.onWindowResize);var a=this;this.interval=setInterval(function(){a.animate()},25),this.animate(!1,!0)},unbindEventListeners:function(){d(this.handle,"mousedown",this.onHandleMouseDown),d(this.handle,"touchstart",this.onHandleTouchStart),d(document,"mousemove",this.onDocumentMouseMove),d(this.wrapper,"touchmove",this.onWrapperTouchMove),d(this.wrapper,"mousedown",this.onWrapperMouseDown),d(this.wrapper,"touchstart",this.onWrapperTouchStart),d(document,"mouseup",this.onDocumentMouseUp),d(document,"touchend",this.onDocumentTouchEnd),d(this.handle,"click",this.onHandleClick),d(window,"resize",this.onWindowResize),clearInterval(this.interval)},onHandleMouseDown:function(a){g.refresh(a),e(a),f(a),this.activity=!1,this.startDrag()},onHandleTouchStart:function(a){g.refresh(a),f(a),this.activity=!1,this.startDrag()},onDocumentMouseMove:function(a){g.refresh(a),this.dragging&&(this.activity=!0)},onWrapperTouchMove:function(a){return g.refresh(a),!this.activity&&this.draggingOnDisabledAxis()?void(this.dragging&&this.stopDrag()):(e(a),void(this.activity=!0))},onWrapperMouseDown:function(a){g.refresh(a),e(a),this.startTap()},onWrapperTouchStart:function(a){g.refresh(a),e(a),this.startTap()},onDocumentMouseUp:function(){this.stopDrag(),this.stopTap()},onDocumentTouchEnd:function(){this.stopDrag(),this.stopTap()},onHandleClick:function(a){this.activity&&(e(a),f(a))},onWindowResize:function(){this.reflow()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,this.handle.className+=" disabled"},reflow:function(){this.setWrapperOffset(),this.bounds=this.calculateBounds(),this.valuePrecision=this.calculateValuePrecision(),this.updateOffsetFromValue()},getStep:function(){return[this.getStepNumber(this.value.target[0]),this.getStepNumber(this.value.target[1])]},getValue:function(){return this.value.target},setStep:function(a,b,c){this.setValue(this.options.steps&&a>1?(a-1)/(this.options.steps-1):0,this.options.steps&&b>1?(b-1)/(this.options.steps-1):0,c)},setValue:function(a,b,c){this.setTargetValue([a,b||0]),c&&(this.groupCopy(this.value.current,this.value.target),this.updateOffsetFromValue(),this.callAnimationCallback())},startTap:function(){this.disabled||(this.tapping=!0,this.setWrapperOffset(),this.setTargetValueByOffset([g.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,g.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current))},startDrag:function(){this.disabled||(this.dragging=!0,this.setWrapperOffset(),this.offset.mouse=[g.x-h.get(this.handle)[0],g.y-h.get(this.handle)[1]])},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var a=this.groupClone(this.value.current);if(this.options.slide){var b=this.change;a[0]+=4*b[0],a[1]+=4*b[1]}this.setTargetValue(a)}},callAnimationCallback:function(){var a=this.value.current;this.options.snap&&this.options.steps>1&&(a=this.getClosestSteps(a)),this.groupCompare(a,this.value.prev)||("function"==typeof this.options.animationCallback&&this.options.animationCallback.call(this,a[0],a[1]),this.groupCopy(this.value.prev,a))},callTargetCallback:function(){"function"==typeof this.options.callback&&this.options.callback.call(this,this.value.target[0],this.value.target[1])},animate:function(a,b){if(!a||this.dragging){if(this.dragging){var c=this.groupClone(this.value.target),d=[g.x-this.offset.wrapper[0]-this.offset.mouse[0],g.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetValueByOffset(d,this.options.loose),this.change=[this.value.target[0]-c[0],this.value.target[1]-c[1]]}(this.dragging||b)&&this.groupCopy(this.value.current,this.value.target),(this.dragging||this.glide()||b)&&(this.updateOffsetFromValue(),this.callAnimationCallback())}},glide:function(){var a=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return a[0]||a[1]?(Math.abs(a[0])>this.valuePrecision[0]||Math.abs(a[1])>this.valuePrecision[1]?(this.value.current[0]+=a[0]*this.options.speed,this.value.current[1]+=a[1]*this.options.speed):this.groupCopy(this.value.current,this.value.target),!0):!1},updateOffsetFromValue:function(){this.offset.current=this.getOffsetsByRatios(this.options.snap?this.getClosestSteps(this.value.current):this.value.current),this.groupCompare(this.offset.current,this.offset.prev)||(this.renderHandlePosition(),this.groupCopy(this.offset.prev,this.offset.current))},renderHandlePosition:function(){this.options.horizontal&&(this.handle.style.left=String(this.offset.current[0])+"px"),this.options.vertical&&(this.handle.style.top=String(this.offset.current[1])+"px")},setTargetValue:function(a,b){var c=b?this.getLooseValue(a):this.getProperValue(a);this.groupCopy(this.value.target,c),this.offset.target=this.getOffsetsByRatios(c),this.callTargetCallback()},setTargetValueByOffset:function(a,b){var c=this.getRatiosByOffsets(a),d=b?this.getLooseValue(c):this.getProperValue(c);this.groupCopy(this.value.target,d),this.offset.target=this.getOffsetsByRatios(d)},getLooseValue:function(a){var b=this.getProperValue(a);return[b[0]+(a[0]-b[0])/4,b[1]+(a[1]-b[1])/4]},getProperValue:function(a){var b=this.groupClone(a);return b[0]=Math.max(b[0],0),b[1]=Math.max(b[1],0),b[0]=Math.min(b[0],1),b[1]=Math.min(b[1],1),(!this.dragging&&!this.tapping||this.options.snap)&&this.options.steps>1&&(b=this.getClosestSteps(b)),b},getRatiosByOffsets:function(a){return[this.getRatioByOffset(a[0],this.bounds.availWidth,this.bounds.left),this.getRatioByOffset(a[1],this.bounds.availHeight,this.bounds.top)]},getRatioByOffset:function(a,b,c){return b?(a-c)/b:0},getOffsetsByRatios:function(a){return[this.getOffsetByRatio(a[0],this.bounds.availWidth,this.bounds.left),this.getOffsetByRatio(a[1],this.bounds.availHeight,this.bounds.top)]},getOffsetByRatio:function(a,b,c){return Math.round(a*b)+c},getStepNumber:function(a){return this.getClosestStep(a)*(this.options.steps-1)+1},getClosestSteps:function(a){return[this.getClosestStep(a[0]),this.getClosestStep(a[1])]},getClosestStep:function(a){for(var b=0,c=1,d=0;d<=this.options.steps-1;d++)Math.abs(this.stepRatios[d]-a)<c&&(c=Math.abs(this.stepRatios[d]-a),b=d);return this.stepRatios[b]},groupCompare:function(a,b){return a[0]==b[0]&&a[1]==b[1]},groupCopy:function(a,b){a[0]=b[0],a[1]=b[1]},groupClone:function(a){return[a[0],a[1]]},draggingOnDisabledAxis:function(){return!this.options.horizontal&&g.xDiff>g.yDiff||!this.options.vertical&&g.yDiff>g.xDiff}};var b=function(a,b){return function(){return a.apply(b,arguments)}},c=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},d=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)},e=function(a){a||(a=window.event),a.preventDefault&&a.preventDefault(),a.returnValue=!1},f=function(a){a||(a=window.event),a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},g={x:0,y:0,xDiff:0,yDiff:0,refresh:function(a){a||(a=window.event),"mousemove"==a.type?this.set(a):a.touches&&this.set(a.touches[0])},set:function(a){var b=this.x,c=this.y;a.pageX||a.pageY?(this.x=a.pageX,this.y=a.pageY):(a.clientX||a.clientY)&&(this.x=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop),this.xDiff=Math.abs(this.x-b),this.yDiff=Math.abs(this.y-c)}},h={get:function(a){var b=0,c=0;if(a.offsetParent)do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return[b,c]}};return a});var UndoManager=function(){"use strict";function a(a,b){return a&&"function"==typeof a[b]?(e=!0,a[b](),e=!1,this):this}var b,c=[],d=-1,e=!1;return{register:function(a,b,c,d,e,f,g){this.add({undo:function(){b.apply(a,c)},redo:function(){f.apply(e,g)}})},add:function(a){return e?this:(c.splice(d+1,c.length-d),c.push(a),d=c.length-1,b&&b(),this)},setCallback:function(a){b=a},undo:function(){var e=c[d];return e?(a(e,"undo"),d-=1,b&&b(),this):this},redo:function(){var e=c[d+1];return e?(a(e,"redo"),d+=1,b&&b(),this):this},clear:function(){var a=c.length;c=[],d=-1,b&&a>0&&b()},hasUndo:function(){return-1!==d},hasRedo:function(){return d<c.length-1},getCommands:function(){return c}}};!function(a,b){function c(a,b){return(p?b.originalEvent.touches[0]:b)["page"+a.toUpperCase()]}function d(b,c,d){var e=a.Event(c,w);a.event.trigger(e,{originalEvent:b},b.target),e.isDefaultPrevented()&&b.preventDefault(),d&&(a.event.remove(u,s+"."+t,f),a.event.remove(u,r+"."+t,g))}function e(b){var e=b.timeStamp||+new Date;j!=e&&(j=e,v.x=w.x=c("x",b),v.y=w.y=c("y",b),v.time=e,v.target=b.target,w.orientation=null,w.end=!1,h=!1,i=!1,k=setTimeout(function(){i=!0,d(b,"press")},a.Finger.pressDuration),a.event.add(u,s+"."+t,f),a.event.add(u,r+"."+t,g),x.preventDefault&&b.preventDefault())}function f(b){return w.x=c("x",b),w.y=c("y",b),w.dx=w.x-v.x,w.dy=w.y-v.y,w.adx=Math.abs(w.dx),w.ady=Math.abs(w.dy),(h=w.adx>x.motionThreshold||w.ady>x.motionThreshold)?(clearTimeout(k),w.orientation||(w.adx>w.ady?(w.orientation="horizontal",w.direction=w.dx>0?1:-1):(w.orientation="vertical",w.direction=w.dy>0?1:-1)),b.target!==v.target?(b.target=v.target,void g.call(this,a.Event(r+"."+t,b))):void d(b,"drag")):void 0}function g(a){var b,c=a.timeStamp||+new Date,e=c-v.time;if(clearTimeout(k),a.target===v.target){if(h||i)x.flickDuration>e&&d(a,"flick"),w.end=!0,b="drag";else{var f=l===a.target&&x.doubleTapInterval>c-m;b=f?"doubletap":"tap",l=f?null:v.target,m=c}d(a,b,!0)}}var h,i,j,k,l,m,n=/chrome/i.exec(b),o=/android/i.exec(b),p="ontouchstart"in window&&!(n&&!o),q=p?"touchstart":"mousedown",r=p?"touchend touchcancel":"mouseup mouseleave",s=p?"touchmove":"mousemove",t="finger",u=a("html")[0],v={},w={},x=a.Finger={pressDuration:300,doubleTapInterval:300,flickDuration:150,motionThreshold:5};a.event.add(u,q+"."+t,e)}(jQuery,navigator.userAgent),!function(a){!function(a){"use strict";function b(){}function c(a){function c(b){b.prototype.option||(b.prototype.option=function(b){a.isPlainObject(b)&&(this.options=a.extend(!0,this.options,b))})}function e(b,c){a.fn[b]=function(e){if("string"==typeof e){for(var g=d.call(arguments,1),h=0,i=this.length;i>h;h++){var j=this[h],k=a.data(j,b);if(k)if(a.isFunction(k[e])&&"_"!==e.charAt(0)){var l=k[e].apply(k,g);if(void 0!==l&&l!==k)return l}else f("no such method '"+e+"' for "+b+" instance");else f("cannot call methods on "+b+" prior to initialization; attempted to call '"+e+"'")}return this}var m=this.map(function(){var d=a.data(this,b);return d?(d.option(e),d._init()):(d=new c(this,e),a.data(this,b,d)),a(this)});return!m||m.length>1?m:m[0]}}if(a){var f="undefined"==typeof console?b:function(a){console.error(a)};return a.bridget=function(a,b){c(b),e(a,b)},a.bridget}}var d=Array.prototype.slice;c(a)}(a),function(a){function b(b,c){function d(a,b){var c="data-slider-"+b,d=a.getAttribute(c);try{return JSON.parse(d)}catch(e){return d}}"string"==typeof b?this.element=document.querySelector(b):b instanceof HTMLElement&&(this.element=b);var e,f,g,h=this.element.style.width,i=!1,j=this.element.parentNode;if(this.sliderElem)i=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var k=document.createElement("div");k.className="slider-track",e=document.createElement("div"),e.className="slider-selection",f=document.createElement("div"),f.className="slider-handle min-slider-handle",g=document.createElement("div"),g.className="slider-handle max-slider-handle",k.appendChild(e),k.appendChild(f),k.appendChild(g);var l=function(a){var b=document.createElement("div");b.className="tooltip-arrow";var c=document.createElement("div");c.className="tooltip-inner",a.appendChild(b),a.appendChild(c)},m=document.createElement("div");m.className="tooltip tooltip-main",l(m);var n=document.createElement("div");n.className="tooltip tooltip-min",l(n);var o=document.createElement("div");o.className="tooltip tooltip-max",l(o),this.sliderElem.appendChild(k),this.sliderElem.appendChild(m),this.sliderElem.appendChild(n),this.sliderElem.appendChild(o),j.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}a&&(this.$element=a(this.element),this.$sliderElem=a(this.sliderElem)),c=c?c:{};for(var p=Object.keys(this.defaultOptions),q=0;q<p.length;q++){var r=p[q],s=c[r];s="undefined"!=typeof s?s:d(this.element,r),s=null!==s?s:this.defaultOptions[r],this.options||(this.options={}),this.options[r]=s}this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),i===!0&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","top","width","height"].forEach(function(a){this._removeProperty(this.trackSelection,a)},this),[this.handle1,this.handle2].forEach(function(a){this._removeProperty(a,"left"),this._removeProperty(a,"top")},this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach(function(a){this._removeProperty(a,"left"),this._removeProperty(a,"top"),this._removeProperty(a,"margin-left"),this._removeProperty(a,"margin-top"),this._removeClass(a,"right"),this._removeClass(a,"top")},this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this._addClass(this.tooltip,"right"),this.tooltip.style.left="100%",this._addClass(this.tooltip_min,"right"),this.tooltip_min.style.left="100%",this._addClass(this.tooltip_max,"right"),this.tooltip_max.style.left="100%"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=h,this.options.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this._addClass(this.tooltip,"top"),this.tooltip.style.top=-this.tooltip.outerHeight-14+"px",this._addClass(this.tooltip_min,"top"),this.tooltip_min.style.top=-this.tooltip_min.outerHeight-14+"px",this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=-this.tooltip_max.outerHeight-14+"px"),this.options.value instanceof Array?this.options.range=!0:this.options.range&&(this.options.value=[this.options.value,this.options.max]),this.trackSelection=e||this.trackSelection,"none"===this.options.selection&&this._addClass(this.trackSelection,"hide"),this.handle1=f||this.handle1,this.handle2=g||this.handle2,i===!0&&(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"));var t=["round","triangle","custom"],u=-1!==t.indexOf(this.options.handle);u&&(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle)),this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos],this.setValue(this.options.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,0),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.touchCapable?(this.mousedown=this._mousedown.bind(this),this.sliderElem.addEventListener("touchstart",this.mousedown,!1)):(this.mousedown=this._mousedown.bind(this),this.sliderElem.addEventListener("mousedown",this.mousedown,!1)),"hide"===this.options.tooltip?(this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide")):"always"===this.options.tooltip?(this._showTooltip(),this._alwaysShowTooltip=!0):(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1),this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)),this.options.enabled?this.enable():this.disable()}var c={formatInvalidInputErrorMsg:function(a){return"Invalid input value '"+a+"' passed in"},callingContextNotSliderInstance:"Calling context element does not have instance of Slider bound to it. Check your code to make sure the JQuery object returned from the call to the slider() initializer is calling the method"},d=function(a,c){return b.call(this,a,c),this};if(d.prototype={_init:function(){},constructor:d,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,enabled:!0,formatter:function(a){return a instanceof Array?a[0]+" : "+a[1]:a},natural_arrow_keys:!1},over:!1,inDrag:!1,getValue:function(){return this.options.range?this.options.value:this.options.value[0]},setValue:function(a,b){a||(a=0),this.options.value=this._validateInputValue(a);var c=this._applyPrecision.bind(this);if(this.options.range?(this.options.value[0]=c(this.options.value[0]),this.options.value[1]=c(this.options.value[1]),this.options.value[0]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[0])),this.options.value[1]=Math.max(this.options.min,Math.min(this.options.max,this.options.value[1]))):(this.options.value=c(this.options.value),this.options.value=[Math.max(this.options.min,Math.min(this.options.max,this.options.value))],this._addClass(this.handle2,"hide"),this.options.value[1]="after"===this.selection?this.options.max:this.options.min),this.diff=this.options.max-this.options.min,this.percentage=this.diff>0?[100*(this.options.value[0]-this.options.min)/this.diff,100*(this.options.value[1]-this.options.min)/this.diff,100*this.options.step/this.diff]:[0,0,100],this._layout(),b===!0){var d=this.options.range?this.options.value:this.options.value[0];this._trigger("slide",d),this._setDataVal(d)}return this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),a&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this.options.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this.options.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this.options.enabled?this.disable():this.enable(),this},isEnabled:function(){return this.options.enabled},on:function(b,c){return a?(this.$element.on(b,c),this.$sliderElem.on(b,c)):this._bindNonQueryEventHandler(b,c),this},getAttribute:function(a){return a?this.options[a]:this.options},setAttribute:function(a,b){return this.options[a]=b,this},refresh:function(){return this._removeSliderEventHandlers(),b.call(this,this.element,this.options),a&&a.data(this.element,"slider",this),this},_removeSliderEventHandlers:function(){this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.handle2.removeEventListener("focus",this.handle2Keydown,!1),this.handle2.removeEventListener("blur",this.handle2Keydown,!1),this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.mousedown,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1)},_bindNonQueryEventHandler:function(a,b){var c=this.eventToCallbackMap[a];c?c.push(b):this.eventToCallbackMap[a]=[]},_cleanUpEventCallbacksMap:function(){for(var a=Object.keys(this.eventToCallbackMap),b=0;b<a.length;b++){var c=a[b];this.eventToCallbackMap[c]=null}},_showTooltip:function(){this.options.tooltip_split===!1?this._addClass(this.tooltip,"in"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in")),this.over=!0},_hideTooltip:function(){this.inDrag===!1&&this.alwaysShowTooltip!==!0&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this.over=!1},_layout:function(){var a;if(a=this.options.reversed?[100-this.percentage[0],this.percentage[1]]:[this.percentage[0],this.percentage[1]],this.handle1.style[this.stylePos]=a[0]+"%",this.handle2.style[this.stylePos]=a[1]+"%","vertical"===this.options.orientation)this.trackSelection.style.top=Math.min(a[0],a[1])+"%",this.trackSelection.style.height=Math.abs(a[0]-a[1])+"%";else{this.trackSelection.style.left=Math.min(a[0],a[1])+"%",this.trackSelection.style.width=Math.abs(a[0]-a[1])+"%";var b=this.tooltip_min.getBoundingClientRect(),c=this.tooltip_max.getBoundingClientRect();b.right>c.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="-30px")}var d;if(this.options.range){d=this.options.formatter(this.options.value),this._setText(this.tooltipInner,d),this.tooltip.style[this.stylePos]=(a[1]+a[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px"),"vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px");var e=this.options.formatter(this.options.value[0]);this._setText(this.tooltipInner_min,e);var f=this.options.formatter(this.options.value[1]);this._setText(this.tooltipInner_max,f),this.tooltip_min.style[this.stylePos]=a[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-top",-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-left",-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=a[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-top",-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-left",-this.tooltip_max.offsetWidth/2+"px")}else d=this.options.formatter(this.options.value[0]),this._setText(this.tooltipInner,d),this.tooltip.style[this.stylePos]=a[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-top",-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-left",-this.tooltip.offsetWidth/2+"px")
},_removeProperty:function(a,b){a.style.removeProperty?a.style.removeProperty(b):a.style.removeAttribute(b)},_mousedown:function(a){if(!this.options.enabled)return!1;this.touchCapable&&"touchstart"===a.type&&(a=a.originalEvent),this._triggerFocusOnHandle(),this.offset=this._offset(this.sliderElem),this.size=this.sliderElem[this.sizePos];var b=this._getPercentage(a);if(this.options.range){var c=Math.abs(this.percentage[0]-b),d=Math.abs(this.percentage[1]-b);this.dragged=d>c?0:1}else this.dragged=0;this.percentage[this.dragged]=this.options.reversed?100-b:b,this._layout(),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable?(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)):(document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1)),this.inDrag=!0;var e=this._calculateValue();return this._trigger("slideStart",e),this._setDataVal(e),this.setValue(e),this._pauseEvent(a),!0},_triggerFocusOnHandle:function(a){0===a&&this.handle1.focus(),1===a&&this.handle2.focus()},_keydown:function(a,b){if(!this.options.enabled)return!1;var c;switch(b.keyCode){case 37:case 40:c=-1;break;case 39:case 38:c=1}if(c){if(this.options.natural_arrow_keys){var d="vertical"===this.options.orientation&&!this.options.reversed,e="horizontal"===this.options.orientation&&this.options.reversed;(d||e)&&(c=-1*c)}var f=c*this.percentage[2],g=this.percentage[a]+f;g>100?g=100:0>g&&(g=0),this.dragged=a,this._adjustPercentageForRangeSliders(g),this.percentage[this.dragged]=g,this._layout();var h=this._calculateValue();return this._trigger("slideStart",h),this._setDataVal(h),this.setValue(h,!0),this._trigger("slideStop",h),this._setDataVal(h),this._pauseEvent(b),!1}},_pauseEvent:function(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1},_mousemove:function(a){if(!this.options.enabled)return!1;this.touchCapable&&"touchmove"===a.type&&(a=a.originalEvent);var b=this._getPercentage(a);this._adjustPercentageForRangeSliders(b),this.percentage[this.dragged]=this.options.reversed?100-b:b,this._layout();var c=this._calculateValue();return this.setValue(c,!0),!1},_adjustPercentageForRangeSliders:function(a){this.options.range&&(0===this.dragged&&this.percentage[1]<a?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>a&&(this.percentage[1]=this.percentage[0],this.dragged=0))},_mouseup:function(){if(!this.options.enabled)return!1;this.touchCapable?(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)):(document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1)),this.inDrag=!1,this.over===!1&&this._hideTooltip();var a=this._calculateValue();return this._layout(),this._setDataVal(a),this._trigger("slideStop",a),!1},_calculateValue:function(){var a;return this.options.range?(a=[this.options.min,this.options.max],0!==this.percentage[0]&&(a[0]=Math.max(this.options.min,this.options.min+Math.round(this.diff*this.percentage[0]/100/this.options.step)*this.options.step),a[0]=this._applyPrecision(a[0])),100!==this.percentage[1]&&(a[1]=Math.min(this.options.max,this.options.min+Math.round(this.diff*this.percentage[1]/100/this.options.step)*this.options.step),a[1]=this._applyPrecision(a[1])),this.options.value=a):(a=this.options.min+Math.round(this.diff*this.percentage[0]/100/this.options.step)*this.options.step,a<this.options.min?a=this.options.min:a>this.options.max&&(a=this.options.max),a=parseFloat(a),a=this._applyPrecision(a),this.options.value=[a,this.options.value[1]]),a},_applyPrecision:function(a){var b=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.step);return this._applyToFixedAndParseFloat(a,b)},_getNumDigitsAfterDecimalPlace:function(a){var b=(""+a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return b?Math.max(0,(b[1]?b[1].length:0)-(b[2]?+b[2]:0)):0},_applyToFixedAndParseFloat:function(a,b){var c=a.toFixed(b);return parseFloat(c)},_getPercentage:function(a){!this.touchCapable||"touchstart"!==a.type&&"touchmove"!==a.type||(a=a.touches[0]);var b=100*(a[this.mousePos]-this.offset[this.stylePos])/this.size;return b=Math.round(b/this.percentage[2])*this.percentage[2],Math.max(0,Math.min(100,b))},_validateInputValue:function(a){if("number"==typeof a)return a;if(a instanceof Array)return this._validateArray(a),a;throw new Error(c.formatInvalidInputErrorMsg(a))},_validateArray:function(a){for(var b=0;b<a.length;b++){var d=a[b];if("number"!=typeof d)throw new Error(c.formatInvalidInputErrorMsg(d))}},_setDataVal:function(a){var b="value: '"+a+"'";this.element.setAttribute("data",b)},_trigger:function(b,c){c=c||void 0;var d=this.eventToCallbackMap[b];if(d&&d.length)for(var e=0;e<d.length;e++){var f=d[e];f(c)}a&&this._triggerJQueryEvent(b,c)},_triggerJQueryEvent:function(a,b){var c={type:a,value:b};this.$element.trigger(c),this.$sliderElem.trigger(c)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(a,b){"undefined"!=typeof a.innerText?a.innerText=b:"undefined"!=typeof a.textContent&&(a.textContent=b)},_removeClass:function(a,b){for(var c=b.split(" "),d=a.className,e=0;e<c.length;e++){var f=c[e],g=new RegExp("(?:\\s|^)"+f+"(?:\\s|$)");d=d.replace(g," ")}a.className=d.trim()},_addClass:function(a,b){for(var c=b.split(" "),d=a.className,e=0;e<c.length;e++){var f=c[e],g=new RegExp("(?:\\s|^)"+f+"(?:\\s|$)"),h=g.test(d);h||(d+=" "+f)}a.className=d.trim()},_offset:function(a){var b=0,c=0;if(a.offsetParent)do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:c}},_css:function(a,b,c){a.style[b]=c}},a){var e=a.fn.slider?"bootstrapSlider":"slider";a.bridget(e,d)}else window.Slider=d}(a)}(window.jQuery),function(a,b,c){function d(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function e(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return q[a.which]?q[a.which]:r[a.which]?r[a.which]:String.fromCharCode(a.which).toLowerCase()}function f(a){a=a||{};var b,c=!1;for(b in w)a[b]?c=!0:w[b]=0;c||(z=!1)}function g(a,b,c,d,e,f){var g,h,i=[],j=c.type;if(!u[a])return[];for("keyup"==j&&k(a)&&(b=[a]),g=0;g<u[a].length;++g)if(h=u[a][g],!(!d&&h.seq&&w[h.seq]!=h.level||j!=h.action||("keypress"!=j||c.metaKey||c.ctrlKey)&&b.sort().join(",")!==h.modifiers.sort().join(","))){var l=d&&h.seq==d&&h.level==f;(!d&&h.combo==e||l)&&u[a].splice(g,1),i.push(h)}return i}function h(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function i(a,b,c,d){A.stopCallback(b,b.target||b.srcElement,c,d)||!1!==a(b,c)||(b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?b.stopPropagation():b.cancelBubble=!0)}function j(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=e(a);b&&("keyup"==a.type&&x===b?x=!1:A.handleKey(b,h(a),a))}function k(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function l(a,b,c,d){function g(b){return function(){z=b,++w[a],clearTimeout(p),p=setTimeout(f,1e3)}}function h(b){i(c,b,a),"keyup"!==d&&(x=e(b)),setTimeout(f,10)}for(var j=w[a]=0;j<b.length;++j){var k=j+1===b.length?h:g(d||m(b[j+1]).action);n(b[j],k,d,a,j)}}function m(a,b){var c,d,e,f=[];for(c="+"===a?["+"]:a.split("+"),e=0;e<c.length;++e)d=c[e],t[d]&&(d=t[d]),b&&"keypress"!=b&&s[d]&&(d=s[d],f.push("shift")),k(d)&&f.push(d);if(c=d,e=b,!e){if(!o){o={};for(var g in q)g>95&&112>g||q.hasOwnProperty(g)&&(o[q[g]]=g)}e=o[c]?"keydown":"keypress"}return"keypress"==e&&f.length&&(e="keydown"),{key:d,modifiers:f,action:e}}function n(a,b,c,d,e){v[a+":"+c]=b,a=a.replace(/\s+/g," ");var f=a.split(" ");1<f.length?l(a,f,b,c):(c=m(a,c),u[c.key]=u[c.key]||[],g(c.key,c.modifiers,{type:c.action},d,a,e),u[c.key][d?"unshift":"push"]({callback:b,modifiers:c.modifiers,action:c.action,seq:d,level:e,combo:a}))}var o,p,q={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},r={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},t={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},u={},v={},w={},x=!1,y=!1,z=!1;for(c=1;20>c;++c)q[111+c]="f"+c;for(c=0;9>=c;++c)q[c+96]=c;d(b,"keypress",j),d(b,"keydown",j),d(b,"keyup",j);var A={bind:function(a,b,c){a=a instanceof Array?a:[a];for(var d=0;d<a.length;++d)n(a[d],b,c);return this},unbind:function(a,b){return A.bind(a,function(){},b)},trigger:function(a,b){return v[a+":"+b]&&v[a+":"+b]({},a),this},reset:function(){return u={},v={},this},stopCallback:function(a,b){return-1<(" "+b.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},handleKey:function(a,b,c){var d,e=g(a,b,c);b={};var h=0,j=!1;for(d=0;d<e.length;++d)e[d].seq&&(h=Math.max(h,e[d].level));for(d=0;d<e.length;++d)e[d].seq?e[d].level==h&&(j=!0,b[e[d].seq]=1,i(e[d].callback,c,e[d].combo,e[d].seq)):j||i(e[d].callback,c,e[d].combo);e="keypress"==c.type&&y,c.type!=z||k(a)||e||f(b),y=j&&"keydown"==c.type}};a.Mousetrap=A,"function"==typeof define&&define.amd&&define(A)}(window,document),function(a){"use strict";var b=function(b,c){this.options=c,this.$select=a(b),this._init()};b.prototype={constructor:b,_init:function(){var b=this.options.callback,c=this.$select.val(),d=this.$select.find("option:selected").data("color"),e=a("<ul>").addClass("dropdown-menu").addClass("dropdown-caret"),f=a("<div>").addClass("dropdown").addClass("dropdown-colorselector"),g=a("<span>").addClass("btn-colorselector").css("background-color",d),h=a("<a>").attr("data-toggle","dropdown").addClass("dropdown-toggle").attr("href","#").append(g);a("option",this.$select).each(function(){var b=a(this),d=b.attr("value"),f=b.data("color"),g=b.text(),h=a("<a>").addClass("color-btn");(b.prop("selected")===!0||c===f)&&h.addClass("selected"),h.css("background-color",f),h.attr("href","#").attr("data-color",f).attr("data-value",d).attr("title",g),e.append(a("<li>").append(h))}),f.append(h),f.append(e),this.$select.hide(),this.$selector=a(f).insertAfter(this.$select),this.$select.on("change",function(){var c=a(this).val(),d=a(this).find("option[value='"+c+"']").data("color"),e=a(this).find("option[value='"+c+"']").text();a(this).next().find("ul").find("li").find(".selected").removeClass("selected"),a(this).next().find("ul").find("li").find("a[data-color='"+d+"']").addClass("selected"),a(this).next().find(".btn-colorselector").css("background-color",d),b(c,d,e)}),e.on("click.colorselector",a.proxy(this._clickColor,this))},_clickColor:function(b){var c=a(b.target);return c.is(".color-btn")?(this.$select.val(c.data("value")).change(),b.preventDefault(),!0):!1},setColor:function(b){var c=a(this.$selector).find("li").find("a[data-color='"+b+"']").data("value");this.setValue(c)},setValue:function(a){this.$select.val(a).change()}},a.fn.colorselector=function(c){var d=Array.apply(null,arguments);return d.shift(),this.each(function(){var e=a(this),f=e.data("colorselector"),g=a.extend({},a.fn.colorselector.defaults,e.data(),"object"==typeof c&&c);f||e.data("colorselector",f=new b(this,g)),"string"==typeof c&&f[c].apply(f,d)})},a.fn.colorselector.defaults={callback:function(){},colorsPerRow:8},a.fn.colorselector.Constructor=b}(jQuery,window,document),function(){function a(a,b,c){r.biginteger_used=1,null!=a&&("number"==typeof a&&"undefined"==typeof b?this.fromInt(a):"number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function b(){return new a(null)}function c(a,b,c,d,e,f){for(;0<=--f;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function d(a,b,c,d,e,f){var g=32767&b;for(b>>=15;0<=--f;){var h=32767&this[a],i=this[a++]>>15,j=b*h+i*g,h=g*h+((32767&j)<<15)+c[d]+(1073741823&e);e=(h>>>30)+(j>>>15)+b*i+(e>>>30),c[d++]=1073741823&h}return e}function e(a,b,c,d,e,f){var g=16383&b;for(b>>=14;0<=--f;){var h=16383&this[a],i=this[a++]>>14,j=b*h+i*g,h=g*h+((16383&j)<<14)+c[d]+e;e=(h>>28)+(j>>14)+b*i,c[d++]=268435455&h}return e}function f(a,b){var c=C[a.charCodeAt(b)];return null==c?-1:c}function g(a){var c=b();return c.fromInt(a),c}function h(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=a>>1&&(c+=1),c}function i(a){this.m=a}function j(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function k(a,b){return a&b}function l(a,b){return a|b}function m(a,b){return a^b}function n(a,b){return a&~b}function o(){}function p(a){return a}function q(c){this.r2=b(),this.q3=b(),a.ONE.dlShiftTo(2*c.t,this.r2),this.mu=this.r2.divide(c),this.m=c}var r={},s=!1;"undefined"!=typeof module&&module.exports?(module.exports=r,s=!0):"undefined"!=typeof document?window.ClipperLib=r:self.ClipperLib=r;var t;if(s)u="chrome",t="Netscape";else{var u=navigator.userAgent.toString().toLowerCase();t=navigator.appName}var v,w,x,y,z,A;v=-1!=u.indexOf("chrome")&&-1==u.indexOf("chromium")?1:0,s=-1!=u.indexOf("chromium")?1:0,w=-1!=u.indexOf("safari")&&-1==u.indexOf("chrome")&&-1==u.indexOf("chromium")?1:0,x=-1!=u.indexOf("firefox")?1:0,u.indexOf("firefox/17"),u.indexOf("firefox/15"),u.indexOf("firefox/3"),y=-1!=u.indexOf("opera")?1:0,u.indexOf("msie 10"),u.indexOf("msie 9"),z=-1!=u.indexOf("msie 8")?1:0,A=-1!=u.indexOf("msie 7")?1:0,u=-1!=u.indexOf("msie ")?1:0,r.biginteger_used=null,"Microsoft Internet Explorer"==t?(a.prototype.am=d,t=30):"Netscape"!=t?(a.prototype.am=c,t=26):(a.prototype.am=e,t=28),a.prototype.DB=t,a.prototype.DM=(1<<t)-1,a.prototype.DV=1<<t,a.prototype.FV=Math.pow(2,52),a.prototype.F1=52-t,a.prototype.F2=2*t-52;var B,C=[];for(t=48,B=0;9>=B;++B)C[t++]=B;for(t=97,B=10;36>B;++B)C[t++]=B;for(t=65,B=10;36>B;++B)C[t++]=B;i.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a},i.prototype.revert=function(a){return a},i.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},i.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},i.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},j.prototype.convert=function(c){var d=b();return c.abs().dlShiftTo(this.m.t,d),d.divRemTo(this.m,null,d),0>c.s&&0<d.compareTo(a.ZERO)&&this.m.subTo(d,d),d},j.prototype.revert=function(a){var c=b();return a.copyTo(c),this.reduce(c),c},j.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM,c=b+this.m.t;for(a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),0<=a.compareTo(this.m)&&a.subTo(this.m,a)},j.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},j.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},a.prototype.copyTo=function(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s},a.prototype.fromInt=function(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0},a.prototype.fromString=function(b,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(b,c);d=2}this.s=this.t=0;for(var e=b.length,g=!1,h=0;0<=--e;){var i=8==d?255&b[e]:f(b,e);0>i?"-"==b.charAt(e)&&(g=!0):(g=!1,0==h?this[this.t++]=i:h+d>this.DB?(this[this.t-1]|=(i&(1<<this.DB-h)-1)<<h,this[this.t++]=i>>this.DB-h):this[this.t-1]|=i<<h,h+=d,h>=this.DB&&(h-=this.DB))}8==d&&0!=(128&b[0])&&(this.s=-1,h>0&&(this[this.t-1]|=(1<<this.DB-h)-1<<h)),this.clamp(),g&&a.ZERO.subTo(this,this)},a.prototype.clamp=function(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t},a.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s},a.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s},a.prototype.lShiftTo=function(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()},a.prototype.rShiftTo=function(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}},a.prototype.subTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()},a.prototype.multiplyTo=function(b,c){var d=this.abs(),e=b.abs(),f=d.t;for(c.t=f+e.t;0<=--f;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=b.s&&a.ZERO.subTo(c,c)},a.prototype.squareTo=function(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}0<a.t&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()},a.prototype.divRemTo=function(c,d,e){var f=c.abs();if(!(0>=f.t)){var g=this.abs();if(g.t<f.t)null!=d&&d.fromInt(0),null!=e&&this.copyTo(e);else{null==e&&(e=b());var i=b(),j=this.s;c=c.s;var k=this.DB-h(f[f.t-1]);if(k>0?(f.lShiftTo(k,i),g.lShiftTo(k,e)):(f.copyTo(i),g.copyTo(e)),f=i.t,g=i[f-1],0!=g){var l=g*(1<<this.F1)+(f>1?i[f-2]>>this.F2:0),m=this.FV/l,l=(1<<this.F1)/l,n=1<<this.F2,o=e.t,p=o-f,q=null==d?b():d;for(i.dlShiftTo(p,q),0<=e.compareTo(q)&&(e[e.t++]=1,e.subTo(q,e)),a.ONE.dlShiftTo(f,q),q.subTo(i,i);i.t<f;)i[i.t++]=0;for(;0<=--p;){var r=e[--o]==g?this.DM:Math.floor(e[o]*m+(e[o-1]+n)*l);if((e[o]+=i.am(0,r,e,p,0,f))<r)for(i.dlShiftTo(p,q),e.subTo(q,e);e[o]<--r;)e.subTo(q,e)}null!=d&&(e.drShiftTo(f,d),j!=c&&a.ZERO.subTo(d,d)),e.t=f,e.clamp(),k>0&&e.rShiftTo(k,e),0>j&&a.ZERO.subTo(e,e)}}}},a.prototype.invDigit=function(){if(1>this.t)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a,b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV;return b>0?this.DV-b:-b},a.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},a.prototype.exp=function(c,d){if(c>4294967295||1>c)return a.ONE;var e=b(),f=b(),g=d.convert(this),i=h(c)-1;for(g.copyTo(e);0<=--i;)if(d.sqrTo(e,f),(c&1<<i)>0)d.mulTo(f,g,e);else var j=e,e=f,f=j;return d.revert(e)},a.prototype.toString=function(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else{if(4!=a)return this.toRadix(a);a=2}var b,c=(1<<a)-1,d=!1,e="",f=this.t,g=this.DB-f*this.DB%a;if(0<f--)for(g<this.DB&&0<(b=this[f]>>g)&&(d=!0,e="0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));f>=0;)a>g?(b=(this[f]&(1<<g)-1)<<a-g,b|=this[--f]>>(g+=this.DB-a)):(b=this[f]>>(g-=a)&c,0>=g&&(g+=this.DB,--f)),b>0&&(d=!0),d&&(e+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));return d?e:"0"},a.prototype.negate=function(){var c=b();return a.ZERO.subTo(this,c),c},a.prototype.abs=function(){return 0>this.s?this.negate():this},a.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t,b=c-a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--c;)if(0!=(b=this[c]-a[c]))return b;return 0},a.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+h(this[this.t-1]^this.s&this.DM)},a.prototype.mod=function(c){var d=b();return this.abs().divRemTo(c,null,d),0>this.s&&0<d.compareTo(a.ZERO)&&c.subTo(d,d),d},a.prototype.modPowInt=function(a,b){var c;return c=256>a||b.isEven()?new i(b):new j(b),this.exp(a,c)},a.ZERO=g(0),a.ONE=g(1),o.prototype.convert=p,o.prototype.revert=p,o.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c)},o.prototype.sqrTo=function(a,b){a.squareTo(b)},q.prototype.convert=function(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var c=b();return a.copyTo(c),this.reduce(c),c},q.prototype.revert=function(a){return a},q.prototype.reduce=function(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)},q.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},q.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)};var D=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],E=67108864/D[D.length-1];a.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},a.prototype.toRadix=function(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var c=this.chunkSize(a),c=Math.pow(a,c),d=g(c),e=b(),f=b(),h="";for(this.divRemTo(d,e,f);0<e.signum();)h=(c+f.intValue()).toString(a).substr(1)+h,e.divRemTo(d,e,f);return f.intValue().toString(a)+h},a.prototype.fromRadix=function(b,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),g=!1,h=0,i=0,j=0;j<b.length;++j){var k=f(b,j);0>k?"-"==b.charAt(j)&&0==this.signum()&&(g=!0):(i=c*i+k,++h>=d&&(this.dMultiply(e),this.dAddOffset(i,0),i=h=0))}h>0&&(this.dMultiply(Math.pow(c,h)),this.dAddOffset(i,0)),g&&a.ZERO.subTo(this,this)},a.prototype.fromNumber=function(b,c,d){if("number"==typeof c)if(2>b)this.fromInt(1);else for(this.fromNumber(b,d),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),l,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this);else{d=[];var e=7&b;d.length=(b>>3)+1,c.nextBytes(d),d[0]=e>0?d[0]&(1<<e)-1:0,this.fromString(d,256)}},a.prototype.bitwiseTo=function(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()},a.prototype.changeBit=function(b,c){var d=a.ONE.shiftLeft(b);return this.bitwiseTo(d,c,d),d},a.prototype.addTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()},a.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()},a.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}},a.prototype.multiplyLowerTo=function(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()},a.prototype.multiplyUpperTo=function(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;0<=--d;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)},a.prototype.modInt=function(a){if(0>=a)return 0;var b=this.DV%a,c=0>this.s?a-1:0;if(0<this.t)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c},a.prototype.millerRabin=function(c){var d=this.subtract(a.ONE),e=d.getLowestSetBit();if(0>=e)return!1;var f=d.shiftRight(e);c=c+1>>1,c>D.length&&(c=D.length);for(var g=b(),h=0;c>h;++h){g.fromInt(D[Math.floor(Math.random()*D.length)]);var i=g.modPow(f,this);if(0!=i.compareTo(a.ONE)&&0!=i.compareTo(d)){for(var j=1;j++<e&&0!=i.compareTo(d);)if(i=i.modPowInt(2,this),0==i.compareTo(a.ONE))return!1;if(0!=i.compareTo(d))return!1}}return!0},a.prototype.clone=function(){var a=b();return this.copyTo(a),a},a.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},a.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},a.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},a.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1},a.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(0<a--)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b},a.prototype.equals=function(a){return 0==this.compareTo(a)},a.prototype.min=function(a){return 0>this.compareTo(a)?this:a},a.prototype.max=function(a){return 0<this.compareTo(a)?this:a},a.prototype.and=function(a){var c=b();return this.bitwiseTo(a,k,c),c},a.prototype.or=function(a){var c=b();return this.bitwiseTo(a,l,c),c},a.prototype.xor=function(a){var c=b();return this.bitwiseTo(a,m,c),c},a.prototype.andNot=function(a){var c=b();return this.bitwiseTo(a,n,c),c},a.prototype.not=function(){for(var a=b(),c=0;c<this.t;++c)a[c]=this.DM&~this[c];return a.t=this.t,a.s=~this.s,a},a.prototype.shiftLeft=function(a){var c=b();return 0>a?this.rShiftTo(-a,c):this.lShiftTo(a,c),c},a.prototype.shiftRight=function(a){var c=b();return 0>a?this.lShiftTo(-a,c):this.rShiftTo(a,c),c},a.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a]){var b=a*this.DB;if(a=this[a],0==a)a=-1;else{var c=0;0==(65535&a)&&(a>>=16,c+=16),0==(255&a)&&(a>>=8,c+=8),0==(15&a)&&(a>>=4,c+=4),0==(3&a)&&(a>>=2,c+=2),0==(1&a)&&++c,a=c}return b+a}return 0>this.s?this.t*this.DB:-1},a.prototype.bitCount=function(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c){for(var d=this[c]^b,e=0;0!=d;)d&=d-1,++e;a+=e}return a},a.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)},a.prototype.setBit=function(a){return this.changeBit(a,l)},a.prototype.clearBit=function(a){return this.changeBit(a,n)},a.prototype.flipBit=function(a){return this.changeBit(a,m)},a.prototype.add=function(a){var c=b();return this.addTo(a,c),c},a.prototype.subtract=function(a){var c=b();return this.subTo(a,c),c},a.prototype.multiply=function(a){var c=b();return this.multiplyTo(a,c),c},a.prototype.divide=function(a){var c=b();return this.divRemTo(a,c,null),c},a.prototype.remainder=function(a){var c=b();return this.divRemTo(a,null,c),c},a.prototype.divideAndRemainder=function(a){var c=b(),d=b();return this.divRemTo(a,c,d),[c,d]},a.prototype.modPow=function(a,c){var d,e,f=a.bitLength(),k=g(1);if(0>=f)return k;d=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new i(c):c.isEven()?new q(c):new j(c);var l=[],m=3,n=d-1,o=(1<<d)-1;if(l[1]=e.convert(this),d>1)for(f=b(),e.sqrTo(l[1],f);o>=m;)l[m]=b(),e.mulTo(f,l[m-2],l[m]),m+=2;for(var p,r=a.t-1,s=!0,t=b(),f=h(a[r])-1;r>=0;){for(f>=n?p=a[r]>>f-n&o:(p=(a[r]&(1<<f+1)-1)<<n-f,r>0&&(p|=a[r-1]>>this.DB+f-n)),m=d;0==(1&p);)p>>=1,--m;if(0>(f-=m)&&(f+=this.DB,--r),s)l[p].copyTo(k),s=!1;else{for(;m>1;)e.sqrTo(k,t),e.sqrTo(t,k),m-=2;m>0?e.sqrTo(k,t):(m=k,k=t,t=m),e.mulTo(t,l[p],k)}for(;r>=0&&0==(a[r]&1<<f);)e.sqrTo(k,t),m=k,k=t,t=m,0>--f&&(f=this.DB-1,--r)}return e.revert(k)},a.prototype.modInverse=function(b){var c=b.isEven();if(this.isEven()&&c||0==b.signum())return a.ZERO;for(var d=b.clone(),e=this.clone(),f=g(1),h=g(0),i=g(0),j=g(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&h.isEven()||(f.addTo(this,f),h.subTo(b,h)),f.rShiftTo(1,f)):h.isEven()||h.subTo(b,h),h.rShiftTo(1,h);for(;e.isEven();)e.rShiftTo(1,e),c?(i.isEven()&&j.isEven()||(i.addTo(this,i),j.subTo(b,j)),i.rShiftTo(1,i)):j.isEven()||j.subTo(b,j),j.rShiftTo(1,j);0<=d.compareTo(e)?(d.subTo(e,d),c&&f.subTo(i,f),h.subTo(j,h)):(e.subTo(d,e),c&&i.subTo(f,i),j.subTo(h,j))}return 0!=e.compareTo(a.ONE)?a.ZERO:0<=j.compareTo(b)?j.subtract(b):0>j.signum()?(j.addTo(b,j),0>j.signum()?j.add(b):j):j},a.prototype.pow=function(a){return this.exp(a,new o)},a.prototype.gcd=function(a){var b=0>this.s?this.negate():this.clone();if(a=0>a.s?a.negate():a.clone(),0>b.compareTo(a)){var c=b,b=a;a=c}var c=b.getLowestSetBit(),d=a.getLowestSetBit();if(0>d)return b;for(d>c&&(d=c),d>0&&(b.rShiftTo(d,b),a.rShiftTo(d,a));0<b.signum();)0<(c=b.getLowestSetBit())&&b.rShiftTo(c,b),0<(c=a.getLowestSetBit())&&a.rShiftTo(c,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));return d>0&&a.lShiftTo(d,a),a},a.prototype.isProbablePrime=function(a){var b,c=this.abs();if(1==c.t&&c[0]<=D[D.length-1]){for(b=0;b<D.length;++b)if(c[0]==D[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<D.length;){for(var d=D[b],e=b+1;e<D.length&&E>d;)d*=D[e++];for(d=c.modInt(d);e>b;)if(0==d%D[b++])return!1}return c.millerRabin(a)},a.prototype.square=function(){var a=b();return this.squareTo(a),a};var F=a;if(F.prototype.IsNegative=function(){return-1==this.compareTo(F.ZERO)?!0:!1},F.op_Equality=function(a,b){return 0==a.compareTo(b)?!0:!1},F.op_Inequality=function(a,b){return 0!=a.compareTo(b)?!0:!1},F.op_GreaterThan=function(a,b){return 0<a.compareTo(b)?!0:!1},F.op_LessThan=function(a,b){return 0>a.compareTo(b)?!0:!1},F.op_Addition=function(a,b){return new F(a).add(new F(b))},F.op_Subtraction=function(a,b){return new F(a).subtract(new F(b))},F.Int128Mul=function(a,b){return new F(a).multiply(new F(b))},F.op_Division=function(a,b){return a.divide(b)},F.prototype.ToDouble=function(){return parseFloat(this.toString())},"undefined"==typeof G)var G=function(a,b){var c;if("undefined"==typeof Object.getOwnPropertyNames)for(c in b.prototype)("undefined"==typeof a.prototype[c]||a.prototype[c]==Object.prototype[c])&&(a.prototype[c]=b.prototype[c]);else for(var d=Object.getOwnPropertyNames(b.prototype),e=0;e<d.length;e++)"undefined"==typeof Object.getOwnPropertyDescriptor(a.prototype,d[e])&&Object.defineProperty(a.prototype,d[e],Object.getOwnPropertyDescriptor(b.prototype,d[e]));for(c in b)"undefined"==typeof a[c]&&(a[c]=b[c]);a.$baseCtor=b};r.Path=function(){return[]},r.Paths=function(){return[]},r.DoublePoint=function(){var a=arguments;this.Y=this.X=0,1==a.length?(this.X=a[0].X,this.Y=a[0].Y):2==a.length&&(this.X=a[0],this.Y=a[1])},r.DoublePoint0=function(){this.Y=this.X=0},r.DoublePoint1=function(a){this.X=a.X,this.Y=a.Y},r.DoublePoint2=function(a,b){this.X=a,this.Y=b},r.PolyNode=function(){this.m_Parent=null,this.m_polygon=new r.Path,this.m_endtype=this.m_jointype=this.m_Index=0,this.m_Childs=[],this.IsOpen=!1},r.PolyNode.prototype.IsHoleNode=function(){for(var a=!0,b=this.m_Parent;null!==b;)a=!a,b=b.m_Parent;return a},r.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},r.PolyNode.prototype.Contour=function(){return this.m_polygon
},r.PolyNode.prototype.AddChild=function(a){var b=this.m_Childs.length;this.m_Childs.push(a),a.m_Parent=this,a.m_Index=b},r.PolyNode.prototype.GetNext=function(){return 0<this.m_Childs.length?this.m_Childs[0]:this.GetNextSiblingUp()},r.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},r.PolyNode.prototype.Childs=function(){return this.m_Childs},r.PolyNode.prototype.Parent=function(){return this.m_Parent},r.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},r.PolyTree=function(){this.m_AllPolys=[],r.PolyNode.call(this)},r.PolyTree.prototype.Clear=function(){for(var a=0,b=this.m_AllPolys.length;b>a;a++)this.m_AllPolys[a]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},r.PolyTree.prototype.GetFirst=function(){return 0<this.m_Childs.length?this.m_Childs[0]:null},r.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},G(r.PolyTree,r.PolyNode),r.Math_Abs_Int64=r.Math_Abs_Int32=r.Math_Abs_Double=function(a){return Math.abs(a)},r.Math_Max_Int32_Int32=function(a,b){return Math.max(a,b)},r.Cast_Int32=u||y||w?function(a){return 0|a}:function(a){return~~a},r.Cast_Int64=v?function(a){return-2147483648>a||a>2147483647?0>a?Math.ceil(a):Math.floor(a):~~a}:x&&"function"==typeof Number.toInteger?function(a){return Number.toInteger(a)}:A||z?function(a){return parseInt(a,10)}:u?function(a){return-2147483648>a||a>2147483647?0>a?Math.ceil(a):Math.floor(a):0|a}:function(a){return 0>a?Math.ceil(a):Math.floor(a)},r.Clear=function(a){a.length=0},r.PI=3.141592653589793,r.PI2=6.283185307179586,r.IntPoint=function(){var a;a=arguments;var b=a.length;this.Y=this.X=0,2==b?(this.X=a[0],this.Y=a[1]):1==b?a[0]instanceof r.DoublePoint?(a=a[0],this.X=r.Clipper.Round(a.X),this.Y=r.Clipper.Round(a.Y)):(a=a[0],this.X=a.X,this.Y=a.Y):this.Y=this.X=0},r.IntPoint.op_Equality=function(a,b){return a.X==b.X&&a.Y==b.Y},r.IntPoint.op_Inequality=function(a,b){return a.X!=b.X||a.Y!=b.Y},r.IntPoint0=function(){this.Y=this.X=0},r.IntPoint1=function(a){this.X=a.X,this.Y=a.Y},r.IntPoint1dp=function(a){this.X=r.Clipper.Round(a.X),this.Y=r.Clipper.Round(a.Y)},r.IntPoint2=function(a,b){this.X=a,this.Y=b},r.IntRect=function(){var a=arguments,b=a.length;4==b?(this.left=a[0],this.top=a[1],this.right=a[2],this.bottom=a[3]):1==b?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):this.bottom=this.right=this.top=this.left=0},r.IntRect0=function(){this.bottom=this.right=this.top=this.left=0},r.IntRect1=function(a){this.left=a.left,this.top=a.top,this.right=a.right,this.bottom=a.bottom},r.IntRect4=function(a,b,c,d){this.left=a,this.top=b,this.right=c,this.bottom=d},r.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},r.PolyType={ptSubject:0,ptClip:1},r.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},r.JoinType={jtSquare:0,jtRound:1,jtMiter:2},r.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},r.EdgeSide={esLeft:0,esRight:1},r.Direction={dRightToLeft:0,dLeftToRight:1},r.TEdge=function(){this.Bot=new r.IntPoint,this.Curr=new r.IntPoint,this.Top=new r.IntPoint,this.Delta=new r.IntPoint,this.Dx=0,this.PolyTyp=r.PolyType.ptSubject,this.Side=r.EdgeSide.esLeft,this.OutIdx=this.WindCnt2=this.WindCnt=this.WindDelta=0,this.PrevInSEL=this.NextInSEL=this.PrevInAEL=this.NextInAEL=this.NextInLML=this.Prev=this.Next=null},r.IntersectNode=function(){this.Edge2=this.Edge1=null,this.Pt=new r.IntPoint},r.MyIntersectNodeSort=function(){},r.MyIntersectNodeSort.Compare=function(a,b){return b.Pt.Y-a.Pt.Y},r.LocalMinima=function(){this.Y=0,this.Next=this.RightBound=this.LeftBound=null},r.Scanbeam=function(){this.Y=0,this.Next=null},r.OutRec=function(){this.Idx=0,this.IsOpen=this.IsHole=!1,this.PolyNode=this.BottomPt=this.Pts=this.FirstLeft=null},r.OutPt=function(){this.Idx=0,this.Pt=new r.IntPoint,this.Prev=this.Next=null},r.Join=function(){this.OutPt2=this.OutPt1=null,this.OffPt=new r.IntPoint},r.ClipperBase=function(){this.m_CurrentLM=this.m_MinimaList=null,this.m_edges=[],this.PreserveCollinear=this.m_HasOpenPaths=this.m_UseFullRange=!1,this.m_CurrentLM=this.m_MinimaList=null,this.m_HasOpenPaths=this.m_UseFullRange=!1},r.ClipperBase.horizontal=-9007199254740992,r.ClipperBase.Skip=-2,r.ClipperBase.Unassigned=-1,r.ClipperBase.tolerance=1e-20,r.ClipperBase.loRange=47453132,r.ClipperBase.hiRange=0xfffffffffffff,r.ClipperBase.near_zero=function(a){return a>-r.ClipperBase.tolerance&&a<r.ClipperBase.tolerance},r.ClipperBase.IsHorizontal=function(a){return 0===a.Delta.Y},r.ClipperBase.prototype.PointIsVertex=function(a,b){var c=b;do{if(r.IntPoint.op_Equality(c.Pt,a))return!0;c=c.Next}while(c!=b);return!1},r.ClipperBase.prototype.PointOnLineSegment=function(a,b,c,d){return d?a.X==b.X&&a.Y==b.Y||a.X==c.X&&a.Y==c.Y||a.X>b.X==a.X<c.X&&a.Y>b.Y==a.Y<c.Y&&F.op_Equality(F.Int128Mul(a.X-b.X,c.Y-b.Y),F.Int128Mul(c.X-b.X,a.Y-b.Y)):a.X==b.X&&a.Y==b.Y||a.X==c.X&&a.Y==c.Y||a.X>b.X==a.X<c.X&&a.Y>b.Y==a.Y<c.Y&&(a.X-b.X)*(c.Y-b.Y)==(c.X-b.X)*(a.Y-b.Y)},r.ClipperBase.prototype.PointOnPolygon=function(a,b,c){for(var d=b;;){if(this.PointOnLineSegment(a,d.Pt,d.Next.Pt,c))return!0;if(d=d.Next,d==b)break}return!1},r.ClipperBase.prototype.SlopesEqual=r.ClipperBase.SlopesEqual=function(){var a,b,c,d=arguments,e=d.length;return 3==e?(e=d[0],a=d[1],(d=d[2])?F.op_Equality(F.Int128Mul(e.Delta.Y,a.Delta.X),F.Int128Mul(e.Delta.X,a.Delta.Y)):r.Cast_Int64(e.Delta.Y*a.Delta.X)==r.Cast_Int64(e.Delta.X*a.Delta.Y)):4==e?(e=d[0],a=d[1],b=d[2],(d=d[3])?F.op_Equality(F.Int128Mul(e.Y-a.Y,a.X-b.X),F.Int128Mul(e.X-a.X,a.Y-b.Y)):0===r.Cast_Int64((e.Y-a.Y)*(a.X-b.X))-r.Cast_Int64((e.X-a.X)*(a.Y-b.Y))):(e=d[0],a=d[1],b=d[2],c=d[3],(d=d[4])?F.op_Equality(F.Int128Mul(e.Y-a.Y,b.X-c.X),F.Int128Mul(e.X-a.X,b.Y-c.Y)):0===r.Cast_Int64((e.Y-a.Y)*(b.X-c.X))-r.Cast_Int64((e.X-a.X)*(b.Y-c.Y)))},r.ClipperBase.SlopesEqual3=function(a,b,c){return c?F.op_Equality(F.Int128Mul(a.Delta.Y,b.Delta.X),F.Int128Mul(a.Delta.X,b.Delta.Y)):r.Cast_Int64(a.Delta.Y*b.Delta.X)==r.Cast_Int64(a.Delta.X*b.Delta.Y)},r.ClipperBase.SlopesEqual4=function(a,b,c,d){return d?F.op_Equality(F.Int128Mul(a.Y-b.Y,b.X-c.X),F.Int128Mul(a.X-b.X,b.Y-c.Y)):0===r.Cast_Int64((a.Y-b.Y)*(b.X-c.X))-r.Cast_Int64((a.X-b.X)*(b.Y-c.Y))},r.ClipperBase.SlopesEqual5=function(a,b,c,d,e){return e?F.op_Equality(F.Int128Mul(a.Y-b.Y,c.X-d.X),F.Int128Mul(a.X-b.X,c.Y-d.Y)):0===r.Cast_Int64((a.Y-b.Y)*(c.X-d.X))-r.Cast_Int64((a.X-b.X)*(c.Y-d.Y))},r.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var a=0,b=this.m_edges.length;b>a;++a){for(var c=0,d=this.m_edges[a].length;d>c;++c)this.m_edges[a][c]=null;r.Clear(this.m_edges[a])}r.Clear(this.m_edges),this.m_HasOpenPaths=this.m_UseFullRange=!1},r.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var a=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=a}this.m_CurrentLM=null},r.ClipperBase.prototype.RangeTest=function(a,b){b.Value?(a.X>r.ClipperBase.hiRange||a.Y>r.ClipperBase.hiRange||-a.X>r.ClipperBase.hiRange||-a.Y>r.ClipperBase.hiRange)&&r.Error("Coordinate outside allowed range in RangeTest()."):(a.X>r.ClipperBase.loRange||a.Y>r.ClipperBase.loRange||-a.X>r.ClipperBase.loRange||-a.Y>r.ClipperBase.loRange)&&(b.Value=!0,this.RangeTest(a,b))},r.ClipperBase.prototype.InitEdge=function(a,b,c,d){a.Next=b,a.Prev=c,a.Curr.X=d.X,a.Curr.Y=d.Y,a.OutIdx=-1},r.ClipperBase.prototype.InitEdge2=function(a,b){a.Curr.Y>=a.Next.Curr.Y?(a.Bot.X=a.Curr.X,a.Bot.Y=a.Curr.Y,a.Top.X=a.Next.Curr.X,a.Top.Y=a.Next.Curr.Y):(a.Top.X=a.Curr.X,a.Top.Y=a.Curr.Y,a.Bot.X=a.Next.Curr.X,a.Bot.Y=a.Next.Curr.Y),this.SetDx(a),a.PolyTyp=b},r.ClipperBase.prototype.FindNextLocMin=function(a){for(var b;;){for(;r.IntPoint.op_Inequality(a.Bot,a.Prev.Bot)||r.IntPoint.op_Equality(a.Curr,a.Top);)a=a.Next;if(a.Dx!=r.ClipperBase.horizontal&&a.Prev.Dx!=r.ClipperBase.horizontal)break;for(;a.Prev.Dx==r.ClipperBase.horizontal;)a=a.Prev;for(b=a;a.Dx==r.ClipperBase.horizontal;)a=a.Next;if(a.Top.Y!=a.Prev.Bot.Y){b.Prev.Bot.X<a.Bot.X&&(a=b);break}}return a},r.ClipperBase.prototype.ProcessBound=function(a,b){var c,d=a,e=a;if(a.Dx==r.ClipperBase.horizontal&&(c=b?a.Prev.Bot.X:a.Next.Bot.X,a.Bot.X!=c&&this.ReverseHorizontal(a)),e.OutIdx!=r.ClipperBase.Skip)if(b){for(;e.Top.Y==e.Next.Bot.Y&&e.Next.OutIdx!=r.ClipperBase.Skip;)e=e.Next;if(e.Dx==r.ClipperBase.horizontal&&e.Next.OutIdx!=r.ClipperBase.Skip){for(c=e;c.Prev.Dx==r.ClipperBase.horizontal;)c=c.Prev;c.Prev.Top.X==e.Next.Top.X?b||(e=c.Prev):c.Prev.Top.X>e.Next.Top.X&&(e=c.Prev)}for(;a!=e;)a.NextInLML=a.Next,a.Dx==r.ClipperBase.horizontal&&a!=d&&a.Bot.X!=a.Prev.Top.X&&this.ReverseHorizontal(a),a=a.Next;a.Dx==r.ClipperBase.horizontal&&a!=d&&a.Bot.X!=a.Prev.Top.X&&this.ReverseHorizontal(a),e=e.Next}else{for(;e.Top.Y==e.Prev.Bot.Y&&e.Prev.OutIdx!=r.ClipperBase.Skip;)e=e.Prev;if(e.Dx==r.ClipperBase.horizontal&&e.Prev.OutIdx!=r.ClipperBase.Skip){for(c=e;c.Next.Dx==r.ClipperBase.horizontal;)c=c.Next;c.Next.Top.X==e.Prev.Top.X?b||(e=c.Next):c.Next.Top.X>e.Prev.Top.X&&(e=c.Next)}for(;a!=e;)a.NextInLML=a.Prev,a.Dx==r.ClipperBase.horizontal&&a!=d&&a.Bot.X!=a.Next.Top.X&&this.ReverseHorizontal(a),a=a.Prev;a.Dx==r.ClipperBase.horizontal&&a!=d&&a.Bot.X!=a.Next.Top.X&&this.ReverseHorizontal(a),e=e.Prev}if(e.OutIdx==r.ClipperBase.Skip){if(a=e,b){for(;a.Top.Y==a.Next.Bot.Y;)a=a.Next;for(;a!=e&&a.Dx==r.ClipperBase.horizontal;)a=a.Prev}else{for(;a.Top.Y==a.Prev.Bot.Y;)a=a.Prev;for(;a!=e&&a.Dx==r.ClipperBase.horizontal;)a=a.Next}a==e?e=b?a.Next:a.Prev:(a=b?e.Next:e.Prev,d=new r.LocalMinima,d.Next=null,d.Y=a.Bot.Y,d.LeftBound=null,d.RightBound=a,d.RightBound.WindDelta=0,e=this.ProcessBound(d.RightBound,b),this.InsertLocalMinima(d))}return e},r.ClipperBase.prototype.AddPath=function(a,b,c){c||b!=r.PolyType.ptClip||r.Error("AddPath: Open paths must be subject.");var d=a.length-1;if(c)for(;d>0&&r.IntPoint.op_Equality(a[d],a[0]);)--d;for(;d>0&&r.IntPoint.op_Equality(a[d],a[d-1]);)--d;if(c&&2>d||!c&&1>d)return!1;for(var e=[],f=0;d>=f;f++)e.push(new r.TEdge);var g=!0;e[1].Curr.X=a[1].X,e[1].Curr.Y=a[1].Y;var h={Value:this.m_UseFullRange};for(this.RangeTest(a[0],h),this.m_UseFullRange=h.Value,h.Value=this.m_UseFullRange,this.RangeTest(a[d],h),this.m_UseFullRange=h.Value,this.InitEdge(e[0],e[1],e[d],a[0]),this.InitEdge(e[d],e[0],e[d-1],a[d]),f=d-1;f>=1;--f)h.Value=this.m_UseFullRange,this.RangeTest(a[f],h),this.m_UseFullRange=h.Value,this.InitEdge(e[f],e[f+1],e[f-1],a[f]);for(f=a=d=e[0];;)if(r.IntPoint.op_Equality(a.Curr,a.Next.Curr)){if(a==a.Next)break;a==d&&(d=a.Next),f=a=this.RemoveEdge(a)}else{if(a.Prev==a.Next)break;if(c&&r.ClipperBase.SlopesEqual(a.Prev.Curr,a.Curr,a.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(a.Prev.Curr,a.Curr,a.Next.Curr))){a==d&&(d=a.Next),a=this.RemoveEdge(a),f=a=a.Prev;continue}if(a=a.Next,a==f)break}if(!c&&a==a.Next||c&&a.Prev==a.Next)return!1;c||(this.m_HasOpenPaths=!0,d.Prev.OutIdx=r.ClipperBase.Skip),a=d;do this.InitEdge2(a,b),a=a.Next,g&&a.Curr.Y!=d.Curr.Y&&(g=!1);while(a!=d);if(g){if(c)return!1;for(a.Prev.OutIdx=r.ClipperBase.Skip,a.Prev.Bot.X<a.Prev.Top.X&&this.ReverseHorizontal(a.Prev),b=new r.LocalMinima,b.Next=null,b.Y=a.Bot.Y,b.LeftBound=null,b.RightBound=a,b.RightBound.Side=r.EdgeSide.esRight,b.RightBound.WindDelta=0;a.Next.OutIdx!=r.ClipperBase.Skip;)a.NextInLML=a.Next,a.Bot.X!=a.Prev.Top.X&&this.ReverseHorizontal(a),a=a.Next;return this.InsertLocalMinima(b),this.m_edges.push(e),!0}for(this.m_edges.push(e),g=null;a=this.FindNextLocMin(a),a!=g;)null==g&&(g=a),b=new r.LocalMinima,b.Next=null,b.Y=a.Bot.Y,a.Dx<a.Prev.Dx?(b.LeftBound=a.Prev,b.RightBound=a,e=!1):(b.LeftBound=a,b.RightBound=a.Prev,e=!0),b.LeftBound.Side=r.EdgeSide.esLeft,b.RightBound.Side=r.EdgeSide.esRight,b.LeftBound.WindDelta=c?b.LeftBound.Next==b.RightBound?-1:1:0,b.RightBound.WindDelta=-b.LeftBound.WindDelta,a=this.ProcessBound(b.LeftBound,e),d=this.ProcessBound(b.RightBound,!e),b.LeftBound.OutIdx==r.ClipperBase.Skip?b.LeftBound=null:b.RightBound.OutIdx==r.ClipperBase.Skip&&(b.RightBound=null),this.InsertLocalMinima(b),e||(a=d);return!0},r.ClipperBase.prototype.AddPaths=function(a,b,c){for(var d=!1,e=0,f=a.length;f>e;++e)this.AddPath(a[e],b,c)&&(d=!0);return d},r.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(a,b,c){return r.IntPoint.op_Equality(a,c)||r.IntPoint.op_Equality(a,b)||r.IntPoint.op_Equality(c,b)?!1:a.X!=c.X?b.X>a.X==b.X<c.X:b.Y>a.Y==b.Y<c.Y},r.ClipperBase.prototype.RemoveEdge=function(a){a.Prev.Next=a.Next,a.Next.Prev=a.Prev;var b=a.Next;return a.Prev=null,b},r.ClipperBase.prototype.SetDx=function(a){a.Delta.X=a.Top.X-a.Bot.X,a.Delta.Y=a.Top.Y-a.Bot.Y,a.Dx=0===a.Delta.Y?r.ClipperBase.horizontal:a.Delta.X/a.Delta.Y},r.ClipperBase.prototype.InsertLocalMinima=function(a){if(null===this.m_MinimaList)this.m_MinimaList=a;else if(a.Y>=this.m_MinimaList.Y)a.Next=this.m_MinimaList,this.m_MinimaList=a;else{for(var b=this.m_MinimaList;null!==b.Next&&a.Y<b.Next.Y;)b=b.Next;a.Next=b.Next,b.Next=a}},r.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)},r.ClipperBase.prototype.ReverseHorizontal=function(a){var b=a.Top.X;a.Top.X=a.Bot.X,a.Bot.X=b},r.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!=this.m_CurrentLM)for(var a=this.m_MinimaList;null!=a;){var b=a.LeftBound;null!=b&&(b.Curr.X=b.Bot.X,b.Curr.Y=b.Bot.Y,b.Side=r.EdgeSide.esLeft,b.OutIdx=r.ClipperBase.Unassigned),b=a.RightBound,null!=b&&(b.Curr.X=b.Bot.X,b.Curr.Y=b.Bot.Y,b.Side=r.EdgeSide.esRight,b.OutIdx=r.ClipperBase.Unassigned),a=a.Next}},r.Clipper=function(a){"undefined"==typeof a&&(a=0),this.m_PolyOuts=null,this.m_ClipType=r.ClipType.ctIntersection,this.m_IntersectNodeComparer=this.m_IntersectList=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null,this.m_ExecuteLocked=!1,this.m_SubjFillType=this.m_ClipFillType=r.PolyFillType.pftEvenOdd,this.m_GhostJoins=this.m_Joins=null,this.StrictlySimple=this.ReverseSolution=this.m_UsingPolyTree=!1,r.ClipperBase.call(this),this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null,this.m_IntersectList=[],this.m_IntersectNodeComparer=r.MyIntersectNodeSort.Compare,this.m_UsingPolyTree=this.m_ExecuteLocked=!1,this.m_PolyOuts=[],this.m_Joins=[],this.m_GhostJoins=[],this.ReverseSolution=0!==(1&a),this.StrictlySimple=0!==(2&a),this.PreserveCollinear=0!==(4&a)},r.Clipper.ioReverseSolution=1,r.Clipper.ioStrictlySimple=2,r.Clipper.ioPreserveCollinear=4,r.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),r.ClipperBase.prototype.Clear.call(this))},r.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var a=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=a}},r.Clipper.prototype.Reset=function(){r.ClipperBase.prototype.Reset.call(this),this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;for(var a=this.m_MinimaList;null!==a;)this.InsertScanbeam(a.Y),a=a.Next},r.Clipper.prototype.InsertScanbeam=function(a){if(null===this.m_Scanbeam)this.m_Scanbeam=new r.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=a;else if(a>this.m_Scanbeam.Y){var b=new r.Scanbeam;b.Y=a,b.Next=this.m_Scanbeam,this.m_Scanbeam=b}else{for(var c=this.m_Scanbeam;null!==c.Next&&a<=c.Next.Y;)c=c.Next;a!=c.Y&&(b=new r.Scanbeam,b.Y=a,b.Next=c.Next,c.Next=b)}},r.Clipper.prototype.Execute=function(){var a=arguments,b=a.length,c=a[1]instanceof r.PolyTree;if(4==b&&!c){if(b=a[0],e=a[1],c=a[2],a=a[3],this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&r.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,r.Clear(e),this.m_SubjFillType=c,this.m_ClipFillType=a,this.m_ClipType=b,this.m_UsingPolyTree=!1;try{var d=this.ExecuteInternal();d&&this.BuildResult(e)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return d}if(4==b&&c){var b=a[0],e=a[1],c=a[2],a=a[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=c,this.m_ClipFillType=a,this.m_ClipType=b,this.m_UsingPolyTree=!0;try{(d=this.ExecuteInternal())&&this.BuildResult2(e)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return d}return 2==b&&!c||2==b&&c?(b=a[0],e=a[1],this.Execute(b,e,r.PolyFillType.pftEvenOdd,r.PolyFillType.pftEvenOdd)):void 0},r.Clipper.prototype.FixHoleLinkage=function(a){if(null!==a.FirstLeft&&(a.IsHole==a.FirstLeft.IsHole||null===a.FirstLeft.Pts)){for(var b=a.FirstLeft;null!==b&&(b.IsHole==a.IsHole||null===b.Pts);)b=b.FirstLeft;a.FirstLeft=b}},r.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),null===this.m_CurrentLM)return!1;var a=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(a),r.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),null===this.m_Scanbeam)break;var b=this.PopScanbeam();if(!this.ProcessIntersections(a,b))return!1;this.ProcessEdgesAtTopOfScanbeam(b),a=b}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);for(var a=0,c=this.m_PolyOuts.length;c>a;a++){var d=this.m_PolyOuts[a];null===d.Pts||d.IsOpen||(d.IsHole^this.ReverseSolution)==0<this.Area(d)&&this.ReversePolyPtLinks(d.Pts)}for(this.JoinCommonEdges(),a=0,c=this.m_PolyOuts.length;c>a;a++)d=this.m_PolyOuts[a],null===d.Pts||d.IsOpen||this.FixupOutPolygon(d);return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{r.Clear(this.m_Joins),r.Clear(this.m_GhostJoins)}},r.Clipper.prototype.PopScanbeam=function(){var a=this.m_Scanbeam.Y;return this.m_Scanbeam=this.m_Scanbeam.Next,a},r.Clipper.prototype.DisposeAllPolyPts=function(){for(var a=0,b=this.m_PolyOuts.length;b>a;++a)this.DisposeOutRec(a);r.Clear(this.m_PolyOuts)},r.Clipper.prototype.DisposeOutRec=function(a){var b=this.m_PolyOuts[a];null!==b.Pts&&this.DisposeOutPts(b.Pts),this.m_PolyOuts[a]=null},r.Clipper.prototype.DisposeOutPts=function(a){if(null!==a)for(a.Prev.Next=null;null!==a;)a=a.Next},r.Clipper.prototype.AddJoin=function(a,b,c){var d=new r.Join;d.OutPt1=a,d.OutPt2=b,d.OffPt.X=c.X,d.OffPt.Y=c.Y,this.m_Joins.push(d)},r.Clipper.prototype.AddGhostJoin=function(a,b){var c=new r.Join;c.OutPt1=a,c.OffPt.X=b.X,c.OffPt.Y=b.Y,this.m_GhostJoins.push(c)},r.Clipper.prototype.InsertLocalMinimaIntoAEL=function(a){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==a;){var b=this.m_CurrentLM.LeftBound,c=this.m_CurrentLM.RightBound;this.PopLocalMinima();var d=null;if(null===b?(this.InsertEdgeIntoAEL(c,null),this.SetWindingCount(c),this.IsContributing(c)&&(d=this.AddOutPt(c,c.Bot))):(null==c?(this.InsertEdgeIntoAEL(b,null),this.SetWindingCount(b),this.IsContributing(b)&&(d=this.AddOutPt(b,b.Bot))):(this.InsertEdgeIntoAEL(b,null),this.InsertEdgeIntoAEL(c,b),this.SetWindingCount(b),c.WindCnt=b.WindCnt,c.WindCnt2=b.WindCnt2,this.IsContributing(b)&&(d=this.AddLocalMinPoly(b,c,b.Bot))),this.InsertScanbeam(b.Top.Y)),null!=c&&(r.ClipperBase.IsHorizontal(c)?this.AddEdgeToSEL(c):this.InsertScanbeam(c.Top.Y)),null!=b&&null!=c){if(null!==d&&r.ClipperBase.IsHorizontal(c)&&0<this.m_GhostJoins.length&&0!==c.WindDelta)for(var e=0,f=this.m_GhostJoins.length;f>e;e++){var g=this.m_GhostJoins[e];this.HorzSegmentsOverlap(g.OutPt1.Pt,g.OffPt,c.Bot,c.Top)&&this.AddJoin(g.OutPt1,d,g.OffPt)}if(0<=b.OutIdx&&null!==b.PrevInAEL&&b.PrevInAEL.Curr.X==b.Bot.X&&0<=b.PrevInAEL.OutIdx&&r.ClipperBase.SlopesEqual(b.PrevInAEL,b,this.m_UseFullRange)&&0!==b.WindDelta&&0!==b.PrevInAEL.WindDelta&&(e=this.AddOutPt(b.PrevInAEL,b.Bot),this.AddJoin(d,e,b.Top)),b.NextInAEL!=c&&(0<=c.OutIdx&&0<=c.PrevInAEL.OutIdx&&r.ClipperBase.SlopesEqual(c.PrevInAEL,c,this.m_UseFullRange)&&0!==c.WindDelta&&0!==c.PrevInAEL.WindDelta&&(e=this.AddOutPt(c.PrevInAEL,c.Bot),this.AddJoin(d,e,c.Top)),d=b.NextInAEL,null!==d))for(;d!=c;)this.IntersectEdges(c,d,b.Curr,!1),d=d.NextInAEL}}},r.Clipper.prototype.InsertEdgeIntoAEL=function(a,b){if(null===this.m_ActiveEdges)a.PrevInAEL=null,a.NextInAEL=null,this.m_ActiveEdges=a;else if(null===b&&this.E2InsertsBeforeE1(this.m_ActiveEdges,a))a.PrevInAEL=null,a.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges=this.m_ActiveEdges.PrevInAEL=a;else{for(null===b&&(b=this.m_ActiveEdges);null!==b.NextInAEL&&!this.E2InsertsBeforeE1(b.NextInAEL,a);)b=b.NextInAEL;a.NextInAEL=b.NextInAEL,null!==b.NextInAEL&&(b.NextInAEL.PrevInAEL=a),a.PrevInAEL=b,b.NextInAEL=a}},r.Clipper.prototype.E2InsertsBeforeE1=function(a,b){return b.Curr.X==a.Curr.X?b.Top.Y>a.Top.Y?b.Top.X<r.Clipper.TopX(a,b.Top.Y):a.Top.X>r.Clipper.TopX(b,a.Top.Y):b.Curr.X<a.Curr.X},r.Clipper.prototype.IsEvenOddFillType=function(a){return a.PolyTyp==r.PolyType.ptSubject?this.m_SubjFillType==r.PolyFillType.pftEvenOdd:this.m_ClipFillType==r.PolyFillType.pftEvenOdd},r.Clipper.prototype.IsEvenOddAltFillType=function(a){return a.PolyTyp==r.PolyType.ptSubject?this.m_ClipFillType==r.PolyFillType.pftEvenOdd:this.m_SubjFillType==r.PolyFillType.pftEvenOdd},r.Clipper.prototype.IsContributing=function(a){var b,c;switch(a.PolyTyp==r.PolyType.ptSubject?(b=this.m_SubjFillType,c=this.m_ClipFillType):(b=this.m_ClipFillType,c=this.m_SubjFillType),b){case r.PolyFillType.pftEvenOdd:if(0===a.WindDelta&&1!=a.WindCnt)return!1;break;case r.PolyFillType.pftNonZero:if(1!=Math.abs(a.WindCnt))return!1;break;case r.PolyFillType.pftPositive:if(1!=a.WindCnt)return!1;break;default:if(-1!=a.WindCnt)return!1}switch(this.m_ClipType){case r.ClipType.ctIntersection:switch(c){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0!==a.WindCnt2;case r.PolyFillType.pftPositive:return 0<a.WindCnt2;default:return 0>a.WindCnt2}case r.ClipType.ctUnion:switch(c){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===a.WindCnt2;case r.PolyFillType.pftPositive:return 0>=a.WindCnt2;default:return 0<=a.WindCnt2}case r.ClipType.ctDifference:if(a.PolyTyp==r.PolyType.ptSubject)switch(c){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===a.WindCnt2;case r.PolyFillType.pftPositive:return 0>=a.WindCnt2;default:return 0<=a.WindCnt2}else switch(c){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0!==a.WindCnt2;case r.PolyFillType.pftPositive:return 0<a.WindCnt2;default:return 0>a.WindCnt2}case r.ClipType.ctXor:if(0===a.WindDelta)switch(c){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===a.WindCnt2;case r.PolyFillType.pftPositive:return 0>=a.WindCnt2;default:return 0<=a.WindCnt2}}return!0},r.Clipper.prototype.SetWindingCount=function(a){for(var b=a.PrevInAEL;null!==b&&(b.PolyTyp!=a.PolyTyp||0===b.WindDelta);)b=b.PrevInAEL;if(null===b)a.WindCnt=0===a.WindDelta?1:a.WindDelta,a.WindCnt2=0,b=this.m_ActiveEdges;else{if(0===a.WindDelta&&this.m_ClipType!=r.ClipType.ctUnion)a.WindCnt=1;else if(this.IsEvenOddFillType(a))if(0===a.WindDelta){for(var c=!0,d=b.PrevInAEL;null!==d;)d.PolyTyp==b.PolyTyp&&0!==d.WindDelta&&(c=!c),d=d.PrevInAEL;a.WindCnt=c?0:1}else a.WindCnt=a.WindDelta;else a.WindCnt=0>b.WindCnt*b.WindDelta?1<Math.abs(b.WindCnt)?0>b.WindDelta*a.WindDelta?b.WindCnt:b.WindCnt+a.WindDelta:0===a.WindDelta?1:a.WindDelta:0===a.WindDelta?0>b.WindCnt?b.WindCnt-1:b.WindCnt+1:0>b.WindDelta*a.WindDelta?b.WindCnt:b.WindCnt+a.WindDelta;a.WindCnt2=b.WindCnt2,b=b.NextInAEL}if(this.IsEvenOddAltFillType(a))for(;b!=a;)0!==b.WindDelta&&(a.WindCnt2=0===a.WindCnt2?1:0),b=b.NextInAEL;else for(;b!=a;)a.WindCnt2+=b.WindDelta,b=b.NextInAEL},r.Clipper.prototype.AddEdgeToSEL=function(a){null===this.m_SortedEdges?(this.m_SortedEdges=a,a.PrevInSEL=null,a.NextInSEL=null):(a.NextInSEL=this.m_SortedEdges,a.PrevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.PrevInSEL=a)},r.Clipper.prototype.CopyAELToSEL=function(){var a=this.m_ActiveEdges;for(this.m_SortedEdges=a;null!==a;)a.PrevInSEL=a.PrevInAEL,a=a.NextInSEL=a.NextInAEL},r.Clipper.prototype.SwapPositionsInAEL=function(a,b){if(a.NextInAEL!=a.PrevInAEL&&b.NextInAEL!=b.PrevInAEL){if(a.NextInAEL==b){var c=b.NextInAEL;null!==c&&(c.PrevInAEL=a);var d=a.PrevInAEL;null!==d&&(d.NextInAEL=b),b.PrevInAEL=d,b.NextInAEL=a,a.PrevInAEL=b,a.NextInAEL=c}else b.NextInAEL==a?(c=a.NextInAEL,null!==c&&(c.PrevInAEL=b),d=b.PrevInAEL,null!==d&&(d.NextInAEL=a),a.PrevInAEL=d,a.NextInAEL=b,b.PrevInAEL=a,b.NextInAEL=c):(c=a.NextInAEL,d=a.PrevInAEL,a.NextInAEL=b.NextInAEL,null!==a.NextInAEL&&(a.NextInAEL.PrevInAEL=a),a.PrevInAEL=b.PrevInAEL,null!==a.PrevInAEL&&(a.PrevInAEL.NextInAEL=a),b.NextInAEL=c,null!==b.NextInAEL&&(b.NextInAEL.PrevInAEL=b),b.PrevInAEL=d,null!==b.PrevInAEL&&(b.PrevInAEL.NextInAEL=b));null===a.PrevInAEL?this.m_ActiveEdges=a:null===b.PrevInAEL&&(this.m_ActiveEdges=b)}},r.Clipper.prototype.SwapPositionsInSEL=function(a,b){if(!(null===a.NextInSEL&&null===a.PrevInSEL||null===b.NextInSEL&&null===b.PrevInSEL)){if(a.NextInSEL==b){var c=b.NextInSEL;null!==c&&(c.PrevInSEL=a);var d=a.PrevInSEL;null!==d&&(d.NextInSEL=b),b.PrevInSEL=d,b.NextInSEL=a,a.PrevInSEL=b,a.NextInSEL=c}else b.NextInSEL==a?(c=a.NextInSEL,null!==c&&(c.PrevInSEL=b),d=b.PrevInSEL,null!==d&&(d.NextInSEL=a),a.PrevInSEL=d,a.NextInSEL=b,b.PrevInSEL=a,b.NextInSEL=c):(c=a.NextInSEL,d=a.PrevInSEL,a.NextInSEL=b.NextInSEL,null!==a.NextInSEL&&(a.NextInSEL.PrevInSEL=a),a.PrevInSEL=b.PrevInSEL,null!==a.PrevInSEL&&(a.PrevInSEL.NextInSEL=a),b.NextInSEL=c,null!==b.NextInSEL&&(b.NextInSEL.PrevInSEL=b),b.PrevInSEL=d,null!==b.PrevInSEL&&(b.PrevInSEL.NextInSEL=b));null===a.PrevInSEL?this.m_SortedEdges=a:null===b.PrevInSEL&&(this.m_SortedEdges=b)}},r.Clipper.prototype.AddLocalMaxPoly=function(a,b,c){this.AddOutPt(a,c),0==b.WindDelta&&this.AddOutPt(b,c),a.OutIdx==b.OutIdx?(a.OutIdx=-1,b.OutIdx=-1):a.OutIdx<b.OutIdx?this.AppendPolygon(a,b):this.AppendPolygon(b,a)},r.Clipper.prototype.AddLocalMinPoly=function(a,b,c){var d,e;return r.ClipperBase.IsHorizontal(b)||a.Dx>b.Dx?(d=this.AddOutPt(a,c),b.OutIdx=a.OutIdx,a.Side=r.EdgeSide.esLeft,b.Side=r.EdgeSide.esRight,e=a,a=e.PrevInAEL==b?b.PrevInAEL:e.PrevInAEL):(d=this.AddOutPt(b,c),a.OutIdx=b.OutIdx,a.Side=r.EdgeSide.esRight,b.Side=r.EdgeSide.esLeft,e=b,a=e.PrevInAEL==a?a.PrevInAEL:e.PrevInAEL),null!==a&&0<=a.OutIdx&&r.Clipper.TopX(a,c.Y)==r.Clipper.TopX(e,c.Y)&&r.ClipperBase.SlopesEqual(e,a,this.m_UseFullRange)&&0!==e.WindDelta&&0!==a.WindDelta&&(c=this.AddOutPt(a,c),this.AddJoin(d,c,e.Top)),d},r.Clipper.prototype.CreateOutRec=function(){var a=new r.OutRec;return a.Idx=-1,a.IsHole=!1,a.IsOpen=!1,a.FirstLeft=null,a.Pts=null,a.BottomPt=null,a.PolyNode=null,this.m_PolyOuts.push(a),a.Idx=this.m_PolyOuts.length-1,a},r.Clipper.prototype.AddOutPt=function(a,b){var c=a.Side==r.EdgeSide.esLeft;if(0>a.OutIdx){var d=this.CreateOutRec();d.IsOpen=0===a.WindDelta;var e=new r.OutPt;d.Pts=e,e.Idx=d.Idx,e.Pt.X=b.X,e.Pt.Y=b.Y,e.Next=e,e.Prev=e,d.IsOpen||this.SetHoleState(a,d),a.OutIdx=d.Idx}else{var d=this.m_PolyOuts[a.OutIdx],f=d.Pts;if(c&&r.IntPoint.op_Equality(b,f.Pt))return f;if(!c&&r.IntPoint.op_Equality(b,f.Prev.Pt))return f.Prev;e=new r.OutPt,e.Idx=d.Idx,e.Pt.X=b.X,e.Pt.Y=b.Y,e.Next=f,e.Prev=f.Prev,e.Prev.Next=e,f.Prev=e,c&&(d.Pts=e)}return e},r.Clipper.prototype.SwapPoints=function(a,b){var c=new r.IntPoint(a.Value);a.Value.X=b.Value.X,a.Value.Y=b.Value.Y,b.Value.X=c.X,b.Value.Y=c.Y},r.Clipper.prototype.HorzSegmentsOverlap=function(a,b,c,d){return a.X>c.X==a.X<d.X?!0:b.X>c.X==b.X<d.X?!0:c.X>a.X==c.X<b.X?!0:d.X>a.X==d.X<b.X?!0:a.X==c.X&&b.X==d.X?!0:a.X==d.X&&b.X==c.X?!0:!1},r.Clipper.prototype.InsertPolyPtBetween=function(a,b,c){var d=new r.OutPt;return d.Pt.X=c.X,d.Pt.Y=c.Y,b==a.Next?(a.Next=d,b.Prev=d,d.Next=b,d.Prev=a):(b.Next=d,a.Prev=d,d.Next=a,d.Prev=b),d},r.Clipper.prototype.SetHoleState=function(a,b){for(var c=!1,d=a.PrevInAEL;null!==d;)0<=d.OutIdx&&0!=d.WindDelta&&(c=!c,null===b.FirstLeft&&(b.FirstLeft=this.m_PolyOuts[d.OutIdx])),d=d.PrevInAEL;c&&(b.IsHole=!0)},r.Clipper.prototype.GetDx=function(a,b){return a.Y==b.Y?r.ClipperBase.horizontal:(b.X-a.X)/(b.Y-a.Y)},r.Clipper.prototype.FirstIsBottomPt=function(a,b){for(var c=a.Prev;r.IntPoint.op_Equality(c.Pt,a.Pt)&&c!=a;)c=c.Prev;for(var d=Math.abs(this.GetDx(a.Pt,c.Pt)),c=a.Next;r.IntPoint.op_Equality(c.Pt,a.Pt)&&c!=a;)c=c.Next;for(var e=Math.abs(this.GetDx(a.Pt,c.Pt)),c=b.Prev;r.IntPoint.op_Equality(c.Pt,b.Pt)&&c!=b;)c=c.Prev;for(var f=Math.abs(this.GetDx(b.Pt,c.Pt)),c=b.Next;r.IntPoint.op_Equality(c.Pt,b.Pt)&&c!=b;)c=c.Next;return c=Math.abs(this.GetDx(b.Pt,c.Pt)),d>=f&&d>=c||e>=f&&e>=c},r.Clipper.prototype.GetBottomPt=function(a){for(var b=null,c=a.Next;c!=a;)c.Pt.Y>a.Pt.Y?(a=c,b=null):c.Pt.Y==a.Pt.Y&&c.Pt.X<=a.Pt.X&&(c.Pt.X<a.Pt.X?(b=null,a=c):c.Next!=a&&c.Prev!=a&&(b=c)),c=c.Next;if(null!==b)for(;b!=c;)for(this.FirstIsBottomPt(c,b)||(a=b),b=b.Next;r.IntPoint.op_Inequality(b.Pt,a.Pt);)b=b.Next;return a},r.Clipper.prototype.GetLowermostRec=function(a,b){null===a.BottomPt&&(a.BottomPt=this.GetBottomPt(a.Pts)),null===b.BottomPt&&(b.BottomPt=this.GetBottomPt(b.Pts));var c=a.BottomPt,d=b.BottomPt;return c.Pt.Y>d.Pt.Y?a:c.Pt.Y<d.Pt.Y?b:c.Pt.X<d.Pt.X?a:c.Pt.X>d.Pt.X?b:c.Next==c?b:d.Next==d?a:this.FirstIsBottomPt(c,d)?a:b},r.Clipper.prototype.Param1RightOfParam2=function(a,b){do if(a=a.FirstLeft,a==b)return!0;while(null!==a);return!1},r.Clipper.prototype.GetOutRec=function(a){for(a=this.m_PolyOuts[a];a!=this.m_PolyOuts[a.Idx];)a=this.m_PolyOuts[a.Idx];return a},r.Clipper.prototype.AppendPolygon=function(a,b){var c,d=this.m_PolyOuts[a.OutIdx],e=this.m_PolyOuts[b.OutIdx];c=this.Param1RightOfParam2(d,e)?e:this.Param1RightOfParam2(e,d)?d:this.GetLowermostRec(d,e);var f=d.Pts,g=f.Prev,h=e.Pts,i=h.Prev;for(a.Side==r.EdgeSide.esLeft?(b.Side==r.EdgeSide.esLeft?(this.ReversePolyPtLinks(h),h.Next=f,f.Prev=h,g.Next=i,i.Prev=g,d.Pts=i):(i.Next=f,f.Prev=i,h.Prev=g,g.Next=h,d.Pts=h),f=r.EdgeSide.esLeft):(b.Side==r.EdgeSide.esRight?(this.ReversePolyPtLinks(h),g.Next=i,i.Prev=g,h.Next=f,f.Prev=h):(g.Next=h,h.Prev=g,f.Prev=i,i.Next=f),f=r.EdgeSide.esRight),d.BottomPt=null,c==e&&(e.FirstLeft!=d&&(d.FirstLeft=e.FirstLeft),d.IsHole=e.IsHole),e.Pts=null,e.BottomPt=null,e.FirstLeft=d,c=a.OutIdx,g=b.OutIdx,a.OutIdx=-1,b.OutIdx=-1,h=this.m_ActiveEdges;null!==h;){if(h.OutIdx==g){h.OutIdx=c,h.Side=f;break}h=h.NextInAEL}e.Idx=d.Idx},r.Clipper.prototype.ReversePolyPtLinks=function(a){if(null!==a){var b,c;b=a;do c=b.Next,b.Next=b.Prev,b=b.Prev=c;while(b!=a)}},r.Clipper.SwapSides=function(a,b){var c=a.Side;a.Side=b.Side,b.Side=c},r.Clipper.SwapPolyIndexes=function(a,b){var c=a.OutIdx;a.OutIdx=b.OutIdx,b.OutIdx=c},r.Clipper.prototype.IntersectEdges=function(a,b,c,d){var e=!d&&null===a.NextInLML&&a.Top.X==c.X&&a.Top.Y==c.Y;d=!d&&null===b.NextInLML&&b.Top.X==c.X&&b.Top.Y==c.Y;var f=0<=a.OutIdx,g=0<=b.OutIdx;if(0===a.WindDelta||0===b.WindDelta)0===a.WindDelta&&0===b.WindDelta?(e||d)&&f&&g&&this.AddLocalMaxPoly(a,b,c):a.PolyTyp==b.PolyTyp&&a.WindDelta!=b.WindDelta&&this.m_ClipType==r.ClipType.ctUnion?0===a.WindDelta?g&&(this.AddOutPt(a,c),f&&(a.OutIdx=-1)):f&&(this.AddOutPt(b,c),g&&(b.OutIdx=-1)):a.PolyTyp!=b.PolyTyp&&(0!==a.WindDelta||1!=Math.abs(b.WindCnt)||this.m_ClipType==r.ClipType.ctUnion&&0!==b.WindCnt2?0!==b.WindDelta||1!=Math.abs(a.WindCnt)||this.m_ClipType==r.ClipType.ctUnion&&0!==a.WindCnt2||(this.AddOutPt(b,c),g&&(b.OutIdx=-1)):(this.AddOutPt(a,c),f&&(a.OutIdx=-1))),e&&(0>a.OutIdx?this.DeleteFromAEL(a):r.Error("Error intersecting polylines")),d&&(0>b.OutIdx?this.DeleteFromAEL(b):r.Error("Error intersecting polylines"));else{if(a.PolyTyp==b.PolyTyp)if(this.IsEvenOddFillType(a)){var h=a.WindCnt;a.WindCnt=b.WindCnt,b.WindCnt=h}else a.WindCnt=0===a.WindCnt+b.WindDelta?-a.WindCnt:a.WindCnt+b.WindDelta,b.WindCnt=0===b.WindCnt-a.WindDelta?-b.WindCnt:b.WindCnt-a.WindDelta;else this.IsEvenOddFillType(b)?a.WindCnt2=0===a.WindCnt2?1:0:a.WindCnt2+=b.WindDelta,this.IsEvenOddFillType(a)?b.WindCnt2=0===b.WindCnt2?1:0:b.WindCnt2-=a.WindDelta;var i,j,k;switch(a.PolyTyp==r.PolyType.ptSubject?(i=this.m_SubjFillType,k=this.m_ClipFillType):(i=this.m_ClipFillType,k=this.m_SubjFillType),b.PolyTyp==r.PolyType.ptSubject?(j=this.m_SubjFillType,h=this.m_ClipFillType):(j=this.m_ClipFillType,h=this.m_SubjFillType),i){case r.PolyFillType.pftPositive:i=a.WindCnt;break;case r.PolyFillType.pftNegative:i=-a.WindCnt;break;default:i=Math.abs(a.WindCnt)}switch(j){case r.PolyFillType.pftPositive:j=b.WindCnt;break;case r.PolyFillType.pftNegative:j=-b.WindCnt;
break;default:j=Math.abs(b.WindCnt)}if(f&&g)e||d||0!==i&&1!=i||0!==j&&1!=j||a.PolyTyp!=b.PolyTyp&&this.m_ClipType!=r.ClipType.ctXor?this.AddLocalMaxPoly(a,b,c):(this.AddOutPt(a,c),this.AddOutPt(b,c),r.Clipper.SwapSides(a,b),r.Clipper.SwapPolyIndexes(a,b));else if(f)(0===j||1==j)&&(this.AddOutPt(a,c),r.Clipper.SwapSides(a,b),r.Clipper.SwapPolyIndexes(a,b));else if(g)(0===i||1==i)&&(this.AddOutPt(b,c),r.Clipper.SwapSides(a,b),r.Clipper.SwapPolyIndexes(a,b));else if(!(0!==i&&1!=i||0!==j&&1!=j||e||d)){switch(k){case r.PolyFillType.pftPositive:f=a.WindCnt2;break;case r.PolyFillType.pftNegative:f=-a.WindCnt2;break;default:f=Math.abs(a.WindCnt2)}switch(h){case r.PolyFillType.pftPositive:g=b.WindCnt2;break;case r.PolyFillType.pftNegative:g=-b.WindCnt2;break;default:g=Math.abs(b.WindCnt2)}if(a.PolyTyp!=b.PolyTyp)this.AddLocalMinPoly(a,b,c);else if(1==i&&1==j)switch(this.m_ClipType){case r.ClipType.ctIntersection:f>0&&g>0&&this.AddLocalMinPoly(a,b,c);break;case r.ClipType.ctUnion:0>=f&&0>=g&&this.AddLocalMinPoly(a,b,c);break;case r.ClipType.ctDifference:(a.PolyTyp==r.PolyType.ptClip&&f>0&&g>0||a.PolyTyp==r.PolyType.ptSubject&&0>=f&&0>=g)&&this.AddLocalMinPoly(a,b,c);break;case r.ClipType.ctXor:this.AddLocalMinPoly(a,b,c)}else r.Clipper.SwapSides(a,b)}e!=d&&(e&&0<=a.OutIdx||d&&0<=b.OutIdx)&&(r.Clipper.SwapSides(a,b),r.Clipper.SwapPolyIndexes(a,b)),e&&this.DeleteFromAEL(a),d&&this.DeleteFromAEL(b)}},r.Clipper.prototype.DeleteFromAEL=function(a){var b=a.PrevInAEL,c=a.NextInAEL;(null!==b||null!==c||a==this.m_ActiveEdges)&&(null!==b?b.NextInAEL=c:this.m_ActiveEdges=c,null!==c&&(c.PrevInAEL=b),a.NextInAEL=null,a.PrevInAEL=null)},r.Clipper.prototype.DeleteFromSEL=function(a){var b=a.PrevInSEL,c=a.NextInSEL;(null!==b||null!==c||a==this.m_SortedEdges)&&(null!==b?b.NextInSEL=c:this.m_SortedEdges=c,null!==c&&(c.PrevInSEL=b),a.NextInSEL=null,a.PrevInSEL=null)},r.Clipper.prototype.UpdateEdgeIntoAEL=function(a){null===a.NextInLML&&r.Error("UpdateEdgeIntoAEL: invalid call");var b=a.PrevInAEL,c=a.NextInAEL;return a.NextInLML.OutIdx=a.OutIdx,null!==b?b.NextInAEL=a.NextInLML:this.m_ActiveEdges=a.NextInLML,null!==c&&(c.PrevInAEL=a.NextInLML),a.NextInLML.Side=a.Side,a.NextInLML.WindDelta=a.WindDelta,a.NextInLML.WindCnt=a.WindCnt,a.NextInLML.WindCnt2=a.WindCnt2,a=a.NextInLML,a.Curr.X=a.Bot.X,a.Curr.Y=a.Bot.Y,a.PrevInAEL=b,a.NextInAEL=c,r.ClipperBase.IsHorizontal(a)||this.InsertScanbeam(a.Top.Y),a},r.Clipper.prototype.ProcessHorizontals=function(a){for(var b=this.m_SortedEdges;null!==b;)this.DeleteFromSEL(b),this.ProcessHorizontal(b,a),b=this.m_SortedEdges},r.Clipper.prototype.GetHorzDirection=function(a,b){a.Bot.X<a.Top.X?(b.Left=a.Bot.X,b.Right=a.Top.X,b.Dir=r.Direction.dLeftToRight):(b.Left=a.Top.X,b.Right=a.Bot.X,b.Dir=r.Direction.dRightToLeft)},r.Clipper.prototype.PrepareHorzJoins=function(a,b){var c=this.m_PolyOuts[a.OutIdx].Pts;a.Side!=r.EdgeSide.esLeft&&(c=c.Prev),b&&(r.IntPoint.op_Equality(c.Pt,a.Top)?this.AddGhostJoin(c,a.Bot):this.AddGhostJoin(c,a.Top))},r.Clipper.prototype.ProcessHorizontal=function(a,b){var c={Dir:null,Left:null,Right:null};this.GetHorzDirection(a,c);for(var d=c.Dir,e=c.Left,f=c.Right,g=a,h=null;null!==g.NextInLML&&r.ClipperBase.IsHorizontal(g.NextInLML);)g=g.NextInLML;for(null===g.NextInLML&&(h=this.GetMaximaPair(g));;){for(var i=a==g,j=this.GetNextInAEL(a,d);null!==j&&!(j.Curr.X==a.Top.X&&null!==a.NextInLML&&j.Dx<a.NextInLML.Dx);){if(c=this.GetNextInAEL(j,d),d==r.Direction.dLeftToRight&&j.Curr.X<=f||d==r.Direction.dRightToLeft&&j.Curr.X>=e){if(0<=a.OutIdx&&0!=a.WindDelta&&this.PrepareHorzJoins(a,b),j==h&&i)return d==r.Direction.dLeftToRight?this.IntersectEdges(a,j,j.Top,!1):this.IntersectEdges(j,a,j.Top,!1),void(0<=h.OutIdx&&r.Error("ProcessHorizontal error"));if(d==r.Direction.dLeftToRight){var k=new r.IntPoint(j.Curr.X,a.Curr.Y);this.IntersectEdges(a,j,k,!0)}else k=new r.IntPoint(j.Curr.X,a.Curr.Y),this.IntersectEdges(j,a,k,!0);this.SwapPositionsInAEL(a,j)}else if(d==r.Direction.dLeftToRight&&j.Curr.X>=f||d==r.Direction.dRightToLeft&&j.Curr.X<=e)break;j=c}if(0<=a.OutIdx&&0!==a.WindDelta&&this.PrepareHorzJoins(a,b),null===a.NextInLML||!r.ClipperBase.IsHorizontal(a.NextInLML))break;a=this.UpdateEdgeIntoAEL(a),0<=a.OutIdx&&this.AddOutPt(a,a.Bot),c={Dir:d,Left:e,Right:f},this.GetHorzDirection(a,c),d=c.Dir,e=c.Left,f=c.Right}null!==a.NextInLML?0<=a.OutIdx?(d=this.AddOutPt(a,a.Top),a=this.UpdateEdgeIntoAEL(a),0!==a.WindDelta&&(e=a.PrevInAEL,c=a.NextInAEL,null!==e&&e.Curr.X==a.Bot.X&&e.Curr.Y==a.Bot.Y&&0!==e.WindDelta&&0<=e.OutIdx&&e.Curr.Y>e.Top.Y&&r.ClipperBase.SlopesEqual(a,e,this.m_UseFullRange)?(c=this.AddOutPt(e,a.Bot),this.AddJoin(d,c,a.Top)):null!==c&&c.Curr.X==a.Bot.X&&c.Curr.Y==a.Bot.Y&&0!==c.WindDelta&&0<=c.OutIdx&&c.Curr.Y>c.Top.Y&&r.ClipperBase.SlopesEqual(a,c,this.m_UseFullRange)&&(c=this.AddOutPt(c,a.Bot),this.AddJoin(d,c,a.Top)))):this.UpdateEdgeIntoAEL(a):null!==h?0<=h.OutIdx?(d==r.Direction.dLeftToRight?this.IntersectEdges(a,h,a.Top,!1):this.IntersectEdges(h,a,a.Top,!1),0<=h.OutIdx&&r.Error("ProcessHorizontal error")):(this.DeleteFromAEL(a),this.DeleteFromAEL(h)):(0<=a.OutIdx&&this.AddOutPt(a,a.Top),this.DeleteFromAEL(a))},r.Clipper.prototype.GetNextInAEL=function(a,b){return b==r.Direction.dLeftToRight?a.NextInAEL:a.PrevInAEL},r.Clipper.prototype.IsMinima=function(a){return null!==a&&a.Prev.NextInLML!=a&&a.Next.NextInLML!=a},r.Clipper.prototype.IsMaxima=function(a,b){return null!==a&&a.Top.Y==b&&null===a.NextInLML},r.Clipper.prototype.IsIntermediate=function(a,b){return a.Top.Y==b&&null!==a.NextInLML},r.Clipper.prototype.GetMaximaPair=function(a){var b=null;return r.IntPoint.op_Equality(a.Next.Top,a.Top)&&null===a.Next.NextInLML?b=a.Next:r.IntPoint.op_Equality(a.Prev.Top,a.Top)&&null===a.Prev.NextInLML&&(b=a.Prev),null===b||-2!=b.OutIdx&&(b.NextInAEL!=b.PrevInAEL||r.ClipperBase.IsHorizontal(b))?b:null},r.Clipper.prototype.ProcessIntersections=function(a,b){if(null==this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(a,b),0==this.m_IntersectList.length)return!0;if(1!=this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch(c){this.m_SortedEdges=null,this.m_IntersectList.length=0,r.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},r.Clipper.prototype.BuildIntersectList=function(a,b){if(null!==this.m_ActiveEdges){var c=this.m_ActiveEdges;for(this.m_SortedEdges=c;null!==c;)c.PrevInSEL=c.PrevInAEL,c.NextInSEL=c.NextInAEL,c.Curr.X=r.Clipper.TopX(c,b),c=c.NextInAEL;for(var d=!0;d&&null!==this.m_SortedEdges;){for(d=!1,c=this.m_SortedEdges;null!==c.NextInSEL;){var e=c.NextInSEL,f=new r.IntPoint;c.Curr.X>e.Curr.X?(!this.IntersectPoint(c,e,f)&&c.Curr.X>e.Curr.X+1&&r.Error("Intersection error"),f.Y>a&&(f.Y=a,f.X=Math.abs(c.Dx)>Math.abs(e.Dx)?r.Clipper.TopX(e,a):r.Clipper.TopX(c,a)),d=new r.IntersectNode,d.Edge1=c,d.Edge2=e,d.Pt.X=f.X,d.Pt.Y=f.Y,this.m_IntersectList.push(d),this.SwapPositionsInSEL(c,e),d=!0):c=e}if(null===c.PrevInSEL)break;c.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},r.Clipper.prototype.EdgesAdjacent=function(a){return a.Edge1.NextInSEL==a.Edge2||a.Edge1.PrevInSEL==a.Edge2},r.Clipper.IntersectNodeSort=function(a,b){return b.Pt.Y-a.Pt.Y},r.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var a=this.m_IntersectList.length,b=0;a>b;b++){if(!this.EdgesAdjacent(this.m_IntersectList[b])){for(var c=b+1;a>c&&!this.EdgesAdjacent(this.m_IntersectList[c]);)c++;if(c==a)return!1;var d=this.m_IntersectList[b];this.m_IntersectList[b]=this.m_IntersectList[c],this.m_IntersectList[c]=d}this.SwapPositionsInSEL(this.m_IntersectList[b].Edge1,this.m_IntersectList[b].Edge2)}return!0},r.Clipper.prototype.ProcessIntersectList=function(){for(var a=0,b=this.m_IntersectList.length;b>a;a++){var c=this.m_IntersectList[a];this.IntersectEdges(c.Edge1,c.Edge2,c.Pt,!0),this.SwapPositionsInAEL(c.Edge1,c.Edge2)}this.m_IntersectList.length=0},v=function(a){return 0>a?Math.ceil(a-.5):Math.round(a)},x=function(a){return 0>a?Math.ceil(a-.5):Math.floor(a+.5)},y=function(a){return 0>a?-Math.round(Math.abs(a)):Math.round(a)},z=function(a){return 0>a?(a-=.5,-2147483648>a?Math.ceil(a):0|a):(a+=.5,a>2147483647?Math.floor(a):0|a)},r.Clipper.Round=u?v:s?y:w?z:x,r.Clipper.TopX=function(a,b){return b==a.Top.Y?a.Top.X:a.Bot.X+r.Clipper.Round(a.Dx*(b-a.Bot.Y))},r.Clipper.prototype.IntersectPoint=function(a,b,c){c.X=0,c.Y=0;var d,e;if(r.ClipperBase.SlopesEqual(a,b,this.m_UseFullRange)||a.Dx==b.Dx)return b.Bot.Y>a.Bot.Y?(c.X=b.Bot.X,c.Y=b.Bot.Y):(c.X=a.Bot.X,c.Y=a.Bot.Y),!1;if(0===a.Delta.X)c.X=a.Bot.X,r.ClipperBase.IsHorizontal(b)?c.Y=b.Bot.Y:(e=b.Bot.Y-b.Bot.X/b.Dx,c.Y=r.Clipper.Round(c.X/b.Dx+e));else if(0===b.Delta.X)c.X=b.Bot.X,r.ClipperBase.IsHorizontal(a)?c.Y=a.Bot.Y:(d=a.Bot.Y-a.Bot.X/a.Dx,c.Y=r.Clipper.Round(c.X/a.Dx+d));else{d=a.Bot.X-a.Bot.Y*a.Dx,e=b.Bot.X-b.Bot.Y*b.Dx;var f=(e-d)/(a.Dx-b.Dx);c.Y=r.Clipper.Round(f),c.X=r.Clipper.Round(Math.abs(a.Dx)<Math.abs(b.Dx)?a.Dx*f+d:b.Dx*f+e)}if(c.Y<a.Top.Y||c.Y<b.Top.Y){if(a.Top.Y>b.Top.Y)return c.Y=a.Top.Y,c.X=r.Clipper.TopX(b,a.Top.Y),c.X<a.Top.X;c.Y=b.Top.Y,c.X=Math.abs(a.Dx)<Math.abs(b.Dx)?r.Clipper.TopX(a,c.Y):r.Clipper.TopX(b,c.Y)}return!0},r.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(a){for(var b=this.m_ActiveEdges;null!==b;){var c=this.IsMaxima(b,a);if(c&&(c=this.GetMaximaPair(b),c=null===c||!r.ClipperBase.IsHorizontal(c)),c){var d=b.PrevInAEL;this.DoMaxima(b),b=null===d?this.m_ActiveEdges:d.NextInAEL}else this.IsIntermediate(b,a)&&r.ClipperBase.IsHorizontal(b.NextInLML)?(b=this.UpdateEdgeIntoAEL(b),0<=b.OutIdx&&this.AddOutPt(b,b.Bot),this.AddEdgeToSEL(b)):(b.Curr.X=r.Clipper.TopX(b,a),b.Curr.Y=a),this.StrictlySimple&&(d=b.PrevInAEL,0<=b.OutIdx&&0!==b.WindDelta&&null!==d&&0<=d.OutIdx&&d.Curr.X==b.Curr.X&&0!==d.WindDelta&&(c=this.AddOutPt(d,b.Curr),d=this.AddOutPt(b,b.Curr),this.AddJoin(c,d,b.Curr))),b=b.NextInAEL}for(this.ProcessHorizontals(!0),b=this.m_ActiveEdges;null!==b;){if(this.IsIntermediate(b,a)){c=null,0<=b.OutIdx&&(c=this.AddOutPt(b,b.Top));var b=this.UpdateEdgeIntoAEL(b),d=b.PrevInAEL,e=b.NextInAEL;null!==d&&d.Curr.X==b.Bot.X&&d.Curr.Y==b.Bot.Y&&null!==c&&0<=d.OutIdx&&d.Curr.Y>d.Top.Y&&r.ClipperBase.SlopesEqual(b,d,this.m_UseFullRange)&&0!==b.WindDelta&&0!==d.WindDelta?(d=this.AddOutPt(d,b.Bot),this.AddJoin(c,d,b.Top)):null!==e&&e.Curr.X==b.Bot.X&&e.Curr.Y==b.Bot.Y&&null!==c&&0<=e.OutIdx&&e.Curr.Y>e.Top.Y&&r.ClipperBase.SlopesEqual(b,e,this.m_UseFullRange)&&0!==b.WindDelta&&0!==e.WindDelta&&(d=this.AddOutPt(e,b.Bot),this.AddJoin(c,d,b.Top))}b=b.NextInAEL}},r.Clipper.prototype.DoMaxima=function(a){var b=this.GetMaximaPair(a);if(null===b)0<=a.OutIdx&&this.AddOutPt(a,a.Top),this.DeleteFromAEL(a);else{for(var c=a.NextInAEL;null!==c&&c!=b;)this.IntersectEdges(a,c,a.Top,!0),this.SwapPositionsInAEL(a,c),c=a.NextInAEL;-1==a.OutIdx&&-1==b.OutIdx?(this.DeleteFromAEL(a),this.DeleteFromAEL(b)):0<=a.OutIdx&&0<=b.OutIdx?this.IntersectEdges(a,b,a.Top,!1):0===a.WindDelta?(0<=a.OutIdx&&(this.AddOutPt(a,a.Top),a.OutIdx=-1),this.DeleteFromAEL(a),0<=b.OutIdx&&(this.AddOutPt(b,a.Top),b.OutIdx=-1),this.DeleteFromAEL(b)):r.Error("DoMaxima error")}},r.Clipper.ReversePaths=function(a){for(var b=0,c=a.length;c>b;b++)a[b].reverse()},r.Clipper.Orientation=function(a){return 0<=r.Clipper.Area(a)},r.Clipper.prototype.PointCount=function(a){if(null===a)return 0;var b=0,c=a;do b++,c=c.Next;while(c!=a);return b},r.Clipper.prototype.BuildResult=function(a){r.Clear(a);for(var b=0,c=this.m_PolyOuts.length;c>b;b++){var d=this.m_PolyOuts[b];if(null!==d.Pts){var d=d.Pts.Prev,e=this.PointCount(d);if(!(2>e)){for(var f=Array(e),g=0;e>g;g++)f[g]=d.Pt,d=d.Prev;a.push(f)}}}},r.Clipper.prototype.BuildResult2=function(a){a.Clear();for(var b=0,c=this.m_PolyOuts.length;c>b;b++){var d=this.m_PolyOuts[b],e=this.PointCount(d.Pts);if(!(d.IsOpen&&2>e||!d.IsOpen&&3>e)){this.FixHoleLinkage(d);var f=new r.PolyNode;a.m_AllPolys.push(f),d.PolyNode=f,f.m_polygon.length=e;for(var d=d.Pts.Prev,g=0;e>g;g++)f.m_polygon[g]=d.Pt,d=d.Prev}}for(b=0,c=this.m_PolyOuts.length;c>b;b++)d=this.m_PolyOuts[b],null!==d.PolyNode&&(d.IsOpen?(d.PolyNode.IsOpen=!0,a.AddChild(d.PolyNode)):null!==d.FirstLeft&&null!=d.FirstLeft.PolyNode?d.FirstLeft.PolyNode.AddChild(d.PolyNode):a.AddChild(d.PolyNode))},r.Clipper.prototype.FixupOutPolygon=function(a){var b=null;a.BottomPt=null;for(var c=a.Pts;;){if(c.Prev==c||c.Prev==c.Next)return this.DisposeOutPts(c),void(a.Pts=null);if(r.IntPoint.op_Equality(c.Pt,c.Next.Pt)||r.IntPoint.op_Equality(c.Pt,c.Prev.Pt)||r.ClipperBase.SlopesEqual(c.Prev.Pt,c.Pt,c.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(c.Prev.Pt,c.Pt,c.Next.Pt)))b=null,c.Prev.Next=c.Next,c=c.Next.Prev=c.Prev;else{if(c==b)break;null===b&&(b=c),c=c.Next}}a.Pts=c},r.Clipper.prototype.DupOutPt=function(a,b){var c=new r.OutPt;return c.Pt.X=a.Pt.X,c.Pt.Y=a.Pt.Y,c.Idx=a.Idx,b?(c.Next=a.Next,c.Prev=a,a.Next.Prev=c,a.Next=c):(c.Prev=a.Prev,c.Next=a,a.Prev.Next=c,a.Prev=c),c},r.Clipper.prototype.GetOverlap=function(a,b,c,d,e){return b>a?d>c?(e.Left=Math.max(a,c),e.Right=Math.min(b,d)):(e.Left=Math.max(a,d),e.Right=Math.min(b,c)):d>c?(e.Left=Math.max(b,c),e.Right=Math.min(a,d)):(e.Left=Math.max(b,d),e.Right=Math.min(a,c)),e.Left<e.Right},r.Clipper.prototype.JoinHorz=function(a,b,c,d,e,f){var g=a.Pt.X>b.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight;if(d=c.Pt.X>d.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight,g==d)return!1;if(g==r.Direction.dLeftToRight){for(;a.Next.Pt.X<=e.X&&a.Next.Pt.X>=a.Pt.X&&a.Next.Pt.Y==e.Y;)a=a.Next;f&&a.Pt.X!=e.X&&(a=a.Next),b=this.DupOutPt(a,!f),r.IntPoint.op_Inequality(b.Pt,e)&&(a=b,a.Pt.X=e.X,a.Pt.Y=e.Y,b=this.DupOutPt(a,!f))}else{for(;a.Next.Pt.X>=e.X&&a.Next.Pt.X<=a.Pt.X&&a.Next.Pt.Y==e.Y;)a=a.Next;f||a.Pt.X==e.X||(a=a.Next),b=this.DupOutPt(a,f),r.IntPoint.op_Inequality(b.Pt,e)&&(a=b,a.Pt.X=e.X,a.Pt.Y=e.Y,b=this.DupOutPt(a,f))}if(d==r.Direction.dLeftToRight){for(;c.Next.Pt.X<=e.X&&c.Next.Pt.X>=c.Pt.X&&c.Next.Pt.Y==e.Y;)c=c.Next;f&&c.Pt.X!=e.X&&(c=c.Next),d=this.DupOutPt(c,!f),r.IntPoint.op_Inequality(d.Pt,e)&&(c=d,c.Pt.X=e.X,c.Pt.Y=e.Y,d=this.DupOutPt(c,!f))}else{for(;c.Next.Pt.X>=e.X&&c.Next.Pt.X<=c.Pt.X&&c.Next.Pt.Y==e.Y;)c=c.Next;f||c.Pt.X==e.X||(c=c.Next),d=this.DupOutPt(c,f),r.IntPoint.op_Inequality(d.Pt,e)&&(c=d,c.Pt.X=e.X,c.Pt.Y=e.Y,d=this.DupOutPt(c,f))}return g==r.Direction.dLeftToRight==f?(a.Prev=c,c.Next=a,b.Next=d,d.Prev=b):(a.Next=c,c.Prev=a,b.Prev=d,d.Next=b),!0},r.Clipper.prototype.JoinPoints=function(a,b,c){var d=a.OutPt1,e=new r.OutPt,f=a.OutPt2,g=new r.OutPt;if((g=a.OutPt1.Pt.Y==a.OffPt.Y)&&r.IntPoint.op_Equality(a.OffPt,a.OutPt1.Pt)&&r.IntPoint.op_Equality(a.OffPt,a.OutPt2.Pt)){for(e=a.OutPt1.Next;e!=d&&r.IntPoint.op_Equality(e.Pt,a.OffPt);)e=e.Next;for(e=e.Pt.Y>a.OffPt.Y,g=a.OutPt2.Next;g!=f&&r.IntPoint.op_Equality(g.Pt,a.OffPt);)g=g.Next;return e==g.Pt.Y>a.OffPt.Y?!1:(e?(e=this.DupOutPt(d,!1),g=this.DupOutPt(f,!0),d.Prev=f,f.Next=d,e.Next=g,g.Prev=e):(e=this.DupOutPt(d,!0),g=this.DupOutPt(f,!1),d.Next=f,f.Prev=d,e.Prev=g,g.Next=e),a.OutPt1=d,a.OutPt2=e,!0)}if(g){for(e=d;d.Prev.Pt.Y==d.Pt.Y&&d.Prev!=e&&d.Prev!=f;)d=d.Prev;for(;e.Next.Pt.Y==e.Pt.Y&&e.Next!=d&&e.Next!=f;)e=e.Next;if(e.Next==d||e.Next==f)return!1;for(g=f;f.Prev.Pt.Y==f.Pt.Y&&f.Prev!=g&&f.Prev!=e;)f=f.Prev;for(;g.Next.Pt.Y==g.Pt.Y&&g.Next!=f&&g.Next!=d;)g=g.Next;if(g.Next==f||g.Next==d)return!1;if(c={Left:null,Right:null},!this.GetOverlap(d.Pt.X,e.Pt.X,f.Pt.X,g.Pt.X,c))return!1;b=c.Left;var h=c.Right;return c=new r.IntPoint,d.Pt.X>=b&&d.Pt.X<=h?(c.X=d.Pt.X,c.Y=d.Pt.Y,b=d.Pt.X>e.Pt.X):f.Pt.X>=b&&f.Pt.X<=h?(c.X=f.Pt.X,c.Y=f.Pt.Y,b=f.Pt.X>g.Pt.X):e.Pt.X>=b&&e.Pt.X<=h?(c.X=e.Pt.X,c.Y=e.Pt.Y,b=e.Pt.X>d.Pt.X):(c.X=g.Pt.X,c.Y=g.Pt.Y,b=g.Pt.X>f.Pt.X),a.OutPt1=d,a.OutPt2=f,this.JoinHorz(d,e,f,g,c,b)}for(e=d.Next;r.IntPoint.op_Equality(e.Pt,d.Pt)&&e!=d;)e=e.Next;if(h=e.Pt.Y>d.Pt.Y||!r.ClipperBase.SlopesEqual(d.Pt,e.Pt,a.OffPt,this.m_UseFullRange)){for(e=d.Prev;r.IntPoint.op_Equality(e.Pt,d.Pt)&&e!=d;)e=e.Prev;if(e.Pt.Y>d.Pt.Y||!r.ClipperBase.SlopesEqual(d.Pt,e.Pt,a.OffPt,this.m_UseFullRange))return!1}for(g=f.Next;r.IntPoint.op_Equality(g.Pt,f.Pt)&&g!=f;)g=g.Next;var i=g.Pt.Y>f.Pt.Y||!r.ClipperBase.SlopesEqual(f.Pt,g.Pt,a.OffPt,this.m_UseFullRange);if(i){for(g=f.Prev;r.IntPoint.op_Equality(g.Pt,f.Pt)&&g!=f;)g=g.Prev;if(g.Pt.Y>f.Pt.Y||!r.ClipperBase.SlopesEqual(f.Pt,g.Pt,a.OffPt,this.m_UseFullRange))return!1}return e==d||g==f||e==g||b==c&&h==i?!1:(h?(e=this.DupOutPt(d,!1),g=this.DupOutPt(f,!0),d.Prev=f,f.Next=d,e.Next=g,g.Prev=e):(e=this.DupOutPt(d,!0),g=this.DupOutPt(f,!1),d.Next=f,f.Prev=d,e.Prev=g,g.Next=e),a.OutPt1=d,a.OutPt2=e,!0)},r.Clipper.GetBounds=function(a){for(var b=0,c=a.length;c>b&&0==a[b].length;)b++;if(b==c)return new r.IntRect(0,0,0,0);var d=new r.IntRect;for(d.left=a[b][0].X,d.right=d.left,d.top=a[b][0].Y,d.bottom=d.top;c>b;b++)for(var e=0,f=a[b].length;f>e;e++)a[b][e].X<d.left?d.left=a[b][e].X:a[b][e].X>d.right&&(d.right=a[b][e].X),a[b][e].Y<d.top?d.top=a[b][e].Y:a[b][e].Y>d.bottom&&(d.bottom=a[b][e].Y);return d},r.Clipper.prototype.GetBounds2=function(a){var b=a,c=new r.IntRect;for(c.left=a.Pt.X,c.right=a.Pt.X,c.top=a.Pt.Y,c.bottom=a.Pt.Y,a=a.Next;a!=b;)a.Pt.X<c.left&&(c.left=a.Pt.X),a.Pt.X>c.right&&(c.right=a.Pt.X),a.Pt.Y<c.top&&(c.top=a.Pt.Y),a.Pt.Y>c.bottom&&(c.bottom=a.Pt.Y),a=a.Next;return c},r.Clipper.PointInPolygon=function(a,b){var c=0,d=b.length;if(3>d)return 0;for(var e=b[0],f=1;d>=f;++f){var g=f==d?b[0]:b[f];if(g.Y==a.Y&&(g.X==a.X||e.Y==a.Y&&g.X>a.X==e.X<a.X))return-1;if(e.Y<a.Y!=g.Y<a.Y)if(e.X>=a.X)if(g.X>a.X)c=1-c;else{var h=(e.X-a.X)*(g.Y-a.Y)-(g.X-a.X)*(e.Y-a.Y);if(0==h)return-1;h>0==g.Y>e.Y&&(c=1-c)}else if(g.X>a.X){if(h=(e.X-a.X)*(g.Y-a.Y)-(g.X-a.X)*(e.Y-a.Y),0==h)return-1;h>0==g.Y>e.Y&&(c=1-c)}e=g}return c},r.Clipper.prototype.PointInPolygon=function(a,b){for(var c=0,d=b;;){var e=b.Pt.X,f=b.Pt.Y,g=b.Next.Pt.X,h=b.Next.Pt.Y;if(h==a.Y&&(g==a.X||f==a.Y&&g>a.X==e<a.X))return-1;if(f<a.Y!=h<a.Y)if(e>=a.X)if(g>a.X)c=1-c;else{if(e=(e-a.X)*(h-a.Y)-(g-a.X)*(f-a.Y),0==e)return-1;e>0==h>f&&(c=1-c)}else if(g>a.X){if(e=(e-a.X)*(h-a.Y)-(g-a.X)*(f-a.Y),0==e)return-1;e>0==h>f&&(c=1-c)}if(b=b.Next,d==b)break}return c},r.Clipper.prototype.Poly2ContainsPoly1=function(a,b){var c=a;do{var d=this.PointInPolygon(c.Pt,b);if(d>=0)return 0!=d;c=c.Next}while(c!=a);return!0},r.Clipper.prototype.FixupFirstLefts1=function(a,b){for(var c=0,d=this.m_PolyOuts.length;d>c;c++){var e=this.m_PolyOuts[c];null!==e.Pts&&e.FirstLeft==a&&this.Poly2ContainsPoly1(e.Pts,b.Pts)&&(e.FirstLeft=b)}},r.Clipper.prototype.FixupFirstLefts2=function(a,b){for(var c=0,d=this.m_PolyOuts,e=d.length,f=d[c];e>c;c++,f=d[c])f.FirstLeft==a&&(f.FirstLeft=b)},r.Clipper.ParseFirstLeft=function(a){for(;null!=a&&null==a.Pts;)a=a.FirstLeft;return a},r.Clipper.prototype.JoinCommonEdges=function(){for(var a=0,b=this.m_Joins.length;b>a;a++){var c=this.m_Joins[a],d=this.GetOutRec(c.OutPt1.Idx),e=this.GetOutRec(c.OutPt2.Idx);if(null!=d.Pts&&null!=e.Pts){var f;if(f=d==e?d:this.Param1RightOfParam2(d,e)?e:this.Param1RightOfParam2(e,d)?d:this.GetLowermostRec(d,e),this.JoinPoints(c,d,e))if(d==e){if(d.Pts=c.OutPt1,d.BottomPt=null,e=this.CreateOutRec(),e.Pts=c.OutPt2,this.UpdateOutPtIdxs(e),this.m_UsingPolyTree){f=0;for(var g=this.m_PolyOuts.length;g-1>f;f++){var h=this.m_PolyOuts[f];null!=h.Pts&&r.Clipper.ParseFirstLeft(h.FirstLeft)==d&&h.IsHole!=d.IsHole&&this.Poly2ContainsPoly1(h.Pts,c.OutPt2)&&(h.FirstLeft=e)}}this.Poly2ContainsPoly1(e.Pts,d.Pts)?(e.IsHole=!d.IsHole,e.FirstLeft=d,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,d),(e.IsHole^this.ReverseSolution)==0<this.Area(e)&&this.ReversePolyPtLinks(e.Pts)):this.Poly2ContainsPoly1(d.Pts,e.Pts)?(e.IsHole=d.IsHole,d.IsHole=!e.IsHole,e.FirstLeft=d.FirstLeft,d.FirstLeft=e,this.m_UsingPolyTree&&this.FixupFirstLefts2(d,e),(d.IsHole^this.ReverseSolution)==0<this.Area(d)&&this.ReversePolyPtLinks(d.Pts)):(e.IsHole=d.IsHole,e.FirstLeft=d.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(d,e))}else e.Pts=null,e.BottomPt=null,e.Idx=d.Idx,d.IsHole=f.IsHole,f==e&&(d.FirstLeft=e.FirstLeft),e.FirstLeft=d,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,d)}}},r.Clipper.prototype.UpdateOutPtIdxs=function(a){var b=a.Pts;do b.Idx=a.Idx,b=b.Prev;while(b!=a.Pts)},r.Clipper.prototype.DoSimplePolygons=function(){for(var a=0;a<this.m_PolyOuts.length;){var b=this.m_PolyOuts[a++],c=b.Pts;if(null!==c)do{for(var d=c.Next;d!=b.Pts;){if(r.IntPoint.op_Equality(c.Pt,d.Pt)&&d.Next!=c&&d.Prev!=c){var e=c.Prev,f=d.Prev;c.Prev=f,f.Next=c,d.Prev=e,e.Next=d,b.Pts=c,e=this.CreateOutRec(),e.Pts=d,this.UpdateOutPtIdxs(e),this.Poly2ContainsPoly1(e.Pts,b.Pts)?(e.IsHole=!b.IsHole,e.FirstLeft=b):this.Poly2ContainsPoly1(b.Pts,e.Pts)?(e.IsHole=b.IsHole,b.IsHole=!e.IsHole,e.FirstLeft=b.FirstLeft,b.FirstLeft=e):(e.IsHole=b.IsHole,e.FirstLeft=b.FirstLeft),d=c}d=d.Next}c=c.Next}while(c!=b.Pts)}},r.Clipper.Area=function(a){var b=a.length;if(3>b)return 0;for(var c=0,d=0,e=b-1;b>d;++d)c+=(a[e].X+a[d].X)*(a[e].Y-a[d].Y),e=d;return.5*-c},r.Clipper.prototype.Area=function(a){var b=a.Pts;if(null==b)return 0;var c=0;do c+=(b.Prev.Pt.X+b.Pt.X)*(b.Prev.Pt.Y-b.Pt.Y),b=b.Next;while(b!=a.Pts);return.5*c},r.Clipper.SimplifyPolygon=function(a,b){var c=[],d=new r.Clipper(0);return d.StrictlySimple=!0,d.AddPath(a,r.PolyType.ptSubject,!0),d.Execute(r.ClipType.ctUnion,c,b,b),c},r.Clipper.SimplifyPolygons=function(a,b){"undefined"==typeof b&&(b=r.PolyFillType.pftEvenOdd);var c=[],d=new r.Clipper(0);return d.StrictlySimple=!0,d.AddPaths(a,r.PolyType.ptSubject,!0),d.Execute(r.ClipType.ctUnion,c,b,b),c},r.Clipper.DistanceSqrd=function(a,b){var c=a.X-b.X,d=a.Y-b.Y;return c*c+d*d},r.Clipper.DistanceFromLineSqrd=function(a,b,c){var d=b.Y-c.Y;return c=c.X-b.X,b=d*b.X+c*b.Y,b=d*a.X+c*a.Y-b,b*b/(d*d+c*c)},r.Clipper.SlopesNearCollinear=function(a,b,c,d){return r.Clipper.DistanceFromLineSqrd(b,a,c)<d},r.Clipper.PointsAreClose=function(a,b,c){var d=a.X-b.X;return a=a.Y-b.Y,c>=d*d+a*a},r.Clipper.ExcludeOp=function(a){var b=a.Prev;return b.Next=a.Next,a.Next.Prev=b,b.Idx=0,b},r.Clipper.CleanPolygon=function(a,b){"undefined"==typeof b&&(b=1.415);var c=a.length;if(0==c)return[];for(var d=Array(c),e=0;c>e;++e)d[e]=new r.OutPt;for(e=0;c>e;++e)d[e].Pt=a[e],d[e].Next=d[(e+1)%c],d[e].Next.Prev=d[e],d[e].Idx=0;for(e=b*b,d=d[0];0==d.Idx&&d.Next!=d.Prev;)r.Clipper.PointsAreClose(d.Pt,d.Prev.Pt,e)?(d=r.Clipper.ExcludeOp(d),c--):r.Clipper.PointsAreClose(d.Prev.Pt,d.Next.Pt,e)?(r.Clipper.ExcludeOp(d.Next),d=r.Clipper.ExcludeOp(d),c-=2):r.Clipper.SlopesNearCollinear(d.Prev.Pt,d.Pt,d.Next.Pt,e)?(d=r.Clipper.ExcludeOp(d),c--):(d.Idx=1,d=d.Next);3>c&&(c=0);for(var f=Array(c),e=0;c>e;++e)f[e]=new r.IntPoint(d.Pt),d=d.Next;return f},r.Clipper.CleanPolygons=function(a,b){for(var c=Array(a.length),d=0,e=a.length;e>d;d++)c[d]=r.Clipper.CleanPolygon(a[d],b);return c},r.Clipper.Minkowski=function(a,b,c,d){var e=d?1:0,f=a.length,g=b.length;if(d=[],c)for(c=0;g>c;c++){for(var h=Array(f),i=0,j=a.length,k=a[i];j>i;i++,k=a[i])h[i]=new r.IntPoint(b[c].X+k.X,b[c].Y+k.Y);d.push(h)}else for(c=0;g>c;c++){for(h=Array(f),i=0,j=a.length,k=a[i];j>i;i++,k=a[i])h[i]=new r.IntPoint(b[c].X-k.X,b[c].Y-k.Y);d.push(h)}for(a=[],c=0;g-1+e>c;c++)for(i=0;f>i;i++)b=[],b.push(d[c%g][i%f]),b.push(d[(c+1)%g][i%f]),b.push(d[(c+1)%g][(i+1)%f]),b.push(d[c%g][(i+1)%f]),r.Clipper.Orientation(b)||b.reverse(),a.push(b);return e=new r.Clipper(0),e.AddPaths(a,r.PolyType.ptSubject,!0),e.Execute(r.ClipType.ctUnion,d,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero),d},r.Clipper.MinkowskiSum=function(){var a=arguments,b=a.length;if(3==b){var c=a[0],d=a[2];return r.Clipper.Minkowski(c,a[1],!0,d)}if(4==b){for(var e,c=a[0],f=a[1],b=a[2],d=a[3],a=new r.Clipper,g=0,h=f.length;h>g;++g)e=r.Clipper.Minkowski(c,f[g],!0,d),a.AddPaths(e,r.PolyType.ptSubject,!0);return d&&a.AddPaths(f,r.PolyType.ptClip,!0),c=new r.Paths,a.Execute(r.ClipType.ctUnion,c,b,b),c}},r.Clipper.MinkowskiDiff=function(a,b,c){return r.Clipper.Minkowski(a,b,!1,c)},r.Clipper.PolyTreeToPaths=function(a){var b=[];return r.Clipper.AddPolyNodeToPaths(a,r.Clipper.NodeType.ntAny,b),b},r.Clipper.AddPolyNodeToPaths=function(a,b,c){var d=!0;switch(b){case r.Clipper.NodeType.ntOpen:return;case r.Clipper.NodeType.ntClosed:d=!a.IsOpen}0<a.m_polygon.length&&d&&c.push(a.m_polygon),d=0,a=a.Childs();for(var e=a.length,f=a[d];e>d;d++,f=a[d])r.Clipper.AddPolyNodeToPaths(f,b,c)},r.Clipper.OpenPathsFromPolyTree=function(a){for(var b=new r.Paths,c=0,d=a.ChildCount();d>c;c++)a.Childs()[c].IsOpen&&b.push(a.Childs()[c].m_polygon);return b},r.Clipper.ClosedPathsFromPolyTree=function(a){var b=new r.Paths;return r.Clipper.AddPolyNodeToPaths(a,r.Clipper.NodeType.ntClosed,b),b},G(r.Clipper,r.ClipperBase),r.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},r.ClipperOffset=function(a,b){"undefined"==typeof a&&(a=2),"undefined"==typeof b&&(b=r.ClipperOffset.def_arc_tolerance),this.m_destPolys=new r.Paths,this.m_srcPoly=new r.Path,this.m_destPoly=new r.Path,this.m_normals=[],this.m_StepsPerRad=this.m_miterLim=this.m_cos=this.m_sin=this.m_sinA=this.m_delta=0,this.m_lowest=new r.IntPoint,this.m_polyNodes=new r.PolyNode,this.MiterLimit=a,this.ArcTolerance=b,this.m_lowest.X=-1},r.ClipperOffset.two_pi=6.28318530717959,r.ClipperOffset.def_arc_tolerance=.25,r.ClipperOffset.prototype.Clear=function(){r.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},r.ClipperOffset.Round=r.Clipper.Round,r.ClipperOffset.prototype.AddPath=function(a,b,c){var d=a.length-1;if(!(0>d)){var e=new r.PolyNode;if(e.m_jointype=b,e.m_endtype=c,c==r.EndType.etClosedLine||c==r.EndType.etClosedPolygon)for(;d>0&&r.IntPoint.op_Equality(a[0],a[d]);)d--;e.m_polygon.push(a[0]);var f=0;b=0;for(var g=1;d>=g;g++)r.IntPoint.op_Inequality(e.m_polygon[f],a[g])&&(f++,e.m_polygon.push(a[g]),a[g].Y>e.m_polygon[b].Y||a[g].Y==e.m_polygon[b].Y&&a[g].X<e.m_polygon[b].X)&&(b=f);c==r.EndType.etClosedPolygon&&2>f||c!=r.EndType.etClosedPolygon&&0>f||(this.m_polyNodes.AddChild(e),c!=r.EndType.etClosedPolygon)||(0>this.m_lowest.X?this.m_lowest=new r.IntPoint(0,b):(a=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y],(e.m_polygon[b].Y>a.Y||e.m_polygon[b].Y==a.Y&&e.m_polygon[b].X<a.X)&&(this.m_lowest=new r.IntPoint(this.m_polyNodes.ChildCount()-1,b))))}},r.ClipperOffset.prototype.AddPaths=function(a,b,c){for(var d=0,e=a.length;e>d;d++)this.AddPath(a[d],b,c)},r.ClipperOffset.prototype.FixOrientations=function(){if(0<=this.m_lowest.X&&!r.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var a=0;a<this.m_polyNodes.ChildCount();a++){var b=this.m_polyNodes.Childs()[a];(b.m_endtype==r.EndType.etClosedPolygon||b.m_endtype==r.EndType.etClosedLine&&r.Clipper.Orientation(b.m_polygon))&&b.m_polygon.reverse()}else for(a=0;a<this.m_polyNodes.ChildCount();a++)b=this.m_polyNodes.Childs()[a],b.m_endtype!=r.EndType.etClosedLine||r.Clipper.Orientation(b.m_polygon)||b.m_polygon.reverse()},r.ClipperOffset.GetUnitNormal=function(a,b){var c=b.X-a.X,d=b.Y-a.Y;if(0==c&&0==d)return new r.DoublePoint(0,0);var e=1/Math.sqrt(c*c+d*d);return new r.DoublePoint(d*e,-(c*e))},r.ClipperOffset.prototype.DoOffset=function(a){if(this.m_destPolys=[],this.m_delta=a,r.ClipperBase.near_zero(a))for(var b=0;b<this.m_polyNodes.ChildCount();b++){var c=this.m_polyNodes.Childs()[b];c.m_endtype==r.EndType.etClosedPolygon&&this.m_destPolys.push(c.m_polygon)}else{this.m_miterLim=2<this.MiterLimit?2/(this.MiterLimit*this.MiterLimit):.5;var b=0>=this.ArcTolerance?r.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(a)*r.ClipperOffset.def_arc_tolerance?Math.abs(a)*r.ClipperOffset.def_arc_tolerance:this.ArcTolerance,d=3.14159265358979/Math.acos(1-b/Math.abs(a));for(this.m_sin=Math.sin(r.ClipperOffset.two_pi/d),this.m_cos=Math.cos(r.ClipperOffset.two_pi/d),this.m_StepsPerRad=d/r.ClipperOffset.two_pi,0>a&&(this.m_sin=-this.m_sin),b=0;b<this.m_polyNodes.ChildCount();b++){c=this.m_polyNodes.Childs()[b],this.m_srcPoly=c.m_polygon;var e=this.m_srcPoly.length;if(!(0==e||0>=a&&(3>e||c.m_endtype!=r.EndType.etClosedPolygon))){if(this.m_destPoly=[],1==e)if(c.m_jointype==r.JoinType.jtRound)for(var c=1,e=0,f=1;d>=f;f++){this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+c*a),r.ClipperOffset.Round(this.m_srcPoly[0].Y+e*a)));var g=c,c=c*this.m_cos-this.m_sin*e,e=g*this.m_sin+e*this.m_cos}else for(e=c=-1,f=0;4>f;++f)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+c*a),r.ClipperOffset.Round(this.m_srcPoly[0].Y+e*a))),0>c?c=1:0>e?e=1:c=-1;else{for(f=this.m_normals.length=0;e-1>f;f++)this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[f],this.m_srcPoly[f+1]));if(this.m_normals.push(c.m_endtype==r.EndType.etClosedLine||c.m_endtype==r.EndType.etClosedPolygon?r.ClipperOffset.GetUnitNormal(this.m_srcPoly[e-1],this.m_srcPoly[0]):new r.DoublePoint(this.m_normals[e-2])),c.m_endtype==r.EndType.etClosedPolygon)for(g=e-1,f=0;e>f;f++)g=this.OffsetPoint(f,g,c.m_jointype);else if(c.m_endtype==r.EndType.etClosedLine){for(g=e-1,f=0;e>f;f++)g=this.OffsetPoint(f,g,c.m_jointype);for(this.m_destPolys.push(this.m_destPoly),this.m_destPoly=[],g=this.m_normals[e-1],f=e-1;f>0;f--)this.m_normals[f]=new r.DoublePoint(-this.m_normals[f-1].X,-this.m_normals[f-1].Y);for(this.m_normals[0]=new r.DoublePoint(-g.X,-g.Y),g=0,f=e-1;f>=0;f--)g=this.OffsetPoint(f,g,c.m_jointype)}else{for(g=0,f=1;e-1>f;++f)g=this.OffsetPoint(f,g,c.m_jointype);for(c.m_endtype==r.EndType.etOpenButt?(f=e-1,g=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_normals[f].X*a),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_normals[f].Y*a)),this.m_destPoly.push(g),g=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X-this.m_normals[f].X*a),r.ClipperOffset.Round(this.m_srcPoly[f].Y-this.m_normals[f].Y*a)),this.m_destPoly.push(g)):(f=e-1,g=e-2,this.m_sinA=0,this.m_normals[f]=new r.DoublePoint(-this.m_normals[f].X,-this.m_normals[f].Y),c.m_endtype==r.EndType.etOpenSquare?this.DoSquare(f,g):this.DoRound(f,g)),f=e-1;f>0;f--)this.m_normals[f]=new r.DoublePoint(-this.m_normals[f-1].X,-this.m_normals[f-1].Y);for(this.m_normals[0]=new r.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),g=e-1,f=g-1;f>0;--f)g=this.OffsetPoint(f,g,c.m_jointype);c.m_endtype==r.EndType.etOpenButt?(g=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*a),r.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*a)),this.m_destPoly.push(g),g=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*a),r.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*a)),this.m_destPoly.push(g)):(this.m_sinA=0,c.m_endtype==r.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1))}}this.m_destPolys.push(this.m_destPoly)}}}},r.ClipperOffset.prototype.Execute=function(){var a=arguments;if(a[0]instanceof r.PolyTree)if(b=a[0],c=a[1],b.Clear(),this.FixOrientations(),this.DoOffset(c),a=new r.Clipper(0),a.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),c>0)a.Execute(r.ClipType.ctUnion,b,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else if(c=r.Clipper.GetBounds(this.m_destPolys),d=new r.Path,d.push(new r.IntPoint(c.left-10,c.bottom+10)),d.push(new r.IntPoint(c.right+10,c.bottom+10)),d.push(new r.IntPoint(c.right+10,c.top-10)),d.push(new r.IntPoint(c.left-10,c.top-10)),a.AddPath(d,r.PolyType.ptSubject,!0),a.ReverseSolution=!0,a.Execute(r.ClipType.ctUnion,b,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),1==b.ChildCount()&&0<b.Childs()[0].ChildCount())for(a=b.Childs()[0],b.Childs()[0]=a.Childs()[0],c=1;c<a.ChildCount();c++)b.AddChild(a.Childs()[c]);else b.Clear();else{var b=a[0],c=a[1];if(r.Clear(b),this.FixOrientations(),this.DoOffset(c),a=new r.Clipper(0),a.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),c>0)a.Execute(r.ClipType.ctUnion,b,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{var c=r.Clipper.GetBounds(this.m_destPolys),d=new r.Path;d.push(new r.IntPoint(c.left-10,c.bottom+10)),d.push(new r.IntPoint(c.right+10,c.bottom+10)),d.push(new r.IntPoint(c.right+10,c.top-10)),d.push(new r.IntPoint(c.left-10,c.top-10)),a.AddPath(d,r.PolyType.ptSubject,!0),a.ReverseSolution=!0,a.Execute(r.ClipType.ctUnion,b,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),0<b.length&&b.splice(0,1)
}}},r.ClipperOffset.prototype.OffsetPoint=function(a,b,c){if(this.m_sinA=this.m_normals[b].X*this.m_normals[a].Y-this.m_normals[a].X*this.m_normals[b].Y,5e-5>this.m_sinA&&-5e-5<this.m_sinA)return b;if(1<this.m_sinA?this.m_sinA=1:-1>this.m_sinA&&(this.m_sinA=-1),0>this.m_sinA*this.m_delta)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_normals[b].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_normals[b].Y*this.m_delta))),this.m_destPoly.push(new r.IntPoint(this.m_srcPoly[a])),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_normals[a].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_normals[a].Y*this.m_delta)));else switch(c){case r.JoinType.jtMiter:c=1+(this.m_normals[a].X*this.m_normals[b].X+this.m_normals[a].Y*this.m_normals[b].Y),c>=this.m_miterLim?this.DoMiter(a,b,c):this.DoSquare(a,b);break;case r.JoinType.jtSquare:this.DoSquare(a,b);break;case r.JoinType.jtRound:this.DoRound(a,b)}return a},r.ClipperOffset.prototype.DoSquare=function(a,b){var c=Math.tan(Math.atan2(this.m_sinA,this.m_normals[b].X*this.m_normals[a].X+this.m_normals[b].Y*this.m_normals[a].Y)/4);this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_delta*(this.m_normals[b].X-this.m_normals[b].Y*c)),r.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_delta*(this.m_normals[b].Y+this.m_normals[b].X*c)))),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_delta*(this.m_normals[a].X+this.m_normals[a].Y*c)),r.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_delta*(this.m_normals[a].Y-this.m_normals[a].X*c))))},r.ClipperOffset.prototype.DoMiter=function(a,b,c){c=this.m_delta/c,this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].X+(this.m_normals[b].X+this.m_normals[a].X)*c),r.ClipperOffset.Round(this.m_srcPoly[a].Y+(this.m_normals[b].Y+this.m_normals[a].Y)*c)))},r.ClipperOffset.prototype.DoRound=function(a,b){for(var c,d=Math.atan2(this.m_sinA,this.m_normals[b].X*this.m_normals[a].X+this.m_normals[b].Y*this.m_normals[a].Y),d=r.Cast_Int32(r.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(d))),e=this.m_normals[b].X,f=this.m_normals[b].Y,g=0;d>g;++g)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].X+e*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[a].Y+f*this.m_delta))),c=e,e=e*this.m_cos-this.m_sin*f,f=c*this.m_sin+f*this.m_cos;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].X+this.m_normals[a].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[a].Y+this.m_normals[a].Y*this.m_delta)))},r.Error=function(a){try{throw Error(a)}catch(b){alert(b.message)}},r.JS={},r.JS.AreaOfPolygon=function(a,b){return b||(b=1),r.Clipper.Area(a)/(b*b)},r.JS.AreaOfPolygons=function(a,b){b||(b=1);for(var c=0,d=0;d<a.length;d++)c+=r.Clipper.Area(a[d]);return c/(b*b)},r.JS.BoundsOfPath=function(a,b){return r.JS.BoundsOfPaths([a],b)},r.JS.BoundsOfPaths=function(a,b){b||(b=1);var c=r.Clipper.GetBounds(a);return c.left/=b,c.bottom/=b,c.right/=b,c.top/=b,c},r.JS.Clean=function(a,b){if(!(a instanceof Array))return[];var c=a[0]instanceof Array;if(a=r.JS.Clone(a),"number"!=typeof b||null===b)return r.Error("Delta is not a number in Clean()."),a;if(0===a.length||1==a.length&&0===a[0].length||0>b)return a;c||(a=[a]);for(var d,e,f,g,h,i,j,k=a.length,l=[],m=0;k>m;m++)if(e=a[m],d=e.length,0!==d)if(3>d)f=e,l.push(f);else{for(f=e,g=b*b,h=e[0],j=i=1;d>j;j++)(e[j].X-h.X)*(e[j].X-h.X)+(e[j].Y-h.Y)*(e[j].Y-h.Y)<=g||(f[i]=e[j],h=e[j],i++);h=e[i-1],(e[0].X-h.X)*(e[0].X-h.X)+(e[0].Y-h.Y)*(e[0].Y-h.Y)<=g&&i--,d>i&&f.splice(i,d-i),f.length&&l.push(f)}return!c&&l.length?l=l[0]:c||0!==l.length?c&&0===l.length&&(l=[[]]):l=[],l},r.JS.Clone=function(a){if(!(a instanceof Array)||0===a.length)return[];if(1==a.length&&0===a[0].length)return[[]];var b=a[0]instanceof Array;b||(a=[a]);var c,d,e,f,g=a.length,h=Array(g);for(d=0;g>d;d++){for(c=a[d].length,f=Array(c),e=0;c>e;e++)f[e]={X:a[d][e].X,Y:a[d][e].Y};h[d]=f}return b||(h=h[0]),h},r.JS.Lighten=function(a,b){if(!(a instanceof Array))return[];if("number"!=typeof b||null===b)return r.Error("Tolerance is not a number in Lighten()."),r.JS.Clone(a);if(0===a.length||1==a.length&&0===a[0].length||0>b)return r.JS.Clone(a);a[0]instanceof Array||(a=[a]);var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,s=a.length,t=b*b,u=[];for(c=0;s>c;c++)if(e=a[c],h=e.length,0!=h){for(f=0;1e6>f;f++){for(g=[],h=e.length,e[h-1].X!=e[0].X||e[h-1].Y!=e[0].Y?(m=1,e.push({X:e[0].X,Y:e[0].Y}),h=e.length):m=0,l=[],d=0;h-2>d;d++)i=e[d],k=e[d+1],j=e[d+2],p=i.X,q=i.Y,i=j.X-p,n=j.Y-q,(0!==i||0!==n)&&(o=((k.X-p)*i+(k.Y-q)*n)/(i*i+n*n),o>1?(p=j.X,q=j.Y):o>0&&(p+=i*o,q+=n*o)),i=k.X-p,n=k.Y-q,j=i*i+n*n,t>=j&&(l[d+1]=1,d++);for(g.push({X:e[0].X,Y:e[0].Y}),d=1;h-1>d;d++)l[d]||g.push({X:e[d].X,Y:e[d].Y});if(g.push({X:e[h-1].X,Y:e[h-1].Y}),m&&e.pop(),!l.length)break;e=g}h=g.length,g[h-1].X==g[0].X&&g[h-1].Y==g[0].Y&&g.pop(),2<g.length&&u.push(g)}return!a[0]instanceof Array&&(u=u[0]),"undefined"==typeof u&&(u=[[]]),u},r.JS.PerimeterOfPath=function(a,b,c){if("undefined"==typeof a)return 0;var d,e,f=Math.sqrt,g=0,h=0,i=d=0;e=0;var j=a.length;if(2>j)return 0;for(b&&(a[j]=a[0],j++);--j;)d=a[j],h=d.X,d=d.Y,e=a[j-1],i=e.X,e=e.Y,g+=f((h-i)*(h-i)+(d-e)*(d-e));return b&&a.pop(),g/c},r.JS.PerimeterOfPaths=function(a,b,c){c||(c=1);for(var d=0,e=0;e<a.length;e++)d+=r.JS.PerimeterOfPath(a[e],b,c);return d},r.JS.ScaleDownPath=function(a,b){var c,d;for(b||(b=1),c=a.length;c--;)d=a[c],d.X/=b,d.Y/=b},r.JS.ScaleDownPaths=function(a,b){var c,d,e;for(b||(b=1),c=a.length;c--;)for(d=a[c].length;d--;)e=a[c][d],e.X/=b,e.Y/=b},r.JS.ScaleUpPath=function(a,b){var c,d,e=Math.round;for(b||(b=1),c=a.length;c--;)d=a[c],d.X=e(d.X*b),d.Y=e(d.Y*b)},r.JS.ScaleUpPaths=function(a,b){var c,d,e,f=Math.round;for(b||(b=1),c=a.length;c--;)for(d=a[c].length;d--;)e=a[c][d],e.X=f(e.X*b),e.Y=f(e.Y*b)},r.ExPolygons=function(){return[]},r.ExPolygon=function(){this.holes=this.outer=null},r.JS.AddOuterPolyNodeToExPolygons=function(a,b){var c=new r.ExPolygon;c.outer=a.Contour();var d=a.Childs(),e=d.length;c.holes=Array(e);var f,g,h,i,j;for(g=0;e>g;g++)for(f=d[g],c.holes[g]=f.Contour(),h=0,i=f.Childs(),j=i.length;j>h;h++)f=i[h],r.JS.AddOuterPolyNodeToExPolygons(f,b);b.push(c)},r.JS.ExPolygonsToPaths=function(a){var b,c,d,e,f=new r.Paths;for(b=0,d=a.length;d>b;b++)for(f.push(a[b].outer),c=0,e=a[b].holes.length;e>c;c++)f.push(a[b].holes[c]);return f},r.JS.PolyTreeToExPolygons=function(a){var b,c,d,e=new r.ExPolygons;for(b=0,c=a.Childs(),d=c.length;d>b;b++)a=c[b],r.JS.AddOuterPolyNodeToExPolygons(a,e);return e}}();var fabric=fabric||{version:"1.4.5"};"undefined"!=typeof exports&&(exports.fabric=fabric),"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window):(fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.window=fabric.document.createWindow()),fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement,fabric.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width"],function(){function a(a,b){this.__eventListeners[a]&&(b?fabric.util.removeFromArray(this.__eventListeners[a],b):this.__eventListeners[a].length=0)}function b(a,b){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var c in a)this.on(c,a[c]);else this.__eventListeners[a]||(this.__eventListeners[a]=[]),this.__eventListeners[a].push(b);return this}function c(b,c){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners={};else if(1===arguments.length&&"object"==typeof arguments[0])for(var d in b)a.call(this,d,b[d]);else a.call(this,b,c);return this}}function d(a,b){if(this.__eventListeners){var c=this.__eventListeners[a];if(c){for(var d=0,e=c.length;e>d;d++)c[d].call(this,b||{});return this}}}fabric.Observable={observe:b,stopObserving:c,fire:d,on:b,off:c,trigger:d}}(),fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var a=0,b=arguments.length;b>a;a++)this._onObjectAdded(arguments[a]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(a,b,c){var d=this.getObjects();return c?d[b]=a:d.splice(b,0,a),this._onObjectAdded(a),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){for(var a,b=this.getObjects(),c=0,d=arguments.length;d>c;c++)a=b.indexOf(arguments[c]),-1!==a&&(b.splice(a,1),this._onObjectRemoved(arguments[c]));return this.renderOnAddRemove&&this.renderAll(),this},forEachObject:function(a,b){for(var c=this.getObjects(),d=c.length;d--;)a.call(b,c[d],d,c);return this},getObjects:function(a){return"undefined"==typeof a?this._objects:this._objects.filter(function(b){return b.type===a})},item:function(a){return this.getObjects()[a]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(a){return this.getObjects().indexOf(a)>-1},complexity:function(){return this.getObjects().reduce(function(a,b){return a+=b.complexity?b.complexity():0},0)}},function(a){var b=Math.sqrt,c=Math.atan2,d=Math.PI/180;fabric.util={removeFromArray:function(a,b){var c=a.indexOf(b);return-1!==c&&a.splice(c,1),a},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},degreesToRadians:function(a){return a*d},radiansToDegrees:function(a){return a/d},rotatePoint:function(a,b,c){var d=Math.sin(c),e=Math.cos(c);a.subtractEquals(b);var f=a.x*e-a.y*d,g=a.x*d+a.y*e;return new fabric.Point(f,g).addEquals(b)},toFixed:function(a,b){return parseFloat(Number(a).toFixed(b))},falseFunction:function(){return!1},getKlass:function(a,b){return a=fabric.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),fabric.util.resolveNamespace(b)[a]},resolveNamespace:function(b){if(!b)return fabric;for(var c=b.split("."),d=c.length,e=a||fabric.window,f=0;d>f;++f)e=e[c[f]];return e},loadImage:function(a,b,c,d){if(!a)return void(b&&b.call(c,a));var e=fabric.util.createImage();e.onload=function(){b&&b.call(c,e),e=e.onload=e.onerror=null},e.onerror=function(){fabric.log("Error loading "+e.src),b&&b.call(c,null,!0),e=e.onload=e.onerror=null},0!==a.indexOf("data")&&"undefined"!=typeof d&&(e.crossOrigin=d),e.src=a},enlivenObjects:function(a,b,c,d){function e(){++g===h&&b&&b(f)}a=a||[];var f=[],g=0,h=a.length;return h?void a.forEach(function(a,b){if(!a||!a.type)return void e();var g=fabric.util.getKlass(a.type,c);g.async?g.fromObject(a,function(c,g){g||(f[b]=c,d&&d(a,f[b])),e()}):(f[b]=g.fromObject(a),d&&d(a,f[b]),e())}):void(b&&b(f))},groupSVGElements:function(a,b,c){var d;return d=a.length>1?new fabric.PathGroup(a,b):a[0],"undefined"!=typeof c&&d.setSourcePath(c),d},populateWithProperties:function(a,b,c){if(c&&"[object Array]"===Object.prototype.toString.call(c))for(var d=0,e=c.length;e>d;d++)c[d]in a&&(b[c[d]]=a[c[d]])},drawDashedLine:function(a,d,e,f,g,h){var i=f-d,j=g-e,k=b(i*i+j*j),l=c(j,i),m=h.length,n=0,o=!0;for(a.save(),a.translate(d,e),a.moveTo(0,0),a.rotate(l),d=0;k>d;)d+=h[n++%m],d>k&&(d=k),a[o?"lineTo":"moveTo"](d,0),o=!o;a.restore()},createCanvasElement:function(a){return a||(a=fabric.document.createElement("canvas")),a.getContext||"undefined"==typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(a),a},createImage:function(){return fabric.isLikelyNode?new(require("canvas").Image):fabric.document.createElement("img")},createAccessors:function(a){for(var b=a.prototype,c=b.stateProperties.length;c--;){var d=b.stateProperties[c],e=d.charAt(0).toUpperCase()+d.slice(1),f="set"+e,g="get"+e;b[g]||(b[g]=function(a){return new Function('return this.get("'+a+'")')}(d)),b[f]||(b[f]=function(a){return new Function("value",'return this.set("'+a+'", value)')}(d))}},clipContext:function(a,b){b.save(),b.beginPath(),a.clipTo(b),b.clip()},multiplyTransformMatrices:function(a,b){for(var c=[[a[0],a[2],a[4]],[a[1],a[3],a[5]],[0,0,1]],d=[[b[0],b[2],b[4]],[b[1],b[3],b[5]],[0,0,1]],e=[],f=0;3>f;f++){e[f]=[];for(var g=0;3>g;g++){for(var h=0,i=0;3>i;i++)h+=c[f][i]*d[i][g];e[f][g]=h}}return[e[0][0],e[1][0],e[0][1],e[1][1],e[0][2],e[1][2]]},getFunctionBody:function(a){return(String(a).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},normalizePoints:function(a,b){var c=fabric.util.array.min(a,"x"),d=fabric.util.array.min(a,"y");c=0>c?c:0,d=0>c?d:0;for(var e=0,f=a.length;f>e;e++)a[e].x-=b.width/2+c||0,a[e].y-=b.height/2+d||0},isTransparent:function(a,b,c,d){d>0&&(b>d?b-=d:b=0,c>d?c-=d:c=0);for(var e=!0,f=a.getImageData(b,c,2*d||1,2*d||1),g=3,h=f.data.length;h>g;g+=4){var i=f.data[g];if(e=0>=i,e===!1)break}return f=null,e}}}("undefined"!=typeof exports?exports:this),function(){function a(a,c,f,h,i,j,k,l,m){if(d=g.call(arguments),e[d])return e[d];var n=b(k,f,h,l,m,a,c),o=(n.x1-n.x0)*(n.x1-n.x0)+(n.y1-n.y0)*(n.y1-n.y0),p=1/o-.25;0>p&&(p=0);var q=Math.sqrt(p);j===i&&(q=-q);var r=.5*(n.x0+n.x1)-q*(n.y1-n.y0),s=.5*(n.y0+n.y1)+q*(n.x1-n.x0),t=Math.atan2(n.y0-s,n.x0-r),u=Math.atan2(n.y1-s,n.x1-r),v=u-t;0>v&&1===j?v+=2*Math.PI:v>0&&0===j&&(v-=2*Math.PI);for(var w=Math.ceil(Math.abs(v/(.5*Math.PI+.001))),x=[],y=0;w>y;y++){var z=t+y*v/w,A=t+(y+1)*v/w;x[y]=[r,s,z,A,f,h,n.sinTh,n.cosTh]}return e[d]=x,x}function b(a,b,c,d,e,f,g){var h=a*(Math.PI/180),i=Math.sin(h),j=Math.cos(h);b=Math.abs(b),c=Math.abs(c);var k=j*(d-f)*.5+i*(e-g)*.5,l=j*(e-g)*.5-i*(d-f)*.5,m=k*k/(b*b)+l*l/(c*c);m>1&&(m=Math.sqrt(m),b*=m,c*=m);var n=j/b,o=i/b,p=-i/c,q=j/c;return{x0:n*d+o*e,y0:p*d+q*e,x1:n*f+o*g,y1:p*f+q*g,sinTh:i,cosTh:j}}function c(a,b,c,e,h,i,j,k){if(d=g.call(arguments),f[d])return f[d];var l=k*h,m=-j*i,n=j*h,o=k*i,p=.5*(e-c),q=8/3*Math.sin(.5*p)*Math.sin(.5*p)/Math.sin(p),r=a+Math.cos(c)-q*Math.sin(c),s=b+Math.sin(c)+q*Math.cos(c),t=a+Math.cos(e),u=b+Math.sin(e),v=t+q*Math.sin(e),w=u-q*Math.cos(e);return f[d]=[l*r+m*s,n*r+o*s,l*v+m*w,n*v+o*w,l*t+m*u,n*t+o*u],f[d]}var d,e={},f={},g=Array.prototype.join;fabric.util.drawArc=function(b,d,e,f){for(var g=f[0],h=f[1],i=f[2],j=f[3],k=f[4],l=f[5],m=f[6],n=a(l,m,g,h,j,k,i,d,e),o=0;o<n.length;o++){var p=c.apply(this,n[o]);b.bezierCurveTo.apply(b,p)}}}(),function(){function a(a,b){for(var c=e.call(arguments,2),d=[],f=0,g=a.length;g>f;f++)d[f]=c.length?a[f][b].apply(a[f],c):a[f][b].call(a[f]);return d}function b(a,b){return d(a,b,function(a,b){return a>=b})}function c(a,b){return d(a,b,function(a,b){return b>a})}function d(a,b,c){if(a&&0!==a.length){var d=a.length-1,e=b?a[d][b]:a[d];if(b)for(;d--;)c(a[d][b],e)&&(e=a[d][b]);else for(;d--;)c(a[d],e)&&(e=a[d]);return e}}var e=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==Number.POSITIVE_INFINITY&&d!==Number.NEGATIVE_INFINITY&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length>>>0;d>c;c++)c in this&&a.call(b,this[c],c,this)}),Array.prototype.map||(Array.prototype.map=function(a,b){for(var c=[],d=0,e=this.length>>>0;e>d;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c}),Array.prototype.every||(Array.prototype.every=function(a,b){for(var c=0,d=this.length>>>0;d>c;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(a,b){for(var c=0,d=this.length>>>0;d>c;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(a,b){for(var c,d=[],e=0,f=this.length>>>0;f>e;e++)e in this&&(c=this[e],a.call(b,c,e,this)&&d.push(c));return d}),Array.prototype.reduce||(Array.prototype.reduce=function(a){var b,c=this.length>>>0,d=0;if(arguments.length>1)b=arguments[1];else for(;;){if(d in this){b=this[d++];break}if(++d>=c)throw new TypeError}for(;c>d;d++)d in this&&(b=a.call(null,b,this[d],d,this));return b}),fabric.util.array={invoke:a,min:c,max:b}}(),function(){function a(a,b){for(var c in b)a[c]=b[c];return a}function b(b){return a({},b)}fabric.util.object={extend:a,clone:b}}(),function(){function a(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})}function b(a,b){return a.charAt(0).toUpperCase()+(b?a.slice(1):a.slice(1).toLowerCase())}function c(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}),fabric.util.string={camelize:a,capitalize:b,escapeXml:c}}(),function(){var a=Array.prototype.slice,b=Function.prototype.apply,c=function(){};Function.prototype.bind||(Function.prototype.bind=function(d){var e,f=this,g=a.call(arguments,1);return e=g.length?function(){return b.call(f,this instanceof c?this:d,g.concat(a.call(arguments)))}:function(){return b.call(f,this instanceof c?this:d,arguments)},c.prototype=this.prototype,e.prototype=new c,e})}(),function(){function a(){}function b(a){var b=this.constructor.superclass.prototype[a];return arguments.length>1?b.apply(this,d.call(arguments,1)):b.call(this)}function c(){function c(){this.initialize.apply(this,arguments)}var f=null,h=d.call(arguments,0);"function"==typeof h[0]&&(f=h.shift()),c.superclass=f,c.subclasses=[],f&&(a.prototype=f.prototype,c.prototype=new a,f.subclasses.push(c));for(var i=0,j=h.length;j>i;i++)g(c,h[i],f);return c.prototype.initialize||(c.prototype.initialize=e),c.prototype.constructor=c,c.prototype.callSuper=b,c}var d=Array.prototype.slice,e=function(){},f=function(){for(var a in{toString:1})if("toString"===a)return!1;return!0}(),g=function(a,b,c){for(var d in b)a.prototype[d]=d in a.prototype&&"function"==typeof a.prototype[d]&&(b[d]+"").indexOf("callSuper")>-1?function(a){return function(){var d=this.constructor.superclass;this.constructor.superclass=c;var e=b[a].apply(this,arguments);return this.constructor.superclass=d,"initialize"!==a?e:void 0}}(d):b[d],f&&(b.toString!==Object.prototype.toString&&(a.prototype.toString=b.toString),b.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=b.valueOf))};fabric.util.createClass=c}(),function(){function a(a){var b,c,d=Array.prototype.slice.call(arguments,1),e=d.length;for(c=0;e>c;c++)if(b=typeof a[d[c]],!/^(?:function|object|unknown)$/.test(b))return!1;return!0}function b(a,b){return{handler:b,wrappedHandler:c(a,b)}}function c(a,b){return function(c){b.call(g(a),c||fabric.window.event)}}function d(a,b){return function(c){if(p[a]&&p[a][b])for(var d=p[a][b],e=0,f=d.length;f>e;e++)d[e].call(this,c||fabric.window.event)}}function e(a,b){a||(a=fabric.window.event);var c=a.target||(typeof a.srcElement!==i?a.srcElement:null),d=fabric.util.getScrollLeftTop(c,b);return{x:q(a)+d.left,y:r(a)+d.top}}function f(a,b,c){var d="touchend"===a.type?"changedTouches":"touches";return a[d]&&a[d][0]?a[d][0][b]-(a[d][0][b]-a[d][0][c])||a[c]:a[c]}var g,h,i="unknown",j=function(){var a=0;return function(b){return b.__uniqueID||(b.__uniqueID="uniqueID__"+a++)}}();!function(){var a={};g=function(b){return a[b]},h=function(b,c){a[b]=c}}();var k,l,m=a(fabric.document.documentElement,"addEventListener","removeEventListener")&&a(fabric.window,"addEventListener","removeEventListener"),n=a(fabric.document.documentElement,"attachEvent","detachEvent")&&a(fabric.window,"attachEvent","detachEvent"),o={},p={};m?(k=function(a,b,c){a.addEventListener(b,c,!1)},l=function(a,b,c){a.removeEventListener(b,c,!1)}):n?(k=function(a,c,d){var e=j(a);h(e,a),o[e]||(o[e]={}),o[e][c]||(o[e][c]=[]);var f=b(e,d);o[e][c].push(f),a.attachEvent("on"+c,f.wrappedHandler)},l=function(a,b,c){var d,e=j(a);if(o[e]&&o[e][b])for(var f=0,g=o[e][b].length;g>f;f++)d=o[e][b][f],d&&d.handler===c&&(a.detachEvent("on"+b,d.wrappedHandler),o[e][b][f]=null)}):(k=function(a,b,c){var e=j(a);if(p[e]||(p[e]={}),!p[e][b]){p[e][b]=[];var f=a["on"+b];f&&p[e][b].push(f),a["on"+b]=d(e,b)}p[e][b].push(c)},l=function(a,b,c){var d=j(a);if(p[d]&&p[d][b])for(var e=p[d][b],f=0,g=e.length;g>f;f++)e[f]===c&&e.splice(f,1)}),fabric.util.addListener=k,fabric.util.removeListener=l;var q=function(a){return typeof a.clientX!==i?a.clientX:0},r=function(a){return typeof a.clientY!==i?a.clientY:0};fabric.isTouchSupported&&(q=function(a){return f(a,"pageX","clientX")},r=function(a){return f(a,"pageY","clientY")}),fabric.util.getPointer=e,fabric.util.object.extend(fabric.util,fabric.Observable)}(),function(){function a(a,b){var c=a.style;if(!c)return a;if("string"==typeof b)return a.style.cssText+=";"+b,b.indexOf("opacity")>-1?f(a,b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var d in b)if("opacity"===d)f(a,b[d]);else{var e="float"===d||"cssFloat"===d?"undefined"==typeof c.styleFloat?"cssFloat":"styleFloat":d;c[e]=b[d]}return a}var b=fabric.document.createElement("div"),c="string"==typeof b.style.opacity,d="string"==typeof b.style.filter,e=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,f=function(a){return a};c?f=function(a,b){return a.style.opacity=b,a}:d&&(f=function(a,b){var c=a.style;return a.currentStyle&&!a.currentStyle.hasLayout&&(c.zoom=1),e.test(c.filter)?(b=b>=.9999?"":"alpha(opacity="+100*b+")",c.filter=c.filter.replace(e,b)):c.filter+=" alpha(opacity="+100*b+")",a}),fabric.util.setStyle=a}(),function(){function a(a){return"string"==typeof a?fabric.document.getElementById(a):a}function b(a,b){var c=fabric.document.createElement(a);for(var d in b)"class"===d?c.className=b[d]:"for"===d?c.htmlFor=b[d]:c.setAttribute(d,b[d]);return c}function c(a,b){a&&-1===(" "+a.className+" ").indexOf(" "+b+" ")&&(a.className+=(a.className?" ":"")+b)}function d(a,c,d){return"string"==typeof c&&(c=b(c,d)),a.parentNode&&a.parentNode.replaceChild(c,a),c.appendChild(a),c}function e(a,b){var c,d,e=0,f=0,g=fabric.document.documentElement,h=fabric.document.body||{scrollLeft:0,scrollTop:0};for(d=a;a&&a.parentNode&&!c;)a=a.parentNode,a!==fabric.document&&"fixed"===fabric.util.getElementStyle(a,"position")&&(c=a),a!==fabric.document&&d!==b&&"absolute"===fabric.util.getElementStyle(a,"position")?(e=0,f=0):a===fabric.document?(e=h.scrollLeft||g.scrollLeft||0,f=h.scrollTop||g.scrollTop||0):(e+=a.scrollLeft||0,f+=a.scrollTop||0);return{left:e,top:f}}function f(a){var b,c,d=a&&a.ownerDocument,e={left:0,top:0},f={left:0,top:0},g={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!d)return{left:0,top:0};for(var h in g)f[g[h]]+=parseInt(k(a,h),10)||0;return b=d.documentElement,"undefined"!=typeof a.getBoundingClientRect&&(e=a.getBoundingClientRect()),c=fabric.util.getScrollLeftTop(a,null),{left:e.left+c.left-(b.clientLeft||0)+f.left,top:e.top+c.top-(b.clientTop||0)+f.top}}var g,h=Array.prototype.slice,i=function(a){return h.call(a,0)};try{g=i(fabric.document.childNodes)instanceof Array}catch(j){}g||(i=function(a){for(var b=new Array(a.length),c=a.length;c--;)b[c]=a[c];return b});var k;k=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(a,b){return fabric.document.defaultView.getComputedStyle(a,null)[b]}:function(a,b){var c=a.style[b];return!c&&a.currentStyle&&(c=a.currentStyle[b]),c},function(){function a(a){return"undefined"!=typeof a.onselectstart&&(a.onselectstart=fabric.util.falseFunction),d?a.style[d]="none":"string"==typeof a.unselectable&&(a.unselectable="on"),a}function b(a){return"undefined"!=typeof a.onselectstart&&(a.onselectstart=null),d?a.style[d]="":"string"==typeof a.unselectable&&(a.unselectable=""),a}var c=fabric.document.documentElement.style,d="userSelect"in c?"userSelect":"MozUserSelect"in c?"MozUserSelect":"WebkitUserSelect"in c?"WebkitUserSelect":"KhtmlUserSelect"in c?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=a,fabric.util.makeElementSelectable=b}(),function(){function a(a,b){var c=fabric.document.getElementsByTagName("head")[0],d=fabric.document.createElement("script"),e=!0;d.onload=d.onreadystatechange=function(a){if(e){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;e=!1,b(a||fabric.window.event),d=d.onload=d.onreadystatechange=null}},d.src=a,c.appendChild(d)}fabric.util.getScript=a}(),fabric.util.getById=a,fabric.util.toArray=i,fabric.util.makeElement=b,fabric.util.addClass=c,fabric.util.wrapElement=d,fabric.util.getScrollLeftTop=e,fabric.util.getElementOffset=f,fabric.util.getElementStyle=k}(),function(){function a(a,b){return a+(/\?/.test(a)?"&":"?")+b}function b(){}function c(c,e){e||(e={});var f,g=e.method?e.method.toUpperCase():"GET",h=e.onComplete||function(){},i=d();return i.onreadystatechange=function(){4===i.readyState&&(h(i),i.onreadystatechange=b)},"GET"===g&&(f=null,"string"==typeof e.parameters&&(c=a(c,e.parameters))),i.open(g,c,!0),("POST"===g||"PUT"===g)&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(f),i}var d=function(){for(var a=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],b=a.length;b--;)try{var c=a[b]();if(c)return a[b]}catch(d){}}();fabric.util.request=c}(),fabric.log=function(){},fabric.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(a){"undefined"!=typeof console[a]&&console[a].apply&&(fabric[a]=function(){return console[a].apply(console,arguments)})}),function(){function a(a){b(function(c){a||(a={});var d,e=c||+new Date,f=a.duration||500,g=e+f,h=a.onChange||function(){},i=a.abort||function(){return!1},j=a.easing||function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},k="startValue"in a?a.startValue:0,l="endValue"in a?a.endValue:100,m=a.byValue||l-k;a.onStart&&a.onStart(),function n(c){d=c||+new Date;var l=d>g?f:d-e;return i()?void(a.onComplete&&a.onComplete()):(h(j(l,k,m,f)),d>g?void(a.onComplete&&a.onComplete()):void b(n))}(e)})}function b(){return c.apply(fabric.window,arguments)}var c=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(a){fabric.window.setTimeout(a,1e3/60)};fabric.util.animate=a,fabric.util.requestAnimFrame=b}(),function(){function a(a,b,c,d){return a<Math.abs(b)?(a=b,d=c/4):d=c/(2*Math.PI)*Math.asin(b/a),{a:a,c:b,p:c,s:d}}function b(a,b,c){return a.a*Math.pow(2,10*(b-=1))*Math.sin(2*(b*c-a.s)*Math.PI/a.p)}function c(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b}function d(a,b,c,d){return a/=d/2,1>a?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b}function e(a,b,c,d){return c*(a/=d)*a*a*a+b}function f(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b}function g(a,b,c,d){return a/=d/2,1>a?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b}function h(a,b,c,d){return c*(a/=d)*a*a*a*a+b}function i(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b}function j(a,b,c,d){return a/=d/2,1>a?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b}function k(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b}function l(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b}function m(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b}function n(a,b,c,d){return 0===a?b:c*Math.pow(2,10*(a/d-1))+b}function o(a,b,c,d){return a===d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b}function p(a,b,c,d){return 0===a?b:a===d?b+c:(a/=d/2,1>a?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b)}function q(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b}function r(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b}function s(a,b,c,d){return a/=d/2,1>a?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b}function t(c,d,e,f){var g=1.70158,h=0,i=e;if(0===c)return d;if(c/=f,1===c)return d+e;h||(h=.3*f);var j=a(i,e,h,g);return-b(j,c,f)+d}function u(b,c,d,e){var f=1.70158,g=0,h=d;if(0===b)return c;if(b/=e,1===b)return c+d;g||(g=.3*e);var i=a(h,d,g,f);return i.a*Math.pow(2,-10*b)*Math.sin(2*(b*e-i.s)*Math.PI/i.p)+i.c+c}function v(c,d,e,f){var g=1.70158,h=0,i=e;if(0===c)return d;if(c/=f/2,2===c)return d+e;h||(h=.3*f*1.5);var j=a(i,e,h,g);return 1>c?-.5*b(j,c,f)+d:j.a*Math.pow(2,-10*(c-=1))*Math.sin(2*(c*f-j.s)*Math.PI/j.p)*.5+j.c+d}function w(a,b,c,d,e){return void 0===e&&(e=1.70158),c*(a/=d)*a*((e+1)*a-e)+b}function x(a,b,c,d,e){return void 0===e&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b}function y(a,b,c,d,e){return void 0===e&&(e=1.70158),a/=d/2,1>a?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b}function z(a,b,c,d){return c-A(d-a,0,c,d)+b}function A(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b}function B(a,b,c,d){return d/2>a?.5*z(2*a,0,c,d)+b:.5*A(2*a-d,0,c,d)+.5*c+b}fabric.util.ease={easeInQuad:function(a,b,c,d){return c*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){return a/=d/2,1>a?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},easeInCubic:function(a,b,c,d){return c*(a/=d)*a*a+b},easeOutCubic:c,easeInOutCubic:d,easeInQuart:e,easeOutQuart:f,easeInOutQuart:g,easeInQuint:h,easeOutQuint:i,easeInOutQuint:j,easeInSine:k,easeOutSine:l,easeInOutSine:m,easeInExpo:n,easeOutExpo:o,easeInOutExpo:p,easeInCirc:q,easeOutCirc:r,easeInOutCirc:s,easeInElastic:t,easeOutElastic:u,easeInOutElastic:v,easeInBack:w,easeOutBack:x,easeInOutBack:y,easeInBounce:z,easeOutBounce:A,easeInOutBounce:B}}(),function(a){"use strict";function b(a){return a in q?q[a]:a}function c(a,b,c){var d;"fill"!==a&&"stroke"!==a||"none"!==b?"fillRule"===a?b="evenodd"===b?"destination-over":b:"strokeDashArray"===a?b=b.replace(/,/g," ").split(/\s+/):"transformMatrix"===a?b=c&&c.transformMatrix?p(c.transformMatrix,k.parseTransformAttribute(b)):k.parseTransformAttribute(b):"visible"===a?(b="none"===b||"hidden"===b?!1:!0,c.visible===!1&&(b=!1)):"originX"===a&&(b="start"===b?"left":"end"===b?"right":"center"):b="",d="[object Array]"===Object.prototype.toString.call(b);var e=d?b.map(parseFloat):parseFloat(b);return!d&&isNaN(e)?b:e}function d(a){for(var b in r)if(a[b]&&"undefined"!=typeof a[r[b]]&&0!==a[b].indexOf("url(")){var c=new k.Color(a[b]);a[b]=c.setAlpha(o(c.getAlpha()*a[r[b]],2)).toRgba(),delete a[r[b]]}return a}function e(a,b){var c=a.match(/(normal|italic)?\s*(normal|small-caps)?\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\s*(\d+)px(?:\/(normal|[\d\.]+))?\s+(.*)/);if(c){var d=c[1],e=c[3],f=c[4],g=c[5],h=c[6];d&&(b.fontStyle=d),e&&(b.fontWeight=isNaN(parseFloat(e))?e:parseFloat(e)),f&&(b.fontSize=parseFloat(f)),h&&(b.fontFamily=h),g&&(b.lineHeight="normal"===g?1:g)}}function f(a,d){var f,g;a.replace(/;$/,"").split(";").forEach(function(a){var h=a.split(":");f=b(h[0].trim().toLowerCase()),g=c(f,h[1].trim()),"font"===f?e(g,d):d[f]=g})}function g(a,d){var f,g;for(var h in a)"undefined"!=typeof a[h]&&(f=b(h.toLowerCase()),g=c(f,a[h]),"font"===f?e(g,d):d[f]=g)}function h(a){var b=a.nodeName,c=a.getAttribute("class"),d=a.getAttribute("id"),e={};for(var f in k.cssRules){var g=c&&new RegExp("^\\."+c).test(f)||d&&new RegExp("^#"+d).test(f)||new RegExp("^"+b).test(f);if(g)for(var h in k.cssRules[f])e[h]=k.cssRules[f][h]}return e}function i(a){var b=a.objects,c=a.options;return b=b.map(function(a){return k[m(a.type)].fromObject(a)}),{objects:b,options:c}}function j(a,b,c){b[c]&&b[c].toSVG&&a.push('<pattern x="0" y="0" id="',c,'Pattern" ','width="',b[c].source.width,'" height="',b[c].source.height,'" patternUnits="userSpaceOnUse">','<image x="0" y="0" ','width="',b[c].source.width,'" height="',b[c].source.height,'" xlink:href="',b[c].source.src,'"></image></pattern>')}var k=a.fabric||(a.fabric={}),l=k.util.object.extend,m=k.util.string.capitalize,n=k.util.object.clone,o=k.util.toFixed,p=k.util.multiplyTransformMatrices,q={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},r={stroke:"strokeOpacity",fill:"fillOpacity"};
k.parseTransformAttribute=function(){function a(a,b){var c=b[0];a[0]=Math.cos(c),a[1]=Math.sin(c),a[2]=-Math.sin(c),a[3]=Math.cos(c)}function b(a,b){var c=b[0],d=2===b.length?b[1]:b[0];a[0]=c,a[3]=d}function c(a,b){a[2]=b[0]}function d(a,b){a[1]=b[0]}function e(a,b){a[4]=b[0],2===b.length&&(a[5]=b[1])}var f=[1,0,0,1,0,0],g="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",h="(?:\\s+,?\\s*|,\\s*)",i="(?:(skewX)\\s*\\(\\s*("+g+")\\s*\\))",j="(?:(skewY)\\s*\\(\\s*("+g+")\\s*\\))",l="(?:(rotate)\\s*\\(\\s*("+g+")(?:"+h+"("+g+")"+h+"("+g+"))?\\s*\\))",m="(?:(scale)\\s*\\(\\s*("+g+")(?:"+h+"("+g+"))?\\s*\\))",n="(?:(translate)\\s*\\(\\s*("+g+")(?:"+h+"("+g+"))?\\s*\\))",o="(?:(matrix)\\s*\\(\\s*("+g+")"+h+"("+g+")"+h+"("+g+")"+h+"("+g+")"+h+"("+g+")"+h+"("+g+")\\s*\\))",p="(?:"+o+"|"+n+"|"+m+"|"+l+"|"+i+"|"+j+")",q="(?:"+p+"(?:"+h+p+")*)",r="^\\s*(?:"+q+"?)\\s*$",s=new RegExp(r),t=new RegExp(p,"g");return function(g){var h=f.concat(),i=[];if(!g||g&&!s.test(g))return h;g.replace(t,function(g){var j=new RegExp(p).exec(g).filter(function(a){return""!==a&&null!=a}),l=j[1],m=j.slice(2).map(parseFloat);switch(l){case"translate":e(h,m);break;case"rotate":m[0]=k.util.degreesToRadians(m[0]),a(h,m);break;case"scale":b(h,m);break;case"skewX":c(h,m);break;case"skewY":d(h,m);break;case"matrix":h=m}i.push(h.concat()),h=f.concat()});for(var j=i[0];i.length>1;)i.shift(),j=k.util.multiplyTransformMatrices(j,i[0]);return j}}(),k.parseSVGDocument=function(){function a(a,b){for(;a&&(a=a.parentNode);)if(b.test(a.nodeName))return!0;return!1}var b=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,c="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",d=new RegExp("^\\s*("+c+"+)\\s*,?\\s*("+c+"+)\\s*,?\\s*("+c+"+)\\s*,?\\s*("+c+"+)\\s*$");return function(c,e,f){if(c){var g=new Date,h=k.util.toArray(c.getElementsByTagName("*"));if(0===h.length){h=c.selectNodes('//*[name(.)!="svg"]');for(var i=[],j=0,l=h.length;l>j;j++)i[j]=h[j];h=i}var m=h.filter(function(c){return b.test(c.tagName)&&!a(c,/^(?:pattern|defs)$/)});if(m&&(!m||m.length)){var o,p,q,r,s=c.getAttribute("viewBox"),t=parseFloat(c.getAttribute("width")),u=parseFloat(c.getAttribute("height")),v=null,w=null;s&&(s=s.match(d))&&(q=parseFloat(s[1]),r=parseFloat(s[2]),o=parseFloat(s[3]),p=parseFloat(s[4])),o&&t&&o!==t?(v=o,w=p):(v=t?t:o,w=u?u:p);var x={width:v,height:w,widthAttr:t,heightAttr:u};k.gradientDefs=k.getGradientDefs(c),k.cssRules=k.getCSSRules(c),k.parseElements(m,function(a){k.documentParsingTime=new Date-g,e&&e(a,x)},n(x),f)}}}}();var s={has:function(a,b){b(!1)},get:function(){},set:function(){}};l(k,{resolveGradients:function(a){for(var b=a.length;b--;){var c=a[b].get("fill");if(/^url\(/.test(c)){var d=c.slice(5,c.length-1);k.gradientDefs[d]&&a[b].set("fill",k.Gradient.fromElement(k.gradientDefs[d],a[b]))}}},getGradientDefs:function(a){var b,c,d=a.getElementsByTagName("linearGradient"),e=a.getElementsByTagName("radialGradient"),f={};for(c=d.length;c--;)b=d[c],f[b.getAttribute("id")]=b;for(c=e.length;c--;)b=e[c],f[b.getAttribute("id")]=b;return f},parseAttributes:function(a,e){if(a){var f,g={};a.parentNode&&/^g$/i.test(a.parentNode.nodeName)&&(g=k.parseAttributes(a.parentNode,e));var i=e.reduce(function(d,e){return f=a.getAttribute(e),f&&(e=b(e),f=c(e,f,g),d[e]=f),d},{});return i=l(i,l(h(a),k.parseStyleAttribute(a))),d(l(g,i))}},parseElements:function(a,b,c,d){new k.ElementsParser(a,b,c,d).parse()},parseStyleAttribute:function(a){var b={},c=a.getAttribute("style");return c?("string"==typeof c?f(c,b):g(c,b),b):b},parsePointsAttribute:function(a){if(!a)return null;a=a.trim();var b=a.indexOf(",")>-1;a=a.split(/\s+/);var c,d,e=[];if(b)for(c=0,d=a.length;d>c;c++){var f=a[c].split(",");e.push({x:parseFloat(f[0]),y:parseFloat(f[1])})}else for(c=0,d=a.length;d>c;c+=2)e.push({x:parseFloat(a[c]),y:parseFloat(a[c+1])});return e},getCSSRules:function(a){for(var b,c=a.getElementsByTagName("style"),d={},e=0,f=c.length;f>e;e++){var g=c[0].textContent;g=g.replace(/\/\*[\s\S]*?\*\//g,""),b=g.match(/[^{]*\{[\s\S]*?\}/g),b=b.map(function(a){return a.trim()}),b.forEach(function(a){var b=a.match(/([\s\S]*?)\s*\{([^}]*)\}/);a=b[1];var c=b[2].trim(),e=c.replace(/;$/,"").split(/\s*;\s*/);d[a]||(d[a]={});for(var f=0,g=e.length;g>f;f++){var h=e[f].split(/\s*:\s*/),i=h[0],j=h[1];d[a][i]=j}})}return d},loadSVGFromURL:function(a,b,c){function d(d){var e=d.responseXML;e&&!e.documentElement&&k.window.ActiveXObject&&d.responseText&&(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(d.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""))),e&&e.documentElement&&k.parseSVGDocument(e.documentElement,function(c,d){s.set(a,{objects:k.util.array.invoke(c,"toObject"),options:d}),b(c,d)},c)}a=a.replace(/^\n\s*/,"").trim(),s.has(a,function(c){c?s.get(a,function(a){var c=i(a);b(c.objects,c.options)}):new k.util.request(a,{method:"get",onComplete:d})})},loadSVGFromString:function(a,b,c){a=a.trim();var d;if("undefined"!=typeof DOMParser){var e=new DOMParser;e&&e.parseFromString&&(d=e.parseFromString(a,"text/xml"))}else k.window.ActiveXObject&&(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(a.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));k.parseSVGDocument(d.documentElement,function(a,c){b(a,c)},c)},createSVGFontFacesMarkup:function(a){for(var b="",c=0,d=a.length;d>c;c++)"text"===a[c].type&&a[c].path&&(b+=["@font-face {","font-family: ",a[c].fontFamily,"; ","src: url('",a[c].path,"')","}"].join(""));return b&&(b=['<style type="text/css">',"<![CDATA[",b,"]]>","</style>"].join("")),b},createSVGRefElementsMarkup:function(a){var b=[];return j(b,a,"backgroundColor"),j(b,a,"overlayColor"),b.join("")}})}("undefined"!=typeof exports?exports:this),fabric.ElementsParser=function(a,b,c,d){this.elements=a,this.callback=b,this.options=c,this.reviver=d},fabric.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var a=0,b=this.elements.length;b>a;a++)!function(a,b){setTimeout(function(){a.createObject(a.elements[b],b)},0)}(this,a)},fabric.ElementsParser.prototype.createObject=function(a,b){var c=fabric[fabric.util.string.capitalize(a.tagName)];if(c&&c.fromElement)try{this._createObject(c,a,b)}catch(d){fabric.log(d)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(a,b,c){if(a.async)a.fromElement(b,this.createCallback(c,b),this.options);else{var d=a.fromElement(b,this.options);this.reviver&&this.reviver(b,d),this.instances.splice(c,0,d),this.checkIfDone()}},fabric.ElementsParser.prototype.createCallback=function(a,b){var c=this;return function(d){c.reviver&&c.reviver(b,d),c.instances.splice(a,0,d),c.checkIfDone()}},fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(a){return null!=a}),fabric.resolveGradients(this.instances),this.callback(this.instances))},function(a){"use strict";function b(a,b){this.x=a,this.y=b}var c=a.fabric||(a.fabric={});return c.Point?void c.warn("fabric.Point is already defined"):(c.Point=b,void(b.prototype={constructor:b,add:function(a){return new b(this.x+a.x,this.y+a.y)},addEquals:function(a){return this.x+=a.x,this.y+=a.y,this},scalarAdd:function(a){return new b(this.x+a,this.y+a)},scalarAddEquals:function(a){return this.x+=a,this.y+=a,this},subtract:function(a){return new b(this.x-a.x,this.y-a.y)},subtractEquals:function(a){return this.x-=a.x,this.y-=a.y,this},scalarSubtract:function(a){return new b(this.x-a,this.y-a)},scalarSubtractEquals:function(a){return this.x-=a,this.y-=a,this},multiply:function(a){return new b(this.x*a,this.y*a)},multiplyEquals:function(a){return this.x*=a,this.y*=a,this},divide:function(a){return new b(this.x/a,this.y/a)},divideEquals:function(a){return this.x/=a,this.y/=a,this},eq:function(a){return this.x===a.x&&this.y===a.y},lt:function(a){return this.x<a.x&&this.y<a.y},lte:function(a){return this.x<=a.x&&this.y<=a.y},gt:function(a){return this.x>a.x&&this.y>a.y},gte:function(a){return this.x>=a.x&&this.y>=a.y},lerp:function(a,c){return new b(this.x+(a.x-this.x)*c,this.y+(a.y-this.y)*c)},distanceFrom:function(a){var b=this.x-a.x,c=this.y-a.y;return Math.sqrt(b*b+c*c)},midPointFrom:function(a){return new b(this.x+(a.x-this.x)/2,this.y+(a.y-this.y)/2)},min:function(a){return new b(Math.min(this.x,a.x),Math.min(this.y,a.y))},max:function(a){return new b(Math.max(this.x,a.x),Math.max(this.y,a.y))},toString:function(){return this.x+","+this.y},setXY:function(a,b){this.x=a,this.y=b},setFromPoint:function(a){this.x=a.x,this.y=a.y},swap:function(a){var b=this.x,c=this.y;this.x=a.x,this.y=a.y,a.x=b,a.y=c}}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";function b(a){this.status=a,this.points=[]}var c=a.fabric||(a.fabric={});return c.Intersection?void c.warn("fabric.Intersection is already defined"):(c.Intersection=b,c.Intersection.prototype={appendPoint:function(a){this.points.push(a)},appendPoints:function(a){this.points=this.points.concat(a)}},c.Intersection.intersectLineLine=function(a,d,e,f){var g,h=(f.x-e.x)*(a.y-e.y)-(f.y-e.y)*(a.x-e.x),i=(d.x-a.x)*(a.y-e.y)-(d.y-a.y)*(a.x-e.x),j=(f.y-e.y)*(d.x-a.x)-(f.x-e.x)*(d.y-a.y);if(0!==j){var k=h/j,l=i/j;k>=0&&1>=k&&l>=0&&1>=l?(g=new b("Intersection"),g.points.push(new c.Point(a.x+k*(d.x-a.x),a.y+k*(d.y-a.y)))):g=new b}else g=new b(0===h||0===i?"Coincident":"Parallel");return g},c.Intersection.intersectLinePolygon=function(a,c,d){for(var e=new b,f=d.length,g=0;f>g;g++){var h=d[g],i=d[(g+1)%f],j=b.intersectLineLine(a,c,h,i);e.appendPoints(j.points)}return e.points.length>0&&(e.status="Intersection"),e},c.Intersection.intersectPolygonPolygon=function(a,c){for(var d=new b,e=a.length,f=0;e>f;f++){var g=a[f],h=a[(f+1)%e],i=b.intersectLinePolygon(g,h,c);d.appendPoints(i.points)}return d.points.length>0&&(d.status="Intersection"),d},void(c.Intersection.intersectPolygonRectangle=function(a,d,e){var f=d.min(e),g=d.max(e),h=new c.Point(g.x,f.y),i=new c.Point(f.x,g.y),j=b.intersectLinePolygon(f,h,a),k=b.intersectLinePolygon(h,g,a),l=b.intersectLinePolygon(g,i,a),m=b.intersectLinePolygon(i,f,a),n=new b;return n.appendPoints(j.points),n.appendPoints(k.points),n.appendPoints(l.points),n.appendPoints(m.points),n.points.length>0&&(n.status="Intersection"),n}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";function b(a){a?this._tryParsingColor(a):this.setSource([0,0,0,1])}function c(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var d=a.fabric||(a.fabric={});return d.Color?void d.warn("fabric.Color is already defined."):(d.Color=b,d.Color.prototype={_tryParsingColor:function(a){var c;return a in b.colorNameMap&&(a=b.colorNameMap[a]),"transparent"===a?void this.setSource([255,255,255,0]):(c=b.sourceFromHex(a),c||(c=b.sourceFromRgb(a)),c||(c=b.sourceFromHsl(a)),void(c&&this.setSource(c)))},_rgbToHsl:function(a,b,c){a/=255,b/=255,c/=255;var e,f,g,h=d.util.array.max([a,b,c]),i=d.util.array.min([a,b,c]);if(g=(h+i)/2,h===i)e=f=0;else{var j=h-i;switch(f=g>.5?j/(2-h-i):j/(h+i),h){case a:e=(b-c)/j+(c>b?6:0);break;case b:e=(c-a)/j+2;break;case c:e=(a-b)/j+4}e/=6}return[Math.round(360*e),Math.round(100*f),Math.round(100*g)]},getSource:function(){return this._source},setSource:function(a){this._source=a},toRgb:function(){var a=this.getSource();return"rgb("+a[0]+","+a[1]+","+a[2]+")"},toRgba:function(){var a=this.getSource();return"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")"},toHsl:function(){var a=this.getSource(),b=this._rgbToHsl(a[0],a[1],a[2]);return"hsl("+b[0]+","+b[1]+"%,"+b[2]+"%)"},toHsla:function(){var a=this.getSource(),b=this._rgbToHsl(a[0],a[1],a[2]);return"hsla("+b[0]+","+b[1]+"%,"+b[2]+"%,"+a[3]+")"},toHex:function(){var a,b,c,d=this.getSource();return a=d[0].toString(16),a=1===a.length?"0"+a:a,b=d[1].toString(16),b=1===b.length?"0"+b:b,c=d[2].toString(16),c=1===c.length?"0"+c:c,a.toUpperCase()+b.toUpperCase()+c.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(a){var b=this.getSource();return b[3]=a,this.setSource(b),this},toGrayscale:function(){var a=this.getSource(),b=parseInt((.3*a[0]+.59*a[1]+.11*a[2]).toFixed(0),10),c=a[3];return this.setSource([b,b,b,c]),this},toBlackWhite:function(a){var b=this.getSource(),c=(.3*b[0]+.59*b[1]+.11*b[2]).toFixed(0),d=b[3];return a=a||127,c=Number(c)<Number(a)?0:255,this.setSource([c,c,c,d]),this},overlayWith:function(a){a instanceof b||(a=new b(a));for(var c=[],d=this.getAlpha(),e=.5,f=this.getSource(),g=a.getSource(),h=0;3>h;h++)c.push(Math.round(f[h]*(1-e)+g[h]*e));return c[3]=d,this.setSource(c),this}},d.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,d.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,d.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,d.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},d.Color.fromRgb=function(a){return b.fromSource(b.sourceFromRgb(a))},d.Color.sourceFromRgb=function(a){var c=a.match(b.reRGBa);if(c){var d=parseInt(c[1],10)/(/%$/.test(c[1])?100:1)*(/%$/.test(c[1])?255:1),e=parseInt(c[2],10)/(/%$/.test(c[2])?100:1)*(/%$/.test(c[2])?255:1),f=parseInt(c[3],10)/(/%$/.test(c[3])?100:1)*(/%$/.test(c[3])?255:1);return[parseInt(d,10),parseInt(e,10),parseInt(f,10),c[4]?parseFloat(c[4]):1]}},d.Color.fromRgba=b.fromRgb,d.Color.fromHsl=function(a){return b.fromSource(b.sourceFromHsl(a))},d.Color.sourceFromHsl=function(a){var d=a.match(b.reHSLa);if(d){var e,f,g,h=(parseFloat(d[1])%360+360)%360/360,i=parseFloat(d[2])/(/%$/.test(d[2])?100:1),j=parseFloat(d[3])/(/%$/.test(d[3])?100:1);if(0===i)e=f=g=j;else{var k=.5>=j?j*(i+1):j+i-j*i,l=2*j-k;e=c(l,k,h+1/3),f=c(l,k,h),g=c(l,k,h-1/3)}return[Math.round(255*e),Math.round(255*f),Math.round(255*g),d[4]?parseFloat(d[4]):1]}},d.Color.fromHsla=b.fromHsl,d.Color.fromHex=function(a){return b.fromSource(b.sourceFromHex(a))},d.Color.sourceFromHex=function(a){if(a.match(b.reHex)){var c=a.slice(a.indexOf("#")+1),d=3===c.length,e=d?c.charAt(0)+c.charAt(0):c.substring(0,2),f=d?c.charAt(1)+c.charAt(1):c.substring(2,4),g=d?c.charAt(2)+c.charAt(2):c.substring(4,6);return[parseInt(e,16),parseInt(f,16),parseInt(g,16),1]}},void(d.Color.fromSource=function(a){var c=new b;return c.setSource(a),c}))}("undefined"!=typeof exports?exports:this),function(){function a(a){var b,c,d=a.getAttribute("style"),e=a.getAttribute("offset");if(e=parseFloat(e)/(/%$/.test(e)?100:1),d){var f=d.split(/\s*;\s*/);""===f[f.length-1]&&f.pop();for(var g=f.length;g--;){var h=f[g].split(/\s*:\s*/),i=h[0].trim(),j=h[1].trim();"stop-color"===i?b=j:"stop-opacity"===i&&(c=j)}}return b||(b=a.getAttribute("stop-color")||"rgb(0,0,0)"),c||(c=a.getAttribute("stop-opacity")),b=new fabric.Color(b).toRgb(),{offset:e,color:b,opacity:isNaN(parseFloat(c))?1:parseFloat(c)}}function b(a){return{x1:a.getAttribute("x1")||0,y1:a.getAttribute("y1")||0,x2:a.getAttribute("x2")||"100%",y2:a.getAttribute("y2")||0}}function c(a){return{x1:a.getAttribute("fx")||a.getAttribute("cx")||"50%",y1:a.getAttribute("fy")||a.getAttribute("cy")||"50%",r1:0,x2:a.getAttribute("cx")||"50%",y2:a.getAttribute("cy")||"50%",r2:a.getAttribute("r")||"50%"}}function d(a,b){for(var c in b){if("string"==typeof b[c]&&/^\d+%$/.test(b[c])){var d=parseFloat(b[c],10);"x1"===c||"x2"===c||"r2"===c?b[c]=fabric.util.toFixed(a.width*d/100,2):("y1"===c||"y2"===c)&&(b[c]=fabric.util.toFixed(a.height*d/100,2))}e(b,c,a)}}function e(a,b,c){"x1"===b||"x2"===b?a[b]-=fabric.util.toFixed(c.width/2,2):("y1"===b||"y2"===b)&&(a[b]-=fabric.util.toFixed(c.height/2,2))}function f(a,b){for(var c in b)e(b,c,a),"x1"===c||"x2"===c||"r2"===c?b[c]=fabric.util.toFixed(b[c]/a.width*100,2)+"%":("y1"===c||"y2"===c)&&(b[c]=fabric.util.toFixed(b[c]/a.height*100,2)+"%")}fabric.Gradient=fabric.util.createClass({initialize:function(a){a||(a={});var b={};this.id=fabric.Object.__uid++,this.type=a.type||"linear",b={x1:a.coords.x1||0,y1:a.coords.y1||0,x2:a.coords.x2||0,y2:a.coords.y2||0},"radial"===this.type&&(b.r1=a.coords.r1||0,b.r2=a.coords.r2||0),this.coords=b,this.gradientUnits=a.gradientUnits||"objectBoundingBox",this.colorStops=a.colorStops.slice()},addColorStop:function(a){for(var b in a){var c=new fabric.Color(a[b]);this.colorStops.push({offset:b,color:c.toRgb(),opacity:c.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,gradientUnits:this.gradientUnits,colorStops:this.colorStops}},toSVG:function(a,b){var c,d=fabric.util.object.clone(this.coords);this.colorStops.sort(function(a,b){return a.offset-b.offset}),b&&"userSpaceOnUse"===this.gradientUnits?(d.x1+=a.width/2,d.y1+=a.height/2,d.x2+=a.width/2,d.y2+=a.height/2):"objectBoundingBox"===this.gradientUnits&&f(a,d),"linear"===this.type?c=["<linearGradient ",'id="SVGID_',this.id,'" gradientUnits="',this.gradientUnits,'" x1="',d.x1,'" y1="',d.y1,'" x2="',d.x2,'" y2="',d.y2,'">']:"radial"===this.type&&(c=["<radialGradient ",'id="SVGID_',this.id,'" gradientUnits="',this.gradientUnits,'" cx="',d.x2,'" cy="',d.y2,'" r="',d.r2,'" fx="',d.x1,'" fy="',d.y1,'">']);for(var e=0;e<this.colorStops.length;e++)c.push("<stop ",'offset="',100*this.colorStops[e].offset+"%",'" style="stop-color:',this.colorStops[e].color,this.colorStops[e].opacity?";stop-opacity: "+this.colorStops[e].opacity:";",'"/>');return c.push("linear"===this.type?"</linearGradient>":"</radialGradient>"),c.join("")},toLive:function(a){var b;if(this.type){"linear"===this.type?b=a.createLinearGradient(this.coords.x1,this.coords.y1,this.coords.x2,this.coords.y2):"radial"===this.type&&(b=a.createRadialGradient(this.coords.x1,this.coords.y1,this.coords.r1,this.coords.x2,this.coords.y2,this.coords.r2));for(var c=0,d=this.colorStops.length;d>c;c++){var e=this.colorStops[c].color,f=this.colorStops[c].opacity,g=this.colorStops[c].offset;"undefined"!=typeof f&&(e=new fabric.Color(e).setAlpha(f).toRgba()),b.addColorStop(parseFloat(g),e)}return b}}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(e,f){var g=e.getElementsByTagName("stop"),h="linearGradient"===e.nodeName?"linear":"radial",i=e.getAttribute("gradientUnits")||"objectBoundingBox",j=[],k={};"linear"===h?k=b(e):"radial"===h&&(k=c(e));for(var l=g.length;l--;)j.push(a(g[l]));return d(f,k),new fabric.Gradient({type:h,coords:k,gradientUnits:i,colorStops:j})},forObject:function(a,b){return b||(b={}),d(a,b),new fabric.Gradient(b)}})}(),fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(a){if(a||(a={}),this.id=fabric.Object.__uid++,a.source)if("string"==typeof a.source)if("undefined"!=typeof fabric.util.getFunctionBody(a.source))this.source=new Function(fabric.util.getFunctionBody(a.source));else{var b=this;this.source=fabric.util.createImage(),fabric.util.loadImage(a.source,function(a){b.source=a})}else this.source=a.source;a.repeat&&(this.repeat=a.repeat),a.offsetX&&(this.offsetX=a.offsetX),a.offsetY&&(this.offsetY=a.offsetY)},toObject:function(){var a;return"function"==typeof this.source?a=String(this.source):"string"==typeof this.source.src&&(a=this.source.src),{source:a,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(a){var b="function"==typeof this.source?this.source():this.source,c=b.width/a.getWidth(),d=b.height/a.getHeight(),e="";return b.src?e=b.src:b.toDataURL&&(e=b.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+this.offsetX+'" y="'+this.offsetY+'" width="'+c+'" height="'+d+'"><image x="0" y="0" width="'+b.width+'" height="'+b.height+'" xlink:href="'+e+'"></image></pattern>'},toLive:function(a){var b="function"==typeof this.source?this.source():this.source;if(!b)return"";if("undefined"!=typeof b.src){if(!b.complete)return"";if(0===b.naturalWidth||0===b.naturalHeight)return""}return a.createPattern(b,this.repeat)}}),function(a){"use strict";var b=a.fabric||(a.fabric={});return b.Shadow?void b.warn("fabric.Shadow is already defined."):(b.Shadow=b.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(a){"string"==typeof a&&(a=this._parseShadow(a));for(var c in a)this[c]=a[c];this.id=b.Object.__uid++},_parseShadow:function(a){var c=a.trim(),d=b.Shadow.reOffsetsAndBlur.exec(c)||[],e=c.replace(b.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:e.trim(),offsetX:parseInt(d[1],10)||0,offsetY:parseInt(d[2],10)||0,blur:parseInt(d[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(a){var b="SourceAlpha";return!a||a.fill!==this.color&&a.stroke!==this.color||(b="SourceGraphic"),'<filter id="SVGID_'+this.id+'" y="-40%" height="180%"><feGaussianBlur in="'+b+'" stdDeviation="'+(this.blur?this.blur/3:0)+'"></feGaussianBlur><feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset><feMerge><feMergeNode></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter>'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};var a={},c=b.Shadow.prototype;return this.color!==c.color&&(a.color=this.color),this.blur!==c.blur&&(a.blur=this.blur),this.offsetX!==c.offsetX&&(a.offsetX=this.offsetX),this.offsetY!==c.offsetY&&(a.offsetY=this.offsetY),a}}),void(b.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/))}("undefined"!=typeof exports?exports:this),function(){"use strict";if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var a=fabric.util.object.extend,b=fabric.util.getElementOffset,c=fabric.util.removeFromArray,d=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(a,b){b||(b={}),this._initStatic(a,b),fabric.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,onBeforeScaleRotate:function(){},_initStatic:function(a,b){this._objects=[],this._createLowerCanvas(a),this._initOptions(b),b.overlayImage&&this.setOverlayImage(b.overlayImage,this.renderAll.bind(this)),b.backgroundImage&&this.setBackgroundImage(b.backgroundImage,this.renderAll.bind(this)),b.backgroundColor&&this.setBackgroundColor(b.backgroundColor,this.renderAll.bind(this)),b.overlayColor&&this.setOverlayColor(b.overlayColor,this.renderAll.bind(this)),this.calcOffset()},calcOffset:function(){return this._offset=b(this.lowerCanvasEl),this},setOverlayImage:function(a,b,c){return this.__setBgOverlayImage("overlayImage",a,b,c)},setBackgroundImage:function(a,b,c){return this.__setBgOverlayImage("backgroundImage",a,b,c)},setOverlayColor:function(a,b){return this.__setBgOverlayColor("overlayColor",a,b)},setBackgroundColor:function(a,b){return this.__setBgOverlayColor("backgroundColor",a,b)},__setBgOverlayImage:function(a,b,c,d){return"string"==typeof b?fabric.util.loadImage(b,function(b){this[a]=new fabric.Image(b,d),c&&c()},this):(this[a]=b,c&&c()),this},__setBgOverlayColor:function(a,b,c){if(b.source){var d=this;fabric.util.loadImage(b.source,function(e){d[a]=new fabric.Pattern({source:e,repeat:b.repeat,offsetX:b.offsetX,offsetY:b.offsetY}),c&&c()})}else this[a]=b,c&&c();return this},_createCanvasElement:function(){var a=fabric.document.createElement("canvas");if(a.style||(a.style={}),!a)throw d;return this._initCanvasElement(a),a},_initCanvasElement:function(a){if(fabric.util.createCanvasElement(a),"undefined"==typeof a.getContext)throw d},_initOptions:function(a){for(var b in a)this[b]=a[b];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px")},_createLowerCanvas:function(a){this.lowerCanvasEl=fabric.util.getById(a)||this._createCanvasElement(),this._initCanvasElement(this.lowerCanvasEl),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(a){return this._setDimension("width",a)},setHeight:function(a){return this._setDimension("height",a)},setDimensions:function(a){for(var b in a)this._setDimension(b,a[b]);return this},_setDimension:function(a,b){return this.lowerCanvasEl[a]=b,this.lowerCanvasEl.style[a]=b+"px",this.upperCanvasEl&&(this.upperCanvasEl[a]=b,this.upperCanvasEl.style[a]=b+"px"),this.cacheCanvasEl&&(this.cacheCanvasEl[a]=b),this.wrapperEl&&(this.wrapperEl.style[a]=b+"px"),this[a]=b,this.calcOffset(),this.renderAll(),this},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(a,b){if(b)if(this.controlsAboveOverlay){var c=b.hasBorders,d=b.hasControls;b.hasBorders=b.hasControls=!1,b.render(a),b.hasBorders=c,b.hasControls=d}else b.render(a)},_onObjectAdded:function(a){this.stateful&&a.setupState(),a.setCoords(),a.canvas=this,this.fire("object:added",{target:a}),a.fire("added")},_onObjectRemoved:function(a){this.getActiveObject()===a&&(this.fire("before:selection:cleared",{target:a}),this._discardActiveObject(),this.fire("selection:cleared")),this.fire("object:removed",{target:a}),a.fire("removed")},clearContext:function(a){return a.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.discardActiveGroup&&this.discardActiveGroup(),this.discardActiveObject&&this.discardActiveObject(),this.clearContext(this.contextContainer),this.contextTop&&this.clearContext(this.contextTop),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(a){var b=this[a===!0&&this.interactive?"contextTop":"contextContainer"],c=this.getActiveGroup();return this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop),a||this.clearContext(b),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,b),this._renderBackground(b),this._renderObjects(b,c),this._renderActiveGroup(b,c),this.clipTo&&b.restore(),this._renderOverlay(b),this.controlsAboveOverlay&&this.interactive&&this.drawControls(b),this.fire("after:render"),this},_renderObjects:function(a,b){var c,d;if(b)for(c=0,d=this._objects.length;d>c;++c)this._objects[c]&&!b.contains(this._objects[c])&&this._draw(a,this._objects[c]);else for(c=0,d=this._objects.length;d>c;++c)this._draw(a,this._objects[c])},_renderActiveGroup:function(a,b){if(b){var c=[];this.forEachObject(function(a){b.contains(a)&&c.push(a)}),b._set("objects",c),this._draw(a,b)}},_renderBackground:function(a){this.backgroundColor&&(a.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(a):this.backgroundColor,a.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height)),this.backgroundImage&&this.backgroundImage.render(a)},_renderOverlay:function(a){this.overlayColor&&(a.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(a):this.overlayColor,a.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height)),this.overlayImage&&this.overlayImage.render(a)},renderTop:function(){var a=this.contextTop||this.contextContainer;this.clearContext(a),this.selection&&this._groupSelector&&this._drawSelection();var b=this.getActiveGroup();return b&&b.render(a),this._renderOverlay(a),this.fire("after:render"),this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(a){return this._centerObject(a,new fabric.Point(this.getCenter().left,a.getCenterPoint().y)),this.renderAll(),this},centerObjectV:function(a){return this._centerObject(a,new fabric.Point(a.getCenterPoint().x,this.getCenter().top)),this.renderAll(),this},centerObject:function(a){var b=this.getCenter();return this._centerObject(a,new fabric.Point(b.left,b.top)),this.renderAll(),this},_centerObject:function(a,b){return a.setPositionByOrigin(b,"center","center"),this},toDatalessJSON:function(a){return this.toDatalessObject(a)},toObject:function(a){return this._toObjectMethod("toObject",a)},toDatalessObject:function(a){return this._toObjectMethod("toDatalessObject",a)},_toObjectMethod:function(b,c){var d=this.getActiveGroup();d&&this.discardActiveGroup();var e={objects:this._toObjects(b,c)};return a(e,this.__serializeBgOverlay()),fabric.util.populateWithProperties(this,e,c),d&&(this.setActiveGroup(new fabric.Group(d.getObjects(),{originX:"center",originY:"center"})),d.forEachObject(function(a){a.set("active",!0)}),this._currentTransform&&(this._currentTransform.target=this.getActiveGroup())),e},_toObjects:function(a,b){return this.getObjects().map(function(c){return this._toObject(c,a,b)},this)},_toObject:function(a,b,c){var d;this.includeDefaultValues||(d=a.includeDefaultValues,a.includeDefaultValues=!1);var e=a[b](c);return this.includeDefaultValues||(a.includeDefaultValues=d),e},__serializeBgOverlay:function(){var a={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};return this.overlayColor&&(a.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor),this.backgroundImage&&(a.backgroundImage=this.backgroundImage.toObject()),this.overlayImage&&(a.overlayImage=this.overlayImage.toObject()),a},toSVG:function(a,b){a||(a={});var c=[];return this._setSVGPreamble(c,a),this._setSVGHeader(c,a),this._setSVGBgOverlayColor(c,"backgroundColor"),this._setSVGBgOverlayImage(c,"backgroundImage"),this._setSVGObjects(c,b),this._setSVGBgOverlayColor(c,"overlayColor"),this._setSVGBgOverlayImage(c,"overlayImage"),c.push("</svg>"),c.join("")},_setSVGPreamble:function(a,b){b.suppressPreamble||a.push('<?xml version="1.0" encoding="',b.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(a,b){a.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',b.viewBox?b.viewBox.width:this.width,'" ','height="',b.viewBox?b.viewBox.height:this.height,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,b.viewBox?'viewBox="'+b.viewBox.x+" "+b.viewBox.y+" "+b.viewBox.width+" "+b.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(a,b){var c=this.getActiveGroup();c&&this.discardActiveGroup();for(var d=0,e=this.getObjects(),f=e.length;f>d;d++)a.push(e[d].toSVG(b));c&&(this.setActiveGroup(new fabric.Group(c.getObjects())),c.forEachObject(function(a){a.set("active",!0)}))},_setSVGBgOverlayImage:function(a,b){this[b]&&this[b].toSVG&&a.push(this[b].toSVG())},_setSVGBgOverlayColor:function(a,b){this[b]&&this[b].source?a.push('<rect x="',this[b].offsetX,'" y="',this[b].offsetY,'" ','width="',"repeat-y"===this[b].repeat||"no-repeat"===this[b].repeat?this[b].source.width:this.width,'" height="',"repeat-x"===this[b].repeat||"no-repeat"===this[b].repeat?this[b].source.height:this.height,'" fill="url(#'+b+'Pattern)"',"></rect>"):this[b]&&"overlayColor"===b&&a.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[b],'"',"></rect>")
},sendToBack:function(a){return c(this._objects,a),this._objects.unshift(a),this.renderAll&&this.renderAll()},bringToFront:function(a){return c(this._objects,a),this._objects.push(a),this.renderAll&&this.renderAll()},sendBackwards:function(a,b){var d=this._objects.indexOf(a);if(0!==d){var e=this._findNewLowerIndex(a,d,b);c(this._objects,a),this._objects.splice(e,0,a),this.renderAll&&this.renderAll()}return this},_findNewLowerIndex:function(a,b,c){var d;if(c){d=b;for(var e=b-1;e>=0;--e){var f=a.intersectsWithObject(this._objects[e])||a.isContainedWithinObject(this._objects[e])||this._objects[e].isContainedWithinObject(a);if(f){d=e;break}}}else d=b-1;return d},bringForward:function(a,b){var d=this._objects.indexOf(a);if(d!==this._objects.length-1){var e=this._findNewUpperIndex(a,d,b);c(this._objects,a),this._objects.splice(e,0,a),this.renderAll&&this.renderAll()}return this},_findNewUpperIndex:function(a,b,c){var d;if(c){d=b;for(var e=b+1;e<this._objects.length;++e){var f=a.intersectsWithObject(this._objects[e])||a.isContainedWithinObject(this._objects[e])||this._objects[e].isContainedWithinObject(a);if(f){d=e;break}}}else d=b+1;return d},moveTo:function(a,b){return c(this._objects,a),this._objects.splice(b,0,a),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this.interactive&&this.removeListeners(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}}),a(fabric.StaticCanvas.prototype,fabric.Observable),a(fabric.StaticCanvas.prototype,fabric.Collection),a(fabric.StaticCanvas.prototype,fabric.DataURLExporter),a(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(a){var b=fabric.util.createCanvasElement();if(!b||!b.getContext)return null;var c=b.getContext("2d");if(!c)return null;switch(a){case"getImageData":return"undefined"!=typeof c.getImageData;case"setLineDash":return"undefined"!=typeof c.setLineDash;case"toDataURL":return"undefined"!=typeof b.toDataURL;case"toDataURLWithQuality":try{return b.toDataURL("image/jpeg",0),!0}catch(d){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}(),fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",setShadow:function(a){return this.shadow=new fabric.Shadow(a),this},_setBrushStyles:function(){var a=this.canvas.contextTop;a.strokeStyle=this.color,a.lineWidth=this.width,a.lineCap=this.strokeLineCap,a.lineJoin=this.strokeLineJoin},_setShadow:function(){if(this.shadow){var a=this.canvas.contextTop;a.shadowColor=this.shadow.color,a.shadowBlur=this.shadow.blur,a.shadowOffsetX=this.shadow.offsetX,a.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var a=this.canvas.contextTop;a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0}}),function(){var a=fabric.util.array.min,b=fabric.util.array.max;fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(a){this.canvas=a,this._points=[]},onMouseDown:function(a){this._prepareForDrawing(a),this._captureDrawingPath(a),this._render()},onMouseMove:function(a){this._captureDrawingPath(a),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(a){var b=new fabric.Point(a.x,a.y);this._reset(),this._addPoint(b),this.canvas.contextTop.moveTo(b.x,b.y)},_addPoint:function(a){this._points.push(a)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(a){var b=new fabric.Point(a.x,a.y);this._addPoint(b)},_render:function(){var a=this.canvas.contextTop;a.beginPath();var b=this._points[0],c=this._points[1];2===this._points.length&&b.x===c.x&&b.y===c.y&&(b.x-=.5,c.x+=.5),a.moveTo(b.x,b.y);for(var d=1,e=this._points.length;e>d;d++){var f=b.midPointFrom(c);a.quadraticCurveTo(b.x,b.y,f.x,f.y),b=this._points[d],c=this._points[d+1]}a.lineTo(b.x,b.y),a.stroke()},_getSVGPathData:function(){return this.box=this.getPathBoundingBox(this._points),this.convertPointsToSVGPath(this._points,this.box.minx,this.box.maxx,this.box.miny,this.box.maxy)},getPathBoundingBox:function(c){for(var d=[],e=[],f=c[0],g=c[1],h=f,i=1,j=c.length;j>i;i++){var k=f.midPointFrom(g);d.push(h.x),d.push(k.x),e.push(h.y),e.push(k.y),f=c[i],g=c[i+1],h=k}return d.push(f.x),e.push(f.y),{minx:a(d),miny:a(e),maxx:b(d),maxy:b(e)}},convertPointsToSVGPath:function(a,b,c,d){var e=[],f=new fabric.Point(a[0].x-b,a[0].y-d),g=new fabric.Point(a[1].x-b,a[1].y-d);e.push("M ",a[0].x-b," ",a[0].y-d," ");for(var h=1,i=a.length;i>h;h++){var j=f.midPointFrom(g);e.push("Q ",f.x," ",f.y," ",j.x," ",j.y," "),f=new fabric.Point(a[h].x-b,a[h].y-d),h+1<a.length&&(g=new fabric.Point(a[h+1].x-b,a[h+1].y-d))}return e.push("L ",f.x," ",f.y," "),e},createPath:function(a){var b=new fabric.Path(a);return b.fill=null,b.stroke=this.color,b.strokeWidth=this.width,b.strokeLineCap=this.strokeLineCap,b.strokeLineJoin=this.strokeLineJoin,this.shadow&&(this.shadow.affectStroke=!0,b.setShadow(this.shadow)),b},_finalizeAndAddPath:function(){var a=this.canvas.contextTop;a.closePath();var b=this._getSVGPathData().join("");if("M 0 0 Q 0 0 0 0 L 0 0"===b)return void this.canvas.renderAll();var c=this.box.minx+(this.box.maxx-this.box.minx)/2,d=this.box.miny+(this.box.maxy-this.box.miny)/2;this.canvas.contextTop.arc(c,d,3,0,2*Math.PI,!1);var e=this.createPath(b);e.set({left:c,top:d,originX:"center",originY:"center"}),this.canvas.add(e),e.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:e})}})}(),fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(a){this.canvas=a,this.points=[]},drawDot:function(a){var b=this.addPoint(a),c=this.canvas.contextTop;c.fillStyle=b.fill,c.beginPath(),c.arc(b.x,b.y,b.radius,0,2*Math.PI,!1),c.closePath(),c.fill()},onMouseDown:function(a){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(a)},onMouseMove:function(a){this.drawDot(a)},onMouseUp:function(){var a=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var b=[],c=0,d=this.points.length;d>c;c++){var e=this.points[c],f=new fabric.Circle({radius:e.radius,left:e.x,top:e.y,originX:"center",originY:"center",fill:e.fill});this.shadow&&f.setShadow(this.shadow),b.push(f)}var g=new fabric.Group(b,{originX:"center",originY:"center"});this.canvas.add(g),this.canvas.fire("path:created",{path:g}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=a,this.canvas.renderAll()},addPoint:function(a){var b=new fabric.Point(a.x,a.y),c=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new fabric.Color(this.color).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return b.radius=c,b.fill=d,this.points.push(b),b}}),fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(a){this.canvas=a,this.sprayChunks=[]},onMouseDown:function(a){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(a),this.render()},onMouseMove:function(a){this.addSprayChunk(a),this.render()},onMouseUp:function(){var a=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var b=[],c=0,d=this.sprayChunks.length;d>c;c++)for(var e=this.sprayChunks[c],f=0,g=e.length;g>f;f++){var h=new fabric.Rect({width:e[f].width,height:e[f].width,left:e[f].x+1,top:e[f].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&h.setShadow(this.shadow),b.push(h)}this.optimizeOverlapping&&(b=this._getOptimizedRects(b));var i=new fabric.Group(b,{originX:"center",originY:"center"});this.canvas.add(i),this.canvas.fire("path:created",{path:i}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=a,this.canvas.renderAll()},_getOptimizedRects:function(a){for(var b,c={},d=0,e=a.length;e>d;d++)b=a[d].left+""+a[d].top,c[b]||(c[b]=a[d]);var f=[];for(b in c)f.push(c[b]);return f},render:function(){var a=this.canvas.contextTop;a.fillStyle=this.color,a.save();for(var b=0,c=this.sprayChunkPoints.length;c>b;b++){var d=this.sprayChunkPoints[b];"undefined"!=typeof d.opacity&&(a.globalAlpha=d.opacity),a.fillRect(d.x,d.y,d.width,d.width)}a.restore()},addSprayChunk:function(a){this.sprayChunkPoints=[];for(var b,c,d,e=this.width/2,f=0;f<this.density;f++){b=fabric.util.getRandomInt(a.x-e,a.x+e),c=fabric.util.getRandomInt(a.y-e,a.y+e),d=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var g={x:b,y:c,width:d};this.randomOpacity&&(g.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(g)}this.sprayChunks.push(this.sprayChunkPoints)}}),fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var a=20,b=5,c=fabric.document.createElement("canvas"),d=c.getContext("2d");return c.width=c.height=a+b,d.fillStyle=this.color,d.beginPath(),d.arc(a/2,a/2,a/2,0,2*Math.PI,!1),d.closePath(),d.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(a){var b=this.callSuper("createPath",a);return b.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction()}),b}}),function(){var a=fabric.util.getPointer,b=fabric.util.degreesToRadians,c=fabric.util.radiansToDegrees,d=Math.atan2,e=Math.abs,f=.5;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(a,b){b||(b={}),this._initStatic(a,b),this._initInteractive(),this._createCacheCanvas(),fabric.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_resetCurrentTransform:function(a){var b=this._currentTransform;b.target.set({scaleX:b.original.scaleX,scaleY:b.original.scaleY,left:b.original.left,top:b.original.top}),this._shouldCenterTransform(a,b.target)?"rotate"===b.action?this._setOriginToCenter(b.target):("center"!==b.originX&&(b.mouseXSign="right"===b.originX?-1:1),"center"!==b.originY&&(b.mouseYSign="bottom"===b.originY?-1:1),b.originX="center",b.originY="center"):(b.originX=b.original.originX,b.originY=b.original.originY)},containsPoint:function(a,b){var c=this.getPointer(a),d=this._normalizePointer(b,c);return b.containsPoint(d)||b._findTargetCorner(c)},_normalizePointer:function(a,b){var c=this.getActiveGroup(),d=b.x,e=b.y,f=c&&"group"!==a.type&&c.contains(a);return f&&(d-=c.left,e-=c.top),{x:d,y:e}},isTargetTransparent:function(a,b,c){var d=a.hasBorders,e=a.transparentCorners;a.hasBorders=a.transparentCorners=!1,this._draw(this.contextCache,a),a.hasBorders=d,a.transparentCorners=e;var f=fabric.util.isTransparent(this.contextCache,b,c,this.targetFindTolerance);return this.clearContext(this.contextCache),f},_shouldClearSelection:function(a,b){var c=this.getActiveGroup(),d=this.getActiveObject();return!b||b&&c&&!c.contains(b)&&c!==b&&!a.shiftKey||b&&!b.evented||b&&!b.selectable&&d&&d!==b},_shouldCenterTransform:function(a,b){if(b){var c,d=this._currentTransform;return"scale"===d.action||"scaleX"===d.action||"scaleY"===d.action?c=this.centeredScaling||b.centeredScaling:"rotate"===d.action&&(c=this.centeredRotation||b.centeredRotation),c?!a.altKey:a.altKey}},_getOriginFromCorner:function(a,b){var c={x:a.originX,y:a.originY};return"ml"===b||"tl"===b||"bl"===b?c.x="right":("mr"===b||"tr"===b||"br"===b)&&(c.x="left"),"tl"===b||"mt"===b||"tr"===b?c.y="bottom":("bl"===b||"mb"===b||"br"===b)&&(c.y="top"),c},_getActionFromCorner:function(a,b){var c="drag";return b&&(c="ml"===b||"mr"===b?"scaleX":"mt"===b||"mb"===b?"scaleY":"mtr"===b?"rotate":"scale"),c},_setupCurrentTransform:function(a,c){if(c){var d=this.getPointer(a),e=c._findTargetCorner(d),f=this._getActionFromCorner(c,e),g=this._getOriginFromCorner(c,e);this._currentTransform={target:c,action:f,scaleX:c.scaleX,scaleY:c.scaleY,offsetX:d.x-c.left,offsetY:d.y-c.top,originX:g.x,originY:g.y,ex:d.x,ey:d.y,left:c.left,top:c.top,theta:b(c.angle),width:c.width*c.scaleX,mouseXSign:1,mouseYSign:1},this._currentTransform.original={left:c.left,top:c.top,scaleX:c.scaleX,scaleY:c.scaleY,originX:g.x,originY:g.y},this._resetCurrentTransform(a)}},_translateObject:function(a,b){var c=this._currentTransform.target;c.get("lockMovementX")||c.set("left",a-this._currentTransform.offsetX),c.get("lockMovementY")||c.set("top",b-this._currentTransform.offsetY)},_scaleObject:function(a,b,c){var d=this._currentTransform,e=d.target,f=e.get("lockScalingX"),g=e.get("lockScalingY");if(!f||!g){var h=e.translateToOriginPoint(e.getCenterPoint(),d.originX,d.originY),i=e.toLocalPoint(new fabric.Point(a,b),d.originX,d.originY);this._setLocalMouse(i,d),this._setObjectScale(i,d,f,g,c),e.setPositionByOrigin(h,d.originX,d.originY)}},_setObjectScale:function(a,b,c,d,e){var f=b.target;b.newScaleX=f.scaleX,b.newScaleY=f.scaleY,"equally"!==e||c||d?e?"x"!==e||f.get("lockUniScaling")?"y"!==e||f.get("lockUniScaling")||(b.newScaleY=a.y/(f.height+f.strokeWidth),d||f.set("scaleY",b.newScaleY)):(b.newScaleX=a.x/(f.width+f.strokeWidth),c||f.set("scaleX",b.newScaleX)):(b.newScaleX=a.x/(f.width+f.strokeWidth),b.newScaleY=a.y/(f.height+f.strokeWidth),c||f.set("scaleX",b.newScaleX),d||f.set("scaleY",b.newScaleY)):this._scaleObjectEqually(a,f,b),this._flipObject(b)},_scaleObjectEqually:function(a,b,c){var d=a.y+a.x,e=(b.height+b.strokeWidth)*c.original.scaleY+(b.width+b.strokeWidth)*c.original.scaleX;c.newScaleX=c.original.scaleX*d/e,c.newScaleY=c.original.scaleY*d/e,b.set("scaleX",c.newScaleX),b.set("scaleY",c.newScaleY)},_flipObject:function(a){a.newScaleX<0&&("left"===a.originX?a.originX="right":"right"===a.originX&&(a.originX="left")),a.newScaleY<0&&("top"===a.originY?a.originY="bottom":"bottom"===a.originY&&(a.originY="top"))},_setLocalMouse:function(a,b){var c=b.target;"right"===b.originX?a.x*=-1:"center"===b.originX&&(a.x*=2*b.mouseXSign,a.x<0&&(b.mouseXSign=-b.mouseXSign)),"bottom"===b.originY?a.y*=-1:"center"===b.originY&&(a.y*=2*b.mouseYSign,a.y<0&&(b.mouseYSign=-b.mouseYSign)),e(a.x)>c.padding?a.x<0?a.x+=c.padding:a.x-=c.padding:a.x=0,e(a.y)>c.padding?a.y<0?a.y+=c.padding:a.y-=c.padding:a.y=0},_rotateObject:function(a,b){var e=this._currentTransform;if(!e.target.get("lockRotation")){var f=d(e.ey-e.top,e.ex-e.left),g=d(b-e.top,a-e.left),h=c(g-f+e.theta);0>h&&(h=360+h),e.target.angle=h}},_setCursor:function(a){this.upperCanvasEl.style.cursor=a},_resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.setAngle(0)},_drawSelection:function(){var a=this.contextTop,b=this._groupSelector,c=b.left,d=b.top,g=e(c),h=e(d);if(a.fillStyle=this.selectionColor,a.fillRect(b.ex-(c>0?0:-c),b.ey-(d>0?0:-d),g,h),a.lineWidth=this.selectionLineWidth,a.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1){var i=b.ex+f-(c>0?0:g),j=b.ey+f-(d>0?0:h);a.beginPath(),fabric.util.drawDashedLine(a,i,j,i+g,j,this.selectionDashArray),fabric.util.drawDashedLine(a,i,j+h-1,i+g,j+h-1,this.selectionDashArray),fabric.util.drawDashedLine(a,i,j,i,j+h,this.selectionDashArray),fabric.util.drawDashedLine(a,i+g-1,j,i+g-1,j+h,this.selectionDashArray),a.closePath(),a.stroke()}else a.strokeRect(b.ex+f-(c>0?0:g),b.ey+f-(d>0?0:h),g,h)},_isLastRenderedObject:function(a){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(a,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(a))},findTarget:function(a,b){if(!this.skipTargetFind){if(this._isLastRenderedObject(a))return this.lastRenderedObjectWithControlsAboveOverlay;var c=this.getActiveGroup();if(c&&!b&&this.containsPoint(a,c))return c;var d=this._searchPossibleTargets(a);return this._fireOverOutEvents(d),d}},_fireOverOutEvents:function(a){a?this._hoveredTarget!==a&&(this.fire("mouse:over",{target:a}),a.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),this._hoveredTarget=a):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(a,b,c){if(b&&b.visible&&b.evented&&this.containsPoint(a,b)){if(!this.perPixelTargetFind&&!b.perPixelTargetFind||b.isEditing)return!0;var d=this.isTargetTransparent(b,c.x,c.y);if(!d)return!0}},_searchPossibleTargets:function(a){for(var b,c=this.getPointer(a),d=this._objects.length;d--;)if(this._checkTarget(a,this._objects[d],c)){this.relatedTarget=this._objects[d],b=this._objects[d];break}return b},getPointer:function(b){var c,d=a(b,this.upperCanvasEl),e=this.upperCanvasEl.getBoundingClientRect();return c=0===e.width||0===e.height?{width:1,height:1}:{width:this.upperCanvasEl.width/e.width,height:this.upperCanvasEl.height/e.height},{x:(d.x-this._offset.left)*c.width,y:(d.y-this._offset.top)*c.height}},_createUpperCanvas:function(){var a=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+a),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(a){var b=this.getWidth()||a.width,c=this.getHeight()||a.height;fabric.util.setStyle(a,{position:"absolute",width:b+"px",height:c+"px",left:0,top:0}),a.width=b,a.height=c,fabric.util.makeElementUnselectable(a)},_copyCanvasStyle:function(a,b){b.style.cssText=a.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(a){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=a,a.set("active",!0)},setActiveObject:function(a,b){return this._setActiveObject(a),this.renderAll(),this.fire("object:selected",{target:a,e:b}),a.fire("selected",{e:b}),this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=null},discardActiveObject:function(a){return this._discardActiveObject(),this.renderAll(),this.fire("selection:cleared",{e:a}),this},_setActiveGroup:function(a){this._activeGroup=a,a&&(a.canvas=this,a.set("active",!0))},setActiveGroup:function(a,b){return this._setActiveGroup(a),a&&(this.fire("object:selected",{target:a,e:b}),a.fire("selected",{e:b})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var a=this.getActiveGroup();a&&a.destroy(),this.setActiveGroup(null)},discardActiveGroup:function(a){return this._discardActiveGroup(),this.fire("selection:cleared",{e:a}),this},deactivateAll:function(){for(var a=this.getObjects(),b=0,c=a.length;c>b;b++)a[b].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(a){var b=this.getActiveGroup()||this.getActiveObject();return b&&this.fire("before:selection:cleared",{target:b,e:a}),this.deactivateAll(),b&&this.fire("selection:cleared",{e:a}),this},drawControls:function(a){var b=this.getActiveGroup();b?this._drawGroupControls(a,b):this._drawObjectsControls(a)},_drawGroupControls:function(a,b){this._drawControls(a,b,"Group")},_drawObjectsControls:function(a){for(var b=0,c=this._objects.length;c>b;++b)this._objects[b]&&this._objects[b].active&&(this._drawControls(a,this._objects[b],"Object"),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[b])},_drawControls:function(a,b,c){a.save(),fabric[c].prototype.transform.call(b,a),b.drawBorders(a).drawControls(a),a.restore()}});for(var g in fabric.StaticCanvas)"prototype"!==g&&(fabric.Canvas[g]=fabric.StaticCanvas[g]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){}),fabric.Element=fabric.Canvas}(),function(){var a={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},b=fabric.util.addListener,c=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this._bindEvents(),b(fabric.window,"resize",this._onResize),b(this.upperCanvasEl,"mousedown",this._onMouseDown),b(this.upperCanvasEl,"mousemove",this._onMouseMove),b(this.upperCanvasEl,"mousewheel",this._onMouseWheel),b(this.upperCanvasEl,"touchstart",this._onMouseDown),b(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof Event&&"add"in Event&&(Event.add(this.upperCanvasEl,"gesture",this._onGesture),Event.add(this.upperCanvasEl,"drag",this._onDrag),Event.add(this.upperCanvasEl,"orientation",this._onOrientationChange),Event.add(this.upperCanvasEl,"shake",this._onShake))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){c(fabric.window,"resize",this._onResize),c(this.upperCanvasEl,"mousedown",this._onMouseDown),c(this.upperCanvasEl,"mousemove",this._onMouseMove),c(this.upperCanvasEl,"mousewheel",this._onMouseWheel),c(this.upperCanvasEl,"touchstart",this._onMouseDown),c(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof Event&&"remove"in Event&&(Event.remove(this.upperCanvasEl,"gesture",this._onGesture),Event.remove(this.upperCanvasEl,"drag",this._onDrag),Event.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),Event.remove(this.upperCanvasEl,"shake",this._onShake))},_onGesture:function(a,b){this.__onTransformGesture&&this.__onTransformGesture(a,b)},_onDrag:function(a,b){this.__onDrag&&this.__onDrag(a,b)},_onMouseWheel:function(a,b){this.__onMouseWheel&&this.__onMouseWheel(a,b)},_onOrientationChange:function(a,b){this.__onOrientationChange&&this.__onOrientationChange(a,b)},_onShake:function(a,b){this.__onShake&&this.__onShake(a,b)},_onMouseDown:function(a){this.__onMouseDown(a),b(fabric.document,"touchend",this._onMouseUp),b(fabric.document,"touchmove",this._onMouseMove),c(this.upperCanvasEl,"mousemove",this._onMouseMove),c(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchstart"===a.type?c(this.upperCanvasEl,"mousedown",this._onMouseDown):(b(fabric.document,"mouseup",this._onMouseUp),b(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(a){if(this.__onMouseUp(a),c(fabric.document,"mouseup",this._onMouseUp),c(fabric.document,"touchend",this._onMouseUp),c(fabric.document,"mousemove",this._onMouseMove),c(fabric.document,"touchmove",this._onMouseMove),b(this.upperCanvasEl,"mousemove",this._onMouseMove),b(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchend"===a.type){var d=this;setTimeout(function(){b(d.upperCanvasEl,"mousedown",d._onMouseDown)},400)}},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a,b){var c=this.getActiveGroup()||this.getActiveObject();return!!(a&&(a.isMoving||a!==c)||!a&&c||!a&&!c&&!this._groupSelector||b&&this._previousPointer&&this.selection&&(b.x!==this._previousPointer.x||b.y!==this._previousPointer.y))},__onMouseUp:function(a){var b;if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(a);this._currentTransform?(this._finalizeCurrentTransform(),b=this._currentTransform.target):b=this.findTarget(a,!0);var c=this._shouldRender(b,this.getPointer(a));this._maybeGroupObjects(a),b&&(b.isMoving=!1),c&&this.renderAll(),this._handleCursorAndEvent(a,b)},_handleCursorAndEvent:function(a,b){this._setCursorFromEvent(a,b);var c=this;setTimeout(function(){c._setCursorFromEvent(a,b)},50),this.fire("mouse:up",{target:b,e:a}),b&&b.fire("mouseup",{e:a})},_finalizeCurrentTransform:function(){var a=this._currentTransform,b=a.target;b._scaling&&(b._scaling=!1),b.setCoords(),this.stateful&&b.hasStateChanged()&&(this.fire("object:modified",{target:b}),b.fire("modified")),this._restoreOriginXY(b)},_restoreOriginXY:function(a){if(this._previousOriginX&&this._previousOriginY){var b=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX,a.originY=this._previousOriginY,a.left=b.x,a.top=b.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.discardActiveObject(a).renderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop),this.freeDrawingBrush.onMouseDown(this.getPointer(a)),this.fire("mouse:down",{e:a})},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var b=this.getPointer(a);this.freeDrawingBrush.onMouseMove(b)}this.upperCanvasEl.style.cursor=this.freeDrawingCursor,this.fire("mouse:move",{e:a})},_onMouseUpInDrawingMode:function(a){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this.fire("mouse:up",{e:a})},__onMouseDown:function(a){var b="which"in a?1===a.which:1===a.button;if(b||fabric.isTouchSupported){if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(a);if(!this._currentTransform){var c=this.findTarget(a),d=this.getPointer(a);this._previousPointer=d;var e=this._shouldRender(c,d),f=this._shouldGroup(a,c);this._shouldClearSelection(a,c)?this._clearSelection(a,c,d):f&&(this._handleGrouping(a,c),c=this.getActiveGroup()),c&&c.selectable&&!f&&(this._beforeTransform(a,c),this._setupCurrentTransform(a,c)),e&&this.renderAll(),this.fire("mouse:down",{target:c,e:a}),c&&c.fire("mousedown",{e:a})}}},_beforeTransform:function(a,b){var c;this.stateful&&b.saveState(),(c=b._findTargetCorner(this.getPointer(a)))&&this.onBeforeScaleRotate(b),b!==this.getActiveGroup()&&b!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(b,a))},_clearSelection:function(a,b,c){this.deactivateAllWithDispatch(a),b&&b.selectable?this.setActiveObject(b,a):this.selection&&(this._groupSelector={ex:c.x,ey:c.y,top:0,left:0})},_setOriginToCenter:function(a){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var b=a.getCenterPoint();a.originX="center",a.originY="center",a.left=b.x,a.top=b.y,this._currentTransform.left=a.left,this._currentTransform.top=a.top},_setCenterToOrigin:function(a){var b=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX,a.originY=this._previousOriginY,a.left=b.x,a.top=b.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(a){var b,c;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(a);var d=this._groupSelector;d?(c=this.getPointer(a),d.left=c.x-d.ex,d.top=c.y-d.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(b=this.findTarget(a),!b||b&&!b.selectable?this.upperCanvasEl.style.cursor=this.defaultCursor:this._setCursorFromEvent(a,b)),this.fire("mouse:move",{target:b,e:a}),b&&b.fire("mousemove",{e:a})},_transformObject:function(a){var b=this.getPointer(a),c=this._currentTransform;c.reset=!1,c.target.isMoving=!0,this._beforeScaleTransform(a,c),this._performTransformAction(a,c,b),this.renderAll()},_performTransformAction:function(a,b,c){var d=c.x,e=c.y,f=b.target,g=b.action;"rotate"===g?(this._rotateObject(d,e),this._fire("rotating",f,a)):"scale"===g?(this._onScale(a,b,d,e),this._fire("scaling",f,a)):"scaleX"===g?(this._scaleObject(d,e,"x"),this._fire("scaling",f,a)):"scaleY"===g?(this._scaleObject(d,e,"y"),this._fire("scaling",f,a)):(this._translateObject(d,e),this._fire("moving",f,a),this._setCursor(this.moveCursor))},_fire:function(a,b,c){this.fire("object:"+a,{target:b,e:c}),b.fire(a,{e:c})},_beforeScaleTransform:function(a,b){if("scale"===b.action||"scaleX"===b.action||"scaleY"===b.action){var c=this._shouldCenterTransform(a,b.target);(c&&("center"!==b.originX||"center"!==b.originY)||!c&&"center"===b.originX&&"center"===b.originY)&&(this._resetCurrentTransform(a),b.reset=!0)}},_onScale:function(a,b,c,d){!a.shiftKey&&!this.uniScaleTransform||b.target.get("lockUniScaling")?(b.reset||"scale"!==b.currentAction||this._resetCurrentTransform(a,b.target),b.currentAction="scaleEqually",this._scaleObject(c,d,"equally")):(b.currentAction="scale",this._scaleObject(c,d))},_setCursorFromEvent:function(a,b){var c=this.upperCanvasEl.style;if(!b||!b.selectable)return c.cursor=this.defaultCursor,!1;var d=this.getActiveGroup(),e=b._findTargetCorner&&(!d||!d.contains(b))&&b._findTargetCorner(this.getPointer(a));return e?this._setCornerCursor(e,b):c.cursor=b.hoverCursor||this.hoverCursor,!0},_setCornerCursor:function(b,c){var d=this.upperCanvasEl.style;if(b in a)d.cursor=this._getRotatedCornerCursor(b,c);else{if("mtr"!==b||!c.hasRotatingPoint)return d.cursor=this.defaultCursor,!1;d.cursor=this.rotationCursor}},_getRotatedCornerCursor:function(b,c){var d=Math.round(c.getAngle()%360/45);return 0>d&&(d+=8),d+=a[b],d%=8,this.cursorMap[d]}})}(),function(){var a=Math.min,b=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(a,b){var c=this.getActiveObject();return a.shiftKey&&(this.getActiveGroup()||c&&c!==b)&&this.selection},_handleGrouping:function(a,b){(b!==this.getActiveGroup()||(b=this.findTarget(a,!0),b&&!b.isType("group")))&&(this.getActiveGroup()?this._updateActiveGroup(b,a):this._createActiveGroup(b,a),this._activeGroup&&this._activeGroup.saveCoords())},_updateActiveGroup:function(a,b){var c=this.getActiveGroup();if(c.contains(a)){if(c.removeWithUpdate(a),this._resetObjectTransform(c),a.set("active",!1),1===c.size())return this.discardActiveGroup(b),void this.setActiveObject(c.item(0))}else c.addWithUpdate(a),this._resetObjectTransform(c);this.fire("selection:created",{target:c,e:b}),c.set("active",!0)},_createActiveGroup:function(a,b){if(this._activeObject&&a!==this._activeObject){var c=this._createGroup(a);this.setActiveGroup(c),this._activeObject=null,this.fire("selection:created",{target:c,e:b})}a.set("active",!0)},_createGroup:function(a){var b=this.getObjects(),c=b.indexOf(this._activeObject)<b.indexOf(a),d=c?[this._activeObject,a]:[a,this._activeObject];
return new fabric.Group(d,{originX:"center",originY:"center"})},_groupSelectedObjects:function(a){var b=this._collectObjects();1===b.length?this.setActiveObject(b[0],a):b.length>1&&(b=new fabric.Group(b.reverse(),{originX:"center",originY:"center"}),this.setActiveGroup(b,a),b.saveCoords(),this.fire("selection:created",{target:b}),this.renderAll())},_collectObjects:function(){for(var c,d=[],e=this._groupSelector.ex,f=this._groupSelector.ey,g=e+this._groupSelector.left,h=f+this._groupSelector.top,i=new fabric.Point(a(e,g),a(f,h)),j=new fabric.Point(b(e,g),b(f,h)),k=e===g&&f===h,l=this._objects.length;l--&&(c=this._objects[l],!(c&&c.selectable&&c.visible&&(c.intersectsWithRect(i,j)||c.isContainedWithinRect(i,j)||c.containsPoint(i)||c.containsPoint(j))&&(c.set("active",!0),d.push(c),k))););return d},_maybeGroupObjects:function(a){this.selection&&this._groupSelector&&this._groupSelectedObjects(a);var b=this.getActiveGroup();b&&(b.setObjectsCoords().setCoords(),b.isMoving=!1,this._setCursor(this.defaultCursor)),this._groupSelector=null,this._currentTransform=null}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(a){a||(a={});var b=a.format||"png",c=a.quality||1,d=a.multiplier||1,e={left:a.left,top:a.top,width:a.width,height:a.height};return 1!==d?this.__toDataURLWithMultiplier(b,c,e,d):this.__toDataURL(b,c,e)},__toDataURL:function(a,b,c){this.renderAll(!0);var d=this.upperCanvasEl||this.lowerCanvasEl,e=this.__getCroppedCanvas(d,c);"jpg"===a&&(a="jpeg");var f=fabric.StaticCanvas.supports("toDataURLWithQuality")?(e||d).toDataURL("image/"+a,b):(e||d).toDataURL("image/"+a);return this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),e&&(e=null),f},__getCroppedCanvas:function(a,b){var c,d,e="left"in b||"top"in b||"width"in b||"height"in b;return e&&(c=fabric.util.createCanvasElement(),d=c.getContext("2d"),c.width=b.width||this.width,c.height=b.height||this.height,d.drawImage(a,-b.left||0,-b.top||0)),c},__toDataURLWithMultiplier:function(a,b,c,d){var e=this.getWidth(),f=this.getHeight(),g=e*d,h=f*d,i=this.getActiveObject(),j=this.getActiveGroup(),k=this.contextTop||this.contextContainer;d>1&&this.setWidth(g).setHeight(h),k.scale(d,d),c.left&&(c.left*=d),c.top&&(c.top*=d),c.width?c.width*=d:1>d&&(c.width=g),c.height?c.height*=d:1>d&&(c.height=h),j?this._tempRemoveBordersControlsFromGroup(j):i&&this.deactivateAll&&this.deactivateAll(),this.renderAll(!0);var l=this.__toDataURL(a,b,c);return this.width=e,this.height=f,k.scale(1/d,1/d),this.setWidth(e).setHeight(f),j?this._restoreBordersControlsOnGroup(j):i&&this.setActiveObject&&this.setActiveObject(i),this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),l},toDataURLWithMultiplier:function(a,b,c){return this.toDataURL({format:a,multiplier:b,quality:c})},_tempRemoveBordersControlsFromGroup:function(a){a.origHasControls=a.hasControls,a.origBorderColor=a.borderColor,a.hasControls=!0,a.borderColor="rgba(0,0,0,0)",a.forEachObject(function(a){a.origBorderColor=a.borderColor,a.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(a){a.hideControls=a.origHideControls,a.borderColor=a.origBorderColor,a.forEachObject(function(a){a.borderColor=a.origBorderColor,delete a.origBorderColor})}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(a,b,c){return this.loadFromJSON(a,b,c)},loadFromJSON:function(a,b,c){if(a){var d="string"==typeof a?JSON.parse(a):a;this.clear();var e=this;return this._enlivenObjects(d.objects,function(){e._setBgOverlay(d,b)},c),this}},_setBgOverlay:function(a,b){var c=this,d={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(a.backgroundImage||a.overlayImage||a.background||a.overlay))return void(b&&b());var e=function(){d.backgroundImage&&d.overlayImage&&d.backgroundColor&&d.overlayColor&&(c.renderAll(),b&&b())};this.__setBgOverlay("backgroundImage",a.backgroundImage,d,e),this.__setBgOverlay("overlayImage",a.overlayImage,d,e),this.__setBgOverlay("backgroundColor",a.background,d,e),this.__setBgOverlay("overlayColor",a.overlay,d,e),e()},__setBgOverlay:function(a,b,c,d){var e=this;return b?void("backgroundImage"===a||"overlayImage"===a?fabric.Image.fromObject(b,function(b){e[a]=b,c[a]=!0,d&&d()}):this["set"+fabric.util.string.capitalize(a,!0)](b,function(){c[a]=!0,d&&d()})):void(c[a]=!0)},_enlivenObjects:function(a,b,c){var d=this;if(0===a.length)return void(b&&b());var e=this.renderOnAddRemove;this.renderOnAddRemove=!1,fabric.util.enlivenObjects(a,function(a){a.forEach(function(a,b){d.insertAt(a,b,!0)}),d.renderOnAddRemove=e,b&&b()},null,c)},_toDataURL:function(a,b){this.clone(function(c){b(c.toDataURL(a))})},_toDataURLWithMultiplier:function(a,b,c){this.clone(function(d){c(d.toDataURLWithMultiplier(a,b))})},clone:function(a,b){var c=JSON.stringify(this.toJSON(b));this.cloneWithoutData(function(b){b.loadFromJSON(c,function(){a&&a(b)})})},cloneWithoutData:function(a){var b=fabric.document.createElement("canvas");b.width=this.getWidth(),b.height=this.getHeight();var c=new fabric.Canvas(b);c.clipTo=this.clipTo,this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),a&&a(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):a&&a(c)}}),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend,d=b.util.toFixed,e=b.util.string.capitalize,f=b.util.degreesToRadians,g=b.StaticCanvas.supports("setLineDash");b.Object||(b.Object=b.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule shadow clipTo visible backgroundColor".split(" "),initialize:function(a){a&&this.setOptions(a)},_initGradient:function(a){!a.fill||!a.fill.colorStops||a.fill instanceof b.Gradient||this.set("fill",new b.Gradient(a.fill))},_initPattern:function(a){!a.fill||!a.fill.source||a.fill instanceof b.Pattern||this.set("fill",new b.Pattern(a.fill)),!a.stroke||!a.stroke.source||a.stroke instanceof b.Pattern||this.set("stroke",new b.Pattern(a.stroke))},_initClipping:function(a){if(a.clipTo&&"string"==typeof a.clipTo){var c=b.util.getFunctionBody(a.clipTo);"undefined"!=typeof c&&(this.clipTo=new Function("ctx",c))}},setOptions:function(a){for(var b in a)this.set(b,a[b]);this._initGradient(a),this._initPattern(a),this._initClipping(a)},transform:function(a,b){a.globalAlpha=this.opacity;var c=b?this._getLeftTopCoords():this.getCenterPoint();a.translate(c.x,c.y),a.rotate(f(this.angle)),a.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(a){var c=b.Object.NUM_FRACTION_DIGITS,e={type:this.type,originX:this.originX,originY:this.originY,left:d(this.left,c),top:d(this.top,c),width:d(this.width,c),height:d(this.height,c),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:d(this.strokeWidth,c),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:d(this.strokeMiterLimit,c),scaleX:d(this.scaleX,c),scaleY:d(this.scaleY,c),angle:d(this.getAngle(),c),flipX:this.flipX,flipY:this.flipY,opacity:d(this.opacity,c),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor};return this.includeDefaultValues||(e=this._removeDefaultValues(e)),b.util.populateWithProperties(this,e,a),e},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(a){var c=b.util.getKlass(a.type).prototype,d=c.stateProperties;return d.forEach(function(b){a[b]===c[b]&&delete a[b]}),a},toString:function(){return"#<fabric."+e(this.type)+">"},get:function(a){return this[a]},_setObject:function(a){for(var b in a)this._set(b,a[b])},set:function(a,b){return"object"==typeof a?this._setObject(a):"function"==typeof b&&"clipTo"!==a?this._set(a,b(this.get(a))):this._set(a,b),this},_set:function(a,c){var e="scaleX"===a||"scaleY"===a;return e&&(c=this._constrainScale(c)),"scaleX"===a&&0>c?(this.flipX=!this.flipX,c*=-1):"scaleY"===a&&0>c?(this.flipY=!this.flipY,c*=-1):"width"===a||"height"===a?this.minScaleLimit=d(Math.min(.1,1/Math.max(this.width,this.height)),2):"shadow"!==a||!c||c instanceof b.Shadow||(c=new b.Shadow(c)),this[a]=c,this},toggle:function(a){var b=this.get(a);return"boolean"==typeof b&&this.set(a,!b),this},setSourcePath:function(a){return this.sourcePath=a,this},render:function(a,c){if(0!==this.width&&0!==this.height&&this.visible){a.save(),this._setupFillRule(a),this._transform(a,c),this._setStrokeStyles(a),this._setFillStyles(a);var d=this.transformMatrix;d&&this.group&&(a.translate(-this.group.width/2,-this.group.height/2),a.transform(d[0],d[1],d[2],d[3],d[4],d[5])),this._setShadow(a),this.clipTo&&b.util.clipContext(this,a),this._render(a,c),this.clipTo&&a.restore(),this._removeShadow(a),this._restoreFillRule(a),this.active&&!c&&(this.drawBorders(a),this.drawControls(a)),a.restore()}},_transform:function(a,b){var c=this.transformMatrix;c&&!this.group&&a.setTransform(c[0],c[1],c[2],c[3],c[4],c[5]),b||this.transform(a)},_setStrokeStyles:function(a){this.stroke&&(a.lineWidth=this.strokeWidth,a.lineCap=this.strokeLineCap,a.lineJoin=this.strokeLineJoin,a.miterLimit=this.strokeMiterLimit,a.strokeStyle=this.stroke.toLive?this.stroke.toLive(a):this.stroke)},_setFillStyles:function(a){this.fill&&(a.fillStyle=this.fill.toLive?this.fill.toLive(a):this.fill)},_setShadow:function(a){this.shadow&&(a.shadowColor=this.shadow.color,a.shadowBlur=this.shadow.blur,a.shadowOffsetX=this.shadow.offsetX,a.shadowOffsetY=this.shadow.offsetY)},_removeShadow:function(a){this.shadow&&(a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0)},_renderFill:function(a){this.fill&&(this.fill.toLive&&(a.save(),a.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0)),"destination-over"===this.fillRule?a.fill("evenodd"):a.fill(),this.fill.toLive&&a.restore(),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a))},_renderStroke:function(a){this.stroke&&(a.save(),this.strokeDashArray?(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),g?(a.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(a)):this._renderDashedStroke&&this._renderDashedStroke(a),a.stroke()):this._stroke?this._stroke(a):a.stroke(),this._removeShadow(a),a.restore())},clone:function(a,c){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(c),a):new b.Object(this.toObject(c))},cloneAsImage:function(a){var c=this.toDataURL();return b.util.loadImage(c,function(c){a&&a(new b.Image(c))}),this},toDataURL:function(a){a||(a={});var c=b.util.createCanvasElement(),d=this.getBoundingRect();c.width=d.width,c.height=d.height,b.util.wrapElement(c,"div");var e=new b.Canvas(c);"jpg"===a.format&&(a.format="jpeg"),"jpeg"===a.format&&(e.backgroundColor="#fff");var f={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1),this.setPositionByOrigin(new b.Point(c.width/2,c.height/2),"center","center");var g=this.canvas;e.add(this);var h=e.toDataURL(a);return this.set(f).setCoords(),this.canvas=g,e.dispose(),e=null,h},isType:function(a){return this.type===a},complexity:function(){return 0},toJSON:function(a){return this.toObject(a)},setGradient:function(a,c){c||(c={});var d={colorStops:[]};d.type=c.type||(c.r1||c.r2?"radial":"linear"),d.coords={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2},(c.r1||c.r2)&&(d.coords.r1=c.r1,d.coords.r2=c.r2);for(var e in c.colorStops){var f=new b.Color(c.colorStops[e]);d.colorStops.push({offset:e,color:f.toRgb(),opacity:f.getAlpha()})}return this.set(a,b.Gradient.forObject(this,d))},setPatternFill:function(a){return this.set("fill",new b.Pattern(a))},setShadow:function(a){return this.set("shadow",new b.Shadow(a))},setColor:function(a){return this.set("fill",a),this},centerH:function(){return this.canvas.centerObjectH(this),this},centerV:function(){return this.canvas.centerObjectV(this),this},center:function(){return this.canvas.centerObject(this),this},remove:function(){return this.canvas.remove(this),this},getLocalPointer:function(a,b){b=b||this.canvas.getPointer(a);var c=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:b.x-c.x,y:b.y-c.y}},_setupFillRule:function(a){this.fillRule&&(this._prevFillRule=a.globalCompositeOperation,a.globalCompositeOperation=this.fillRule)},_restoreFillRule:function(a){this.fillRule&&this._prevFillRule&&(a.globalCompositeOperation=this._prevFillRule)}}),b.util.createAccessors(b.Object),b.Object.prototype.rotate=b.Object.prototype.setAngle,c(b.Object.prototype,b.Observable),b.Object.NUM_FRACTION_DIGITS=2,b.Object.__uid=0)}("undefined"!=typeof exports?exports:this),function(){var a=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(b,c,d){var e=b.x,f=b.y,g=this.stroke?this.strokeWidth:0;return"left"===c?e=b.x+(this.getWidth()+g*this.scaleX)/2:"right"===c&&(e=b.x-(this.getWidth()+g*this.scaleX)/2),"top"===d?f=b.y+(this.getHeight()+g*this.scaleY)/2:"bottom"===d&&(f=b.y-(this.getHeight()+g*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(e,f),b,a(this.angle))},translateToOriginPoint:function(b,c,d){var e=b.x,f=b.y,g=this.stroke?this.strokeWidth:0;return"left"===c?e=b.x-(this.getWidth()+g*this.scaleX)/2:"right"===c&&(e=b.x+(this.getWidth()+g*this.scaleX)/2),"top"===d?f=b.y-(this.getHeight()+g*this.scaleY)/2:"bottom"===d&&(f=b.y+(this.getHeight()+g*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(e,f),b,a(this.angle))},getCenterPoint:function(){var a=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(a,this.originX,this.originY)},getPointByOrigin:function(a,b){var c=this.getCenterPoint();return this.translateToOriginPoint(c,a,b)},toLocalPoint:function(b,c,d){var e,f,g=this.getCenterPoint(),h=this.stroke?this.strokeWidth:0;return c&&d?(e="left"===c?g.x-(this.getWidth()+h*this.scaleX)/2:"right"===c?g.x+(this.getWidth()+h*this.scaleX)/2:g.x,f="top"===d?g.y-(this.getHeight()+h*this.scaleY)/2:"bottom"===d?g.y+(this.getHeight()+h*this.scaleY)/2:g.y):(e=this.left,f=this.top),fabric.util.rotatePoint(new fabric.Point(b.x,b.y),g,-a(this.angle)).subtractEquals(new fabric.Point(e,f))},setPositionByOrigin:function(a,b,c){var d=this.translateToCenterPoint(a,b,c),e=this.translateToOriginPoint(d,this.originX,this.originY);this.set("left",e.x),this.set("top",e.y)},adjustPosition:function(b){var c=a(this.angle),d=this.getWidth()/2,e=Math.cos(c)*d,f=Math.sin(c)*d,g=this.getWidth(),h=Math.cos(c)*g,i=Math.sin(c)*g;"center"===this.originX&&"left"===b||"right"===this.originX&&"center"===b?(this.left-=e,this.top-=f):"left"===this.originX&&"center"===b||"center"===this.originX&&"right"===b?(this.left+=e,this.top+=f):"left"===this.originX&&"right"===b?(this.left+=h,this.top+=i):"right"===this.originX&&"left"===b&&(this.left-=h,this.top-=i),this.setCoords(),this.originX=b},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})}(),function(){var a=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(a,b){var c=this.oCoords,d=new fabric.Point(c.tl.x,c.tl.y),e=new fabric.Point(c.tr.x,c.tr.y),f=new fabric.Point(c.bl.x,c.bl.y),g=new fabric.Point(c.br.x,c.br.y),h=fabric.Intersection.intersectPolygonRectangle([d,e,g,f],a,b);return"Intersection"===h.status},intersectsWithObject:function(a){function b(a){return{tl:new fabric.Point(a.tl.x,a.tl.y),tr:new fabric.Point(a.tr.x,a.tr.y),bl:new fabric.Point(a.bl.x,a.bl.y),br:new fabric.Point(a.br.x,a.br.y)}}var c=b(this.oCoords),d=b(a.oCoords),e=fabric.Intersection.intersectPolygonPolygon([c.tl,c.tr,c.br,c.bl],[d.tl,d.tr,d.br,d.bl]);return"Intersection"===e.status},isContainedWithinObject:function(a){var b=a.getBoundingRect(),c=new fabric.Point(b.left,b.top),d=new fabric.Point(b.left+b.width,b.top+b.height);return this.isContainedWithinRect(c,d)},isContainedWithinRect:function(a,b){var c=this.getBoundingRect();return c.left>=a.x&&c.left+c.width<=b.x&&c.top>=a.y&&c.top+c.height<=b.y},containsPoint:function(a){var b=this._getImageLines(this.oCoords),c=this._findCrossPoints(a,b);return 0!==c&&c%2===1},_getImageLines:function(a){return{topline:{o:a.tl,d:a.tr},rightline:{o:a.tr,d:a.br},bottomline:{o:a.br,d:a.bl},leftline:{o:a.bl,d:a.tl}}},_findCrossPoints:function(a,b){var c,d,e,f,g,h,i,j=0;for(var k in b)if(i=b[k],!(i.o.y<a.y&&i.d.y<a.y||i.o.y>=a.y&&i.d.y>=a.y||(i.o.x===i.d.x&&i.o.x>=a.x?(g=i.o.x,h=a.y):(c=0,d=(i.d.y-i.o.y)/(i.d.x-i.o.x),e=a.y-c*a.x,f=i.o.y-d*i.o.x,g=-(e-f)/(c-d),h=e+c*g),g>=a.x&&(j+=1),2!==j)))break;return j},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var a=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],b=fabric.util.array.min(a),c=fabric.util.array.max(a),d=Math.abs(b-c),e=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],f=fabric.util.array.min(e),g=fabric.util.array.max(e),h=Math.abs(f-g);return{left:b,top:f,width:d,height:h}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(a){return Math.abs(a)<this.minScaleLimit?0>a?-this.minScaleLimit:this.minScaleLimit:a},scale:function(a){return a=this._constrainScale(a),0>a&&(this.flipX=!this.flipX,this.flipY=!this.flipY,a*=-1),this.scaleX=a,this.scaleY=a,this.setCoords(),this},scaleToWidth:function(a){var b=this.getBoundingRectWidth()/this.getWidth();return this.scale(a/this.width/b)},scaleToHeight:function(a){var b=this.getBoundingRectHeight()/this.getHeight();return this.scale(a/this.height/b)},setCoords:function(){var b=this.strokeWidth>1?this.strokeWidth:0,c=this.padding,d=a(this.angle);this.currentWidth=(this.width+b)*this.scaleX+2*c,this.currentHeight=(this.height+b)*this.scaleY+2*c,this.currentWidth<0&&(this.currentWidth=Math.abs(this.currentWidth));var e=Math.sqrt(Math.pow(this.currentWidth/2,2)+Math.pow(this.currentHeight/2,2)),f=Math.atan(isFinite(this.currentHeight/this.currentWidth)?this.currentHeight/this.currentWidth:0),g=Math.cos(f+d)*e,h=Math.sin(f+d)*e,i=Math.sin(d),j=Math.cos(d),k=this.getCenterPoint(),l={x:k.x-g,y:k.y-h},m={x:l.x+this.currentWidth*j,y:l.y+this.currentWidth*i},n={x:m.x-this.currentHeight*i,y:m.y+this.currentHeight*j},o={x:l.x-this.currentHeight*i,y:l.y+this.currentHeight*j},p={x:l.x-this.currentHeight/2*i,y:l.y+this.currentHeight/2*j},q={x:l.x+this.currentWidth/2*j,y:l.y+this.currentWidth/2*i},r={x:m.x-this.currentHeight/2*i,y:m.y+this.currentHeight/2*j},s={x:o.x+this.currentWidth/2*j,y:o.y+this.currentWidth/2*i},t={x:q.x,y:q.y};return this.oCoords={tl:l,tr:m,br:n,bl:o,ml:p,mt:q,mr:r,mb:s,mtr:t},this._setCornerCoords&&this._setCornerCoords(),this}})}(),fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(a){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,a):this.canvas.sendBackwards(this,a),this},bringForward:function(a){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,a):this.canvas.bringForward(this,a),this},moveTo:function(a){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,a):this.canvas.moveTo(this,a),this}}),fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(){var a=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",b=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",c=this.strokeWidth?this.strokeWidth:"0",d=this.strokeDashArray?this.strokeDashArray.join(" "):"",e=this.strokeLineCap?this.strokeLineCap:"butt",f=this.strokeLineJoin?this.strokeLineJoin:"miter",g=this.strokeMiterLimit?this.strokeMiterLimit:"4",h="undefined"!=typeof this.opacity?this.opacity:"1",i=this.visible?"":" visibility: hidden;",j=this.shadow&&"text"!==this.type?"filter: url(#SVGID_"+this.shadow.id+");":"";return["stroke: ",b,"; ","stroke-width: ",c,"; ","stroke-dasharray: ",d,"; ","stroke-linecap: ",e,"; ","stroke-linejoin: ",f,"; ","stroke-miterlimit: ",g,"; ","fill: ",a,"; ","opacity: ",h,";",j,i].join("")},getSvgTransform:function(){var a=fabric.util.toFixed,b=this.getAngle(),c=this.getCenterPoint(),d=fabric.Object.NUM_FRACTION_DIGITS,e="translate("+a(c.x,d)+" "+a(c.y,d)+")",f=0!==b?" rotate("+a(b,d)+")":"",g=1===this.scaleX&&1===this.scaleY?"":" scale("+a(this.scaleX,d)+" "+a(this.scaleY,d)+")",h=this.flipX?"matrix(-1 0 0 1 0 0) ":"",i=this.flipY?"matrix(1 0 0 -1 0 0)":"";return[e,f,g,h,i].join("")},_createBaseSVGMarkup:function(){var a=[];return this.fill&&this.fill.toLive&&a.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&a.push(this.stroke.toSVG(this,!1)),this.shadow&&a.push(this.shadow.toSVG(this)),a}}),fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(a){return this.get(a)!==this.originalState[a]},this)},saveState:function(a){return this.stateProperties.forEach(function(a){this.originalState[a]=this.get(a)},this),a&&a.stateProperties&&a.stateProperties.forEach(function(a){this.originalState[a]=this.get(a)},this),this},setupState:function(){return this.originalState={},this.saveState(),this}}),function(){var a=fabric.util.degreesToRadians,b="undefined"!=typeof G_vmlCanvasManager;fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(a){if(!this.hasControls||!this.active)return!1;var b,c,d=a.x,e=a.y;for(var f in this.oCoords)if(this.isControlVisible(f)&&("mtr"!==f||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==f&&"mr"!==f&&"mb"!==f&&"ml"!==f)&&(c=this._getImageLines(this.oCoords[f].corner),b=this._findCrossPoints({x:d,y:e},c),0!==b&&b%2===1))return this.__corner=f,f;return!1},_setCornerCoords:function(){var b=this.oCoords,c=a(this.angle),d=a(45-this.angle),e=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,f=e*Math.cos(d),g=e*Math.sin(d),h=Math.sin(c),i=Math.cos(c);b.tl.corner={tl:{x:b.tl.x-g,y:b.tl.y-f},tr:{x:b.tl.x+f,y:b.tl.y-g},bl:{x:b.tl.x-f,y:b.tl.y+g},br:{x:b.tl.x+g,y:b.tl.y+f}},b.tr.corner={tl:{x:b.tr.x-g,y:b.tr.y-f},tr:{x:b.tr.x+f,y:b.tr.y-g},br:{x:b.tr.x+g,y:b.tr.y+f},bl:{x:b.tr.x-f,y:b.tr.y+g}},b.bl.corner={tl:{x:b.bl.x-g,y:b.bl.y-f},bl:{x:b.bl.x-f,y:b.bl.y+g},br:{x:b.bl.x+g,y:b.bl.y+f},tr:{x:b.bl.x+f,y:b.bl.y-g}},b.br.corner={tr:{x:b.br.x+f,y:b.br.y-g},bl:{x:b.br.x-f,y:b.br.y+g},br:{x:b.br.x+g,y:b.br.y+f},tl:{x:b.br.x-g,y:b.br.y-f}},b.ml.corner={tl:{x:b.ml.x-g,y:b.ml.y-f},tr:{x:b.ml.x+f,y:b.ml.y-g},bl:{x:b.ml.x-f,y:b.ml.y+g},br:{x:b.ml.x+g,y:b.ml.y+f}},b.mt.corner={tl:{x:b.mt.x-g,y:b.mt.y-f},tr:{x:b.mt.x+f,y:b.mt.y-g},bl:{x:b.mt.x-f,y:b.mt.y+g},br:{x:b.mt.x+g,y:b.mt.y+f}},b.mr.corner={tl:{x:b.mr.x-g,y:b.mr.y-f},tr:{x:b.mr.x+f,y:b.mr.y-g},bl:{x:b.mr.x-f,y:b.mr.y+g},br:{x:b.mr.x+g,y:b.mr.y+f}},b.mb.corner={tl:{x:b.mb.x-g,y:b.mb.y-f},tr:{x:b.mb.x+f,y:b.mb.y-g},bl:{x:b.mb.x-f,y:b.mb.y+g},br:{x:b.mb.x+g,y:b.mb.y+f}},b.mtr.corner={tl:{x:b.mtr.x-g+h*this.rotatingPointOffset,y:b.mtr.y-f-i*this.rotatingPointOffset},tr:{x:b.mtr.x+f+h*this.rotatingPointOffset,y:b.mtr.y-g-i*this.rotatingPointOffset},bl:{x:b.mtr.x-f+h*this.rotatingPointOffset,y:b.mtr.y+g-i*this.rotatingPointOffset},br:{x:b.mtr.x+g+h*this.rotatingPointOffset,y:b.mtr.y+f-i*this.rotatingPointOffset}}},drawBorders:function(a){if(!this.hasBorders)return this;var b=this.padding,c=2*b,d=2*~~(this.strokeWidth/2);a.save(),a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,a.strokeStyle=this.borderColor;var e=1/this._constrainScale(this.scaleX),f=1/this._constrainScale(this.scaleY);a.lineWidth=1/this.borderScaleFactor,a.scale(e,f);var g=this.getWidth(),h=this.getHeight();if(a.strokeRect(~~(-(g/2)-b-d/2*this.scaleX)-.5,~~(-(h/2)-b-d/2*this.scaleY)-.5,~~(g+c+d*this.scaleX)+1,~~(h+c+d*this.scaleY)+1),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var i=(this.flipY?h+d*this.scaleY+2*b:-h-d*this.scaleY-2*b)/2;a.beginPath(),a.moveTo(0,i),a.lineTo(0,i+(this.flipY?this.rotatingPointOffset:-this.rotatingPointOffset)),a.closePath(),a.stroke()}return a.restore(),this},drawControls:function(a){if(!this.hasControls)return this;var b=this.cornerSize,c=b/2,d=~~(this.strokeWidth/2),e=-(this.width/2),f=-(this.height/2),g=this.padding/this.scaleX,h=this.padding/this.scaleY,i=c/this.scaleY,j=c/this.scaleX,k=(c-b)/this.scaleX,l=(c-b)/this.scaleY,m=this.height,n=this.width,o=this.transparentCorners?"strokeRect":"fillRect";return a.save(),a.lineWidth=1/Math.max(this.scaleX,this.scaleY),a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,a.strokeStyle=a.fillStyle=this.cornerColor,this._drawControl("tl",a,o,e-j-d-g,f-i-d-h),this._drawControl("tr",a,o,e+n-j+d+g,f-i-d-h),this._drawControl("bl",a,o,e-j-d-g,f+m+l+d+h),this._drawControl("br",a,o,e+n+k+d+g,f+m+l+d+h),this.get("lockUniScaling")||(this._drawControl("mt",a,o,e+n/2-j,f-i-d-h),this._drawControl("mb",a,o,e+n/2-j,f+m+l+d+h),this._drawControl("mr",a,o,e+n+k+d+g,f+m/2-i),this._drawControl("ml",a,o,e-j-d-g,f+m/2-i)),this.hasRotatingPoint&&this._drawControl("mtr",a,o,e+n/2-j,this.flipY?f+m+this.rotatingPointOffset/this.scaleY-this.cornerSize/this.scaleX/2+d+h:f-this.rotatingPointOffset/this.scaleY-this.cornerSize/this.scaleY/2-d-h),a.restore(),this},_drawControl:function(a,c,d,e,f){var g=this.cornerSize/this.scaleX,h=this.cornerSize/this.scaleY;this.isControlVisible(a)&&(b||this.transparentCorners||c.clearRect(e,f,g,h),c[d](e,f,g,h))},isControlVisible:function(a){return this._getControlsVisibility()[a]},setControlVisible:function(a,b){return this._getControlsVisibility()[a]=b,this},setControlsVisibility:function(a){a||(a={});for(var b in a)this.setControlVisible(b,a[b]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(a,b){b=b||{};var c=function(){},d=b.onComplete||c,e=b.onChange||c,f=this;return fabric.util.animate({startValue:a.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(b){a.set("left",b),f.renderAll(),e()},onComplete:function(){a.setCoords(),d()}}),this},fxCenterObjectV:function(a,b){b=b||{};var c=function(){},d=b.onComplete||c,e=b.onChange||c,f=this;return fabric.util.animate({startValue:a.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(b){a.set("top",b),f.renderAll(),e()},onComplete:function(){a.setCoords(),d()}}),this},fxRemove:function(a,b){b=b||{};var c=function(){},d=b.onComplete||c,e=b.onChange||c,f=this;return fabric.util.animate({startValue:a.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){a.set("active",!1)},onChange:function(b){a.set("opacity",b),f.renderAll(),e()},onComplete:function(){f.remove(a),d()}}),this}}),fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var a,b,c=[];for(a in arguments[0])c.push(a);for(var d=0,e=c.length;e>d;d++)a=c[d],b=d!==e-1,this._animate(a,arguments[0][a],arguments[1],b)}else this._animate.apply(this,arguments);return this},_animate:function(a,b,c,d){var e,f=this;b=b.toString(),c=c?fabric.util.object.clone(c):{},~a.indexOf(".")&&(e=a.split("."));var g=e?this.get(e[0])[e[1]]:this.get(a);"from"in c||(c.from=g),b=~b.indexOf("=")?g+parseFloat(b.replace("=","")):parseFloat(b),fabric.util.animate({startValue:c.from,endValue:b,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(){return c.abort.call(f)},onChange:function(b){e?f[e[0]][e[1]]=b:f.set(a,b),d||c.onChange&&c.onChange()},onComplete:function(){d||(f.setCoords(),c.onComplete&&c.onComplete())}})}}),function(a){"use strict";function b(a,b){var c=a.origin,d=a.axis1,e=a.axis2,f=a.dimension,g=b.nearest,h=b.center,i=b.farthest;return function(){switch(this.get(c)){case g:return Math.min(this.get(d),this.get(e));case h:return Math.min(this.get(d),this.get(e))+.5*this.get(f);case i:return Math.max(this.get(d),this.get(e))}}}var c=a.fabric||(a.fabric={}),d=c.util.object.extend,e={x1:1,x2:1,y1:1,y2:1},f=c.StaticCanvas.supports("setLineDash");return c.Line?void c.warn("fabric.Line is already defined"):(c.Line=c.util.createClass(c.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(a,b){b=b||{},a||(a=[0,0,0,0]),this.callSuper("initialize",b),this.set("x1",a[0]),this.set("y1",a[1]),this.set("x2",a[2]),this.set("y2",a[3]),this._setWidthHeight(b)},_setWidthHeight:function(a){a||(a={}),this.width=Math.abs(this.x2-this.x1)||1,this.height=Math.abs(this.y2-this.y1)||1,this.left="left"in a?a.left:this._getLeftToOriginX(),this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,b){return this[a]=b,"undefined"!=typeof e[a]&&this._setWidthHeight(),this},_getLeftToOriginX:b({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:b({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a){a.beginPath();var b=this.group&&"path-group"===this.group.type;if(b&&!this.transformMatrix){var c=this.getCenterPoint();a.translate(-this.group.width/2+c.x,-this.group.height/2+c.y)}if(!this.strokeDashArray||this.strokeDashArray&&f){var d=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1;a.moveTo(1===this.width?0:d*this.width/2,1===this.height?0:e*this.height/2),a.lineTo(1===this.width?0:-1*d*this.width/2,1===this.height?0:-1*e*this.height/2)}a.lineWidth=this.strokeWidth;var g=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle,this.stroke&&this._renderStroke(a),a.strokeStyle=g},_renderDashedStroke:function(a){var b=this.x1<=this.x2?-1:1,d=this.y1<=this.y2?-1:1,e=1===this.width?0:b*this.width/2,f=1===this.height?0:d*this.height/2;a.beginPath(),c.util.drawDashedLine(a,e,f,-e,-f,this.strokeDashArray),a.closePath()},toObject:function(a){return d(this.callSuper("toObject",a),{x1:this.get("x1"),y1:this.get("y1"),x2:this.get("x2"),y2:this.get("y2")})},toSVG:function(a){var b=this._createBaseSVGMarkup();return b.push("<line ",'x1="',this.get("x1"),'" y1="',this.get("y1"),'" x2="',this.get("x2"),'" y2="',this.get("y2"),'" style="',this.getSvgStyles(),'"/>'),a?a(b.join("")):b.join("")},complexity:function(){return 1}}),c.Line.ATTRIBUTE_NAMES=c.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),c.Line.fromElement=function(a,b){var e=c.parseAttributes(a,c.Line.ATTRIBUTE_NAMES),f=[e.x1||0,e.y1||0,e.x2||0,e.y2||0];
return new c.Line(f,d(e,b))},void(c.Line.fromObject=function(a){var b=[a.x1,a.y1,a.x2,a.y2];return new c.Line(b,a)}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";function b(a){return"radius"in a&&a.radius>0}var c=a.fabric||(a.fabric={}),d=2*Math.PI,e=c.util.object.extend;return c.Circle?void c.warn("fabric.Circle is already defined."):(c.Circle=c.util.createClass(c.Object,{type:"circle",radius:0,initialize:function(a){a=a||{},this.set("radius",a.radius||0),this.callSuper("initialize",a)},_set:function(a,b){return this.callSuper("_set",a,b),"radius"===a&&this.setRadius(b),this},toObject:function(a){return e(this.callSuper("toObject",a),{radius:this.get("radius")})},toSVG:function(a){var b=this._createBaseSVGMarkup();return b.push("<circle ",'cx="0" cy="0" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath(),a.globalAlpha=this.group?a.globalAlpha*this.opacity:this.opacity,a.arc(b?this.left:0,b?this.top:0,this.radius,0,d,!1),a.closePath(),this._renderFill(a),this.stroke&&this._renderStroke(a)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(a){this.radius=a,this.set("width",2*a).set("height",2*a)},complexity:function(){return 1}}),c.Circle.ATTRIBUTE_NAMES=c.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),c.Circle.fromElement=function(a,d){d||(d={});var f=c.parseAttributes(a,c.Circle.ATTRIBUTE_NAMES);if(!b(f))throw new Error("value of `r` attribute is required and can not be negative");"left"in f&&(f.left-=d.width/2||0),"top"in f&&(f.top-=d.height/2||0);var g=new c.Circle(e(f,d));return g.cx=parseFloat(a.getAttribute("cx"))||0,g.cy=parseFloat(a.getAttribute("cy"))||0,g},void(c.Circle.fromObject=function(a){return new c.Circle(a)}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={});return b.Triangle?void b.warn("fabric.Triangle is already defined"):(b.Triangle=b.util.createClass(b.Object,{type:"triangle",initialize:function(a){a=a||{},this.callSuper("initialize",a),this.set("width",a.width||100).set("height",a.height||100)},_render:function(a){var b=this.width/2,c=this.height/2;a.beginPath(),a.moveTo(-b,c),a.lineTo(0,-c),a.lineTo(b,c),a.closePath(),this._renderFill(a),this._renderStroke(a)},_renderDashedStroke:function(a){var c=this.width/2,d=this.height/2;a.beginPath(),b.util.drawDashedLine(a,-c,d,0,-d,this.strokeDashArray),b.util.drawDashedLine(a,0,-d,c,d,this.strokeDashArray),b.util.drawDashedLine(a,c,d,-c,d,this.strokeDashArray),a.closePath()},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=this.width/2,d=this.height/2,e=[-c+" "+d,"0 "+-d,c+" "+d].join(",");return b.push("<polygon ",'points="',e,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),a?a(b.join("")):b.join("")},complexity:function(){return 1}}),void(b.Triangle.fromObject=function(a){return new b.Triangle(a)}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=2*Math.PI,d=b.util.object.extend;return b.Ellipse?void b.warn("fabric.Ellipse is already defined."):(b.Ellipse=b.util.createClass(b.Object,{type:"ellipse",rx:0,ry:0,initialize:function(a){a=a||{},this.callSuper("initialize",a),this.set("rx",a.rx||0),this.set("ry",a.ry||0),this.set("width",2*this.get("rx")),this.set("height",2*this.get("ry"))},toObject:function(a){return d(this.callSuper("toObject",a),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(a){var b=this._createBaseSVGMarkup();return b.push("<ellipse ",'rx="',this.get("rx"),'" ry="',this.get("ry"),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),a?a(b.join("")):b.join("")},render:function(a,b){return 0!==this.rx&&0!==this.ry?this.callSuper("render",a,b):void 0},_render:function(a,b){a.beginPath(),a.save(),a.globalAlpha=this.group?a.globalAlpha*this.opacity:this.opacity,this.transformMatrix&&this.group&&a.translate(this.cx,this.cy),a.transform(1,0,0,this.ry/this.rx,0,0),a.arc(b?this.left:0,b?this.top:0,this.rx,0,c,!1),a.restore(),this._renderFill(a),this._renderStroke(a)},complexity:function(){return 1}}),b.Ellipse.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),b.Ellipse.fromElement=function(a,c){c||(c={});var e=b.parseAttributes(a,b.Ellipse.ATTRIBUTE_NAMES),f=e.left,g=e.top;"left"in e&&(e.left-=c.width/2||0),"top"in e&&(e.top-=c.height/2||0);var h=new b.Ellipse(d(e,c));return h.cx=f||0,h.cy=g||0,h},void(b.Ellipse.fromObject=function(a){return new b.Ellipse(a)}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";function b(a){return a.left=a.left||0,a.top=a.top||0,a}var c=a.fabric||(a.fabric={}),d=c.util.object.extend;if(c.Rect)return void console.warn("fabric.Rect is already defined");var e=c.Object.prototype.stateProperties.concat();e.push("rx","ry","x","y"),c.Rect=c.util.createClass(c.Object,{stateProperties:e,type:"rect",rx:0,ry:0,x:0,y:0,strokeDashArray:null,initialize:function(a){a=a||{},this.callSuper("initialize",a),this._initRxRy(),this.x=a.x||0,this.y=a.y||0},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(a){if(1===this.width&&1===this.height)return void a.fillRect(0,0,1,1);var b=this.rx?Math.min(this.rx,this.width/2):0,c=this.ry?Math.min(this.ry,this.height/2):0,d=this.width,e=this.height,f=-d/2,g=-e/2,h=this.group&&"path-group"===this.group.type,i=0!==b||0!==c,j=.4477152502;a.beginPath(),a.globalAlpha=h?a.globalAlpha*this.opacity:this.opacity,this.transformMatrix&&h&&a.translate(this.width/2+this.x,this.height/2+this.y),!this.transformMatrix&&h&&a.translate(-this.group.width/2+this.width/2+this.x,-this.group.height/2+this.height/2+this.y),a.moveTo(f+b,g),a.lineTo(f+d-b,g),i&&a.bezierCurveTo(f+d-j*b,g,f+d,g+j*c,f+d,g+c),a.lineTo(f+d,g+e-c),i&&a.bezierCurveTo(f+d,g+e-j*c,f+d-j*b,g+e,f+d-b,g+e),a.lineTo(f+b,g+e),i&&a.bezierCurveTo(f+j*b,g+e,f,g+e-j*c,f,g+e-c),a.lineTo(f,g+c),i&&a.bezierCurveTo(f,g+j*c,f+j*b,g,f+b,g),a.closePath(),this._renderFill(a),this._renderStroke(a)},_renderDashedStroke:function(a){var b=-this.width/2,d=-this.height/2,e=this.width,f=this.height;a.beginPath(),c.util.drawDashedLine(a,b,d,b+e,d,this.strokeDashArray),c.util.drawDashedLine(a,b+e,d,b+e,d+f,this.strokeDashArray),c.util.drawDashedLine(a,b+e,d+f,b,d+f,this.strokeDashArray),c.util.drawDashedLine(a,b,d+f,b,d,this.strokeDashArray),a.closePath()},_normalizeLeftTopProperties:function(a){return"left"in a&&this.set("left",a.left+this.getWidth()/2),this.set("x",a.left||0),"top"in a&&this.set("top",a.top+this.getHeight()/2),this.set("y",a.top||0),this},toObject:function(a){var b=d(this.callSuper("toObject",a),{rx:this.get("rx")||0,ry:this.get("ry")||0,x:this.get("x"),y:this.get("y")});return this.includeDefaultValues||this._removeDefaultValues(b),b},toSVG:function(a){var b=this._createBaseSVGMarkup();return b.push("<rect ",'x="',-1*this.width/2,'" y="',-1*this.height/2,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),a?a(b.join("")):b.join("")},complexity:function(){return 1}}),c.Rect.ATTRIBUTE_NAMES=c.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),c.Rect.fromElement=function(a,e){if(!a)return null;var f=c.parseAttributes(a,c.Rect.ATTRIBUTE_NAMES);f=b(f);var g=new c.Rect(d(e?c.util.object.clone(e):{},f));return g._normalizeLeftTopProperties(f),g},c.Rect.fromObject=function(a){return new c.Rect(a)}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.toFixed;return b.Polyline?void b.warn("fabric.Polyline is already defined"):(b.Polyline=b.util.createClass(b.Object,{type:"polyline",points:null,initialize:function(a,b,c){b=b||{},this.set("points",a),this.callSuper("initialize",b),this._calcDimensions(c)},_calcDimensions:function(a){return b.Polygon.prototype._calcDimensions.call(this,a)},toObject:function(a){return b.Polygon.prototype.toObject.call(this,a)},toSVG:function(a){for(var b=[],d=this._createBaseSVGMarkup(),e=0,f=this.points.length;f>e;e++)b.push(c(this.points[e].x,2),",",c(this.points[e].y,2)," ");return d.push("<polyline ",'points="',b.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),a?a(d.join("")):d.join("")},_render:function(a){var b;a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y);for(var c=0,d=this.points.length;d>c;c++)b=this.points[c],a.lineTo(b.x,b.y);this._renderFill(a),this._renderStroke(a)},_renderDashedStroke:function(a){var c,d;a.beginPath();for(var e=0,f=this.points.length;f>e;e++)c=this.points[e],d=this.points[e+1]||c,b.util.drawDashedLine(a,c.x,c.y,d.x,d.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),b.Polyline.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(),b.Polyline.fromElement=function(a,c){if(!a)return null;c||(c={});var d=b.parsePointsAttribute(a.getAttribute("points")),e=b.parseAttributes(a,b.Polyline.ATTRIBUTE_NAMES);return b.util.normalizePoints(d,c),new b.Polyline(d,b.util.object.extend(e,c),!0)},void(b.Polyline.fromObject=function(a){var c=a.points;return new b.Polyline(c,a,!0)}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend,d=b.util.array.min,e=b.util.array.max,f=b.util.toFixed;return b.Polygon?void b.warn("fabric.Polygon is already defined"):(b.Polygon=b.util.createClass(b.Object,{type:"polygon",points:null,initialize:function(a,b,c){b=b||{},this.points=a,this.callSuper("initialize",b),this._calcDimensions(c)},_calcDimensions:function(a){var b=this.points,c=d(b,"x"),f=d(b,"y"),g=e(b,"x"),h=e(b,"y");if(this.width=g-c||1,this.height=h-f||1,this.minX=c,this.minY=f,!a){var i=this.width/2+this.minX,j=this.height/2+this.minY;this.points.forEach(function(a){a.x-=i,a.y-=j},this)}},toObject:function(a){return c(this.callSuper("toObject",a),{points:this.points.concat()})},toSVG:function(a){for(var b=[],c=this._createBaseSVGMarkup(),d=0,e=this.points.length;e>d;d++)b.push(f(this.points[d].x,2),",",f(this.points[d].y,2)," ");return c.push("<polygon ",'points="',b.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),a?a(c.join("")):c.join("")},_render:function(a){var b;a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y);for(var c=0,d=this.points.length;d>c;c++)b=this.points[c],a.lineTo(b.x,b.y);this._renderFill(a),(this.stroke||this.strokeDashArray)&&(a.closePath(),this._renderStroke(a))},_renderDashedStroke:function(a){var c,d;a.beginPath();for(var e=0,f=this.points.length;f>e;e++)c=this.points[e],d=this.points[e+1]||this.points[0],b.util.drawDashedLine(a,c.x,c.y,d.x,d.y,this.strokeDashArray);a.closePath()},complexity:function(){return this.points.length}}),b.Polygon.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(),b.Polygon.fromElement=function(a,d){if(!a)return null;d||(d={});var e=b.parsePointsAttribute(a.getAttribute("points")),f=b.parseAttributes(a,b.Polygon.ATTRIBUTE_NAMES);return b.util.normalizePoints(e,d),new b.Polygon(e,c(f,d),!0)},void(b.Polygon.fromObject=function(a){return new b.Polygon(a.points,a,!0)}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";function b(a){return"H"===a[0]?a[1]:a[a.length-2]}function c(a){return"V"===a[0]?a[1]:a[a.length-1]}var d=a.fabric||(a.fabric={}),e=d.util.array.min,f=d.util.array.max,g=d.util.object.extend,h=Object.prototype.toString,i=d.util.drawArc,j={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7};return d.Path?void d.warn("fabric.Path is already defined"):(d.Path=d.util.createClass(d.Object,{type:"path",path:null,initialize:function(a,b){if(b=b||{},this.setOptions(b),!a)throw new Error("`path` argument is required");var c="[object Array]"===h.call(a);this.path=c?a:a.match&&a.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(c||(this.path=this._parsePath()),this._initializePath(b),b.sourcePath&&this.setSourcePath(b.sourcePath))},_initializePath:function(a){var b="width"in a&&null!=a.width,c="height"in a&&null!=a.width,d="left"in a,e="top"in a,f=d?this.left:0,h=e?this.top:0;b&&c?(e||(this.top=this.height/2),d||(this.left=this.width/2)):(g(this,this._parseDimensions()),b&&(this.width=a.width),c&&(this.height=a.height)),this.pathOffset=this.pathOffset||this._calculatePathOffset(f,h)},_calculatePathOffset:function(a,b){return{x:this.left-a-this.width/2,y:this.top-b-this.height/2}},_render:function(a){for(var b,c,d,e,f,g,h=null,j=0,k=0,l=0,m=0,n=-(this.width/2+this.pathOffset.x),o=-(this.height/2+this.pathOffset.y),p=0,q=this.path.length;q>p;++p){switch(b=this.path[p],b[0]){case"l":j+=b[1],k+=b[2],a.lineTo(j+n,k+o);break;case"L":j=b[1],k=b[2],a.lineTo(j+n,k+o);break;case"h":j+=b[1],a.lineTo(j+n,k+o);break;case"H":j=b[1],a.lineTo(j+n,k+o);break;case"v":k+=b[1],a.lineTo(j+n,k+o);break;case"V":k=b[1],a.lineTo(j+n,k+o);break;case"m":j+=b[1],k+=b[2],g=!h||"m"!==h[0]&&"M"!==h[0]?"moveTo":"lineTo",a[g](j+n,k+o);break;case"M":j=b[1],k=b[2],g=!h||"m"!==h[0]&&"M"!==h[0]?"moveTo":"lineTo",a[g](j+n,k+o);break;case"c":c=j+b[5],d=k+b[6],l=j+b[3],m=k+b[4],a.bezierCurveTo(j+b[1]+n,k+b[2]+o,l+n,m+o,c+n,d+o),j=c,k=d;break;case"C":j=b[5],k=b[6],l=b[3],m=b[4],a.bezierCurveTo(b[1]+n,b[2]+o,l+n,m+o,j+n,k+o);break;case"s":c=j+b[3],d=k+b[4],l=l?2*j-l:j,m=m?2*k-m:k,a.bezierCurveTo(l+n,m+o,j+b[1]+n,k+b[2]+o,c+n,d+o),l=j+b[1],m=k+b[2],j=c,k=d;break;case"S":c=b[3],d=b[4],l=2*j-l,m=2*k-m,a.bezierCurveTo(l+n,m+o,b[1]+n,b[2]+o,c+n,d+o),j=c,k=d,l=b[1],m=b[2];break;case"q":c=j+b[3],d=k+b[4],l=j+b[1],m=k+b[2],a.quadraticCurveTo(l+n,m+o,c+n,d+o),j=c,k=d;break;case"Q":c=b[3],d=b[4],a.quadraticCurveTo(b[1]+n,b[2]+o,c+n,d+o),j=c,k=d,l=b[1],m=b[2];break;case"t":c=j+b[1],d=k+b[2],null===h[0].match(/[QqTt]/)?(l=j,m=k):"t"===h[0]?(l=2*j-e,m=2*k-f):"q"===h[0]&&(l=2*j-l,m=2*k-m),e=l,f=m,a.quadraticCurveTo(l+n,m+o,c+n,d+o),j=c,k=d,l=j+b[1],m=k+b[2];break;case"T":c=b[1],d=b[2],l=2*j-l,m=2*k-m,a.quadraticCurveTo(l+n,m+o,c+n,d+o),j=c,k=d;break;case"a":i(a,j+n,k+o,[b[1],b[2],b[3],b[4],b[5],b[6]+j+n,b[7]+k+o]),j+=b[6],k+=b[7];break;case"A":i(a,j+n,k+o,[b[1],b[2],b[3],b[4],b[5],b[6]+n,b[7]+o]),j=b[6],k=b[7];break;case"z":case"Z":a.closePath()}h=b}},render:function(a,b){if(this.visible){a.save();var c=this.transformMatrix;c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5]),b||this.transform(a),this._setStrokeStyles(a),this._setFillStyles(a),this._setShadow(a),this.clipTo&&d.util.clipContext(this,a),a.beginPath(),this._render(a),this._renderFill(a),this._renderStroke(a),this.clipTo&&a.restore(),this._removeShadow(a),!b&&this.active&&(this.drawBorders(a),this.drawControls(a)),a.restore()}},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){var b=g(this.callSuper("toObject",a),{path:this.path.map(function(a){return a.slice()}),pathOffset:this.pathOffset});return this.sourcePath&&(b.sourcePath=this.sourcePath),this.transformMatrix&&(b.transformMatrix=this.transformMatrix),b},toDatalessObject:function(a){var b=this.toObject(a);return this.sourcePath&&(b.path=this.sourcePath),delete b.sourcePath,b},toSVG:function(a){for(var b=[],c=this._createBaseSVGMarkup(),d=0,e=this.path.length;e>d;d++)b.push(this.path[d].join(" "));var f=b.join(" ");return c.push('<g transform="',this.group?"":this.getSvgTransform(),'">',"<path ",'d="',f,'" style="',this.getSvgStyles(),'" transform="translate(',-this.width/2," ",-this.height/2,")",'" stroke-linecap="round" ',"/>","</g>"),a?a(c.join("")):c.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var a,b,c,d,e,f=[],g=[],h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,i=0,k=this.path.length;k>i;i++){for(a=this.path[i],d=a.slice(1).trim(),g.length=0;c=h.exec(d);)g.push(c[0]);e=[a.charAt(0)];for(var l=0,m=g.length;m>l;l++)b=parseFloat(g[l]),isNaN(b)||e.push(b);var n=e[0].toLowerCase(),o=j[n];if(e.length-1>o)for(var p=1,q=e.length;q>p;p+=o)f.push([e[0]].concat(e.slice(p,p+o)));else f.push(e)}return f},_parseDimensions:function(){var a=[],b=[],c={};this.path.forEach(function(d,e){this._getCoordsFromCommand(d,e,a,b,c)},this);var d=e(a),g=e(b),h=f(a),i=f(b),j=h-d,k=i-g,l={left:this.left+(d+j/2),top:this.top+(g+k/2),width:j,height:k};return l},_getCoordsFromCommand:function(a,d,e,f,g){var h=!1;"H"!==a[0]&&(g.x=b(0===d?a:this.path[d-1])),"V"!==a[0]&&(g.y=c(0===d?a:this.path[d-1])),a[0]===a[0].toLowerCase()&&(h=!0);var i,j=this._getXY(a,h,g);i=parseInt(j.x,10),isNaN(i)||e.push(i),i=parseInt(j.y,10),isNaN(i)||f.push(i)},_getXY:function(a,d,e){var f=d?e.x+b(a):"V"===a[0]?e.x:b(a),g=d?e.y+c(a):"H"===a[0]?e.y:c(a);return{x:f,y:g}}}),d.Path.fromObject=function(a,b){"string"==typeof a.path?d.loadSVGFromURL(a.path,function(c){var e=c[0],f=a.path;delete a.path,d.util.object.extend(e,a),e.setSourcePath(f),b(e)}):b(new d.Path(a.path,a))},d.Path.ATTRIBUTE_NAMES=d.SHARED_ATTRIBUTES.concat(["d"]),d.Path.fromElement=function(a,b,c){var e=d.parseAttributes(a,d.Path.ATTRIBUTE_NAMES);b&&b(new d.Path(e.d,g(e,c)))},void(d.Path.async=!0))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend,d=b.util.array.invoke,e=b.Object.prototype.toObject;return b.PathGroup?void b.warn("fabric.PathGroup is already defined"):(b.PathGroup=b.util.createClass(b.Path,{type:"path-group",fill:"",initialize:function(a,b){b=b||{},this.paths=a||[];for(var c=this.paths.length;c--;)this.paths[c].group=this;this.setOptions(b),b.widthAttr&&(this.scaleX=b.widthAttr/b.width),b.heightAttr&&(this.scaleY=b.heightAttr/b.height),this.setCoords(),b.sourcePath&&this.setSourcePath(b.sourcePath)},render:function(a){if(this.visible){a.save();var c=this.transformMatrix;c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this.transform(a),this._setShadow(a),this.clipTo&&b.util.clipContext(this,a);for(var d=0,e=this.paths.length;e>d;++d)this.paths[d].render(a,!0);this.clipTo&&a.restore(),this._removeShadow(a),this.active&&(this.drawBorders(a),this.drawControls(a)),a.restore()}},_set:function(a,b){if("fill"===a&&b&&this.isSameColor())for(var c=this.paths.length;c--;)this.paths[c]._set(a,b);return this.callSuper("_set",a,b)},toObject:function(a){var b=c(e.call(this,a),{paths:d(this.getObjects(),"toObject",a)});return this.sourcePath&&(b.sourcePath=this.sourcePath),b},toDatalessObject:function(a){var b=this.toObject(a);return this.sourcePath&&(b.paths=this.sourcePath),b},toSVG:function(a){for(var b=this.getObjects(),c=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransform(),'" ',">"],d=0,e=b.length;e>d;d++)c.push(b[d].toSVG(a));return c.push("</g>"),a?a(c.join("")):c.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var a=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(b){return(b.get("fill")||"").toLowerCase()===a})},complexity:function(){return this.paths.reduce(function(a,b){return a+(b&&b.complexity?b.complexity():0)},0)},getObjects:function(){return this.paths}}),b.PathGroup.fromObject=function(a,c){"string"==typeof a.paths?b.loadSVGFromURL(a.paths,function(d){var e=a.paths;delete a.paths;var f=b.util.groupSVGElements(d,a,e);c(f)}):b.util.enlivenObjects(a.paths,function(d){delete a.paths,c(new b.PathGroup(d,a))})},void(b.PathGroup.async=!0))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend,d=b.util.array.min,e=b.util.array.max,f=b.util.array.invoke;if(!b.Group){var g={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};b.Group=b.util.createClass(b.Object,b.Collection,{type:"group",initialize:function(a,b){b=b||{},this._objects=a||[];for(var d=this._objects.length;d--;)this._objects[d].group=this;this.originalState={},this.callSuper("initialize"),this._calcBounds(),this._updateObjectsCoords(),b&&c(this,b),this._setOpacityIfSame(),this.setCoords(!0),this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(a){var b=a.getLeft(),c=a.getTop();a.set({originalLeft:b,originalTop:c,left:b-this.left,top:c-this.top}),a.setCoords(),a.__origHasControls=a.hasControls,a.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(a){return this._restoreObjectsState(),this._objects.push(a),a.group=this,this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(a){a.set("active",!0),a.group=this},removeWithUpdate:function(a){return this._moveFlippedObject(a),this._restoreObjectsState(),this.forEachObject(this._setObjectActive,this),this.remove(a),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(a){a.group=this},_onObjectRemoved:function(a){delete a.group,a.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(a,b){if(a in this.delegatedProperties){var c=this._objects.length;for(this[a]=b;c--;)this._objects[c].set(a,b)}else this[a]=b},toObject:function(a){return c(this.callSuper("toObject",a),{objects:f(this._objects,"toObject",a)})},render:function(a,c){if(this.visible){a.save(),this.transform(a),this.clipTo&&b.util.clipContext(this,a);for(var d=0,e=this._objects.length;e>d;d++)this._renderObject(this._objects[d],a);this.clipTo&&a.restore(),!c&&this.active&&(this.drawBorders(a),this.drawControls(a)),a.restore()}},_renderObject:function(a,b){var c=a.borderScaleFactor,d=a.hasRotatingPoint,e=Math.max(this.scaleX,this.scaleY);a.visible&&(a.borderScaleFactor=e,a.hasRotatingPoint=!1,a.render(b),a.borderScaleFactor=c,a.hasRotatingPoint=d)},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},_moveFlippedObject:function(a){var b=a.get("originX"),c=a.get("originY"),d=a.getCenterPoint();a.set({originX:"center",originY:"center",left:d.x,top:d.y}),this._toggleFlipping(a);var e=a.getPointByOrigin(b,c);return a.set({originX:b,originY:c,left:e.x,top:e.y}),this},_toggleFlipping:function(a){this.flipX&&(a.toggle("flipX"),a.set("left",-a.get("left")),a.setAngle(-a.getAngle())),this.flipY&&(a.toggle("flipY"),a.set("top",-a.get("top")),a.setAngle(-a.getAngle()))},_restoreObjectState:function(a){return this._setObjectPosition(a),a.setCoords(),a.hasControls=a.__origHasControls,delete a.__origHasControls,a.set("active",!1),a.setCoords(),delete a.group,this},_setObjectPosition:function(a){var b=this.getLeft(),c=this.getTop(),d=this._getRotatedLeftTop(a);a.set({angle:a.getAngle()+this.getAngle(),left:b+d.left,top:c+d.top,scaleX:a.get("scaleX")*this.get("scaleX"),scaleY:a.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(a){var b=this.getAngle()*(Math.PI/180);return{left:-Math.sin(b)*a.getTop()*this.get("scaleY")+Math.cos(b)*a.getLeft()*this.get("scaleX"),top:Math.cos(b)*a.getTop()*this.get("scaleY")+Math.sin(b)*a.getLeft()*this.get("scaleX")}},destroy:function(){return this._objects.forEach(this._moveFlippedObject,this),this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(a){a.setCoords()}),this},_setOpacityIfSame:function(){var a=this.getObjects(),b=a[0]?a[0].get("opacity"):1,c=a.every(function(a){return a.get("opacity")===b});c&&(this.opacity=b)},_calcBounds:function(a){for(var b,c=[],d=[],e=0,f=this._objects.length;f>e;++e){b=this._objects[e],b.setCoords();for(var g in b.oCoords)c.push(b.oCoords[g].x),d.push(b.oCoords[g].y)}this.set(this._getBounds(c,d,a))},_getBounds:function(a,b,c){var f=d(a),g=e(a),h=d(b),i=e(b),j=g-f||0,k=i-h||0,l={width:j,height:k};return c||(l.left=f+j/2||0,l.top=h+k/2||0),l},toSVG:function(a){for(var b=["<g ",'transform="',this.getSvgTransform(),'">'],c=0,d=this._objects.length;d>c;c++)b.push(this._objects[c].toSVG(a));return b.push("</g>"),a?a(b.join("")):b.join("")},get:function(a){if(a in g){if(this[a])return this[a];for(var b=0,c=this._objects.length;c>b;b++)if(this._objects[b][a])return!0;return!1}return a in this.delegatedProperties?this._objects[0]&&this._objects[0].get(a):this[a]}}),b.Group.fromObject=function(a,c){b.util.enlivenObjects(a.objects,function(d){delete a.objects,c&&c(new b.Group(d,a))})},b.Group.async=!0}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=fabric.util.object.extend;return a.fabric||(a.fabric={}),a.fabric.Image?void fabric.warn("fabric.Image is already defined."):(fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",initialize:function(a,b){b||(b={}),this.filters=[],this.callSuper("initialize",b),this._initElement(a,b),this._initConfig(b),b.filters&&(this.filters=b.filters,this.applyFilters())},getElement:function(){return this._element},setElement:function(a,b){return this._element=a,this._originalElement=a,this._initConfig(),0!==this.filters.length&&this.applyFilters(b),this},setCrossOrigin:function(a){return this.crossOrigin=a,this._element.crossOrigin=a,this},getOriginalSize:function(){var a=this.getElement();return{width:a.width,height:a.height}},render:function(a,b){if(this.visible){a.save();var c=this.transformMatrix,d=this.group&&"path-group"===this.group.type;d&&a.translate(-this.group.width/2,-this.group.height/2),c&&a.transform(c[0],c[1],c[2],c[3],c[4],c[5]),b||this.transform(a),d&&a.translate(this.width/2,this.height/2),a.save(),this._setShadow(a),this.clipTo&&fabric.util.clipContext(this,a),this._render(a),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a),this._renderStroke(a),this.clipTo&&a.restore(),a.restore(),this.active&&!b&&(this.drawBorders(a),this.drawControls(a)),a.restore()}},_stroke:function(a){a.save(),this._setStrokeStyles(a),a.beginPath(),a.strokeRect(-this.width/2,-this.height/2,this.width,this.height),a.closePath(),a.restore()},_renderDashedStroke:function(a){var b=-this.width/2,c=-this.height/2,d=this.width,e=this.height;a.save(),this._setStrokeStyles(a),a.beginPath(),fabric.util.drawDashedLine(a,b,c,b+d,c,this.strokeDashArray),fabric.util.drawDashedLine(a,b+d,c,b+d,c+e,this.strokeDashArray),fabric.util.drawDashedLine(a,b+d,c+e,b,c+e,this.strokeDashArray),fabric.util.drawDashedLine(a,b,c+e,b,c,this.strokeDashArray),a.closePath(),a.restore()},toObject:function(a){return b(this.callSuper("toObject",a),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(a){return a&&a.toObject()}),crossOrigin:this.crossOrigin})},toSVG:function(a){var b=[];if(b.push('<g transform="',this.getSvgTransform(),'">','<image xlink:href="',this.getSvgSrc(),'" style="',this.getSvgStyles(),'" transform="translate('+-this.width/2+" "+-this.height/2+")",'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="none"',"></image>"),this.stroke||this.strokeDashArray){var c=this.fill;this.fill=null,b.push("<rect ",'x="',-1*this.width/2,'" y="',-1*this.height/2,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>'),this.fill=c}return b.push("</g>"),a?a(b.join("")):b.join("")},getSrc:function(){return this.getElement()?this.getElement().src||this.getElement()._src:void 0},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(a,b){this.constructor.fromObject(this.toObject(b),a)},applyFilters:function(a){if(this._originalElement){if(0===this.filters.length)return this._element=this._originalElement,void(a&&a());var b=this._originalElement,c=fabric.util.createCanvasElement(),d=fabric.util.createImage(),e=this;return c.width=b.width,c.height=b.height,c.getContext("2d").drawImage(b,0,0,b.width,b.height),this.filters.forEach(function(a){a&&a.applyTo(c)}),d.width=b.width,d.height=b.height,fabric.isLikelyNode?(d.src=c.toBuffer(void 0,fabric.Image.pngCompression),e._element=d,a&&a()):(d.onload=function(){e._element=d,a&&a(),d.onload=c=b=null},d.src=c.toDataURL("image/png")),this}},_render:function(a){this._element&&a.drawImage(this._element,-this.width/2,-this.height/2,this.width,this.height)},_resetWidthHeight:function(){var a=this.getElement();this.set("width",a.width),this.set("height",a.height)},_initElement:function(a){this.setElement(fabric.util.getById(a)),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(a){a||(a={}),this.setOptions(a),this._setWidthHeight(a),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(a,b){a.filters&&a.filters.length?fabric.util.enlivenObjects(a.filters,function(a){b&&b(a)},"fabric.Image.filters"):b&&b()},_setWidthHeight:function(a){this.width="width"in a?a.width:this.getElement()?this.getElement().width||0:0,this.height="height"in a?a.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(a,b){fabric.util.loadImage(a.src,function(c){fabric.Image.prototype._initFilters.call(a,a,function(d){a.filters=d||[];var e=new fabric.Image(c,a);b&&b(e)})},null,a.crossOrigin)},fabric.Image.fromURL=function(a,b,c){fabric.util.loadImage(a,function(a){b(new fabric.Image(a,c))},null,c&&c.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height xlink:href".split(" ")),fabric.Image.fromElement=function(a,c,d){var e=fabric.parseAttributes(a,fabric.Image.ATTRIBUTE_NAMES);fabric.Image.fromURL(e["xlink:href"],c,b(d?fabric.util.object.clone(d):{},e))},fabric.Image.async=!0,void(fabric.Image.pngCompression=1))}("undefined"!=typeof exports?exports:this),fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var a=this.getAngle()%360;return a>0?90*Math.round((a-1)/90):90*Math.round(a/90)},straighten:function(){return this.setAngle(this._getAngleValueForStraighten()),this},fxStraighten:function(a){a=a||{};var b=function(){},c=a.onComplete||b,d=a.onChange||b,e=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(a){e.setAngle(a),d()},onComplete:function(){e.setCoords(),c()},onStart:function(){e.set("active",!1)}}),this}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(a){return a.straighten(),this.renderAll(),this},fxStraightenObject:function(a){return a.fxStraighten({onChange:this.renderAll.bind(this)}),this}}),fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}}),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend;b.Image.filters.Brightness=b.util.createClass(b.Image.filters.BaseFilter,{type:"Brightness",initialize:function(a){a=a||{},this.brightness=a.brightness||100},applyTo:function(a){for(var b=a.getContext("2d"),c=b.getImageData(0,0,a.width,a.height),d=c.data,e=this.brightness,f=0,g=d.length;g>f;f+=4)d[f]+=e,d[f+1]+=e,d[f+2]+=e;b.putImageData(c,0,0)},toObject:function(){return c(this.callSuper("toObject"),{brightness:this.brightness})}}),b.Image.filters.Brightness.fromObject=function(a){return new b.Image.filters.Brightness(a)}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend;b.Image.filters.Convolute=b.util.createClass(b.Image.filters.BaseFilter,{type:"Convolute",initialize:function(a){a=a||{},this.opaque=a.opaque,this.matrix=a.matrix||[0,0,0,0,1,0,0,0,0];var c=b.util.createCanvasElement();
this.tmpCtx=c.getContext("2d")},_createImageData:function(a,b){return this.tmpCtx.createImageData(a,b)},applyTo:function(a){for(var b=this.matrix,c=a.getContext("2d"),d=c.getImageData(0,0,a.width,a.height),e=Math.round(Math.sqrt(b.length)),f=Math.floor(e/2),g=d.data,h=d.width,i=d.height,j=h,k=i,l=this._createImageData(j,k),m=l.data,n=this.opaque?1:0,o=0;k>o;o++)for(var p=0;j>p;p++){for(var q=o,r=p,s=4*(o*j+p),t=0,u=0,v=0,w=0,x=0;e>x;x++)for(var y=0;e>y;y++){var z=q+x-f,A=r+y-f;if(!(0>z||z>i||0>A||A>h)){var B=4*(z*h+A),C=b[x*e+y];t+=g[B]*C,u+=g[B+1]*C,v+=g[B+2]*C,w+=g[B+3]*C}}m[s]=t,m[s+1]=u,m[s+2]=v,m[s+3]=w+n*(255-w)}c.putImageData(l,0,0)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),b.Image.filters.Convolute.fromObject=function(a){return new b.Image.filters.Convolute(a)}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend;b.Image.filters.GradientTransparency=b.util.createClass(b.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(a){a=a||{},this.threshold=a.threshold||100},applyTo:function(a){for(var b=a.getContext("2d"),c=b.getImageData(0,0,a.width,a.height),d=c.data,e=this.threshold,f=d.length,g=0,h=d.length;h>g;g+=4)d[g+3]=e+255*(f-g)/f;b.putImageData(c,0,0)},toObject:function(){return c(this.callSuper("toObject"),{threshold:this.threshold})}}),b.Image.filters.GradientTransparency.fromObject=function(a){return new b.Image.filters.GradientTransparency(a)}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={});b.Image.filters.Grayscale=b.util.createClass(b.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(a){for(var b,c=a.getContext("2d"),d=c.getImageData(0,0,a.width,a.height),e=d.data,f=d.width*d.height*4,g=0;f>g;)b=(e[g]+e[g+1]+e[g+2])/3,e[g]=b,e[g+1]=b,e[g+2]=b,g+=4;c.putImageData(d,0,0)}}),b.Image.filters.Grayscale.fromObject=function(){return new b.Image.filters.Grayscale}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={});b.Image.filters.Invert=b.util.createClass(b.Image.filters.BaseFilter,{type:"Invert",applyTo:function(a){var b,c=a.getContext("2d"),d=c.getImageData(0,0,a.width,a.height),e=d.data,f=e.length;for(b=0;f>b;b+=4)e[b]=255-e[b],e[b+1]=255-e[b+1],e[b+2]=255-e[b+2];c.putImageData(d,0,0)}}),b.Image.filters.Invert.fromObject=function(){return new b.Image.filters.Invert}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend;b.Image.filters.Mask=b.util.createClass(b.Image.filters.BaseFilter,{type:"Mask",initialize:function(a){a=a||{},this.mask=a.mask,this.channel=[0,1,2,3].indexOf(a.channel)>-1?a.channel:0},applyTo:function(a){if(this.mask){var c,d=a.getContext("2d"),e=d.getImageData(0,0,a.width,a.height),f=e.data,g=this.mask.getElement(),h=b.util.createCanvasElement(),i=this.channel,j=e.width*e.height*4;h.width=g.width,h.height=g.height,h.getContext("2d").drawImage(g,0,0,g.width,g.height);var k=h.getContext("2d").getImageData(0,0,g.width,g.height),l=k.data;for(c=0;j>c;c+=4)f[c+3]=l[c+i];d.putImageData(e,0,0)}},toObject:function(){return c(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}}),b.Image.filters.Mask.fromObject=function(a,c){b.util.loadImage(a.mask.src,function(d){a.mask=new b.Image(d,a.mask),c&&c(new b.Image.filters.Mask(a))})},b.Image.filters.Mask.async=!0}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend;b.Image.filters.Noise=b.util.createClass(b.Image.filters.BaseFilter,{type:"Noise",initialize:function(a){a=a||{},this.noise=a.noise||100},applyTo:function(a){for(var b,c=a.getContext("2d"),d=c.getImageData(0,0,a.width,a.height),e=d.data,f=this.noise,g=0,h=e.length;h>g;g+=4)b=(.5-Math.random())*f,e[g]+=b,e[g+1]+=b,e[g+2]+=b;c.putImageData(d,0,0)},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),b.Image.filters.Noise.fromObject=function(a){return new b.Image.filters.Noise(a)}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend;b.Image.filters.Pixelate=b.util.createClass(b.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(a){a=a||{},this.blocksize=a.blocksize||4},applyTo:function(a){var b,c,d,e,f,g,h,i=a.getContext("2d"),j=i.getImageData(0,0,a.width,a.height),k=j.data,l=j.height,m=j.width;for(c=0;l>c;c+=this.blocksize)for(d=0;m>d;d+=this.blocksize){b=4*c*m+4*d,e=k[b],f=k[b+1],g=k[b+2],h=k[b+3];for(var n=c,o=c+this.blocksize;o>n;n++)for(var p=d,q=d+this.blocksize;q>p;p++)b=4*n*m+4*p,k[b]=e,k[b+1]=f,k[b+2]=g,k[b+3]=h}i.putImageData(j,0,0)},toObject:function(){return c(this.callSuper("toObject"),{blocksize:this.blocksize})}}),b.Image.filters.Pixelate.fromObject=function(a){return new b.Image.filters.Pixelate(a)}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend;b.Image.filters.RemoveWhite=b.util.createClass(b.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(a){a=a||{},this.threshold=a.threshold||30,this.distance=a.distance||20},applyTo:function(a){for(var b,c,d,e=a.getContext("2d"),f=e.getImageData(0,0,a.width,a.height),g=f.data,h=this.threshold,i=this.distance,j=255-h,k=Math.abs,l=0,m=g.length;m>l;l+=4)b=g[l],c=g[l+1],d=g[l+2],b>j&&c>j&&d>j&&k(b-c)<i&&k(b-d)<i&&k(c-d)<i&&(g[l+3]=1);e.putImageData(f,0,0)},toObject:function(){return c(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}}),b.Image.filters.RemoveWhite.fromObject=function(a){return new b.Image.filters.RemoveWhite(a)}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={});b.Image.filters.Sepia=b.util.createClass(b.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(a){var b,c,d=a.getContext("2d"),e=d.getImageData(0,0,a.width,a.height),f=e.data,g=f.length;for(b=0;g>b;b+=4)c=.3*f[b]+.59*f[b+1]+.11*f[b+2],f[b]=c+100,f[b+1]=c+50,f[b+2]=c+255;d.putImageData(e,0,0)}}),b.Image.filters.Sepia.fromObject=function(){return new b.Image.filters.Sepia}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={});b.Image.filters.Sepia2=b.util.createClass(b.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(a){var b,c,d,e,f=a.getContext("2d"),g=f.getImageData(0,0,a.width,a.height),h=g.data,i=h.length;for(b=0;i>b;b+=4)c=h[b],d=h[b+1],e=h[b+2],h[b]=(.393*c+.769*d+.189*e)/1.351,h[b+1]=(.349*c+.686*d+.168*e)/1.203,h[b+2]=(.272*c+.534*d+.131*e)/2.14;f.putImageData(g,0,0)}}),b.Image.filters.Sepia2.fromObject=function(){return new b.Image.filters.Sepia2}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend;b.Image.filters.Tint=b.util.createClass(b.Image.filters.BaseFilter,{type:"Tint",initialize:function(a){a=a||{},this.color=a.color||"#000000",this.opacity="undefined"!=typeof a.opacity?a.opacity:new b.Color(this.color).getAlpha()},applyTo:function(a){var c,d,e,f,g,h,i,j,k,l=a.getContext("2d"),m=l.getImageData(0,0,a.width,a.height),n=m.data,o=n.length;for(k=new b.Color(this.color).getSource(),d=k[0]*this.opacity,e=k[1]*this.opacity,f=k[2]*this.opacity,j=1-this.opacity,c=0;o>c;c+=4)g=n[c],h=n[c+1],i=n[c+2],n[c]=d+g*j,n[c+1]=e+h*j,n[c+2]=f+i*j;l.putImageData(m,0,0)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}}),b.Image.filters.Tint.fromObject=function(a){return new b.Image.filters.Tint(a)}}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend,d=b.util.object.clone,e=b.util.toFixed,f=b.StaticCanvas.supports("setLineDash");if(b.Text)return void b.warn("fabric.Text is already defined");var g=b.Object.prototype.stateProperties.concat();g.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor","useNative","path"),b.Text=b.util.createClass(b.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,textDecoration:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.3,textBackgroundColor:"",path:null,useNative:!0,stateProperties:g,stroke:null,shadow:null,initialize:function(a,b){b=b||{},this.text=a,this.__skipDimension=!0,this.setOptions(b),this.__skipDimension=!1,this._initDimensions(),this.setCoords()},_initDimensions:function(){if(!this.__skipDimension){var a=b.util.createCanvasElement();this._render(a.getContext("2d"))}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(a){var b=this.group&&"path-group"===this.group.type;b&&!this.transformMatrix?a.translate(-this.group.width/2+this.left,-this.group.height/2+this.top):b&&this.transformMatrix&&a.translate(-this.group.width/2,-this.group.height/2),"undefined"==typeof Cufon||this.useNative===!0?this._renderViaNative(a):this._renderViaCufon(a)},_renderViaNative:function(a){var c=this.text.split(this._reNewline);this.transform(a,b.isLikelyNode),this._setTextStyles(a),this.width=this._getTextWidth(a,c),this.height=this._getTextHeight(a,c),this.clipTo&&b.util.clipContext(this,a),this._renderTextBackground(a,c),this._translateForTextAlign(a),this._renderText(a,c),"left"!==this.textAlign&&"justify"!==this.textAlign&&a.restore(),this._renderTextDecoration(a,c),this.clipTo&&a.restore(),this._setBoundaries(a,c),this._totalLineHeight=0},_renderText:function(a,b){a.save(),this._setShadow(a),this._renderTextFill(a,b),this._renderTextStroke(a,b),this._removeShadow(a),a.restore()},_translateForTextAlign:function(a){"left"!==this.textAlign&&"justify"!==this.textAlign&&(a.save(),a.translate("center"===this.textAlign?this.width/2:this.width,0))},_setBoundaries:function(a,b){this._boundaries=[];for(var c=0,d=b.length;d>c;c++){var e=this._getLineWidth(a,b[c]),f=this._getLineLeftOffset(e);this._boundaries.push({height:this.fontSize*this.lineHeight,width:e,left:f})}},_setTextStyles:function(a){this._setFillStyles(a),this._setStrokeStyles(a),a.textBaseline="alphabetic",this.skipTextAlign||(a.textAlign=this.textAlign),a.font=this._getFontDeclaration()},_getTextHeight:function(a,b){return this.fontSize*b.length*this.lineHeight},_getTextWidth:function(a,b){for(var c=a.measureText(b[0]||"|").width,d=1,e=b.length;e>d;d++){var f=a.measureText(b[d]).width;f>c&&(c=f)}return c},_renderChars:function(a,b,c,d,e){b[a](c,d,e)},_renderTextLine:function(a,b,c,d,e,f){if(e-=this.fontSize/4,"justify"!==this.textAlign)return void this._renderChars(a,b,c,d,e,f);var g=b.measureText(c).width,h=this.width;if(h>g)for(var i=c.split(/\s+/),j=b.measureText(c.replace(/\s+/g,"")).width,k=h-j,l=i.length-1,m=k/l,n=0,o=0,p=i.length;p>o;o++)this._renderChars(a,b,i[o],d+n,e,f),n+=b.measureText(i[o]).width+m;else this._renderChars(a,b,c,d,e,f)},_getLeftOffset:function(){return b.isLikelyNode?0:-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(a,b){if(this.fill||this._skipFillStrokeCheck){this._boundaries=[];for(var c=0,d=0,e=b.length;e>d;d++){var f=this._getHeightOfLine(a,d,b);c+=f,this._renderTextLine("fillText",a,b[d],this._getLeftOffset(),this._getTopOffset()+c,d)}}},_renderTextStroke:function(a,b){if(this.stroke||this._skipFillStrokeCheck){var c=0;a.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),f&&a.setLineDash(this.strokeDashArray)),a.beginPath();for(var d=0,e=b.length;e>d;d++){var g=this._getHeightOfLine(a,d,b);c+=g,this._renderTextLine("strokeText",a,b[d],this._getLeftOffset(),this._getTopOffset()+c,d)}a.closePath(),a.restore()}},_getHeightOfLine:function(){return this.fontSize*this.lineHeight},_renderTextBackground:function(a,b){this._renderTextBoxBackground(a),this._renderTextLinesBackground(a,b)},_renderTextBoxBackground:function(a){this.backgroundColor&&(a.save(),a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),a.restore())},_renderTextLinesBackground:function(a,b){if(this.textBackgroundColor){a.save(),a.fillStyle=this.textBackgroundColor;for(var c=0,d=b.length;d>c;c++)if(""!==b[c]){var e=this._getLineWidth(a,b[c]),f=this._getLineLeftOffset(e);a.fillRect(this._getLeftOffset()+f,this._getTopOffset()+c*this.fontSize*this.lineHeight,e,this.fontSize*this.lineHeight)}a.restore()}},_getLineLeftOffset:function(a){return"center"===this.textAlign?(this.width-a)/2:"right"===this.textAlign?this.width-a:0},_getLineWidth:function(a,b){return"justify"===this.textAlign?this.width:a.measureText(b).width},_renderTextDecoration:function(a,b){function c(c){for(var f=0,g=b.length;g>f;f++){var h=e._getLineWidth(a,b[f]),i=e._getLineLeftOffset(h);a.fillRect(e._getLeftOffset()+i,~~(c+f*e._getHeightOfLine(a,f,b)-d),h,1)}}if(this.textDecoration){var d=this._getTextHeight(a,b)/2,e=this;this.textDecoration.indexOf("underline")>-1&&c(this.fontSize*this.lineHeight),this.textDecoration.indexOf("line-through")>-1&&c(this.fontSize*this.lineHeight-this.fontSize/2),this.textDecoration.indexOf("overline")>-1&&c(this.fontSize*this.lineHeight-this.fontSize)}},_getFontDeclaration:function(){return[b.isLikelyNode?this.fontWeight:this.fontStyle,b.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",b.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(a,b){if(this.visible){a.save();var c=this.transformMatrix;!c||this.group&&"path-group"!==this.group.type||a.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._render(a),!b&&this.active&&(this.drawBorders(a),this.drawControls(a)),a.restore()}},toObject:function(a){var b=c(this.callSuper("toObject",a),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,path:this.path,textBackgroundColor:this.textBackgroundColor,useNative:this.useNative});return this.includeDefaultValues||this._removeDefaultValues(b),b},toSVG:function(a){var b=[],c=this.text.split(this._reNewline),d=this._getSVGLeftTopOffsets(c),e=this._getSVGTextAndBg(d.lineTop,d.textLeft,c),f=this._getSVGShadows(d.lineTop,c);return d.textTop+=this._fontAscent?this._fontAscent/5*this.lineHeight:0,this._wrapSVGTextAndBg(b,e,f,d),a?a(b.join("")):b.join("")},_getSVGLeftTopOffsets:function(a){var b=this.useNative?this.fontSize*this.lineHeight:-this._fontAscent-this._fontAscent/5*this.lineHeight,c=-(this.width/2),d=this.useNative?this.fontSize-1:this.height/2-a.length*this.fontSize-this._totalLineHeight;return{textLeft:c,textTop:d,lineTop:b}},_wrapSVGTextAndBg:function(a,b,c,d){a.push('<g transform="',this.getSvgTransform(),'">',b.textBgRects.join(""),"<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" ','transform="translate(',e(d.textLeft,2)," ",e(d.textTop,2),')">',c.join(""),b.textSpans.join(""),"</text>","</g>")},_getSVGShadows:function(a,c){var d,f,g=[],h=1;if(!this.shadow||!this._boundaries)return g;for(d=0,f=c.length;f>d;d++)if(""!==c[d]){var i=this._boundaries&&this._boundaries[d]?this._boundaries[d].left:0;g.push('<tspan x="',e(i+h+this.shadow.offsetX,2),0===d||this.useNative?'" y':'" dy','="',e(this.useNative?a*d-this.height/2+this.shadow.offsetY:a+(0===d?this.shadow.offsetY:0),2),'" ',this._getFillAttributes(this.shadow.color),">",b.util.string.escapeXml(c[d]),"</tspan>"),h=1}else h++;return g},_getSVGTextAndBg:function(a,b,c){var d=[],e=[],f=1;this._setSVGBg(e);for(var g=0,h=c.length;h>g;g++)""!==c[g]?(this._setSVGTextLineText(c[g],g,d,a,f,e),f=1):f++,this.textBackgroundColor&&this._boundaries&&this._setSVGTextLineBg(e,g,b,a);return{textSpans:d,textBgRects:e}},_setSVGTextLineText:function(a,c,d,f,g){var h=this._boundaries&&this._boundaries[c]?e(this._boundaries[c].left,2):0;d.push('<tspan x="',h,'" ',0===c||this.useNative?"y":"dy",'="',e(this.useNative?f*c-this.height/2:f*g,2),'" ',this._getFillAttributes(this.fill),">",b.util.string.escapeXml(a),"</tspan>")},_setSVGTextLineBg:function(a,b,c,d){a.push("<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',e(c+this._boundaries[b].left,2),'" y="',e(d*b-this.height/2,2),'" width="',e(this._boundaries[b].width,2),'" height="',e(this._boundaries[b].height,2),'"></rect>')},_setSVGBg:function(a){this.backgroundColor&&this._boundaries&&a.push("<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,2),'" y="',e(-this.height/2,2),'" width="',e(this.width,2),'" height="',e(this.height,2),'"></rect>')},_getFillAttributes:function(a){var c=a&&"string"==typeof a?new b.Color(a):"";return c&&c.getSource()&&1!==c.getAlpha()?'opacity="'+c.getAlpha()+'" fill="'+c.setAlpha(1).toRgb()+'"':'fill="'+a+'"'},_set:function(a,b){"fontFamily"===a&&this.path&&(this.path=this.path.replace(/(.*?)([^\/]*)(\.font\.js)/,"$1"+b+"$3")),this.callSuper("_set",a,b),a in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),b.Text.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),b.Text.DEFAULT_SVG_FONT_SIZE=16,b.Text.fromElement=function(a,c){if(!a)return null;var d=b.parseAttributes(a,b.Text.ATTRIBUTE_NAMES);c=b.util.object.extend(c?b.util.object.clone(c):{},d),"dx"in d&&(c.left+=d.dx),"dy"in d&&(c.top+=d.dy),"fontSize"in c||(c.fontSize=b.Text.DEFAULT_SVG_FONT_SIZE),c.originX||(c.originX="center");var e=new b.Text(a.textContent,c);return e.set({left:e.getLeft()+e.getWidth()/2,top:e.getTop()-e.getHeight()/2}),e},b.Text.fromObject=function(a){return new b.Text(a.text,d(a))},b.util.createAccessors(b.Text)}("undefined"!=typeof exports?exports:this),function(){var a=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,styles:null,caching:!0,_skipFillStrokeCheck:!0,_reSpace:/\s|\n/,_fontSizeFraction:4,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,_charWidthsCache:{},initialize:function(a,b){this.styles=b?b.styles||{}:{},this.callSuper("initialize",a,b),this.initBehavior(),fabric.IText.instances.push(this),this.__lineWidths={},this.__lineHeights={},this.__lineOffsets={}},isEmptyStyles:function(){if(!this.styles)return!0;var a=this.styles;for(var b in a)for(var c in a[b])for(var d in a[b][c])return!1;return!0},setSelectionStart:function(a){this.selectionStart!==a&&this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionStart=a,this.hiddenTextarea&&(this.hiddenTextarea.selectionStart=a)},setSelectionEnd:function(a){this.selectionEnd!==a&&this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionEnd=a,this.hiddenTextarea&&(this.hiddenTextarea.selectionEnd=a)},getSelectionStyles:function(a,b){if(2===arguments.length){for(var c=[],d=a;b>d;d++)c.push(this.getSelectionStyles(d));return c}var e=this.get2DCursorLocation(a);return this.styles[e.lineIndex]?this.styles[e.lineIndex][e.charIndex]||{}:{}},setSelectionStyles:function(a){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,a);else for(var b=this.selectionStart;b<this.selectionEnd;b++)this._extendStyles(b,a);return this},_extendStyles:function(a,b){var c=this.get2DCursorLocation(a);this.styles[c.lineIndex]||(this.styles[c.lineIndex]={}),this.styles[c.lineIndex][c.charIndex]||(this.styles[c.lineIndex][c.charIndex]={}),fabric.util.object.extend(this.styles[c.lineIndex][c.charIndex],b)},_render:function(a){this.callSuper("_render",a),this.ctx=a,this.isEditing&&this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(this.active){var a,b=this.text.split("");this.selectionStart===this.selectionEnd?(a=this._getCursorBoundaries(b,"cursor"),this.renderCursor(a)):(a=this._getCursorBoundaries(b,"selection"),this.renderSelection(b,a))}},get2DCursorLocation:function(a){"undefined"==typeof a&&(a=this.selectionStart);var b=this.text.slice(0,a),c=b.split(this._reNewline);return{lineIndex:c.length-1,charIndex:c[c.length-1].length}},getCurrentCharStyle:function(a,b){var c=this.styles[a]&&this.styles[a][0===b?0:b-1];return{fontSize:c&&c.fontSize||this.fontSize,fill:c&&c.fill||this.fill,textBackgroundColor:c&&c.textBackgroundColor||this.textBackgroundColor,textDecoration:c&&c.textDecoration||this.textDecoration,fontFamily:c&&c.fontFamily||this.fontFamily,stroke:c&&c.stroke||this.stroke,strokeWidth:c&&c.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(a,b){return this.styles[a]&&this.styles[a][0===b?0:b-1]&&this.styles[a][0===b?0:b-1].fontSize||this.fontSize},getCurrentCharColor:function(a,b){return this.styles[a]&&this.styles[a][0===b?0:b-1]&&this.styles[a][0===b?0:b-1].fill||this.cursorColor},_getCursorBoundaries:function(a,b){var c=this.get2DCursorLocation(),d=this.text.split(this._reNewline),e=Math.round(this._getLeftOffset()),f=-this.height/2,g=this._getCursorBoundariesOffsets(a,b,c,d);return{left:e,top:f,leftOffset:g.left+g.lineLeft,topOffset:g.top}},_getCursorBoundariesOffsets:function(a,b,c,d){for(var e=0,f=0,g=0,h=0,i="cursor"===b?this._getHeightOfLine(this.ctx,0)-this.getCurrentCharFontSize(c.lineIndex,c.charIndex):0,j=0;j<this.selectionStart;j++){if("\n"===a[j]){h=0;var k=f+("cursor"===b?1:0);i+=this._getCachedLineHeight(k),f++,g=0}else h+=this._getWidthOfChar(this.ctx,a[j],f,g),g++;e=this._getCachedLineOffset(f,d)}return this._clearCache(),{top:i,left:h,lineLeft:e}},_clearCache:function(){this.__lineWidths={},this.__lineHeights={},this.__lineOffsets={}},_getCachedLineHeight:function(a){return this.__lineHeights[a]||(this.__lineHeights[a]=this._getHeightOfLine(this.ctx,a))},_getCachedLineWidth:function(a,b){return this.__lineWidths[a]||(this.__lineWidths[a]=this._getWidthOfLine(this.ctx,a,b))},_getCachedLineOffset:function(a,b){var c=this._getCachedLineWidth(a,b);return this.__lineOffsets[a]||(this.__lineOffsets[a]=this._getLineLeftOffset(c))},renderCursor:function(a){var b=this.ctx;b.save();var c=this.get2DCursorLocation(),d=c.lineIndex,e=c.charIndex,f=this.getCurrentCharFontSize(d,e),g=0===d&&0===e?this._getCachedLineOffset(d,this.text.split(this._reNewline)):a.leftOffset;b.fillStyle=this.getCurrentCharColor(d,e),b.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,b.fillRect(a.left+g,a.top+a.topOffset,this.cursorWidth/this.scaleX,f),b.restore()},renderSelection:function(a,b){var c=this.ctx;c.save(),c.fillStyle=this.selectionColor;for(var d=this.get2DCursorLocation(this.selectionStart),e=this.get2DCursorLocation(this.selectionEnd),f=d.lineIndex,g=e.lineIndex,h=this.text.split(this._reNewline),i=f;g>=i;i++){var j=this._getCachedLineOffset(i,h)||0,k=this._getCachedLineHeight(i),l=0;if(i===f)for(var m=0,n=h[i].length;n>m;m++)m>=d.charIndex&&(i!==g||m<e.charIndex)&&(l+=this._getWidthOfChar(c,h[i][m],i,m)),m<d.charIndex&&(j+=this._getWidthOfChar(c,h[i][m],i,m));else if(i>f&&g>i)l+=this._getCachedLineWidth(i,h)||5;else if(i===g)for(var o=0,p=e.charIndex;p>o;o++)l+=this._getWidthOfChar(c,h[i][o],i,o);c.fillRect(b.left+j,b.top+b.topOffset,l,k),b.topOffset+=k}c.restore()},_renderChars:function(a,b,c,d,e,f){if(this.isEmptyStyles())return this._renderCharsFast(a,b,c,d,e);this.skipTextAlign=!0,d-="center"===this.textAlign?this.width/2:"right"===this.textAlign?this.width:0;var g,h=this.text.split(this._reNewline),i=this._getWidthOfLine(b,f,h),j=this._getHeightOfLine(b,f,h),k=this._getLineLeftOffset(i),l=c.split(""),m="";d+=k||0,b.save();for(var n=0,o=l.length;o>=n;n++){g=g||this.getCurrentCharStyle(f,n);var p=this.getCurrentCharStyle(f,n+1);(this._hasStyleChanged(g,p)||n===o)&&(this._renderChar(a,b,f,n-1,m,d,e,j),m="",g=p),m+=l[n]}b.restore()},_renderCharsFast:function(a,b,c,d,e){this.skipTextAlign=!1,"fillText"===a&&this.fill&&this.callSuper("_renderChars",a,b,c,d,e),"strokeText"===a&&this.stroke&&this.callSuper("_renderChars",a,b,c,d,e)},_renderChar:function(a,b,c,d,e,f,g,h){var i,j,k;if(this.styles&&this.styles[c]&&(i=this.styles[c][d])){var l=i.stroke||this.stroke,m=i.fill||this.fill;b.save(),j=this._applyCharStylesGetWidth(b,e,c,d,i),k=this._getHeightOfChar(b,e,c,d),m&&b.fillText(e,f,g),l&&b.strokeText(e,f,g),this._renderCharDecoration(b,i,f,g,j,h,k),b.restore(),b.translate(j,0)}else"strokeText"===a&&this.stroke&&b[a](e,f,g),"fillText"===a&&this.fill&&b[a](e,f,g),j=this._applyCharStylesGetWidth(b,e,c,d),this._renderCharDecoration(b,null,f,g,j,h),b.translate(b.measureText(e).width,0)},_hasStyleChanged:function(a,b){return a.fill!==b.fill||a.fontSize!==b.fontSize||a.textBackgroundColor!==b.textBackgroundColor||a.textDecoration!==b.textDecoration||a.fontFamily!==b.fontFamily||a.stroke!==b.stroke||a.strokeWidth!==b.strokeWidth},_renderCharDecoration:function(a,b,c,d,e,f,g){var h=b?b.textDecoration||this.textDecoration:this.textDecoration,i=(b?b.fontSize:null)||this.fontSize;h&&(h.indexOf("underline")>-1&&this._renderCharDecorationAtOffset(a,c,d+this.fontSize/this._fontSizeFraction,e,0,this.fontSize/20),h.indexOf("line-through")>-1&&this._renderCharDecorationAtOffset(a,c,d+this.fontSize/this._fontSizeFraction,e,g/2,i/20),h.indexOf("overline")>-1&&this._renderCharDecorationAtOffset(a,c,d,e,f-this.fontSize/this._fontSizeFraction,this.fontSize/20))},_renderCharDecorationAtOffset:function(a,b,c,d,e,f){a.fillRect(b,c-e,d,f)},_renderTextLine:function(a,b,c,d,e,f){e+=this.fontSize/4,this.callSuper("_renderTextLine",a,b,c,d,e,f)},_renderTextDecoration:function(a,b){return this.isEmptyStyles()?this.callSuper("_renderTextDecoration",a,b):void 0},_renderTextLinesBackground:function(a,b){if(this.textBackgroundColor||this.styles){a.save(),this.textBackgroundColor&&(a.fillStyle=this.textBackgroundColor);for(var c=0,d=this.fontSize/this._fontSizeFraction,e=0,f=b.length;f>e;e++){var g=this._getHeightOfLine(a,e,b);if(""!==b[e]){var h=this._getWidthOfLine(a,e,b),i=this._getLineLeftOffset(h);if(this.textBackgroundColor&&(a.fillStyle=this.textBackgroundColor,a.fillRect(this._getLeftOffset()+i,this._getTopOffset()+c+d,h,g)),this.styles[e])for(var j=0,k=b[e].length;k>j;j++)if(this.styles[e]&&this.styles[e][j]&&this.styles[e][j].textBackgroundColor){var l=b[e][j];a.fillStyle=this.styles[e][j].textBackgroundColor,a.fillRect(this._getLeftOffset()+i+this._getWidthOfCharsAt(a,e,j,b),this._getTopOffset()+c+d,this._getWidthOfChar(a,l,e,j,b)+1,g)}c+=g}else c+=g}a.restore()}},_getCacheProp:function(a,b){return a+b.fontFamily+b.fontSize+b.fontWeight+b.fontStyle+b.shadow},_applyCharStylesGetWidth:function(b,c,d,e,f){var g=f||this.styles[d]&&this.styles[d][e];g=g?a(g):{},this._applyFontStyles(g);var h=this._getCacheProp(c,g);if(this.isEmptyStyles()&&this._charWidthsCache[h]&&this.caching)return this._charWidthsCache[h];"string"==typeof g.shadow&&(g.shadow=new fabric.Shadow(g.shadow));var i=g.fill||this.fill;return b.fillStyle=i.toLive?i.toLive(b):i,g.stroke&&(b.strokeStyle=g.stroke&&g.stroke.toLive?g.stroke.toLive(b):g.stroke),b.lineWidth=g.strokeWidth||this.strokeWidth,b.font=this._getFontDeclaration.call(g),this._setShadow.call(g,b),this.caching?(this._charWidthsCache[h]||(this._charWidthsCache[h]=b.measureText(c).width),this._charWidthsCache[h]):b.measureText(c).width},_applyFontStyles:function(a){a.fontFamily||(a.fontFamily=this.fontFamily),a.fontSize||(a.fontSize=this.fontSize),a.fontWeight||(a.fontWeight=this.fontWeight),a.fontStyle||(a.fontStyle=this.fontStyle)},_getStyleDeclaration:function(b,c){return this.styles[b]&&this.styles[b][c]?a(this.styles[b][c]):{}},_getWidthOfChar:function(a,b,c,d){var e=this._getStyleDeclaration(c,d);this._applyFontStyles(e);var f=this._getCacheProp(b,e);if(this._charWidthsCache[f]&&this.caching)return this._charWidthsCache[f];if(a){a.save();var g=this._applyCharStylesGetWidth(a,b,c,d);return a.restore(),g}},_getHeightOfChar:function(a,b,c,d){return this.styles[c]&&this.styles[c][d]?this.styles[c][d].fontSize||this.fontSize:this.fontSize},_getWidthOfCharAt:function(a,b,c,d){d=d||this.text.split(this._reNewline);var e=d[b].split("")[c];return this._getWidthOfChar(a,e,b,c)},_getHeightOfCharAt:function(a,b,c,d){d=d||this.text.split(this._reNewline);var e=d[b].split("")[c];return this._getHeightOfChar(a,e,b,c)},_getWidthOfCharsAt:function(a,b,c,d){for(var e=0,f=0;c>f;f++)e+=this._getWidthOfCharAt(a,b,f,d);return e},_getWidthOfLine:function(a,b,c){return this._getWidthOfCharsAt(a,b,c[b].length,c)},_getTextWidth:function(a,b){if(this.isEmptyStyles())return this.callSuper("_getTextWidth",a,b);for(var c=this._getWidthOfLine(a,0,b),d=1,e=b.length;e>d;d++){var f=this._getWidthOfLine(a,d,b);f>c&&(c=f)}return c},_getHeightOfLine:function(a,b,c){c=c||this.text.split(this._reNewline);for(var d=this._getHeightOfChar(a,c[b][0],b,0),e=c[b],f=e.split(""),g=1,h=f.length;h>g;g++){var i=this._getHeightOfChar(a,f[g],b,g);i>d&&(d=i)}return d*this.lineHeight},_getTextHeight:function(a,b){for(var c=0,d=0,e=b.length;e>d;d++)c+=this._getHeightOfLine(a,d,b);return c},_getTopOffset:function(){var a=fabric.Text.prototype._getTopOffset.call(this);return a-this.fontSize/this._fontSizeFraction},_renderTextBoxBackground:function(a){this.backgroundColor&&(a.save(),a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset()+this.fontSize/this._fontSizeFraction,this.width,this.height),a.restore())},toObject:function(b){return fabric.util.object.extend(this.callSuper("toObject",b),{styles:a(this.styles)})}}),fabric.IText.fromObject=function(b){return new fabric.IText(b.text,a(b))},fabric.IText.instances=[]}(),function(){var a=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initCursorSelectionHandlers(),this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var a=this;setTimeout(function(){a.selected=!0},100),this.canvas&&!this.canvas._hasITextHandlers&&(this._initCanvasHandlers(),this.canvas._hasITextHandlers=!0)})},_initCanvasHandlers:function(){this.canvas.on("selection:cleared",function(){fabric.IText.prototype.exitEditingOnOthers.call()}),this.canvas.on("mouse:up",function(){fabric.IText.instances.forEach(function(a){a.__isMousedown=!1})}),this.canvas.on("object:selected",function(a){fabric.IText.prototype.exitEditingOnOthers.call(a.target)})},_tick:function(){var a=this;this._abortCursorAnimation||this.animate("_currentCursorOpacity",1,{duration:this.cursorDuration,onComplete:function(){a._onTickComplete()},onChange:function(){a.canvas&&a.canvas.renderAll()},abort:function(){return a._abortCursorAnimation}})},_onTickComplete:function(){if(!this._abortCursorAnimation){var a=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){a.animate("_currentCursorOpacity",0,{duration:this.cursorDuration/2,onComplete:function(){a._tick()},onChange:function(){a.canvas&&a.canvas.renderAll()},abort:function(){return a._abortCursorAnimation}})},100)}},initDelayedCursor:function(a){var b=this,c=a?0:this.cursorDelay;a&&(this._abortCursorAnimation=!0,clearTimeout(this._cursorTimeout1),this._currentCursorOpacity=1,this.canvas&&this.canvas.renderAll()),this._cursorTimeout2&&clearTimeout(this._cursorTimeout2),this._cursorTimeout2=setTimeout(function(){b._abortCursorAnimation=!1,b._tick()},c)},abortCursorAnimation:function(){this._abortCursorAnimation=!0,clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,this.canvas&&this.canvas.renderAll();
var a=this;setTimeout(function(){a._abortCursorAnimation=!1},10)},selectAll:function(){this.selectionStart=0,this.selectionEnd=this.text.length,this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(a){var b=0,c=a-1;if(this._reSpace.test(this.text.charAt(c)))for(;this._reSpace.test(this.text.charAt(c));)b++,c--;for(;/\S/.test(this.text.charAt(c))&&c>-1;)b++,c--;return a-b},findWordBoundaryRight:function(a){var b=0,c=a;if(this._reSpace.test(this.text.charAt(c)))for(;this._reSpace.test(this.text.charAt(c));)b++,c++;for(;/\S/.test(this.text.charAt(c))&&c<this.text.length;)b++,c++;return a+b},findLineBoundaryLeft:function(a){for(var b=0,c=a-1;!/\n/.test(this.text.charAt(c))&&c>-1;)b++,c--;return a-b},findLineBoundaryRight:function(a){for(var b=0,c=a;!/\n/.test(this.text.charAt(c))&&c<this.text.length;)b++,c++;return a+b},getNumNewLinesInSelectedText:function(){for(var a=this.getSelectedText(),b=0,c=0,d=a.split(""),e=d.length;e>c;c++)"\n"===d[c]&&b++;return b},searchWordBoundary:function(a,b){for(var c=this._reSpace.test(this.text.charAt(a))?a-1:a,d=this.text.charAt(c),e=/[ \n\.,;!\?\-]/;!e.test(d)&&c>0&&c<this.text.length;)c+=b,d=this.text.charAt(c);return e.test(d)&&"\n"!==d&&(c+=1===b?0:1),c},selectWord:function(a){var b=this.searchWordBoundary(a,-1),c=this.searchWordBoundary(a,1);this.setSelectionStart(b),this.setSelectionEnd(c),this.initDelayedCursor(!0)},selectLine:function(a){var b=this.findLineBoundaryLeft(a),c=this.findLineBoundaryRight(a);this.setSelectionStart(b),this.setSelectionEnd(c),this.initDelayedCursor(!0)},enterEditing:function(){return!this.isEditing&&this.editable?(this.exitEditingOnOthers(),this.isEditing=!0,this.initHiddenTextarea(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._tick(),this.canvas&&this.canvas.renderAll(),this.fire("editing:entered"),this.canvas&&this.canvas.fire("text:editing:entered",{target:this}),this):void 0},exitEditingOnOthers:function(){fabric.IText.instances.forEach(function(a){a.selected=!1,a.isEditing&&a.exitEditing()},this)},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){this.hiddenTextarea&&(this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart)},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this.fire("editing:exited"),this.canvas&&this.canvas.fire("text:editing:exited",{target:this}),this},_removeExtraneousStyles:function(){var a=this.text.split(this._reNewline);for(var b in this.styles)a[b]||delete this.styles[b]},_removeCharsFromTo:function(a,b){for(var c=b;c!==a;){var d=this.get2DCursorLocation(c).charIndex;c--;var e=this.get2DCursorLocation(c).charIndex,f=e>d;f?this.removeStyleObject(f,c+1):this.removeStyleObject(0===this.get2DCursorLocation(c).charIndex,c)}this.text=this.text.slice(0,a)+this.text.slice(b)},insertChars:function(a){var b="\n"===this.text.slice(this.selectionStart,this.selectionStart+1);this.text=this.text.slice(0,this.selectionStart)+a+this.text.slice(this.selectionEnd),this.selectionStart===this.selectionEnd&&this.insertStyleObjects(a,b,this.copiedStyles),this.selectionStart+=a.length,this.selectionEnd=this.selectionStart,this.canvas&&this.canvas.renderAll().renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},insertNewlineStyleObject:function(b,c,d){this.shiftLineStyles(b,1),this.styles[b+1]||(this.styles[b+1]={});var e=this.styles[b][c-1],f={};if(d)f[0]=a(e),this.styles[b+1]=f;else{for(var g in this.styles[b])parseInt(g,10)>=c&&(f[parseInt(g,10)-c]=this.styles[b][g],delete this.styles[b][g]);this.styles[b+1]=f}},insertCharStyleObject:function(b,c,d){var e=this.styles[b],f=a(e);0!==c||d||(c=1);for(var g in f){var h=parseInt(g,10);h>=c&&(e[h+1]=f[h])}this.styles[b][c]=d||a(e[c-1])},insertStyleObjects:function(a,b,c){if(!this.isEmptyStyles()){var d=this.get2DCursorLocation(),e=d.lineIndex,f=d.charIndex;this.styles[e]||(this.styles[e]={}),"\n"===a?this.insertNewlineStyleObject(e,f,b):c?this._insertStyles(c):this.insertCharStyleObject(e,f)}},_insertStyles:function(a){for(var b=0,c=a.length;c>b;b++){var d=this.get2DCursorLocation(this.selectionStart+b),e=d.lineIndex,f=d.charIndex;this.insertCharStyleObject(e,f,a[b])}},shiftLineStyles:function(b,c){var d=a(this.styles);for(var e in this.styles){var f=parseInt(e,10);f>b&&(this.styles[f+c]=d[f])}},removeStyleObject:function(b,c){var d=this.get2DCursorLocation(c),e=d.lineIndex,f=d.charIndex;if(b){var g=this.text.split(this._reNewline),h=g[e-1],i=h?h.length:0;this.styles[e-1]||(this.styles[e-1]={});for(f in this.styles[e])this.styles[e-1][parseInt(f,10)+i]=this.styles[e][f];this.shiftLineStyles(e,-1)}else{var j=this.styles[e];if(j){var k=this.selectionStart===this.selectionEnd?-1:0;delete j[f+k]}var l=a(j);for(var m in l){var n=parseInt(m,10);n>=f&&0!==n&&(j[n-1]=l[n],delete j[n])}}},insertNewline:function(){this.insertChars("\n")}})}(),fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(a){this.__newClickTime=+new Date;var b=this.canvas.getPointer(a.e);this.isTripleClick(b)?(this.fire("tripleclick",a),this._stopEvent(a.e)):this.isDoubleClick(b)&&(this.fire("dblclick",a),this._stopEvent(a.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=b,this.__lastIsEditing=this.isEditing},isDoubleClick:function(a){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===a.x&&this.__lastPointer.y===a.y&&this.__lastIsEditing},isTripleClick:function(a){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===a.x&&this.__lastPointer.y===a.y},_stopEvent:function(a){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler(),this.initMousedownHandler(),this.initMousemoveHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("dblclick",function(a){this.selectWord(this.getSelectionStartFromPointer(a.e))}),this.on("tripleclick",function(a){this.selectLine(this.getSelectionStartFromPointer(a.e))})},initMousedownHandler:function(){this.on("mousedown",function(a){var b=this.canvas.getPointer(a.e);this.__mousedownX=b.x,this.__mousedownY=b.y,this.__isMousedown=!0,this.hiddenTextarea&&this.canvas&&this.canvas.wrapperEl.appendChild(this.hiddenTextarea),this.selected&&this.setCursorByClick(a.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.initDelayedCursor(!0))})},initMousemoveHandler:function(){this.on("mousemove",function(a){if(this.__isMousedown&&this.isEditing){var b=this.getSelectionStartFromPointer(a.e);b>=this.__selectionStartOnMouseDown?(this.setSelectionStart(this.__selectionStartOnMouseDown),this.setSelectionEnd(b)):(this.setSelectionStart(b),this.setSelectionEnd(this.__selectionStartOnMouseDown))}})},_isObjectMoved:function(a){var b=this.canvas.getPointer(a);return this.__mousedownX!==b.x||this.__mousedownY!==b.y},initMouseupHandler:function(){this.on("mouseup",function(a){this.__isMousedown=!1,this._isObjectMoved(a.e)||(this.selected&&(this.enterEditing(),this.initDelayedCursor(!0)),this.selected=!0)})},setCursorByClick:function(a){var b=this.getSelectionStartFromPointer(a);a.shiftKey?b<this.selectionStart?(this.setSelectionEnd(this.selectionStart),this.setSelectionStart(b)):this.setSelectionEnd(b):(this.setSelectionStart(b),this.setSelectionEnd(b))},_getLocalRotatedPointer:function(a){var b=this.canvas.getPointer(a),c=new fabric.Point(b.x,b.y),d=new fabric.Point(this.left,this.top),e=fabric.util.rotatePoint(c,d,fabric.util.degreesToRadians(-this.angle));return this.getLocalPointer(a,e)},getSelectionStartFromPointer:function(a){for(var b,c=this._getLocalRotatedPointer(a),d=this.text.split(this._reNewline),e=0,f=0,g=0,h=0,i=0,j=d.length;j>i;i++){g+=this._getHeightOfLine(this.ctx,i)*this.scaleY;var k=this._getWidthOfLine(this.ctx,i,d),l=this._getLineLeftOffset(k);f=l*this.scaleX,this.flipX&&(d[i]=d[i].split("").reverse().join(""));for(var m=0,n=d[i].length;n>m;m++){var o=d[i][m];if(e=f,f+=this._getWidthOfChar(this.ctx,o,i,this.flipX?n-m:m)*this.scaleX,!(g<=c.y||f<=c.x))return this._getNewSelectionStartFromOffset(c,e,f,h+i,n);h++}if(c.y<g)return this._getNewSelectionStartFromOffset(c,e,f,h+i,n,m)}return"undefined"==typeof b?this.text.length:void 0},_getNewSelectionStartFromOffset:function(a,b,c,d,e,f){var g=a.x-b,h=c-a.x,i=h>g?0:1,j=d+i;return this.flipX&&(j=e-j),j>this.text.length&&(j=this.text.length),f===e&&j--,j}}),fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.style.cssText="position: absolute; top: 0; left: -9999px",fabric.document.body.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keypress",this.onKeyPress.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",13:"insertNewline",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMap:{65:"selectAll",67:"copy",86:"paste",88:"cut"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(a){if(this.isEditing){if(a.keyCode in this._keysMap)this[this._keysMap[a.keyCode]](a);else{if(!(a.keyCode in this._ctrlKeysMap&&(a.ctrlKey||a.metaKey)))return;this[this._ctrlKeysMap[a.keyCode]](a)}a.preventDefault(),a.stopPropagation(),this.canvas&&this.canvas.renderAll()}},forwardDelete:function(a){this.selectionStart===this.selectionEnd&&this.moveCursorRight(a),this.removeChars(a)},copy:function(){var a=this.getSelectedText();this.copiedText=a,this.copiedStyles=this.getSelectionStyles(this.selectionStart,this.selectionEnd)},paste:function(){this.copiedText&&this.insertChars(this.copiedText)},cut:function(a){this.copy(),this.removeChars(a)},onKeyPress:function(a){!this.isEditing||a.metaKey||a.ctrlKey||8===a.keyCode||13===a.keyCode||(this.insertChars(String.fromCharCode(a.which)),a.preventDefault(),a.stopPropagation())},getDownCursorOffset:function(a,b){var c,d,e=b?this.selectionEnd:this.selectionStart,f=this.text.split(this._reNewline),g=this.text.slice(0,e),h=this.text.slice(e),i=g.slice(g.lastIndexOf("\n")+1),j=h.match(/(.*)\n?/)[1],k=(h.match(/.*\n(.*)\n?/)||{})[1]||"",l=this.get2DCursorLocation(e);if(l.lineIndex===f.length-1||a.metaKey)return this.text.length-e;var m=this._getWidthOfLine(this.ctx,l.lineIndex,f);d=this._getLineLeftOffset(m);for(var n=d,o=l.lineIndex,p=0,q=i.length;q>p;p++)c=i[p],n+=this._getWidthOfChar(this.ctx,c,o,p);var r=this._getIndexOnNextLine(l,k,n,f);return j.length+1+r},_getIndexOnNextLine:function(a,b,c,d){for(var e,f=a.lineIndex+1,g=this._getWidthOfLine(this.ctx,f,d),h=this._getLineLeftOffset(g),i=h,j=0,k=0,l=b.length;l>k;k++){var m=b[k],n=this._getWidthOfChar(this.ctx,m,f,k);if(i+=n,i>c){e=!0;var o=i-n,p=i,q=Math.abs(o-c),r=Math.abs(p-c);j=q>r?k+1:k;break}}return e||(j=b.length),j},moveCursorDown:function(a){this.abortCursorAnimation(),this._currentCursorOpacity=1;var b=this.getDownCursorOffset(a,"right"===this._selectionDirection);a.shiftKey?this.moveCursorDownWithShift(b):this.moveCursorDownWithoutShift(b),this.initDelayedCursor()},moveCursorDownWithoutShift:function(a){this._selectionDirection="right",this.selectionStart+=a,this.selectionStart>this.text.length&&(this.selectionStart=this.text.length),this.selectionEnd=this.selectionStart},moveCursorDownWithShift:function(a){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?(this.selectionStart+=a,void(this._selectionDirection="left")):(this._selectionDirection="right",this.selectionEnd+=a,this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length),void 0)},getUpCursorOffset:function(a,b){var c=b?this.selectionEnd:this.selectionStart,d=this.get2DCursorLocation(c);if(0===d.lineIndex||a.metaKey)return c;for(var e,f=this.text.slice(0,c),g=f.slice(f.lastIndexOf("\n")+1),h=(f.match(/\n?(.*)\n.*$/)||{})[1]||"",i=this.text.split(this._reNewline),j=this._getWidthOfLine(this.ctx,d.lineIndex,i),k=this._getLineLeftOffset(j),l=k,m=d.lineIndex,n=0,o=g.length;o>n;n++)e=g[n],l+=this._getWidthOfChar(this.ctx,e,m,n);var p=this._getIndexOnPrevLine(d,h,l,i);return h.length-p+g.length},_getIndexOnPrevLine:function(a,b,c,d){for(var e,f=a.lineIndex-1,g=this._getWidthOfLine(this.ctx,f,d),h=this._getLineLeftOffset(g),i=h,j=0,k=0,l=b.length;l>k;k++){var m=b[k],n=this._getWidthOfChar(this.ctx,m,f,k);if(i+=n,i>c){e=!0;var o=i-n,p=i,q=Math.abs(o-c),r=Math.abs(p-c);j=q>r?k:k-1;break}}return e||(j=b.length-1),j},moveCursorUp:function(a){this.abortCursorAnimation(),this._currentCursorOpacity=1;var b=this.getUpCursorOffset(a,"right"===this._selectionDirection);a.shiftKey?this.moveCursorUpWithShift(b):this.moveCursorUpWithoutShift(b),this.initDelayedCursor()},moveCursorUpWithShift:function(a){if(this.selectionStart===this.selectionEnd)this.selectionStart-=a;else{if("right"===this._selectionDirection)return this.selectionEnd-=a,void(this._selectionDirection="right");this.selectionStart-=a}this.selectionStart<0&&(this.selectionStart=0),this._selectionDirection="left"},moveCursorUpWithoutShift:function(a){this.selectionStart===this.selectionEnd&&(this.selectionStart-=a),this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd=this.selectionStart,this._selectionDirection="left"},moveCursorLeft:function(a){(0!==this.selectionStart||0!==this.selectionEnd)&&(this.abortCursorAnimation(),this._currentCursorOpacity=1,a.shiftKey?this.moveCursorLeftWithShift(a):this.moveCursorLeftWithoutShift(a),this.initDelayedCursor())},_move:function(a,b,c){a.altKey?this[b]=this["findWordBoundary"+c](this[b]):a.metaKey?this[b]=this["findLineBoundary"+c](this[b]):this[b]+="Left"===c?-1:1},_moveLeft:function(a,b){this._move(a,b,"Left")},_moveRight:function(a,b){this._move(a,b,"Right")},moveCursorLeftWithoutShift:function(a){this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this._moveLeft(a,"selectionStart"),this.selectionEnd=this.selectionStart},moveCursorLeftWithShift:function(a){"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(a,"selectionEnd"):(this._selectionDirection="left",this._moveLeft(a,"selectionStart"),"\n"===this.text.charAt(this.selectionStart)&&this.selectionStart--,this.selectionStart<0&&(this.selectionStart=0))},moveCursorRight:function(a){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||(this.abortCursorAnimation(),this._currentCursorOpacity=1,a.shiftKey?this.moveCursorRightWithShift(a):this.moveCursorRightWithoutShift(a),this.initDelayedCursor())},moveCursorRightWithShift:function(a){"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(a,"selectionStart"):(this._selectionDirection="right",this._moveRight(a,"selectionEnd"),"\n"===this.text.charAt(this.selectionEnd-1)&&this.selectionEnd++,this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length))},moveCursorRightWithoutShift:function(a){this._selectionDirection="right",this.selectionStart===this.selectionEnd?(this._moveRight(a,"selectionStart"),this.selectionEnd=this.selectionStart):(this.selectionEnd+=this.getNumNewLinesInSelectedText(),this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length),this.selectionStart=this.selectionEnd)},removeChars:function(a){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(a):this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.selectionEnd=this.selectionStart,this._removeExtraneousStyles(),this.canvas&&this.canvas.renderAll().renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(a){if(0!==this.selectionStart)if(a.metaKey){var b=this.findLineBoundaryLeft(this.selectionStart);this._removeCharsFromTo(b,this.selectionStart),this.selectionStart=b}else if(a.altKey){var c=this.findWordBoundaryLeft(this.selectionStart);this._removeCharsFromTo(c,this.selectionStart),this.selectionStart=c}else{var d="\n"===this.text.slice(this.selectionStart-1,this.selectionStart);this.removeStyleObject(d),this.selectionStart--,this.text=this.text.slice(0,this.selectionStart)+this.text.slice(this.selectionStart+1)}}}),fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(a,b,c,d,e,f){this.styles[b]?this._setSVGTextLineChars(a,b,c,d,e,f):this.callSuper("_setSVGTextLineText",a,b,c,d,e)},_setSVGTextLineChars:function(a,b,c,d,e,f){for(var g=0===b||this.useNative?"y":"dy",h=a.split(""),i=0,j=this._getSVGLineLeftOffset(b),k=this._getSVGLineTopOffset(b),l=this._getHeightOfLine(this.ctx,b),m=0,n=h.length;n>m;m++){var o=this.styles[b][m]||{};c.push(this._createTextCharSpan(h[m],o,j,k,g,i));var p=this._getWidthOfChar(this.ctx,h[m],b,m);o.textBackgroundColor&&f.push(this._createTextCharBg(o,j,k,l,p,i)),i+=p}},_getSVGLineLeftOffset:function(a){return this._boundaries&&this._boundaries[a]?fabric.util.toFixed(this._boundaries[a].left,2):0},_getSVGLineTopOffset:function(a){for(var b=0,c=0;a>=c;c++)b+=this._getHeightOfLine(this.ctx,c);return b-this.height/2},_createTextCharBg:function(a,b,c,d,e,f){return['<rect fill="',a.textBackgroundColor,'" transform="translate(',-this.width/2," ",-this.height+d,")",'" x="',b+f,'" y="',c+d,'" width="',e,'" height="',d,'"></rect>'].join("")},_createTextCharSpan:function(a,b,c,d,e,f){var g=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text"},b));return['<tspan x="',c+f,'" ',e,'="',d,'" ',b.fontFamily?'font-family="'+b.fontFamily.replace(/"/g,"'")+'" ':"",b.fontSize?'font-size="'+b.fontSize+'" ':"",b.fontStyle?'font-style="'+b.fontStyle+'" ':"",b.fontWeight?'font-weight="'+b.fontWeight+'" ':"",b.textDecoration?'text-decoration="'+b.textDecoration+'" ':"",'style="',g,'">',fabric.util.string.escapeXml(a),"</tspan>"].join("")}}),function(){function request(a,b,c){var d=URL.parse(a);d.port||(d.port=0===d.protocol.indexOf("https:")?443:80);var e=443===d.port?HTTPS:HTTP,f=e.request({hostname:d.hostname,port:d.port,path:d.path,method:"GET"},function(a){var d="";b&&a.setEncoding(b),a.on("end",function(){c(d)}),a.on("data",function(b){200===a.statusCode&&(d+=b)})});f.on("error",function(a){fabric.log(a.errno===process.ECONNREFUSED?"ECONNREFUSED: connection refused to "+d.hostname+":"+d.port:a.message)}),f.end()}function requestFs(a,b){var c=require("fs");c.readFile(a,function(a,c){if(a)throw fabric.log(a),a;b(c)})}if("undefined"==typeof document||"undefined"==typeof window){var DOMParser=require("xmldom").DOMParser,URL=require("url"),HTTP=require("http"),HTTPS=require("https"),Canvas=require("canvas"),Image=require("canvas").Image;fabric.util.loadImage=function(a,b,c){function d(d){e.src=new Buffer(d,"binary"),e._src=a,b&&b.call(c,e)}var e=new Image;a&&(a instanceof Buffer||0===a.indexOf("data"))?(e.src=e._src=a,b&&b.call(c,e)):a&&0!==a.indexOf("http")?requestFs(a,d):a?request(a,"binary",d):b&&b.call(c,a)},fabric.loadSVGFromURL=function(a,b,c){a=a.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim(),0!==a.indexOf("http")?requestFs(a,function(a){fabric.loadSVGFromString(a.toString(),b,c)}):request(a,"",function(a){fabric.loadSVGFromString(a,b,c)})},fabric.loadSVGFromString=function(a,b,c){var d=(new DOMParser).parseFromString(a);fabric.parseSVGDocument(d.documentElement,function(a,c){b&&b(a,c)},c)},fabric.util.getScript=function(url,callback){request(url,"",function(body){eval(body),callback&&callback()})},fabric.Image.fromObject=function(a,b){fabric.util.loadImage(a.src,function(c){var d=new fabric.Image(c);d._initConfig(a),d._initFilters(a,function(a){d.filters=a||[],b&&b(d)})})},fabric.createCanvasForNode=function(a,b,c,d){d=d||c;var e=fabric.document.createElement("canvas"),f=new Canvas(a||600,b||600,d);e.style={},e.width=f.width,e.height=f.height;var g=fabric.Canvas||fabric.StaticCanvas,h=new g(e,c);return h.contextContainer=f.getContext("2d"),h.nodeCanvas=f,h.Font=Canvas.Font,h},fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()},fabric.StaticCanvas.prototype.createJPEGStream=function(a){return this.nodeCanvas.createJPEGStream(a)};var origSetWidth=fabric.StaticCanvas.prototype.setWidth;fabric.StaticCanvas.prototype.setWidth=function(a){return origSetWidth.call(this,a),this.nodeCanvas.width=a,this},fabric.Canvas&&(fabric.Canvas.prototype.setWidth=fabric.StaticCanvas.prototype.setWidth);var origSetHeight=fabric.StaticCanvas.prototype.setHeight;fabric.StaticCanvas.prototype.setHeight=function(a){return origSetHeight.call(this,a),this.nodeCanvas.height=a,this},fabric.Canvas&&(fabric.Canvas.prototype.setHeight=fabric.StaticCanvas.prototype.setHeight)}}(),function(a){"use strict";var b,c,d,e;return e=function(a){return a.left=a.left||0,a.top=a.top||0,a},c=a.fabric||(a.fabric={}),b=c.util.object.extend,c.Shelf?void console.warn("fabric.Shelf is already defined"):(d=c.Object.prototype.stateProperties.concat(),d.push("id","count","side","top_cm","left_cm","eachWidth","eachHeight","label"),c.Shelf=c.util.createClass(c.Object,{stateProperties:d,type:"shelf",eachWidth:90,eachHeight:25,__width:function(){return this.__eachWidth()*this.count},__height:function(){return this.__eachHeight()*this.side},__eachWidth:function(){return this.eachWidth*haika.scale},__eachHeight:function(){return this.eachHeight*haika.scale},count:1,side:1,label:"",minScaleLimit:1,strokeDashArray:null,initialize:function(a){a=a||{},this.callSuper("initialize",a),this.width=this.__width(),this.height=this.__height()},_render:function(a){var b,c,d,e,f,g,h;return 1===this.width&&1===this.height?void a.fillRect(0,0,1,1):(a.scale(1/this.scaleX,1/this.scaleY),e=0,0===this.scaleX||"mr"!==this.__corner&&"tr"!==this.__corner&&"br"!==this.__corner||(e=(this.count*this.__eachWidth()-this.width*this.scaleX)/2),0===this.scaleX||"ml"!==this.__corner&&"tl"!==this.__corner&&"bl"!==this.__corner||(e=-1*(this.count*this.__eachWidth()-this.width*this.scaleX)/2),f=this.__eachWidth(),b=this.__eachHeight(),g=-f/2*this.count+e,h=-b/2*this.side,c=this.group&&"path-group"===this.group.type,a.globalAlpha=c?a.globalAlpha*this.opacity:this.opacity,this.transformMatrix&&c&&a.translate(this.width/2+this.x,this.height/2+this.y),!this.transformMatrix&&c&&a.translate(-this.group.width/2+this.width/2+this.x,-this.group.height/2+this.height/2+this.y),1===this.side&&(this.__renderShelf(a,g,h,f,b),haika.scale>.5&&this.__renderSide(a,g,h,f,b)),2===this.side&&this.__renderShelf(a,g,h,f,b),this.active&&(a.font="13.5px Arial",a.textAlign="center",a.textBaseline="middle",a.fillStyle="rgba(0, 0, 0,1)",d=1===this.side?"":"",d="["+this.id+"] "+d+this.count+"",a.fillText(d,0,this.height*this.scaleY/2+15)),void a.scale(this.scaleX,this.scaleY))},__renderShelf:function(a,b,c,d,e){var f;return f=d*this.count,this.__renderRect(a,b,c,f,e),this.__renderPartitionLine(a,b,c,d,e),2===this.side?(this.__renderRect(a,b,c+e,f,e),this.__renderPartitionLine(a,b,c+e,d,e)):void 0},__renderRect:function(a,b,c,d,e){return a.lineWidth=1,a.beginPath(),a.moveTo(b,c),a.lineTo(b+d,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.lineTo(b,c),a.closePath(),this._renderFill(a),this._renderStroke(a)},__renderPartitionLine:function(a,b,c,d,e){var f;if(!(this.count<=1)){for(a.lineWidth=1,a.beginPath(),f=1;f<this.count;)a.moveTo(b+d*f,c),a.lineTo(b+d*f,c+e),f++;return a.closePath(),this._renderStroke(a)}},__renderSide:function(a,b,c,d,e){return a.lineWidth=5,a.beginPath(),a.moveTo(b,c+e-1),a.lineTo(b+d*this.count,c+e-1),a.closePath(),this._renderStroke(a)},__resizeShelf:function(){var a,b,c,d;return b=this.scaleX*this.currentWidth,a=this.scaleY*this.currentHeight,c=Math.floor(b/this.__eachWidth()),1>c&&(c=1),c>10&&(c=10),d=Math.round(a/this.__eachHeight()),1>d&&(d=1),d>2&&(d=2),this.set({count:c,side:d,minScaleLimit:.01,flipX:!1,flipY:!1})},__modifiedShelf:function(){var a;return this.angle=this.angle%360,(this.angle>=350||this.angle<=10)&&(this.angle=0),this.angle>=80&&this.angle<=100&&(this.angle=90),this.angle>=170&&this.angle<=190&&(this.angle=180),this.angle>=260&&this.angle<=280&&(this.angle=270),0===this.scaleX||"mr"!==this.__corner&&"tr"!==this.__corner&&"br"!==this.__corner||(a=this.angle*(Math.PI/180),this.top=this.top+Math.sin(a)*(this.count*this.__eachWidth()-this.width*this.scaleX)/2,this.left=this.left+Math.cos(a)*(this.count*this.__eachWidth()-this.width*this.scaleX)/2),0===this.scaleX||"ml"!==this.__corner&&"tl"!==this.__corner&&"bl"!==this.__corner||(a=this.angle*(Math.PI/180),this.top=this.top-Math.sin(a)*(this.count*this.__eachWidth()-this.width*this.scaleX)/2,this.left=this.left-Math.cos(a)*(this.count*this.__eachWidth()-this.width*this.scaleX)/2),this.scaleX=this.scaleY=1,this.width=this.__width(),this.height=this.__height(),this.setCoords()},_renderDashedStroke:function(a){var b,d,e,f;e=-this.width/2,f=-this.height/2,d=this.width,b=this.height,a.beginPath(),c.util.drawDashedLine(a,e,f,e+d,f,this.strokeDashArray),c.util.drawDashedLine(a,e+d,f,e+d,f+b,this.strokeDashArray),c.util.drawDashedLine(a,e+d,f+b,e,f+b,this.strokeDashArray),c.util.drawDashedLine(a,e,f+b,e,f,this.strokeDashArray),a.closePath()},_normalizeLeftTopProperties:function(a){return"left"in a&&this.set("left",a.left+this.getWidth()/2),this.set("x",a.left||0),"top"in a&&this.set("top",a.top+this.getHeight()/2),this.set("y",a.top||0),this},toObject:function(a){var c;return c=b(this.callSuper("toObject",a),{count:this.get("count"),side:this.get("side")}),this.includeDefaultValues||this._removeDefaultValues(c),c},toGeoJSON:function(){var a,b,d,e,f,g,h,i,j,k,l,m,n,o;for(i=this.eachWidth*this.count/100,f=this.eachHeight*this.side/100,j=-i/2+this.left_cm/100,k=-f/2+this.top_cm/100,d=[[[j,k],[j+i,k],[j+i,k+f],[j,k+f],[j,k]]],h=[],l=0,n=d.length;n>l;l++)for(a=d[l],m=0,o=a.length;o>m;m++)b=a[m],g=c.util.rotatePoint(new c.Point(b[0],b[1]),new c.Point(this.left_cm/100,this.top_cm/100),c.util.degreesToRadians(this.angle)),h.push([-g.x,g.y]);return e={type:"Feature",geometry:{type:"Polygon",coordinates:[h]},properties:{label:this.label?this.label:"",type:this.type,left_cm:this.left_cm,top_cm:this.top_cm,eachWidth:this.eachWidth,eachHeight:this.eachHeight,id:this.id,count:this.count,side:this.side,angle:this.angle,fill:this.fill,stroke:this.stroke}}},toSVG:function(a){var b,c,d,e,f,g,h,i,j;for(f=this._createBaseSVGMarkup(),f.push("<g>"),b=this.get("count"),g=this.get("side"),h=this.eachWidth,c=this.eachHeight,i=-h/2*this.count,j=-c/2*this.side,d=0,e=0;b>d;)f.push('<rect x="'+(-1*this.width/2+this.width/b*d)+'" y="'+-1*this.height/2+'" rx="'+this.get("rx")+'" ry="'+this.get("ry")+'" width="'+this.width/b+'" height="'+this.height/2+'" style="'+this.getSvgStyles()+'" transform="'+this.getSvgTransform()+'"/>'),d++;if(2===g)for(d=0;b>d;)f.push('<rect x="'+(-1*this.width/2+this.width/b*d)+'" y="'+(-1*this.height/2+this.eachHeight)+'" rx="'+this.get("rx")+'" ry="'+this.get("ry")+'" width="'+this.width/b+'" height="'+this.height/2+'" style="'+this.getSvgStyles()+'" transform="'+this.getSvgTransform()+'"/>'),d++;return f.push("</g>"),a?a(f.join("")):f.join("")},getJsonSchema:function(){var a;return a={title:"",type:"object",properties:{label:{title:"",type:"string","default":""},count:{title:"",type:"integer","default":3,minimum:1,maximum:10},side:{type:"integer","default":1,minimum:1,maximum:2},angle:{type:"integer","default":0,minimum:0,maximum:360},eachWidth:{type:"integer","default":90,minimum:1},eachHeight:{type:"integer","default":25,minimum:1}}}},complexity:function(){return 1}}),c.Shelf.ATTRIBUTE_NAMES=c.SHARED_ATTRIBUTES.concat("width height count side".split(" ")),c.Shelf.fromElement=function(a,d){var f,g;return a?(f=c.parseAttributes(a,c.Shelf.ATTRIBUTE_NAMES),f=e(f),g=new c.Shelf(b(d?c.util.object.clone(d):{},f)),g._normalizeLeftTopProperties(f),g):null},void(c.Shelf.fromObject=function(a){return new c.Shelf(a)}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b,c,d,e;return e=function(a){return a.left=a.left||0,a.top=a.top||0,a},c=a.fabric||(a.fabric={}),b=c.util.object.extend,c.curvedShelf?void console.warn("fabric.curvedShelf is already defined"):(d=c.Object.prototype.stateProperties.concat(),d.push("rx","ry","x","y"),c.curvedShelf=c.util.createClass(c.Object,{stateProperties:d,type:"curved_shelf",rx:0,ry:0,x:0,y:0,__width:function(){return this.__eachWidth()*this.count},__height:function(){return this.__eachHeight()*this.side},__eachWidth:function(){return 90*haika.scale},__eachHeight:function(){return 25*haika.scale},count:1,side:1,minScaleLimit:1,strokeDashArray:null,initialize:function(a){a=a||{},this.callSuper("initialize",a),this._initRxRy(),this.x=a.x||0,this.y=a.y||0,this.width=this.__width(),this.height=this.__height()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(a){var b,c,d,e,f,g;return 1===this.width&&1===this.height?void a.fillRect(0,0,1,1):(a.scale(1/this.scaleX,1/this.scaleY),c=(180-30*this.count)/2*Math.PI/180,b=c+30*this.count*Math.PI/180,d=0,e=0,a.beginPath(),a.arc(d,e,this.height*this.scaleY/2,c,b,!1),g=this.height*this.scaleY/2-this.__eachHeight()*this.side,10>=g&&(g=10),30*this.count<360&&a.arc(d,e,g,b,c,!0),a.closePath(),this._renderFill(a),this._renderStroke(a),a.beginPath(),g=this.height*this.scaleY/2-1*this.__eachHeight(),10>=g&&(g=10),a.arc(d,e,g,c,b,!1),a.stroke(),this.active&&(a.font="13.5px Arial",a.textAlign="center",a.textBaseline="middle",a.fillStyle="rgba(0, 0, 0,1)",f=1===this.side?"":"",f="["+this.id+"] "+f+this.count+"",a.fillText(f,0,this.height*this.scaleY/2+15)),void a.scale(this.scaleX,this.scaleY))},__resizeShelf:function(){var a,b,c,d;return b=this.scaleX*this.currentWidth,a=this.scaleY*this.currentHeight,c=Math.floor(b/this.__eachWidth()),1>c&&(c=1),c>20&&(c=20),d=Math.round(a/this.__eachHeight()),1>d&&(d=1),d>2&&(d=2),this.set({count:c,side:d,minScaleLimit:.01,flipX:!1,flipY:!1})},__modifiedShelf:function(){return this.angle=this.angle%360,(this.angle>=350||this.angle<=10)&&(this.angle=0),this.angle>=80&&this.angle<=100&&(this.angle=90),this.angle>=170&&this.angle<=190&&(this.angle=180),this.angle>=260&&this.angle<=280&&(this.angle=270),this.height=this.height*this.scaleY,this.scaleX=this.scaleY=1,this.width=this.__width(),this.setCoords()
},_normalizeLeftTopProperties:function(a){return"left"in a&&this.set("left",a.left+this.getWidth()/2),this.set("x",a.left||0),"top"in a&&this.set("top",a.top+this.getHeight()/2),this.set("y",a.top||0),this},toObject:function(a){var c;return c=b(this.callSuper("toObject",a),{rx:this.get("rx")||0,ry:this.get("ry")||0,x:this.get("x"),y:this.get("y")}),this.includeDefaultValues||this._removeDefaultValues(c),c},toGeoJSON:function(){var a,b,c,d,e,f;return d=this.__eachWidth()*this.count,c=this.__eachHeight()*this.side,a=this.getCenterPoint(),e=-d/2+a.x,f=-c/2+a.y,e=haika.transformLeftX_px2cm(e),f=haika.transformTopY_px2cm(f),b={type:"Feature",geometry:{type:"Polygon",coordinates:[[[-e,f],[-(e+d),f],[-(e+d),f+c],[-e,f+c],[-e,f]]]},properties:{type:this.type,left_cm:this.left_cm,top_cm:this.top_cm,id:this.id,count:this.count,side:this.side,angle:this.angle,fill:this.fill,stroke:this.stroke}}},toSVG:function(a){var b,c,d,e,f;for(e=this._createBaseSVGMarkup(),e.push("<g>"),c=0,d=0,b=this.get("count"),f="one"===this.get("row")?1:2;b>c;)e.push('<rect x="'+(-1*this.width/2+this.width/b*c)+'" y="'+-1*this.height/2+'" rx="'+this.get("rx")+'" ry="'+this.get("ry")+'" width="'+this.width/b+'" height="'+this.height+'" style="'+this.getSvgStyles()+'" transform="'+this.getSvgTransform()+'"/>'),c++;return e.push("</g>"),a?a(e.join("")):e.join("")},getJsonSchema:function(){var a;return a={title:"",type:"object",properties:{count:{title:"",type:"integer","default":3,minimum:1,maximum:12},side:{type:"integer","default":1,minimum:1,maximum:2},angle:{type:"integer","default":0,minimum:0,maximum:360}}}},complexity:function(){return 1}}),c.curvedShelf.ATTRIBUTE_NAMES=c.SHARED_ATTRIBUTES.concat("x y rx ry width height count side".split(" ")),c.curvedShelf.fromElement=function(a,d){var f,g;return a?(f=c.parseAttributes(a,c.Shelf.ATTRIBUTE_NAMES),f=e(f),g=new c.Shelf(b(d?c.util.object.clone(d):{},f)),g._normalizeLeftTopProperties(f),g):null},void(c.curvedShelf.fromObject=function(a){return new c.curvedShelf(a)}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b,c;return c=a.fabric||(a.fabric={}),b=c.util.object.extend,c.Beacon?void console.warn("fabric.Beacon is already defined"):void(c.Beacon=c.util.createClass(c.Object,{type:"beacon",eachWidth:10,eachHeight:10,minor:0,__width:function(){return this.eachWidth*haika.scale},__height:function(){return this.eachHeight*haika.scale},initialize:function(a){a=a||{},this.callSuper("initialize",a),this.width=this.__width(),this.height=this.__height()},_render:function(a){return a.beginPath(),1===this.width&&1===this.height?void a.fillRect(0,0,1,1):(a.fillRect(this.width/2*-1,this.height/2*-1,this.width,this.height),this._renderFill(a),void this._renderStroke(a))},__resizeShelf:function(){return this.set({flipX:!1,flipY:!1})},__modifiedShelf:function(){return this.angle=this.angle%360,(this.angle>=350||this.angle<=10)&&(this.angle=0),this.angle>=80&&this.angle<=100&&(this.angle=90),this.angle>=170&&this.angle<=190&&(this.angle=180),this.angle>=260&&this.angle<=280&&(this.angle=270),this.width=this.__width(),this.height=this.__height(),this.setCoords(),this.__is_into()},__is_into:function(){var a,b,c,d,e,f,g,h,i,j,k;for(f=haika.canvas.getObjects(),k=[],i=0,j=f.length;j>i;i++)e=f[i],e.type.match(/shelf$/)?(c=e.__width()/2,d=e.left-c,g=e.left+c,b=e.__height()/2,h=e.top-b,a=e.top+b,k.push(this.left>d&&this.left<g&&this.top>h&&this.top<a?log("into:"+e.id):void 0)):k.push(void 0);return k},_normalizeLeftTopProperties:function(a){return"left"in a&&this.set("left",a.left+this.getWidth()/2),"top"in a&&this.set("top",a.top+this.getHeight()/2),this},toObject:function(a){var c;return c=b(this.callSuper("toObject",a)),this.includeDefaultValues||this._removeDefaultValues(c),c},toGeoJSON:function(){var a,b,d,e,f,g,h,i,j,k,l,m,n,o;for(i=this.__width()/100,f=this.__height()/100,j=-i/2+this.left_cm/100,k=-f/2+this.top_cm/100,d=[[[j,k],[j+i,k],[j+i,k+f],[j,k+f],[j,k]]],h=[],l=0,n=d.length;n>l;l++)for(a=d[l],m=0,o=a.length;o>m;m++)b=a[m],g=c.util.rotatePoint(new c.Point(b[0],b[1]),new c.Point(this.left_cm/100,this.top_cm/100),c.util.degreesToRadians(this.angle)),h.push([-g.x,g.y]);return e={type:"Feature",geometry:{type:"Polygon",coordinates:[h]},properties:{type:this.type,left_cm:this.left_cm,top_cm:this.top_cm,id:this.id,angle:this.angle,fill:this.fill,stroke:this.stroke,minor:this.minor}}},toSVG:function(){return""},getJsonSchema:function(){var a;return a={title:"",type:"object",properties:{angle:{type:"integer","default":0,minimum:0,maximum:360},minor:{type:"integer"}}}},complexity:function(){return 1}}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b,c;return c=a.fabric||(a.fabric={}),b=c.util.object.extend,c.Wall?void console.warn("fabric.Wall is already defined"):void(c.Wall=c.util.createClass(c.Rect,{type:"wall",eachWidth:100,eachHeight:100,width_scale:1,height_scale:1,__width:function(){return this.eachWidth*this.width_scale*haika.scale},__height:function(){return this.eachHeight*this.height_scale*haika.scale},initialize:function(a){a=a||{},this.callSuper("initialize",a),this.width=this.__width(),this.height=this.__height()},__resizeShelf:function(){return this.set({flipX:!1,flipY:!1})},__modifiedShelf:function(){return this.angle=this.angle%360,(this.angle>=350||this.angle<=10)&&(this.angle=0),this.angle>=80&&this.angle<=100&&(this.angle=90),this.angle>=170&&this.angle<=190&&(this.angle=180),this.angle>=260&&this.angle<=280&&(this.angle=270),1!==this.sacleX&&(this.width=this.width*this.scaleX,this.width_scale=this.width/(this.eachWidth*haika.scale)),1!==this.sacleY&&(this.height=this.height*this.scaleY,this.height_scale=this.height/(this.eachHeight*haika.scale)),this.scaleX=this.scaleY=1,this.setCoords()},toGeoJSON:function(){var a,b,d,e,f,g,h,i,j,k,l,m,n,o;for(i=this.eachWidth*this.width_scale/100,f=this.eachHeight*this.height_scale/100,j=-i/2+this.left_cm/100,k=-f/2+this.top_cm/100,d=[[[j,k],[j+i,k],[j+i,k+f],[j,k+f],[j,k]]],h=[],l=0,n=d.length;n>l;l++)for(a=d[l],m=0,o=a.length;o>m;m++)b=a[m],g=c.util.rotatePoint(new c.Point(b[0],b[1]),new c.Point(this.left_cm/100,this.top_cm/100),c.util.degreesToRadians(this.angle)),h.push([-g.x,g.y]);return e={type:"Feature",geometry:{type:"Polygon",coordinates:[h]},properties:{type:this.type,left_cm:this.left_cm,top_cm:this.top_cm,id:this.id,angle:this.angle,fill:this.fill,stroke:this.stroke,width_scale:this.width_scale,height_scale:this.height_scale}}},toSVG:function(a){var b,c,d;return b=this._createBaseSVGMarkup(),c=this.left,d=this.top,this.group&&"path-group"===this.group.type||(c=-this.width/2,d=-this.height/2),b.push("<rect ",'x="',c,'" y="',d,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>\n'),a?a(b.join("")):b.join("")},getJsonSchema:function(){var a;return a={title:"",type:"object",properties:{angle:{type:"integer","default":0,minimum:0,maximum:360},width_scale:{type:"number","default":1},height_scale:{type:"number","default":1}}}},complexity:function(){return 1}}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b,c;return c=a.fabric||(a.fabric={}),b=c.util.object.extend,c.Floor?void console.warn("fabric.Floor is already defined"):void(c.Floor=c.util.createClass(c.Rect,{type:"floor",eachWidth:1e3,eachHeight:1e3,width_scale:1,height_scale:1,__width:function(){return this.eachWidth*this.width_scale*haika.scale},__height:function(){return this.eachHeight*this.height_scale*haika.scale},initialize:function(a){a=a||{},this.callSuper("initialize",a),this.width=this.__width(),this.height=this.__height()},__resizeShelf:function(){return this.set({flipX:!1,flipY:!1})},__modifiedShelf:function(){return this.angle=this.angle%360,(this.angle>=350||this.angle<=10)&&(this.angle=0),this.angle>=80&&this.angle<=100&&(this.angle=90),this.angle>=170&&this.angle<=190&&(this.angle=180),this.angle>=260&&this.angle<=280&&(this.angle=270),1!==this.sacleX&&(this.width=this.width*this.scaleX,this.width_scale=this.width/(this.eachWidth*haika.scale)),1!==this.sacleY&&(this.height=this.height*this.scaleY,this.height_scale=this.height/(this.eachHeight*haika.scale)),this.scaleX=this.scaleY=1,this.setCoords()},toGeoJSON:function(){var a,b,d,e,f,g,h,i,j,k,l,m,n,o;for(i=this.eachWidth*this.width_scale/100,f=this.eachHeight*this.height_scale/100,j=-i/2+this.left_cm/100,k=-f/2+this.top_cm/100,d=[[[j,k],[j+i,k],[j+i,k+f],[j,k+f],[j,k]]],h=[],l=0,n=d.length;n>l;l++)for(a=d[l],m=0,o=a.length;o>m;m++)b=a[m],g=c.util.rotatePoint(new c.Point(b[0],b[1]),new c.Point(this.left_cm/100,this.top_cm/100),c.util.degreesToRadians(this.angle)),h.push([-g.x,g.y]);return e={type:"Feature",geometry:{type:"Polygon",coordinates:[h]},properties:{type:this.type,left_cm:this.left_cm,top_cm:this.top_cm,id:this.id,angle:this.angle,fill:this.fill,stroke:this.stroke,width_scale:this.width_scale,height_scale:this.height_scale}}},toSVG:function(){return""},getJsonSchema:function(){var a;return a={title:"",type:"object",properties:{angle:{type:"integer","default":0,minimum:0,maximum:360},width_scale:{type:"number","default":1},height_scale:{type:"number","default":1}}}},complexity:function(){return 1}}))}("undefined"!=typeof exports?exports:this),function(a){"use strict";var b;return b=a.fabric||(a.fabric={}),b.drawGridLines?void console.warn("fabric.drawGridLines is already defined"):void(b.drawGridLines=function(a){var b,c,d,e,f,g;for(g=a.canvas.width,b=a.canvas.height,d=100*haika.scale,50>d&&(d=500*haika.scale),50>d&&(d=1e3*haika.scale),a.save(),a.beginPath(),a.setLineDash([2,2]),a.lineWidth=1,a.strokeStyle="#999999",a.opacity=1,e=1e3*haika.transformLeftX_cm2px(0)%Math.floor(1e3*d)/1e3,f=1e3*haika.transformTopY_cm2px(0)%Math.floor(1e3*d)/1e3,c=0;c<Math.ceil(g/d)+1;)a.moveTo(Math.floor(c*d+e)+.5,0),a.lineTo(Math.floor(c*d+e)+.5,b),++c;for(c=0;c<Math.ceil(b/d)+1;)a.moveTo(0,Math.floor(c*d+f)+.5),a.lineTo(g,Math.floor(c*d+f)+.5),++c;a.closePath(),a.stroke(),a.restore()})}("undefined"!=typeof exports?exports:this);var haika,log;log=function(a){try{return console.log(a)}catch(b){}},haika={state:"shelf",centerX:0,centerY:0,scale:1,objects:[],canvas:!1,background_image:null,fillColor:"#CFE2F3",strokeColor:"#000000",options:{},default_options:{canvas_id:"canvas_area",canvas_width:800,canvas_height:600,scale:1,bgurl:null,bgopacity:1,bgscale:1,lon:0,lat:0,angle:0,geojson_scale:1.5},transformLeftX_cm2px:function(a){return this.canvas.getWidth()/2+(this.centerX-a)*this.scale},transformTopY_cm2px:function(a){return this.canvas.getHeight()/2+(this.centerY-a)*this.scale},transformLeftX_px2cm:function(a){return this.centerX-(a-this.canvas.getWidth()/2)/this.scale},transformTopY_px2cm:function(a){return this.centerY-(a-this.canvas.getHeight()/2)/this.scale},init:function(a){var b;return this.options=$.extend(this.default_options,a),b=new fabric.Canvas(this.options.canvas_id,{rotationCursor:'url("img/rotate.cur") 10 10, crosshair'}),b.setWidth(this.options.canvas_width),$("#canvas_width").val(this.options.canvas_width),b.setHeight(this.options.canvas_height),$("#canvas_height").val(this.options.canvas_height),b._getActionFromCorner=function(a,b){var c;return c="drag",b&&("ml"===b||"mr"===b||"tr"===b||"tl"===b||"bl"===b||"br"===b?c="scaleX":"mt"===b||"mb"===b?c="scaleY":"mtr"===b&&(c="rotate")),c},b._renderBackground=function(a){return a.mozImageSmoothingEnabled=!1,this.backgroundImage&&this.backgroundImage.render(a),a.mozImageSmoothingEnabled=!0,fabric.drawGridLines(a)},initAligningGuidelines(b),this.canvas=b,null!=a.scale&&(this.scale=a.scale),this.render(),setTimeout(function(a){return function(){var b;return b=function(a){return alert(a)},a.openFromApi(2,null,null,b),$(a).trigger("haika:initialized")}}(this),500),this.bindEvent()},bindEvent:function(){return this.canvas.on("object:selected",function(a){return function(b){var c;return c=b.target,null!=c._objects&&(c.lockScalingX=!0,c.lockScalingY=!0),a.saveDelay(),a.setPropetyPanel()}}(this)),this.canvas.on("before:selection:cleared",function(a){return function(b){var c;return c=b.target,a.canvas.deactivateAll().renderAll(),a.saveDelay(),a.editor_change(),a.setPropetyPanel()}}(this)),this.canvas.on("object:scaling",function(){return function(a){var b;return b=a.target,null!=b.__resizeShelf?b.__resizeShelf():void 0}}(this)),this.canvas.on("object:modified",function(a){return function(b){var c;return c=b.target,null!=c.__modifiedShelf&&c.__modifiedShelf(),a.setPropetyPanel()}}(this)),$(window).on("beforeunload",function(a){return function(){a.render(),a.save()}}(this))},loadBgFromUrl:function(a){return this.options.bgurl=a,this.render()},resetBg:function(){return loadBgFromUrl("")},lastId:0,getId:function(){return 0===this.objects.length?0:(this.lastId+=1,this.lastId)},getCountFindById:function(a){var b;return b=null,$(this.objects).each(function(c,d){return d.id===a?b=c:void 0}),b},add:function(a){var b,c,d,e,f,g,h;""!==a.id&&a.id||(a.id=this.getId()),c={id:a.id},e=["type","width","height","scaleX","scaleY","left","top","angle","fill","stroke"],f=a.constructor.prototype.getJsonSchema();for(b in f.properties)e.push(b);for(g=0,h=e.length;h>g;g++)d=e[g],"top"!==d?"left"!==d?c[d]=a[d]:c.left_cm=this.transformLeftX_px2cm(a.left):c.top_cm=this.transformTopY_px2cm(a.top);return this.objects.push(c),$(this).trigger("haika:add"),c.id},setState:function(a){var b;return b=a.type.match(/shelf$/)?"shelf":"wall"===a.type?"wall":"floor"===a.type?"floor":"beacon",this.state=b,$(".nav a."+this.state).tab("show")},getObjects:function(a,b){var c,d,e,f,g,h,i;if(null==b&&(b=!0),f=this.canvas.getActiveObject(),f&&(d=a(f),d&&b&&$(this.canvas.getObjects()).each(function(a){return function(b,c){return c.id===d?a.canvas.setActiveObject(c):void 0}}(this))),c=this.canvas.getActiveGroup()){for(e=[],i=c.getObjects(),g=0,h=i.length;h>g;g++)f=i[g],d=a(f),e.push(d);return b?this.activeGroup(e):this.render()}},activeGroup:function(a){var b,c,d,e,f,g,h,i,j;for(d=[],j=this.canvas.getObjects(),f=0,h=j.length;h>f;f++)for(e=j[f],g=0,i=a.length;i>g;g++)c=a[g],e.id===c&&d.push(e);return d=d.map(function(a){return a.set("active",!0)}),b=new fabric.Group(d,{originX:"center",originY:"center"}),this.canvas._activeObject=null,this.canvas.setActiveGroup(b.setCoords()).renderAll()},remove:function(){return this.getObjects(function(a){return function(b){return a.__remove(b)}}(this),!1),$(this).trigger("haika:remove")},__remove:function(a){var b;return this.canvas.remove(a),b=this.getCountFindById(a.id),this.objects.splice(b,1),a},bringToFront:function(){return this.getObjects(function(a){return function(b){var c,d;return c=a.getCountFindById(b.id),b.bringToFront(),d=a.objects[c],a.objects.splice(c,1),a.objects.push(d),d.id}}(this))},duplicate:function(){var a,b,c,d,e,f,g,h;if(e=this.canvas.getActiveObject(),e&&(d=fabric.util.object.clone(e),d.id=this.getId(),d.top=this.transformTopY_cm2px(this.centerY),d.left=this.transformLeftX_cm2px(this.centerX),b=this.add(d)),a=this.canvas.getActiveGroup())for(c=[],h=a.getObjects(),f=0,g=h.length;g>f;f++)e=h[f],d=fabric.util.object.clone(e),d.id=this.getId(),d.top=this.transformTopY_cm2px(this.centerY)+e.top,d.left=this.transformLeftX_cm2px(this.centerX)+e.left,b=this.add(d),c.push(b);return this.saveDelay(),this.render(),e&&$(this.canvas.getObjects()).each(function(a){return function(c,d){return d.id===b?a.canvas.setActiveObject(d):void 0}}(this)),a&&this.activeGroup(c),$(this).trigger("haika:duplicate")},clipboard:[],clipboard_scale:0,copy:function(){var a,b,c,d,e;if(this.clipboard=[],b=this.canvas.getActiveObject(),b&&this.clipboard.push(fabric.util.object.clone(b)),a=this.canvas.getActiveGroup())for(e=a.getObjects(),c=0,d=e.length;d>c;c++)b=e[c],this.clipboard.push(fabric.util.object.clone(b));return this.clipboard_scale=this.scale,$(this).trigger("haika:copy")},paste:function(){var a,b,c,d,e,f,g;if(!(this.clipboard.length<=0)){if(1===this.clipboard.length)return d=this.clipboard[0],c=fabric.util.object.clone(d),c.id=this.getId(),c.top=this.transformTopY_cm2px(this.centerY),c.left=this.transformLeftX_cm2px(this.centerX),a=this.add(c),this.saveDelay(),this.render(),$(this.canvas.getObjects()).each(function(b){return function(c,d){return d.id===a?b.canvas.setActiveObject(d):void 0}}(this));for(b=[],g=this.clipboard,e=0,f=g.length;f>e;e++)d=g[e],c=fabric.util.object.clone(d),c.id=this.getId(),c.top=this.transformTopY_cm2px(this.centerY)+d.top*this.scale/this.clipboard_scale,c.left=this.transformLeftX_cm2px(this.centerX)+d.left*this.scale/this.clipboard_scale,a=this.add(c),b.push(a);return this.saveDelay(),log("pre render"+this.clipboard[0].top),this.render(),log("after render"+this.clipboard[0].top),this.activeGroup(b),$(this).trigger("haika:paste")}},selectAll:function(){var a,b;return this.canvas.discardActiveGroup(),b=this.canvas.getObjects().map(function(a){return a.set("active",!0)}),a=new fabric.Group(b,{originX:"center",originY:"center"}),this.canvas._activeObject=null,this.canvas.setActiveGroup(a.setCoords()).renderAll()},unselectAll:function(){return this.canvas.deactivateAll().renderAll()},unselect:function(){var a;return a=this.canvas.getActiveObject(),a||(a=this.canvas.getActiveGroup()),a?(this.canvas.fire("before:selection:cleared",{target:a}),this.canvas.fire("selection:cleared",{target:a})):void 0},getClass:function(a){return"shelf"===a?fabric.Shelf:"curved_shelf"===a?fabric.curvedShelf:"beacon"===a?fabric.Beacon:"wall"===a?fabric.Wall:"floor"===a?fabric.Floor:fabric.Shelf},render:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(!this.background_image&&this.options.bgurl&&fabric.Image.fromURL(this.options.bgurl,function(a){return function(b){a.background_image=b,a.render()}}(this)),this.canvas.renderOnAddRemove=!1,this.unselect(),this.canvas._objects.length=0,a=[],d=[],e=[],b=[],r=this.objects,f=0,j=r.length;j>f;f++)c=r[f],"beacon"===c.type&&a.push(c),"wall"===c.type&&e.push(c),"floor"===c.type&&b.push(c),c.type.match(/shelf$/)&&d.push(c);if("floor"!==this.state)for(g=0,k=b.length;k>g;g++)c=b[g],this.addObjectToCanvas(c);for(h=0,l=e.length;l>h;h++)c=e[h],this.addObjectToCanvas(c);if("floor"===this.state)for(i=0,m=b.length;m>i;i++)c=b[i],this.addObjectToCanvas(c);for(p=0,n=d.length;n>p;p++)c=d[p],this.addObjectToCanvas(c);for(q=0,o=a.length;o>q;q++)c=a[q],this.addObjectToCanvas(c);return this.background_image?(this.canvas.setBackgroundImage(this.background_image),this.background_image.left=Math.floor(this.transformLeftX_cm2px(this.background_image._originalElement.width/2*this.options.bgscale)),this.background_image.top=Math.floor(this.transformTopY_cm2px(this.background_image._originalElement.height/2*this.options.bgscale)),this.background_image.width=Math.floor(this.background_image._originalElement.width*this.options.bgscale*this.scale),this.background_image.height=Math.floor(this.background_image._originalElement.height*this.options.bgscale*this.scale),this.background_image.opacity=this.options.bgopacity):this.canvas.setBackgroundImage(null),this.canvas.renderAll(),this.canvas.renderOnAddRemove=!0,this.setCanvasProperty(),$(this).trigger("haika:render")},addObjectToCanvas:function(a){var b,c,d,e;c=this.getClass(a.type),d=new c,a.type.match(/shelf$/)&&(d.side=a.side,d.count=a.count,d.eachWidth=a.eachWidth,d.eachHeight=a.eachHeight),d.selectable=a.type.match(this.state),a.type.match(this.state)||(d.opacity=.5),d.id=a.id,d.scaleX=d.scaleY=1,("wall"===a.type||"floor"===a.type)&&(d.width_scale=a.width_scale,d.height_scale=a.height_scale),d.width=d.__width(),d.height=d.__height(),d.top=this.transformTopY_cm2px(a.top_cm),d.left=this.transformLeftX_cm2px(a.left_cm),d.top_cm=a.top_cm,d.left_cm=a.left_cm,d.angle=a.angle,d.originX="center",d.originY="center","beacon"===a.type?(d.fill="#000000",d.hasControls=!1,d.padding=10,d.borderColor="#0000ee"):"wall"===a.type?(d.fill="#000000",d.borderColor="#000000"):"floor"===a.type?(d.fill="",d.borderColor="#000000"):(d.borderColor="#000000",d.fill=a.fill,d.padding=0),d.stroke=a.stroke,d.transparentCorners=!1,d.cornerColor="#488BD4",d.borderOpacityWhenMoving=.8,d.cornerSize=10,e=d.constructor.prototype.getJsonSchema();for(b in e.properties)d[b]=a[b];return this.canvas.add(d)},setCanvasProperty:function(){return $("#canvas_width").html(this.canvas.getWidth()),$("#canvas_height").html(this.canvas.getHeight()),$("#canvas_centerX").html(this.centerX),$("#canvas_centerY").html(this.centerY),$("#canvas_bgscale").val(this.options.bgscale),$("#canvas_bgopacity").val(this.options.bgopacity),$("#canvas_lon").val(this.options.lon),$("#canvas_lat").val(this.options.lat),$("#canvas_angle").val(this.canvas.angle),$("#geojson_scale").val(this.canvas.geojson_scale)},getMovePixel:function(a){return a.shiftKey?10:1},up:function(a){var b;return b=this.canvas.getActiveObject(),b?(b.top=b.top-this.getMovePixel(a),this.canvas.renderAll()):void 0},down:function(a){var b;return b=this.canvas.getActiveObject(),b?(b.top=b.top+this.getMovePixel(a),this.canvas.renderAll()):void 0},left:function(a){var b;return b=this.canvas.getActiveObject(),b?(b.left=b.left-this.getMovePixel(a),this.canvas.renderAll()):void 0},right:function(a){var b;return b=this.canvas.getActiveObject(),b?(b.left=b.left+this.getMovePixel(a),this.canvas.renderAll()):void 0},alignLeft:function(){var a,b,c,d,e,f,g,h,i,j;if(b=this.canvas.getActiveGroup(),b._objects){for(c=0,i=b._objects,e=0,g=i.length;g>e;e++)d=i[e],a=d.getBoundingRect(),c=Math.min(a.left,c);for(j=b._objects,f=0,h=j.length;h>f;f++)d=j[f],a=d.getBoundingRect(),d.left=c+a.width/2;return this.saveDelay(),this.canvas.renderAll()}},alignRight:function(){var a,b,c,d,e,f,g,h,i,j;if(b=this.canvas.getActiveGroup(),b._objects){for(c=0,i=b._objects,e=0,g=i.length;g>e;e++)d=i[e],a=d.getBoundingRect(),c=Math.max(a.left+a.width,c);for(j=b._objects,f=0,h=j.length;h>f;f++)d=j[f],a=d.getBoundingRect(),d.left=c-a.width/2;return this.canvas.renderAll()}},alignCenter:function(){var a,b,c,d,e;if(a=this.canvas.getActiveGroup(),a._objects){for(e=a._objects,c=0,d=e.length;d>c;c++)b=e[c],b.left=0;return this.canvas.renderAll()}},alignTop:function(){var a,b,c,d,e,f,g,h,i,j;if(b=this.canvas.getActiveGroup(),b._objects){for(d=0,i=b._objects,e=0,g=i.length;g>e;e++)c=i[e],a=c.getBoundingRect(),d=Math.min(a.top,d);for(j=b._objects,f=0,h=j.length;h>f;f++)c=j[f],a=c.getBoundingRect(),c.top=d+a.height/2;return this.canvas.renderAll()}},alignBottom:function(){var a,b,c,d,e,f,g,h,i,j;if(b=this.canvas.getActiveGroup(),b._objects){for(d=0,i=b._objects,e=0,g=i.length;g>e;e++)c=i[e],a=c.getBoundingRect(),d=Math.max(a.top+a.height,d);for(j=b._objects,f=0,h=j.length;h>f;f++)c=j[f],a=c.getBoundingRect(),c.top=d-a.height/2;return this.canvas.renderAll()}},alignVcenter:function(){var a,b,c,d,e;if(a=this.canvas.getActiveGroup(),a._objects){for(e=a._objects,c=0,d=e.length;d>c;c++)b=e[c],b.top=0;return this.canvas.renderAll()}},zoomIn:function(){var a;return this.unselect(),a=this.scale,this.scale=this.scale+Math.pow(this.scale+1,2)/20,this.scale>=4&&(this.scale=4),1>a&&this.scale>1&&(this.scale=1),this.scale=(100*this.scale).toFixed(0)/100,this.render(),$(".zoom").html((100*this.scale).toFixed(0)+"%")},zoomOut:function(){var a;return this.unselect(),a=this.scale,this.scale=this.scale-Math.pow(this.scale+1,2)/20,this.scale<=.05&&(this.scale=.05),a>1&&this.scale<1&&(this.scale=1),this.scale=(100*this.scale).toFixed(0)/100,this.render(),$(".zoom").html((100*this.scale).toFixed(0)+"%")},zoomReset:function(){return this.unselect(),this.scale=1,this.render(),$(".zoom").html("100%")},reset:function(){return this.objects=[],localStorage.clear(),$(window).off("beforeunload"),location.reload()},setPropetyPanel:function(a){var b,c,d,e,f;if($(".canvas_panel, .object_panel, .group_panel").hide(),a=this.canvas.getActiveObject(),a&&null!=a.getJsonSchema){this.editor.schema=a.getJsonSchema(),e={};for(c in this.editor.schema.properties)f="integer"===this.editor.schema.properties[c].type?parseInt(a[c]).toFixed(0):a[c],e[c]=f;return this.editor.setValue(e),null!=a.toGeoJSON&&$("#geojson").val(JSON.stringify(a.toGeoJSON(),null,4)),$(".object_panel").show(),void $("#object_id").html(a.id)}return(b=this.canvas.getActiveGroup())?(d=b._objects,$("#group_count").html(d.length),$(".group_panel").show(),void 0):$(".canvas_panel").show()}},$.extend(haika,{_dataId:null,_revision:null,_collision:null,_api_load_endpoint:"/api/floor/load",_api_save_endpoint:"/api/floor/save",_geojson:{},nowSaving:!1,close:function(){return this._dataId=null,this._revision=null,this._collision=null,this._geojson={},this.objects.length=0,this.background_image=null},openFromApi:function(a,b,c,d){return null==b&&(b=null),null==c&&(c=null),null==d&&(d=null),this._dataId&&this.close(),this.nowSaving&&d&&d(""),$.ajax({url:this._api_load_endpoint,type:"POST",cache:!1,dataType:"json",data:{id:a,revision:b},error:function(){return function(){return d&&d("")}}(this),success:function(a){return function(b){return b.locked?d&&d(""):(a._dataId=b.id,a._revision=b.revision,a._collision=b.collision,a._geojson=b.data,a.loadFromGeoJson(),$(a).trigger("haika:load"),c&&c())}}(this)})},loadFromGeoJson:function(a){var b,c,d,e,f,g,h,i;if(null==a&&(a=null),a||(a=this._geojson),this.options.bgscale=a.haika.bgscale?a.haika.bgscale:4.425,this.options.bgopacity=a.haika.bgopacity,this.options.bgurl=null!=a.haika.bgurl?a.haika.bgurl:"",this.options.angle=a.haika.angle,null!=a.haika.geojson_scale&&(this.options.geojson_scale=a.haika.geojson_scale),null!=a.haika.lon&&null!=a.haika.lat&&(this.options.lon=parseFloat(a.haika.lon),this.options.lat=parseFloat(a.haika.lat)),a&&a.features.length>0)for(i=a.features,g=0,h=i.length;h>g;g++){d=i[g],d.properties.id>this.lastId&&(this.lastId=d.properties.id),c=this.getClass(d.properties.type),f=new c({id:d.properties.id,top:this.transformTopY_cm2px(d.properties.top_cm),left:this.transformLeftX_cm2px(d.properties.left_cm),top_cm:d.properties.top_cm,left_cm:d.properties.left_cm,fill:d.properties.fill,stroke:d.properties.stroke,angle:d.properties.angle}),e=f.constructor.prototype.getJsonSchema();for(b in e.properties)f[b]=d.properties[b];this.add(f)}return this.render()},getCanvasProperty:function(){return{state:this.state,scale:this.scale,centerX:this.centerX,centerY:this.centerY,bgurl:this.options.bgurl,bgscale:this.options.bgscale,bgopacity:this.options.bgopacity,lon:this.options.lon,lat:this.options.lat,angle:this.options.angle,geojson_scale:this.options.geojson_scale}},saveTimeout:null,save:function(){var a,b;return this.prepareData(),log("save"),this.nowSaving?void setTimeout(function(a){return function(){return a.save()}}(this),500):(this.nowSaving=!0,b=this.toGeoJSON(),b.haika=this.getCanvasProperty(),b.haika.version=1,b=JSON.stringify(b),a={id:this._dataId,revision:this._revision,collision:this._collision,data:b},$.ajax({url:this._api_save_endpoint,type:"POST",data:a,dataType:"text",success:function(a){return function(b){var c;return c=JSON.parse(b),c.success===!1?(alert(c.message),location.reload()):(a._revision=c.revision,a._collision=c.collision),a.nowSaving=!1,a.saveTimeout?(clearTimeout(a.saveTimeout),a.saveTimeout=null):void 0}}(this),error:function(a){return function(){return a.nowSaving=!1,a.saveTimeout&&(clearTimeout(a.saveTimeout),a.saveTimeout=null),alert("")}}(this)}),$(this).trigger("haika:save"))},saveDelay:function(){return this.prepareData(),this.saveTimeout||clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(function(a){return function(){return a.save()}}(this),2e3)},prepareData:function(){var a,b,c,d,e,f,g,h;for(g=this.canvas.getObjects(),h=[],e=0,f=g.length;f>e;e++)c=g[e],a=this.getCountFindById(c.id),this.objects[a].id=c.id,this.objects[a].type=c.type,this.objects[a].top_cm=this.transformTopY_px2cm(c.top),c.top_cm=this.objects[a].top_cm,this.objects[a].left_cm=this.transformLeftX_px2cm(c.left),c.left_cm=this.objects[a].left_cm,this.objects[a].scaleX=c.scaleX/this.scale,this.objects[a].scaleY=c.scaleY/this.scale,this.objects[a].angle=c.angle,this.objects[a].fill=c.fill,this.objects[a].stroke=c.stroke,d=c.constructor.prototype.getJsonSchema(),h.push(function(){var e;e=[];for(b in d.properties)e.push(this.objects[a][b]=c[b]);return e}.call(this));return h},toGeoJSON:function(){var a,b,c,d,e,f,g;for(b=[],g=this.canvas.getObjects(),e=0,f=g.length;f>e;e++)d=g[e],c=d.toGeoJSON(),b.push(c);return a={type:"FeatureCollection",features:b}},toSVG:function(){var a,b,c,d,e,f,g,h,i;for(f=[],i=this.canvas.getObjects(),g=0,h=i.length;h>g;g++)c=i[g],e=c.toSVG(),f.push(e);return log(f),d='<svg viewBox="0 0 1024 768">',b="</svg>",a=[d,f.join(""),b].join(""),log(a),a},"import":function(){var a,b;return a=window.prompt("id",""),b="http://lab.calil.jp/haika_store/data/"+this.id+".json",$.ajax({url:b,type:"GET",cache:!1,dataType:"text",success:function(a){return function(b){var c,d;return d=JSON.parse(b),c=d.canvas,d.geojson.haika=d.canvas,a.loadRender(d.geojson)}}(this),error:function(){return function(){return alert("")}}(this)})}}),$(haika).on("haika:initialized",function(){var a,b,c,d,e,f,g;return g=5e3,b=haika.bgimg?haika.bgimg_width:2500,a=haika.bgimg?haika.bgimg_height:2500,e=b*haika.options.bgscale/2,f=a*haika.options.bgscale/2,c=-((haika.centerX-g)/1e4),d=-((haika.centerY-g)/1e4),new Dragdealer("horizontal-scroller",{x:c,animationCallback:function(a){var b;return haika.unselect(),b=1e4*a-g,b>e-haika.canvas.getWidth()/2&&(b=e-haika.canvas.getWidth()/2),b<-e+haika.canvas.getWidth()/2&&(b=-e+haika.canvas.getWidth()/2),haika.centerX=-b.toFixed(0),haika.render()}}),new Dragdealer("vertical-scroller",{y:d,horizontal:!1,vertical:!0,animationCallback:function(a,b){var c;return haika.unselect(),c=1e4*b-g,c>f-haika.canvas.getHeight()/2&&(c=f-haika.canvas.getHeight()/2),c<-f+haika.canvas.getHeight()/2&&(c=-f+haika.canvas.getHeight()/2),haika.centerY=-c.toFixed(0),haika.render()}})}),$.extend(haika,{setting:{navbar_height:function(){return $("#navbar").length>0?$("#navbar").height()+45:0},sidebar_width:function(){return $(".sidebar-collapse").length>0?$(".sidebar-collapse").width()+45:0},scrollbar_width:$("#vertical-scroller").width(),scrollbar_height:$("#horizontal-scroller").height(),toolbar_width:$(".toolbar_container").width()+14,property_panel_width:$(".property_panel").width(),getWidth:function(){return window.innerWidth-this.sidebar_width()-this.toolbar_width-this.scrollbar_width-this.property_panel_width-20},getHeight:function(){return window.innerHeight-this.navbar_height()-$(".header").height()-this.scrollbar_height},start:function(){return $(".main_container, .canvas_panel").css("width",this.getWidth()),$(".main_container").css("margin-left",this.toolbar_width),$("#vertical-scroller, #vertical-scroller .dragdealer").css("height",this.getHeight()),$(".toolbar_container,.property_panel").css("height",this.getHeight()+this.scrollbar_height),$(window).resize(function(a){return function(){return haika.canvas.setWidth(a.getWidth()),haika.canvas.setHeight(a.getHeight()),$(".main_container, .canvas_panel").css("width",a.getWidth()),$("#vertical-scroller, #vertical-scroller .dragdealer").css("height",a.getHeight()),$(".toolbar_container,.property_panel").css("height",a.getHeight()+a.scrollbar_height),haika.render()}}(this)),haika.init({canvas_id:"canvas_area",canvas_width:this.getWidth(),canvas_height:this.getHeight(),bgopacity:.2,bgscale:4})}}}),$(function(){return $(".nav-tabs a").click(function(a){return a.preventDefault(),haika.state=$(a.target).attr("class"),haika.render(),haika.addbuttons.showAddButtons(haika.state),$(this).tab("show")})}),haika.setting.start(),$.extend(haika,{addbuttons:{add:function(a){var b,c,d;return log(a),c=haika.getClass(a.type),d=new c({top:haika.transformTopY_cm2px(haika.centerY),left:haika.transformLeftX_cm2px(haika.centerX),fill:haika.fillColor,stroke:haika.strokeColor,angle:null!=a.angle?a.angle:0}),null!=a.count&&(d.count=a.count),null!=a.side&&(d.side=a.side),a.type.match(/shelf$/)&&(d.eachWidth=a.eachWidth,d.eachHeight=a.eachHeight),b=haika.add(d),haika.setState(d),haika.render(),haika.undo.add(b),$(haika.canvas.getObjects()).each(function(){return function(a,b){return b.id===d.id?setTimeout(function(){return haika.canvas.setActiveObject(haika.canvas.item(a)),$(".add").blur()
},10):void 0}}(this))},addmany:function(){var a,b;for(b=0;8>b;){for(a=0;22>a;)this.add(200+400*b,100+50*a,90),a++;b++}haika.render()},showAddButtons:function(a){return $(".toolbar_container ul:first>li").each(function(b,c){return $(c).attr("state")===a?$(c).show():$(c).hide()})}}}),$(function(){var a,b,c,d,e;a={shelf:{icon:"square-o",title:"",eachWidth:90,eachHeight:26,count:5,side:1,state:"shelf"},big_shelf:{icon:"square-o",title:"",eachWidth:90,eachHeight:33,count:5,side:1,state:"shelf"},magazine_shelf:{icon:"square-o",title:"",eachWidth:90,eachHeight:45,count:5,side:1,state:"shelf"},kamishibai_shelf:{icon:"square-o",title:"",eachWidth:90,eachHeight:90,count:1,side:1,state:"shelf"},booktrack_shelf:{icon:"square-o",title:"",eachWidth:60,eachHeight:40,count:1,side:1,angle:20,state:"shelf"},curved_shelf:{icon:"dot-circle-o",title:"",count:3,side:2,state:"shelf"},beacon:{icon:"square",title:"",state:"beacon"},wall:{icon:"square",title:"",state:"wall"},floor:{icon:"square",title:"",state:"floor"}},e=[];for(c in a)d=a[c],b='<li id="add_'+c+'" key="'+c+'" state="'+d.state+'"><i class="fa fa-'+d.icon+'"></i> '+d.title+"</li>",$(".toolbar_container ul:first").append(b),haika.addbuttons.showAddButtons("shelf"),e.push($("#add_"+c).click(function(b){var d;return c=$(b.target).attr("key"),d=a[c],d.type=c,haika.addbuttons.add(d),haika.render()}));return e}),$(haika).on("haika:initialized",function(){return haika.addbuttons.showAddButtons(haika.state)}),$.extend(haika,{colorpicker:{init:function(){var a,b,c,d,e,f,g,h,i;for(e="",c=new Array("f","c","9","6","3","0"),b=2,g=0;6>g;){for(h=0;6>h;){for(i=0;6>i;)d=c[g]+c[g]+c[h]+c[h]+c[i]+c[i],e+='<option data-color="#'+d+'" value="'+b+'"></option>',i++,b++;h++}g++}for(f=0;6>f;)d=c[f]+c[f]+c[f]+c[f]+c[f]+c[f],e+='<option data-color="#'+d+'" value="'+b+'"></option>',f++;return $("#fill-color").append(e),$("#stroke-color").append(e),a=function(a,b){var c,d,e,f,g,h;if(null==b&&(b=!0),d=haika.canvas.getActiveObject(),d&&a(d),c=haika.canvas.getActiveGroup()){for(g=c.getObjects(),h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(a(d));return h}},$("#fill-color").colorselector({callback:function(b,c){return haika.fillColor=c,a(function(a){return a.fill=c}),haika.canvas.renderAll()}}),$("#stroke-color").colorselector({callback:function(b,c){return haika.strokeColor=c,a(function(a){return a.stroke=c}),haika.canvas.renderAll()}})}}}),haika.colorpicker.init(),$("#bgimg").change(function(a){var b,c;return c=a.target.files,0!==c.length?(b=new FormData,b.append("id",haika.id),b.append("userfile",c[0]),$.ajax({url:"/haika_store/upload.php",data:b,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(){var a;return a="/haika_store/image/"+haika.id+"_"+c[0].name,haika.loadBgFromUrl(a)}})):void 0}),$(function(){return $(".add_custom_shelf").click(function(){return add("custom_shelf"),haika.render()}),$(".add_beacon").click(function(){return add("beacon"),haika.render()}),$(".remove").click(function(){var a;return a=haika.canvas.getActiveObject(),haika.remove(),a?haika.undo.remove(a):void 0}),$(".zoomin").click(function(){return haika.zoomIn()}),$(".zoomout").click(function(){return haika.zoomOut()}),$(".zoomreset").click(function(){return haika.zoomReset()}),$(".bringtofront").click(function(){return haika.bringToFront()}),$(".duplicate").click(function(){return haika.duplicate()}),$(".copy").click(function(){return haika.copy()}),$(".paste").click(function(){return haika.paste()}),$(".align-left").click(function(){return haika.alignLeft()}),$(".align-center").click(function(){return haika.alignCenter()}),$(".align-right").click(function(){return haika.alignRight()}),$(".align-top").click(function(){return haika.alignTop()}),$(".align-vcenter").click(function(){return haika.alignVcenter()}),$(".align-bottom").click(function(){return haika.alignBottom()})}),$(function(){var a,b;return b=!1,$("canvas").on("mousewheel",function(){return function(a){return b?void 0:(b=setTimeout(function(){return b=!1},100),a.deltaY>0&&haika.zoomIn(),a.deltaY<0?haika.zoomOut():void 0)}}(this)),$("#canvas_bgscale").change(function(){return haika.options.bgscale=parseFloat($(this).val()),haika.render()}),$("#bgreset").click(function(){return haika.resetBg()}),$("#bgopacity_slider").slider({step:1,min:1,max:100,value:100*haika.options.bgopacity,formatter:function(a){return haika.options.bgopacity=a/100,haika.render(),a/100}}),$(".undo").click(function(){return haika.undo.undoManager.undo()}),a=function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1},Mousetrap.bind("mod+o",function(){return $("#file").trigger("click"),!1}),Mousetrap.bind("mod+c",function(){return haika.copy(),!1}),Mousetrap.bind("mod+v",function(){return haika.paste(),!1}),Mousetrap.bind("mod+d",function(b){return a(b),haika.duplicate(),!1}),Mousetrap.bind("mod+a",function(b){return a(b),haika.selectAll(),!1}),Mousetrap.bind("mod+z",function(b){return a(b),haika.undo.undoManager.undo(),!1}),Mousetrap.bind(["esc","escape"],function(b){return a(b),haika.unselectAll(),!1}),Mousetrap.bind(["up","shift+up"],function(b){return a(b),haika.up(b),!1}),Mousetrap.bind(["down","shift+down"],function(b){return a(b),haika.down(b),!1}),Mousetrap.bind(["left","shift+left"],function(b){return a(b),haika.left(b),!1}),Mousetrap.bind(["right","shift+right"],function(b){return a(b),haika.right(b),!1}),$(document).unbind("keydown").bind("keydown",function(a){var b,c;c=!1,(8===a.keyCode||46===a.keyCode)&&(b=a.srcElement||a.target,c="INPUT"===b.tagName.toUpperCase()&&("TEXT"===b.type.toUpperCase()||"PASSWORD"===b.type.toUpperCase()||"FILE"===b.type.toUpperCase()||"EMAIL"===b.type.toUpperCase())||"TEXTAREA"===b.tagName.toUpperCase()?b.readOnly||b.disabled:!0),c&&(a.preventDefault(),haika.remove())})}),$.extend(haika,{undo:{undoManager:new UndoManager,states:[],set_selected:!0,add:function(a){return log("add set"),this.undoManager.add({undo:function(b){return function(){var c;return log("undo add "+a),c=b.getObject(a),log(c),haika.__remove(c)}}(this),redo:function(){return function(){}}(this)})},remove:function(a){return log("remove set"),this.undoManager.add({undo:function(){return function(){return log("undo remove "+a.id),log(a),haika.add(a),haika.render()}}(this),redo:function(){return function(){}}(this)})},init:function(){return haika.canvas.on("object:selected",function(a){return function(b){var c,d;return c=b.target,a.set_selected?0===a.states.length||c.id!==a.states[a.states.length-1].id?(c.saveState(),d=$.extend(!0,{},c.originalState),d.state_type="selected",a.states.push(d)):void 0:void(a.set_selected=!0)}}(this)),haika.canvas.on("selection:cleared",function(){return function(a){var b;return b=a.target}}(this)),haika.canvas.on("object:modified",function(a){return function(b){var c,d;c=b.target,c.saveState(),d=$.extend(!0,{},c.originalState),d.state_type="modified",a.states.push(d),a.undoManager.add({undo:function(){var b;return a.states.length>0?(haika.canvas.deactivateAll(),b=a.states[a.states.length-2],c=a.getObject(b.id),c&&(a.setState(c,b),a.states.pop(),"selected"===a.states[a.states.length-1].state_type&&a.states.pop(),a.set_selected=!1,haika.canvas.setActiveObject(c)),log(a.states)):void 0},redo:function(){}})}}(this))},getObject:function(a){var b,c,d,e,f;for(c=null,f=haika.canvas.getObjects(),d=0,e=f.length;e>d;d++)if(b=f[d],b.id===a){c=b;break}return c},setState:function(a,b){return a.setOptions(b),a.setCoords()}}}),haika.undo.init();var addPixel,loadComplete,loadImg;loadImg=function(a){var b;if(a.type.match(/image\/.+/)&&"image/svg+xml"!==a.type)return b=new FileReader,b.onload=function(){return loadComplete(this.result)},b.readAsDataURL(a)},$("#file").change(function(a){var b;return b=a.target.files,0!==b.length?loadImg(b[0]):void 0}),loadComplete=function(a){var b,c,d,e,f,g,h;return e=new Image,e.src=a,b=document.createElement("canvas"),c=b.getContext("2d"),b.width=e.width,b.height=e.height,c.translate(0,e.height),c.scale(1,-1),c.translate(e.width,0),c.scale(-1,1),c.drawImage(e,0,0),g=b.width,d=b.height,a=c.getImageData(0,0,g,d).data,f={image:a,w:g,h:d},h=new Worker("js/haika-image-worker.js"),h.onmessage=function(a){var b,c,d,e;switch(log(a.data),a.data.status){case"working":return log(a.data.count);case"end":for(c=a.data.result,d=0,e=c.length;e>d;d++)b=c[d],addPixel(b.x,b.y,b.color);return haika.render()}},h.postMessage(f)},addPixel=function(a,b,c){var d,e,f;return d=10,e=haika.getClass("shelf"),f=new e({top:haika.transformTopY_cm2px(b*d),left:haika.transformLeftX_cm2px(a*d),fill:c,stroke:c,angle:0,count:1,side:1,eachWidth:d,eachHeight:d}),haika.add(f)},$.extend(haika,{editor:new JSONEditor(document.getElementById("editor"),{theme:"bootstrap3",iconlib:"fontawesome4",disable_edit_json:!0,disable_properties:!0,schema:{title:"",type:"object",properties:{label:{title:"",type:"string"},count:{title:"",type:"integer","default":3,minimum:1,maximum:10},side:{title:"",type:"integer","default":1,minimum:1,maximum:2},angle:{title:"",type:"integer","default":0,minimum:0,maximum:360},eachWidth:{type:"integer","default":90,minimum:1},eachHeight:{type:"integer","default":25,minimum:1},minor:{type:"integer"}}}}),editor_change:function(){var a,b,c,d,e;if(c=haika.editor.validate(),c.length)log(c);else if(b=haika.editor.getValue(),log(b),e=haika.canvas.getActiveObject(),log(e),e){a=!1;for(d in haika.editor.schema.properties)log(d),log(b[d]),e[d]!==b[d]&&(e[d]=b[d],a=!0);a&&(log("change"),haika.save())}}}),haika.editor.on("change",function(){return log("onchange")}),function(){function aa(){return function(a){return a}}function ba(){return function(){}}function k(a){return function(){return this[a]}}function ca(a){return function(){return a}}function fa(){}function ga(a){a.gb=function(){return a.ae?a.ae:a.ae=new a}}function ha(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function s(a){return void 0!==a}function ka(a){return null===a}function ma(a){return"array"==ha(a)}function na(a){var b=ha(a);return"array"==b||"object"==b&&"number"==typeof a.length}function oa(a){return"string"==typeof a}function pa(a){return"number"==typeof a}function qa(a){return"function"==ha(a)}function ra(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function sa(a){return a[ta]||(a[ta]=++ua)}function va(a){return a.call.apply(a.bind,arguments)}function wa(a,b){if(!a)throw Error();if(2<arguments.length){var c=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(d,c),a.apply(b,d)}}return function(){return a.apply(b,arguments)}}function xa(){return xa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?va:wa,xa.apply(null,arguments)}function za(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=Array.prototype.slice.call(arguments);return c.unshift.apply(c,b),a.apply(this,c)}}function t(a,b){var c=a.split("."),d=ea;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function v(a,b){function c(){}c.prototype=b.prototype,a.I=b.prototype,a.prototype=new c}function Ba(a){Error.captureStackTrace?Error.captureStackTrace(this,Ba):this.stack=Error().stack||"",a&&(this.message=String(a))}function Ca(a){for(var b=a.split("%s"),c="",d=Array.prototype.slice.call(arguments,1);d.length&&1<b.length;)c+=b.shift()+d.shift();return c+b.join("%s")}function Da(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function Ea(a){return Fa.test(a)?(-1!=a.indexOf("&")&&(a=a.replace(Ga,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Ha,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(Ia,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Ja,"&quot;")),a):a}function Ka(a){a=s(void 0)?a.toFixed(void 0):String(a);var b=a.indexOf(".");return-1==b&&(b=a.length),b=Math.max(0,2-b),Array(b+1).join("0")+a}function La(a,b){for(var c=0,d=Da(String(a)).split("."),e=Da(String(b)).split("."),f=Math.max(d.length,e.length),g=0;0==c&&f>g;g++){var h=d[g]||"",i=e[g]||"",j=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var l=j.exec(h)||["","",""],m=k.exec(i)||["","",""];if(0==l[0].length&&0==m[0].length)break;c=((0==l[1].length?0:parseInt(l[1],10))<(0==m[1].length?0:parseInt(m[1],10))?-1:(0==l[1].length?0:parseInt(l[1],10))>(0==m[1].length?0:parseInt(m[1],10))?1:0)||((0==l[2].length)<(0==m[2].length)?-1:(0==l[2].length)>(0==m[2].length)?1:0)||(l[2]<m[2]?-1:l[2]>m[2]?1:0)}while(0==c)}return c}function Ra(a,b){var c=Sa(a,b,void 0);return 0>c?null:oa(a)?a.charAt(c):a[c]}function Sa(a,b,c){for(var d=a.length,e=oa(a)?a.split(""):a,f=0;d>f;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Ua(a,b){var c,d=Na(a,b);return(c=d>=0)&&Ma.splice.call(a,d,1),c}function Va(){return Ma.concat.apply(Ma,arguments)}function Wa(a){var b=a.length;if(b>0){for(var c=Array(b),d=0;b>d;d++)c[d]=a[d];return c}return[]}function Ya(a){for(var b=1;b<arguments.length;b++){var c,d=arguments[b];if(ma(d)||(c=na(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(c)for(var e=a.length,f=d.length,g=0;f>g;g++)a[e+g]=d[g];else a.push(d)}}function Za(a){Ma.splice.apply(a,ab(arguments,1))}function ab(a,b,c){return 2>=arguments.length?Ma.slice.call(a,b):Ma.slice.call(a,b,c)}function bb(a,b){Ma.sort.call(a,b||db)}function eb(a,b){if(!na(a)||!na(b)||a.length!=b.length)return!1;for(var c=a.length,d=fb,e=0;c>e;e++)if(!d(a[e],b[e]))return!1;return!0}function db(a,b){return a>b?1:b>a?-1:0}function fb(a,b){return a===b}function gb(a,b,c){this.a=a,this.x=b,this.y=c}function hb(a,b,c,d){return s(d)?(d.a=a,d.x=b,d.y=c,d):new gb(a,b,c)}function ib(a,b,c){return a+"/"+b+"/"+c}function jb(a){var b,c,d=Array(a.a),e=1<<a.a-1;for(b=0;b<a.a;++b)c=48,a.x&e&&(c+=1),a.y&e&&(c+=2),d[b]=String.fromCharCode(c),e>>=1;return d.join("")}function kb(a,b,c,d){this.a=a,this.c=b,this.b=c,this.d=d}function lb(a,b,c,d,e){return s(e)?(e.a=a,e.c=b,e.b=c,e.d=d,e):new kb(a,b,c,d)}function mb(a){this.d=a.html,this.a=s(a.tileRanges)?a.tileRanges:null}function ub(){return ea.navigator?ea.navigator.userAgent:null}function vb(){return ea.navigator}function Fb(){var a=ea.document;return a?a.documentMode:void 0}function Nb(a){return Mb[a]||(Mb[a]=0<=La(Gb,a))}function Sb(a){return a=a.className,oa(a)&&a.match(/\S+/g)||[]}function Tb(a){for(var b=Sb(a),c=ab(arguments,1),d=b.length+c.length,e=b,f=0;f<c.length;f++)0<=Na(e,c[f])||e.push(c[f]);return a.className=b.join(" "),b.length==d}function Ub(a,b,c){for(var d=Sb(a),e=!1,f=0;f<d.length;f++)d[f]==b&&(Za(d,f--,1),e=!0);e&&(d.push(c),a.className=d.join(" "))}function Vb(a,b,c){return Math.min(Math.max(a,b),c)}function Wb(a,b){var c=a%b;return 0>c*b?c+b:c}function Xb(a){return a*Math.PI/180}function Yb(a,b){this.x=s(a)?a:0,this.y=s(b)?b:0}function Zb(a,b){this.width=a,this.height=b}function $b(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function ac(a,b){for(var c in a)if(b.call(void 0,a[c],c,a))return!0;return!1}function bc(a){var b,c=0;for(b in a)c++;return c}function cc(a){var b,c=[],d=0;for(b in a)c[d++]=a[b];return c}function dc(a){var b,c=[],d=0;for(b in a)c[d++]=b;return c}function ec(a){for(var b in a)return!1;return!0}function gc(a){for(var b in a)delete a[b]}function hc(a,b){b in a&&delete a[b]}function w(a,b,c){return b in a?a[b]:c}function ic(a,b){var c=[];return b in a?a[b]:a[b]=c}function jc(a){var b,c={};for(b in a)c[b]=a[b];return c}function lc(a){for(var b,c,d=1;d<arguments.length;d++){c=arguments[d];for(b in c)a[b]=c[b];for(var e=0;e<kc.length;e++)b=kc[e],Object.prototype.hasOwnProperty.call(c,b)&&(a[b]=c[b])}}function mc(a){return a?new nc(oc(a)):Qb||(Qb=new nc)}function pc(a){return oa(a)?document.getElementById(a):a}function qc(a,b){$b(b,function(b,c){"style"==c?a.style.cssText=b:"class"==c?a.className=b:"for"==c?a.htmlFor=b:c in rc?a.setAttribute(rc[c],b):0==c.lastIndexOf("aria-",0)||0==c.lastIndexOf("data-",0)?a.setAttribute(c,b):a[c]=b})}function sc(a){return a=a.document.documentElement,new Zb(a.clientWidth,a.clientHeight)}function tc(){var a=arguments,b=document,c=a[0],d=a[1];if(!Rb&&d&&(d.name||d.type)){if(c=["<",c],d.name&&c.push(' name="',Ea(d.name),'"'),d.type){c.push(' type="',Ea(d.type),'"');var e={};lc(e,d),delete e.type,d=e}c.push(">"),c=c.join("")}return c=b.createElement(c),d&&(oa(d)?c.className=d:ma(d)?Tb.apply(null,[c].concat(d)):qc(c,d)),2<a.length&&uc(b,c,a,2),c}function uc(a,b,c,d){function e(c){c&&b.appendChild(oa(c)?a.createTextNode(c):c)}for(;d<c.length;d++){var f=c[d];!na(f)||ra(f)&&0<f.nodeType?e(f):Oa(vc(f)?Wa(f):f,e)}}function wc(a){return document.createElement(a)}function xc(a){uc(oc(a),a,arguments,1)}function yc(a){for(var b;b=a.firstChild;)a.removeChild(b)}function zc(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)}function Ac(a,b,c){a.insertBefore(b,a.childNodes[c]||null)}function Bc(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function Cc(a){if(void 0!=a.firstElementChild)a=a.firstElementChild;else for(a=a.firstChild;a&&1!=a.nodeType;)a=a.nextSibling;return a}function Ec(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(16&a.compareDocumentPosition(b));for(;b&&a!=b;)b=b.parentNode;return b==a}function oc(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function vc(a){if(a&&"number"==typeof a.length){if(ra(a))return"function"==typeof a.item||"string"==typeof a.item;if(qa(a))return"function"==typeof a.item}return!1}function nc(a){this.a=a||ea.document||document}function Fc(a){var b=a.a;return a=Bb?b.body:b.documentElement,b=b.parentWindow||b.defaultView,zb&&Nb("10")&&b.pageYOffset!=a.scrollTop?new Yb(a.scrollLeft,a.scrollTop):new Yb(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}function Gc(a,b,c,d){this.top=a,this.right=b,this.bottom=c,this.left=d}function Hc(a,b,c,d){this.left=a,this.top=b,this.width=c,this.height=d}function Ic(a,b){var c=oc(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))?c[b]||c.getPropertyValue(b)||"":""}function Jc(a,b){return Ic(a,b)||(a.currentStyle?a.currentStyle[b]:null)||a.style&&a.style[b]}function Kc(a,b,c){var d,e=Ab&&(rb||Eb)&&Nb("1.9");b instanceof Yb?(d=b.x,b=b.y):(d=b,b=c),a.style.left=Lc(d,e),a.style.top=Lc(b,e)}function Mc(a){var b;try{b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}return zb&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop),b}function Nc(a){if(zb&&!(zb&&Pb>=8))return a.offsetParent;var b=oc(a),c=Jc(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Jc(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null}function Oc(a){var b,c,d=oc(a),e=Jc(a,"position"),f=Ab&&d.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==e&&(b=d.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),g=new Yb(0,0);if(b=d?oc(d):document,(c=!zb)||(c=zb&&Pb>=9)||(mc(b),c=!0),c=c?b.documentElement:b.body,a==c)return g;if(a.getBoundingClientRect)b=Mc(a),a=Fc(mc(d)),g.x=b.left+a.x,g.y=b.top+a.y;else if(d.getBoxObjectFor&&!f)b=d.getBoxObjectFor(a),a=d.getBoxObjectFor(c),g.x=b.screenX-a.screenX,g.y=b.screenY-a.screenY;else{f=a;do{if(g.x+=f.offsetLeft,g.y+=f.offsetTop,f!=a&&(g.x+=f.clientLeft||0,g.y+=f.clientTop||0),Bb&&"fixed"==Jc(f,"position")){g.x+=d.body.scrollLeft,g.y+=d.body.scrollTop;break}f=f.offsetParent}while(f&&f!=a);for((yb||Bb&&"absolute"==e)&&(g.y-=d.body.offsetTop),f=a;(f=Nc(f))&&f!=d.body&&f!=c;)g.x-=f.scrollLeft,yb&&"TR"==f.tagName||(g.y-=f.scrollTop)}return g}function Pc(a,b){var c=Qc(a),d=Qc(b);return new Yb(c.x-d.x,c.y-d.y)}function Qc(a){if(1==a.nodeType){var b;if(a.getBoundingClientRect)b=Mc(a),b=new Yb(b.left,b.top);else{b=Fc(mc(a));var c=Oc(a);b=new Yb(c.x-b.x,c.y-b.y)}if(Ab&&!Nb(12)){var d;zb?d="-ms-transform":Bb?d="-webkit-transform":yb?d="-o-transform":Ab&&(d="-moz-transform");var e;d&&(e=Jc(a,d)),e||(e=Jc(a,"transform")),a=e&&(a=e.match(Rc))?new Yb(parseFloat(a[1]),parseFloat(a[2])):new Yb(0,0),a=new Yb(b.x+a.x,b.y+a.y)}else a=b;return a}return d=qa(a.df),e=a,a.targetTouches?e=a.targetTouches[0]:d&&a.N.targetTouches&&(e=a.N.targetTouches[0]),new Yb(e.clientX,e.clientY)}function Lc(a,b){return"number"==typeof a&&(a=(b?Math.round(a):a)+"px"),a}function Sc(a){var b=Tc;if("none"!=Jc(a,"display"))return b(a);var c=a.style,d=c.display,e=c.visibility,f=c.position;return c.visibility="hidden",c.position="absolute",c.display="inline",a=b(a),c.display=d,c.position=f,c.visibility=e,a}function Tc(a){var b=a.offsetWidth,c=a.offsetHeight,d=Bb&&!b&&!c;return s(b)&&!d||!a.getBoundingClientRect?new Zb(b,c):(a=Mc(a),new Zb(a.right-a.left,a.bottom-a.top))}function Uc(a,b){var c=a.style;"opacity"in c?c.opacity=b:"MozOpacity"in c?c.MozOpacity=b:"filter"in c&&(c.filter=""===b?"":"alpha(opacity="+100*b+")")}function Vc(a,b){a.style.display=b?"":"none"}function Wc(a){return"rtl"==Jc(a,"direction")}function Xc(a){var b,c=oc(a),d=zb&&a.currentStyle;return(b=d)&&(mc(c),b="auto"!=d.width&&"auto"!=d.height&&!d.boxSizing),b?(c=Yc(a,d.width,"width","pixelWidth"),a=Yc(a,d.height,"height","pixelHeight"),new Zb(c,a)):(d=new Zb(a.offsetWidth,a.offsetHeight),c=$c(a,"padding"),a=ad(a),new Zb(d.width-a.left-c.left-c.right-a.right,d.height-a.top-c.top-c.bottom-a.bottom))}function Yc(a,b,c,d){if(/^\d+px?$/.test(b))return parseInt(b,10);var e=a.style[c],f=a.runtimeStyle[c];return a.runtimeStyle[c]=a.currentStyle[c],a.style[c]=b,b=a.style[d],a.style[c]=e,a.runtimeStyle[c]=f,b}function bd(a,b){var c=a.currentStyle?a.currentStyle[b]:null;return c?Yc(a,c,"left","pixelLeft"):0}function $c(a,b){if(zb){var c=bd(a,b+"Left"),d=bd(a,b+"Right"),e=bd(a,b+"Top"),f=bd(a,b+"Bottom");return new Gc(e,d,f,c)}return c=Ic(a,b+"Left"),d=Ic(a,b+"Right"),e=Ic(a,b+"Top"),f=Ic(a,b+"Bottom"),new Gc(parseFloat(e),parseFloat(d),parseFloat(f),parseFloat(c))}function dd(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:null))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:null;return c in cd?cd[c]:Yc(a,c,"left","pixelLeft")}function ad(a){if(zb){var b=dd(a,"borderLeft"),c=dd(a,"borderRight"),d=dd(a,"borderTop");return a=dd(a,"borderBottom"),new Gc(d,c,a,b)}return b=Ic(a,"borderLeftWidth"),c=Ic(a,"borderRightWidth"),d=Ic(a,"borderTopWidth"),a=Ic(a,"borderBottomWidth"),new Gc(parseFloat(d),parseFloat(c),parseFloat(a),parseFloat(b))}function ed(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}function fd(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}function hd(a,b,c,d,e){a[0]=b,a[1]=c,a[2]=d,a[3]=e}function id(){var a=Array(16);return jd(a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),a}function kd(){var a=Array(16);return jd(a,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),a}function jd(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){a[0]=b,a[1]=c,a[2]=d,a[3]=e,a[4]=f,a[5]=g,a[6]=h,a[7]=i,a[8]=j,a[9]=k,a[10]=l,a[11]=m,a[12]=n,a[13]=o,a[14]=p,a[15]=q}function ld(a,b){a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]}function md(a){a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1}function nd(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],i=a[5],j=a[6],k=a[7],l=a[8],m=a[9],n=a[10],o=a[11],p=a[12],q=a[13],r=a[14];a=a[15];var s=b[0],t=b[1],u=b[2],v=b[3],w=b[4],x=b[5],y=b[6],z=b[7],A=b[8],B=b[9],C=b[10],D=b[11],E=b[12],F=b[13],G=b[14];b=b[15],c[0]=d*s+h*t+l*u+p*v,c[1]=e*s+i*t+m*u+q*v,c[2]=f*s+j*t+n*u+r*v,c[3]=g*s+k*t+o*u+a*v,c[4]=d*w+h*x+l*y+p*z,c[5]=e*w+i*x+m*y+q*z,c[6]=f*w+j*x+n*y+r*z,c[7]=g*w+k*x+o*y+a*z,c[8]=d*A+h*B+l*C+p*D,c[9]=e*A+i*B+m*C+q*D,c[10]=f*A+j*B+n*C+r*D,c[11]=g*A+k*B+o*C+a*D,c[12]=d*E+h*F+l*G+p*b,c[13]=e*E+i*F+m*G+q*b,c[14]=f*E+j*F+n*G+r*b,c[15]=g*E+k*F+o*G+a*b}function od(a,b,c){var d=a[1]*b+a[5]*c+0*a[9]+a[13],e=a[2]*b+a[6]*c+0*a[10]+a[14],f=a[3]*b+a[7]*c+0*a[11]+a[15];a[12]=a[0]*b+a[4]*c+0*a[8]+a[12],a[13]=d,a[14]=e,a[15]=f}function pd(a,b,c){jd(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,1*a[8],1*a[9],1*a[10],1*a[11],a[12],a[13],a[14],a[15])}function qd(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=Math.cos(b),l=Math.sin(b);a[0]=c*k+g*l,a[1]=d*k+h*l,a[2]=e*k+i*l,a[3]=f*k+j*l,a[4]=c*-l+g*k,a[5]=d*-l+h*k,a[6]=e*-l+i*k,a[7]=f*-l+j*k}function rd(a,b){var c=wc("CANVAS");return s(a)&&(c.width=a),s(b)&&(c.height=b),c.getContext("2d")}function ud(a,b){var c=a.style;c.WebkitTransform=b,c.MozTransform=b,c.a=b,c.msTransform=b,c.transform=b,zb&&!vd&&(a.style.transformOrigin="0 0")}function wd(a,b){var c;if(td()){if(s(6)){var d=Array(16);for(c=0;16>c;++c)d[c]=b[c].toFixed(6);c=d.join(",")}else c=b.join(",");ud(a,"matrix3d("+c+")")}else if(sd()){if(d=[b[0],b[1],b[4],b[5],b[12],b[13]],s(6)){var e=Array(6);for(c=0;6>c;++c)e[c]=d[c].toFixed(6);c=e.join(",")}else c=d.join(",");ud(a,"matrix("+c+")")}else a.style.left=Math.round(b[12])+"px",a.style.top=Math.round(b[13])+"px"}function yd(a,b){var c,d,e=xd.length;for(d=0;e>d;++d)try{if(c=a.getContext(xd[d],b),null!==c)return c}catch(f){}return null}function Ld(){0!=Md&&(this.Ei=Error().stack,Nd[sa(this)]=this)}function Od(a,b){var c=za(Pd,b);a.Qa||(a.Qa=[]),a.Qa.push(xa(c,void 0))}function Pd(a){a&&"function"==typeof a.bc&&a.bc()}function Qd(a,b){this.type=a,this.d=this.target=b}function Rd(a){a.Ma()}function Sd(a){a.preventDefault()}function Xd(a){return Xd[" "](a),a}function Yd(a,b){a&&Zd(this,a,b)}function Zd(a,b,c){var d=a.type=b.type;if(Qd.call(a,d),a.target=b.target||b.srcElement,a.d=c,c=b.relatedTarget){if(Ab){var e;a:{try{Xd(c.nodeName),e=!0;break a}catch(f){}e=!1}e||(c=null)}}else"mouseover"==d?c=b.fromElement:"mouseout"==d&&(c=b.toElement);a.relatedTarget=c,a.offsetX=Bb||void 0!==b.offsetX?b.offsetX:b.layerX,a.offsetY=Bb||void 0!==b.offsetY?b.offsetY:b.layerY,a.clientX=void 0!==b.clientX?b.clientX:b.pageX,a.clientY=void 0!==b.clientY?b.clientY:b.pageY,a.screenX=b.screenX||0,a.screenY=b.screenY||0,a.button=b.button,a.Ya=b.keyCode||0,a.md=b.charCode||("keypress"==d?b.keyCode:0),a.lc=b.ctrlKey,a.na=b.altKey,a.Za=b.shiftKey,a.od=b.metaKey,a.Pb=rb?b.metaKey:b.ctrlKey,a.state=b.state,a.N=b,b.defaultPrevented&&a.preventDefault(),delete a.nb}function ae(a){return!((Td?0!=a.N.button:"click"==a.type?0:!(a.N.button&$d[0]))||Bb&&rb&&a.lc)}function ce(a){return!(!a||!a[be])}function ee(a,b,c,d,e,f){this.Na=a,this.a=b,this.src=c,this.type=d,this.capture=!!e,this.wb=f,this.key=++de,this.cb=this.Fb=!1}function fe(a){a.cb=!0,a.Na=null,a.a=null,a.src=null,a.wb=null}function z(a,b,c,d,e){if(ma(b)){for(var f=0;f<b.length;f++)z(a,b[f],c,d,e);return null}return c=ke(c),ce(a)?a.oa(b,c,d,e):le(a,b,c,!1,d,e)}function le(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");e=!!e;var g=he;b in g||(g[b]={L:0}),g=g[b],e in g||(g[e]={L:0},g.L++);var h,g=g[e],i=sa(a);if(g[i]){h=g[i];for(var j=0;j<h.length;j++)if(g=h[j],g.Na==c&&g.wb==f){if(g.cb)break;return d||(h[j].Fb=!1),h[j]}}else h=g[i]=[],g.L++;return j=me(),g=new ee(c,j,a,b,e,f),g.Fb=d,j.src=a,j.Na=g,h.push(g),ie[i]||(ie[i]=[]),ie[i].push(g),a.addEventListener?a.addEventListener(b,j,e):a.attachEvent(b in je?je[b]:je[b]="on"+b,j),ge[g.key]=g}function me(){var a=ne,b=Ud?function(c){return a.call(b.src,b.Na,c)}:function(c){return c=a.call(b.src,b.Na,c),c?void 0:c};return b}function oe(a,b,c,d,e){if(ma(b)){for(var f=0;f<b.length;f++)oe(a,b[f],c,d,e);return null}return c=ke(c),ce(a)?a.ga.add(b,c,!0,d,e):le(a,b,c,!0,d,e)}function pe(a,b,c,d,e){if(ma(b))for(var f=0;f<b.length;f++)pe(a,b[f],c,d,e);else if(c=ke(c),ce(a))a.Ed(b,c,d,e);else if(d=!!d,a=qe(a,b,d))for(f=0;f<a.length;f++)if(a[f].Na==c&&a[f].capture==d&&a[f].wb==e){re(a[f]);break}}function re(a){if(pa(a)||!a||a.cb)return!1;var b=a.src;if(ce(b))return se(b.ga,a);var c=a.type,d=a.a,e=a.capture;return b.removeEventListener?b.removeEventListener(c,d,e):b.detachEvent&&b.detachEvent(c in je?je[c]:je[c]="on"+c,d),b=sa(b),ie[b]&&(d=ie[b],Ua(d,a),0==d.length&&delete ie[b]),fe(a),(d=he[c][e][b])&&(Ua(d,a),0==d.length&&(delete he[c][e][b],he[c][e].L--),0==he[c][e].L&&(delete he[c][e],he[c].L--),0==he[c].L&&delete he[c]),delete ge[a.key],!0}function qe(a,b,c){var d=he;return b in d&&(d=d[b],c in d&&(d=d[c],a=sa(a),d[a]))?d[a]:null}function te(a){if(ce(a))return ue(a.ga,void 0);a=sa(a);var b=ie[a];if(b){var c=s(void 0),d=s(void 0);return c&&d?(b=he[void 0],!!b&&!!b[void 0]&&a in b[void 0]):c||d?Qa(b,function(a){return c&&void 0==a.type||d&&void 0==a.capture}):!0}return!1}function ve(a,b,c){var d=1;if(b=sa(b),a[b])for(a=Wa(a[b]),b=0;b<a.length;b++){var e=a[b];e&&!e.cb&&(d&=!1!==we(e,c))}return Boolean(d)}function we(a,b){var c=a.Na,d=a.wb||a.src;return a.Fb&&re(a),c.call(d,b)}function ne(a,b){if(a.cb)return!0;var c=a.type,d=he;if(!(c in d))return!0;var e,f,d=d[c];if(!Ud){if(!(c=b))a:{for(var c=["window","event"],g=ea;e=c.shift();){if(null==g[e]){c=null;break a}g=g[e]}c=g}if(e=c,c=!0 in d,g=!1 in d,c){if(0>e.keyCode||void 0!=e.returnValue)return!0;a:{var h=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(i){h=!0}(h||void 0==e.returnValue)&&(e.returnValue=!0)}}h=new Yd,Zd(h,e,this),e=!0;try{if(c){for(var j=[],k=h.d;k;k=k.parentNode)j.push(k);f=d[!0];for(var l=j.length-1;!h.nb&&l>=0;l--)h.d=j[l],e&=ve(f,j[l],h);if(g)for(f=d[!1],l=0;!h.nb&&l<j.length;l++)h.d=j[l],e&=ve(f,j[l],h)}else e=we(a,h)}finally{j&&(j.length=0)}return e}return d=new Yd(b,this),e=we(a,d)}function ke(a){return qa(a)?a:a[xe]||(a[xe]=function(b){return a.handleEvent(b)})}function ye(a){return function(){return a}}function Be(a){return a}function Ce(a){return function(){throw a}}function De(a){var b;return b=b||0,function(){return a.apply(this,Array.prototype.slice.call(arguments,0,b))}}function Ee(){var a=arguments,b=a.length;return function(){for(var c=0;b>c;c++)if(!a[c].apply(this,arguments))return!1;return!0}}function Fe(a){this.src=a,this.a={},this.d=0}function se(a,b){var c=b.type;if(!(c in a.a))return!1;var d=Ua(a.a[c],b);return d&&(fe(b),0==a.a[c].length&&(delete a.a[c],a.d--)),d}function ue(a,b){var c=s(b),d=s(void 0);return ac(a.a,function(a){for(var e=0;e<a.length;++e)if(!(c&&a[e].type!=b||d&&void 0!=a[e].capture))return!0;return!1})}function Ge(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.cb&&f.Na==b&&f.capture==!!c&&f.wb==d)return e}return-1}function He(){Ld.call(this),this.ga=new Fe(this),this.Je=this}function A(a,b){var c,d=a.xd;if(d)for(c=[];d;d=d.xd)c.push(d);var d=a.Je,e=b,f=e.type||e;if(oa(e))e=new Qd(e,d);else if(e instanceof Qd)e.target=e.target||d;else{var g=e,e=new Qd(f,d);lc(e,g)}var h,g=!0;if(c)for(var i=c.length-1;!e.nb&&i>=0;i--)h=e.d=c[i],g=Ie(h,f,!0,e)&&g;if(e.nb||(h=e.d=d,g=Ie(h,f,!0,e)&&g,e.nb||(g=Ie(h,f,!1,e)&&g)),c)for(i=0;!e.nb&&i<c.length;i++)h=e.d=c[i],g=Ie(h,f,!1,e)&&g;return g}function Ie(a,b,c,d){if(b=a.ga.a[b],!b)return!0;b=Wa(b);for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.cb&&g.capture==c){var h=g.Na,i=g.wb||g.src;g.Fb&&se(a.ga,g),e=!1!==h.call(i,d)&&e}}return e&&0!=d.we}function Je(){He.call(this),this.d=0}function Ke(a,b){Qd.call(this,a),this.key=b}function Le(a,b){this.target=a,this.key=b,this.d=this.a=Be}function Me(a){Je.call(this),sa(this),this.t={},this.da={},this.Db={},this.Eb={},s(a)&&this.H(a)}function Qe(a){return Ne.hasOwnProperty(a)?Ne[a]:Ne[a]="change:"+a.toLowerCase()}function Te(a,b){return function(c){c.key===b&&A(this,new Ke("beforepropertychange",a))
}}function Re(a,b){var c=Qe(b);A(a,c),A(a,new Ke("propertychange",b))}function Ue(a,b,c){Qd.call(this,a,c),this.element=b}function D(a){Me.call(this),this.a=a||[],Ve(this)}function Ve(a){a.v("length",a.a.length)}function We(a,b){return a[0]+=b[0],a[1]+=b[1],a}function Xe(a,b){var c=a[0],d=a[1],e=b[0],f=b[1],g=e[0],e=e[1],h=f[0],f=f[1],i=h-g,j=f-e,c=0===i&&0===j?0:(i*(c-g)+j*(d-e))/(i*i+j*j||0);return 0>=c||(c>=1?(g=h,e=f):(g+=c*i,e+=c*j)),[g,e]}function Ye(a,b){var c=Wb(a+180,360)-180,d=Math.abs(Math.round(3600*c));return Math.floor(d/3600)+" "+Math.floor(d/60%60)+" "+Math.floor(d%60)+" "+b.charAt(0>c?1:0)}function Ze(a,b,c){return s(a)?b.replace("{x}",a[0].toFixed(c)).replace("{y}",a[1].toFixed(c)):""}function $e(a,b){for(var c=!0,d=a.length-1;d>=0;--d)if(a[d]!=b[d]){c=!1;break}return c}function af(a,b){var c=Math.cos(b),d=Math.sin(b),e=a[1]*c+a[0]*d;return a[0]=a[0]*c-a[1]*d,a[1]=e,a}function bf(a,b){var c=a[0]-b[0],d=a[1]-b[1];return c*c+d*d}function cf(a,b){return Ze(a,"{x}, {y}",b)}function F(a){Me.call(this),a=s(a)?a:{},this.a=null,z(this,Qe("tracking"),this.h,!1,this),this.b(s(a.tracking)?a.tracking:!1)}function df(a,b,c){Qd.call(this,a),this.map=b,this.b=s(c)?c:null}function ef(a,b,c){Qd.call(this,a),this.a=b,a=s(c)?c:{},this.buttons=ff(a),this.yd=gf(a,this.buttons),this.bubbles=w(a,"bubbles",!1),this.cancelable=w(a,"cancelable",!1),this.view=w(a,"view",null),this.detail=w(a,"detail",null),this.screenX=w(a,"screenX",0),this.screenY=w(a,"screenY",0),this.clientX=w(a,"clientX",0),this.clientY=w(a,"clientY",0),this.c=w(a,"ctrlKey",!1),this.b=w(a,"altKey",!1),this.g=w(a,"shiftKey",!1),this.f=w(a,"metaKey",!1),this.button=w(a,"button",0),this.relatedTarget=w(a,"relatedTarget",null),this.pointerId=w(a,"pointerId",0),this.width=w(a,"width",0),this.height=w(a,"height",0),this.i=w(a,"tiltX",0),this.h=w(a,"tiltY",0),this.pointerType=w(a,"pointerType",""),this.e=w(a,"hwTimestamp",0),this.Mc=w(a,"isPrimary",!1),b.preventDefault&&(this.preventDefault=function(){b.preventDefault()})}function ff(a){if(a.buttons||hf)a=a.buttons;else switch(a.which){case 1:a=1;break;case 2:a=4;break;case 3:a=2;break;default:a=0}return a}function gf(a,b){var c=0;return c=a.yd?a.yd:b?.5:0}function kf(a,b){this.a=a,this.e=b}function lf(a){kf.call(this,a,{mousedown:this.ig,mousemove:this.jg,mouseup:this.mg,mouseover:this.lg,mouseout:this.kg}),this.d=a.d,this.b=[]}function mf(a,b){for(var c,d=a.b,e=b.clientX,f=b.clientY,g=0,h=d.length;h>g&&(c=d[g]);g++){var i=Math.abs(f-c[1]);if(25>=Math.abs(e-c[0])&&25>=i)return!0}return!1}function nf(a){var b=of(a,a.N),c=b.preventDefault;return b.preventDefault=function(){a.preventDefault(),c()},b.pointerId=1,b.Mc=!0,b.pointerType="mouse",b}function vf(a){kf.call(this,a,{MSPointerDown:this.rg,MSPointerMove:this.sg,MSPointerUp:this.vg,MSPointerOut:this.tg,MSPointerOver:this.ug,MSPointerCancel:this.qg,MSGotPointerCapture:this.og,MSLostPointerCapture:this.pg}),this.d=a.d,this.b=["","unavailable","touch","pen","mouse"]}function wf(a,b){var c=b;return pa(b.N.pointerType)&&(c=of(b,b.N),c.pointerType=a.b[b.N.pointerType]),c}function xf(a){kf.call(this,a,{pointerdown:this.Hh,pointermove:this.Ih,pointerup:this.Lh,pointerout:this.Jh,pointerover:this.Kh,pointercancel:this.Gh,gotpointercapture:this.Df,lostpointercapture:this.gg})}function zf(a,b){kf.call(this,a,{touchstart:this.gi,touchmove:this.fi,touchend:this.ei,touchcancel:this.di}),this.d=a.d,this.g=b,this.b=void 0,this.f=0,this.c=void 0}function Af(a,b,c){var d=Wa(b.N.changedTouches),d=Pa(d,za(a.ci,b),a);Oa(d,function(a){a.preventDefault=function(){b.preventDefault()}},a),Oa(d,za(c,b),a)}function Bf(a,b){var c=b.N.touches;if(bc(a.d)>=c.length){var d=[];$b(a.d,function(a,b){var e;if(!(e=1==b))a:{e=c.length;for(var f,g=0;e>g;g++)if(f=c[g],f.identifier===b-2){e=!0;break a}e=!1}e||d.push(a.yb)},a),Oa(d,za(a.fd,b),a)}}function Cf(a,b){var c=a.g.b,d=b.N.changedTouches[0];if(a.b===d.identifier){var e=[d.clientX,d.clientY];c.push(e),ea.setTimeout(function(){Ua(c,e)},2500)}}function Gf(a){He.call(this),this.c=a,this.d={},this.b={},this.a=[],Id?Hf(this,new xf(this)):Jd?Hf(this,new vf(this)):(a=new lf(this),Hf(this,a),Hd&&Hf(this,new zf(this,a))),a=this.a.length;for(var b,c=0;a>c;c++)b=this.a[c],If(this,dc(b.e))}function Hf(a,b){var c=dc(b.e);c&&(Oa(c,function(a){var c=b.e[a];c&&(this.b[a]=xa(c,b))},a),a.a.push(b))}function If(a,b){Oa(b,function(a){z(this.c,a,this.e,!1,this)},a)}function Jf(a,b){Oa(b,function(a){pe(this.c,a,this.e,!1,this)},a)}function of(a,b){for(var c,d={},e=0,f=Kf.length;f>e;e++)c=Kf[e][0],d[c]=a[c]||b[c]||Kf[e][1];return d}function uf(a,b,c){a.yb(b,c),b.target.contains(b.relatedTarget)||(b.bubbles=!1,pf(a,Ff,b,c))}function tf(a,b,c){b.bubbles=!0,pf(a,Df,b,c),b.target.contains(b.relatedTarget)||(b.bubbles=!1,pf(a,Ef,b,c))}function pf(a,b,c,d){A(a,new ef(b,d,c))}function yf(a,b){A(a,new ef(b.type,b,b.N))}function Nf(a,b,c,d){df.call(this,a,b,d),this.a=c,this.originalEvent=c.N,this.coordinate=b.Td(this.originalEvent),this.pixel=b.kd(this.originalEvent)}function Of(a,b,c,d){Nf.call(this,a,b,c.a,d),this.c=c}function Pf(a){He.call(this),this.d=a,this.e=0,this.i=!1,this.f=this.g=this.b=null,a=this.d.b,this.t=0,this.l={},this.c=new Gf(a),this.a=null,this.g=z(this.c,qf,this.Tf,!1,this),this.h=z(this.c,rf,this.Qh,!1,this)}function Qf(a,b){var c;c=new Of(Rf,a.d,b),A(a,c),0!==a.e?(ea.clearTimeout(a.e),a.e=0,c=new Of(Sf,a.d,b),A(a,c)):a.e=ea.setTimeout(xa(function(){this.e=0;var a=new Of(Tf,this.d,b);A(this,a)},a),250)}function Uf(a,b){b.type==Vf||b.type==Wf?delete a.l[b.pointerId]:b.type==Xf&&(a.l[b.pointerId]=!0),a.t=bc(a.l)}function ag(a){return a=a.a,a.na&&!a.Pb&&a.Za}function bg(a){return a.type==Tf}function cg(a){return a=a.a,!a.na&&!a.Pb&&!a.Za}function dg(a){return a=a.a,!a.na&&!a.Pb&&a.Za}function eg(a){return a=a.a.target.tagName,"INPUT"!==a&&"SELECT"!==a&&"TEXTAREA"!==a}function fg(a){return 1==a.c.pointerId}function gg(a){return function(b){return s(b)?[Vb(b[0],a[0],a[2]),Vb(b[1],a[1],a[3])]:void 0}}function hg(a){return a}function ig(a,b){var c,d;for(c=0,d=b.length;d>c;++c)a.push(b[c])}function jg(a,b,c){var d=a.length;if(a[0]<=b)return 0;if(!(b<=a[d-1]))if(c>0){for(c=1;d>c;++c)if(a[c]<b)return c-1}else if(0>c){for(c=1;d>c;++c)if(a[c]<=b)return c}else for(c=1;d>c;++c){if(a[c]==b)return c;if(a[c]<b)return a[c-1]-b<b-a[c]?c-1:c}return d-1}function kg(a){return function(b,c,d){return s(b)?(b=jg(a,b,d),b=Vb(b+c,0,a.length-1),a[b]):void 0}}function lg(a,b,c){return function(d,e,f){return s(d)?(f=f>0?0:0>f?1:.5,d=Math.floor(Math.log(b/d)/Math.log(a)+f),e=Math.max(d+e,0),s(c)&&(e=Math.min(e,c)),b/Math.pow(a,e)):void 0}}function mg(a){return s(a)?0:void 0}function ng(a,b){return s(a)?a+b:void 0}function og(a){var b=2*Math.PI/a;return function(a,c){return s(a)?a=Math.floor((a+c)/b+.5)*b:void 0}}function pg(){var a=Xb(5);return function(b,c){return s(b)?Math.abs(b+c)<=a?0:b+c:void 0}}function qg(a,b,c){this.center=a,this.resolution=b,this.rotation=c}function rg(){Me.call(this),this.h=[0,0]}function sg(a,b){a.h[1]+=b}function tg(a){for(var b=ug(),c=0,d=a.length;d>c;++c){var e=b,f=a[c];f[0]<e[0]&&(e[0]=f[0]),f[0]>e[2]&&(e[2]=f[0]),f[1]<e[1]&&(e[1]=f[1]),f[1]>e[3]&&(e[3]=f[1])}return b}function vg(a,b,c){var d=Math.min.apply(null,a),e=Math.min.apply(null,b);return a=Math.max.apply(null,a),b=Math.max.apply(null,b),wg(d,e,a,b,c)}function xg(a,b,c){return s(c)?(c[0]=a[0]-b,c[1]=a[1]-b,c[2]=a[2]+b,c[3]=a[3]+b,c):[a[0]-b,a[1]-b,a[2]+b,a[3]+b]}function yg(a,b){return s(b)?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a.slice()}function zg(a,b,c){return b=b<a[0]?a[0]-b:a[2]<b?b-a[2]:0,a=c<a[1]?a[1]-c:a[3]<c?c-a[3]:0,b*b+a*a}function Ag(a,b){return a[0]<=b[0]&&b[2]<=a[2]&&a[1]<=b[1]&&b[3]<=a[3]}function ug(){return[1/0,1/0,-1/0,-1/0]}function wg(a,b,c,d,e){return s(e)?(e[0]=a,e[1]=b,e[2]=c,e[3]=d,e):[a,b,c,d]}function Bg(a){return wg(1/0,1/0,-1/0,-1/0,a)}function Cg(a,b){return a[0]==b[0]&&a[2]==b[2]&&a[1]==b[1]&&a[3]==b[3]}function Dg(a,b){return b[0]<a[0]&&(a[0]=b[0]),b[2]>a[2]&&(a[2]=b[2]),b[1]<a[1]&&(a[1]=b[1]),b[3]>a[3]&&(a[3]=b[3]),a}function Eg(a,b,c,d,e){for(;d>c;c+=e){var f=a,g=b[c],h=b[c+1];f[0]=Math.min(f[0],g),f[1]=Math.min(f[1],h),f[2]=Math.max(f[2],g),f[3]=Math.max(f[3],h)}return a}function Fg(a){return[a[0],a[1]]}function Gg(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]}function Hg(a,b,c,d){var e=b*d[0]/2;d=b*d[1]/2,b=Math.cos(c),c=Math.sin(c),e=[-e,-e,e,e],d=[-d,d,-d,d];var f,g,h;for(f=0;4>f;++f)g=e[f],h=d[f],e[f]=a[0]+g*b-h*c,d[f]=a[1]+g*c+h*b;return vg(e,d,void 0)}function Jg(a){return a[3]-a[1]}function Kg(a){return[a[0],a[3]]}function Lg(a){return a[2]-a[0]}function Mg(a,b){return a[0]<=b[2]&&a[2]>=b[0]&&a[1]<=b[3]&&a[3]>=b[1]}function Ng(a){return a[2]<a[0]||a[3]<a[1]}function Og(a,b){return s(b)?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a}function Pg(a,b){var c=(a[2]-a[0])/2*(b-1),d=(a[3]-a[1])/2*(b-1);a[0]-=c,a[2]+=c,a[1]-=d,a[3]+=d}function Qg(a,b){return Mg(a,b)&&(a[0]==b[2]||a[2]==b[0]||a[1]==b[3]||a[3]==b[1])}function Rg(a,b,c){return a=[a[0],a[1],a[0],a[3],a[2],a[1],a[2],a[3]],b(a,a,2),vg([a[0],a[2],a[4],a[6]],[a[1],a[3],a[5],a[7]],c)}function Sg(){Je.call(this),this.extent=void 0,this.f=-1,this.g={},this.l=this.i=0}function Tg(a,b,c,d){var e=c[0],f=c[1],g=c[4],h=c[5],i=c[12];c=c[13];var j,k,l=s(d)?d:[],m=0;for(j=0,k=a.length;k>j;j+=b){var n=a[j],o=a[j+1];l[m++]=e*n+g*o+i,l[m++]=f*n+h*o+c}return s(d)&&l.length!=m&&(l.length=m),l}function Ug(){Sg.call(this),this.b="XY",this.a=2,this.j=null}function Vg(a){if("XY"==a)return 2;if("XYZ"==a||"XYM"==a)return 3;if("XYZM"==a)return 4;throw Error("unsupported layout: "+a)}function Wg(a,b,c){a.a=Vg(b),a.b=b,a.j=c}function Xg(a,b,c,d){if(s(b))c=Vg(b);else{for(b=0;d>b;++b){if(0===c.length)return a.b="XY",void(a.a=2);c=c[0]}if(c=c.length,2==c)b="XY";else if(3==c)b="XYZ";else{if(4!=c)throw Error("unsupported stride: "+c);b="XYZM"}}a.b=b,a.a=c}function Yg(a,b,c){var d=a.j;return null===d?null:Tg(d,a.a,b,c)}function Zg(a,b,c,d){for(var e=0,f=a[c-d],g=a[c-d+1];c>b;b+=d)var h=a[b],i=a[b+1],e=e+(g*h-f*i),f=h,g=i;return e/2}function $g(a,b,c,d){var e,f,g=0;for(e=0,f=c.length;f>e;++e){var h=c[e],g=g+Zg(a,b,h,d);b=h}return g}function ah(a,b,c,d){return a=c-a,b=d-b,a*a+b*b}function bh(a,b,c,d,e,f,g){var h=a[b],i=a[b+1],j=a[c]-h,k=a[c+1]-i;if(0!==j||0!==k)if(f=((e-h)*j+(f-i)*k)/(j*j+k*k),f>1)b=c;else if(f>0){for(e=0;d>e;++e)g[e]=a[b+e]+f*(a[c+e]-a[b+e]);return void(g.length=d)}for(e=0;d>e;++e)g[e]=a[b+e];g.length=d}function ch(a,b,c,d,e){var f=a[b],g=a[b+1];for(b+=d;c>b;b+=d){var h=a[b],i=a[b+1],f=ah(f,g,h,i);f>e&&(e=f),f=h,g=i}return e}function dh(a,b,c,d,e){var f,g;for(f=0,g=c.length;g>f;++f){var h=c[f];e=ch(a,b,h,d,e),b=h}return e}function eh(a,b,c,d,e,f,g,h,i,j,k){if(b==c)return j;var l;if(0===e){if(l=ah(g,h,a[b],a[b+1]),j>l){for(k=0;d>k;++k)i[k]=a[b+k];return i.length=d,l}return j}for(var m=s(k)?k:[0/0,0/0],n=b+d;c>n;)if(bh(a,n-d,n,d,g,h,m),l=ah(g,h,m[0],m[1]),j>l){for(j=l,k=0;d>k;++k)i[k]=m[k];i.length=d,n+=d}else n+=d*Math.max((Math.sqrt(l)-Math.sqrt(j))/e|0,1);if(f&&(bh(a,c-d,b,d,g,h,m),l=ah(g,h,m[0],m[1]),j>l)){for(j=l,k=0;d>k;++k)i[k]=m[k];i.length=d}return j}function fh(a,b,c,d,e,f,g,h,i,j,k){k=s(k)?k:[0/0,0/0];var l,m;for(l=0,m=c.length;m>l;++l){var n=c[l];j=eh(a,b,n,d,e,f,g,h,i,j,k),b=n}return j}function gh(a,b){var c,d,e=0;for(c=0,d=b.length;d>c;++c)a[e++]=b[c];return e}function hh(a,b,c,d){var e,f;for(e=0,f=c.length;f>e;++e){var g,h=c[e];for(g=0;d>g;++g)a[b++]=h[g]}return b}function ih(a,b,c,d,e){e=s(e)?e:[];var f,g,h=0;for(f=0,g=c.length;g>f;++f)b=hh(a,b,c[f],d),e[h++]=b;return e.length=h,e}function jh(a,b,c,d,e){e=s(e)?e:[];for(var f=0;c>b;b+=d)e[f++]=a.slice(b,b+d);return e.length=f,e}function kh(a,b,c,d,e){e=s(e)?e:[];var f,g,h=0;for(f=0,g=c.length;g>f;++f){var i=c[f];e[h++]=jh(a,b,i,d,e[h]),b=i}return e.length=h,e}function lh(a,b,c,d,e,f,g){var h=(c-b)/d;if(3>h){for(;c>b;b+=d)f[g++]=a[b],f[g++]=a[b+1];return g}var i=Array(h);i[0]=1,i[h-1]=1,c=[b,c-d];for(var j,k=0;0<c.length;){var l=c.pop(),m=c.pop(),n=0,o=a[m],p=a[m+1],q=a[l],r=a[l+1];for(j=m+d;l>j;j+=d){var s;s=a[j];var t=a[j+1],u=o,v=p,w=q-u,x=r-v;if(0!==w||0!==x){var y=((s-u)*w+(t-v)*x)/(w*w+x*x);y>1?(u=q,v=r):y>0&&(u+=w*y,v+=x*y)}s=ah(s,t,u,v),s>n&&(k=j,n=s)}n>e&&(i[(k-b)/d]=1,k>m+d&&c.push(m,k),l>k+d&&c.push(k,l))}for(j=0;h>j;++j)i[j]&&(f[g++]=a[b+j*d],f[g++]=a[b+j*d+1]);return g}function mh(a,b,c,d,e,f,g,h){var i,j;for(i=0,j=c.length;j>i;++i){var k=c[i];a:{var l=a,m=k,n=d,o=e,p=f;if(b!=m){var q=o*Math.round(l[b]/o),r=o*Math.round(l[b+1]/o);b+=n,p[g++]=q,p[g++]=r;var s=void 0,t=void 0;do if(s=o*Math.round(l[b]/o),t=o*Math.round(l[b+1]/o),b+=n,b==m){p[g++]=s,p[g++]=t;break a}while(s==q&&t==r);for(;m>b;){var u,v;if(u=o*Math.round(l[b]/o),v=o*Math.round(l[b+1]/o),b+=n,u!=s||v!=t){var w=s-q,x=t-r,y=u-q,z=v-r;w*z==x*y&&(0>w&&w>y||w==y||w>0&&y>w)&&(0>x&&x>z||x==z||x>0&&z>x)||(p[g++]=s,p[g++]=t,q=s,r=t),s=u,t=v}}p[g++]=s,p[g++]=t}}h.push(g),b=k}return g}function nh(a,b){Ug.call(this),this.c=this.h=-1,this.P(a,b)}function oh(a,b,c){Wg(a,b,c),a.k()}function ph(a,b){Ug.call(this),this.P(a,b)}function qh(a,b,c){Wg(a,b,c),a.k()}function rh(a,b,c,d,e,f){for(var g=!1,h=a[c-d],i=a[c-d+1];c>b;b+=d){var j=a[b],k=a[b+1];i>f!=k>f&&(j-h)*(f-i)/(k-i)+h>e&&(g=!g),h=j,i=k}return g}function sh(a,b,c,d,e,f){if(0===c.length||!rh(a,b,c[0],d,e,f))return!1;var g;for(b=1,g=c.length;g>b;++b)if(rh(a,c[b-1],c[b],d,e,f))return!1;return!0}function th(a,b,c,d,e,f,g){var h,i,j,k,l,m=e[f+1],n=[],o=c[0];for(j=a[o-d],l=a[o-d+1],h=b;o>h;h+=d)k=a[h],i=a[h+1],(l>=m&&m>=i||m>=l&&i>=m)&&(j=(m-l)/(i-l)*(k-j)+j,n.push(j)),j=k,l=i;for(o=0/0,l=-1/0,n.sort(),j=n[0],h=1,i=n.length;i>h;++h){k=n[h];var p=Math.abs(k-j);p>l&&(j=(j+k)/2,sh(a,b,c,d,j,m)&&(o=j,l=p)),j=k}return isNaN(o)&&(o=e[f]),s(g)?(g.push(o,m),g):[o,m]}function uh(a,b,c,d){for(var e=0,f=a[c-d],g=a[c-d+1];c>b;b+=d)var h=a[b],i=a[b+1],e=e+(h-f)*(i+g),f=h,g=i;return e>0}function vh(a,b,c){var d,e,f=0;for(d=0,e=b.length;e>d;++d){var g=b[d],f=uh(a,f,g,c);if(0===d?!f:f)return!1;f=g}return!0}function wh(a,b,c,d){var e,f;for(e=0,f=c.length;f>e;++e){var g=c[e],h=uh(a,b,g,d);if(0===e?!h:h)for(var h=a,i=g,j=d;i-j>b;){var k;for(k=0;j>k;++k){var l=h[b+k];h[b+k]=h[i-j+k],h[i-j+k]=l}b+=j,i-=j}b=g}return b}function G(a,b){Ug.call(this),this.c=[],this.t=-1,this.n=null,this.A=this.o=this.w=-1,this.h=null,this.P(a,b)}function zh(a){if(a.t!=a.d){var b=Gg(a.u());a.n=th(yh(a),0,a.c,a.a,b,0),a.t=a.d}return a.n}function yh(a){if(a.A!=a.d){var b=a.j;vh(b,a.c,a.a)?a.h=b:(a.h=b.slice(),a.h.length=wh(a.h,0,a.c,a.a)),a.A=a.d}return a.h}function xh(a,b,c,d){Wg(a,b,c),a.c=d,a.k()}function Ah(a){this.radius=a}function Bh(a,b,c){var d=Xb(b[1]),e=Xb(c[1]),f=(e-d)/2;return b=Xb(c[0]-b[0])/2,d=Math.sin(f)*Math.sin(f)+Math.sin(b)*Math.sin(b)*Math.cos(d)*Math.cos(e),2*a.radius*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))}function Fh(a){this.a=a.code,this.Fa=a.units,this.t=s(a.extent)?a.extent:null,this.e=s(a.axisOrientation)?a.axisOrientation:"enu",this.l=s(a.global)?a.global:!1,this.i=null}function Gh(a){return a.e}function Hh(a,b){var c={units:a.units,axisOrientation:a.axis};lc(c,b),Fh.call(this,c),this.h=a,this.g=null}function Kh(a){return a.h}function Oh(a){Ph(a),Oa(a,function(b){Oa(a,function(a){b!==a&&Qh(b,a,Rh)})})}function Sh(){var a=Th,b=Uh,c=Vh;Oa(Wh,function(d){Oa(a,function(a){Qh(d,a,b),Qh(a,d,c)})})}function Xh(a){Mh[a.a]=a,Qh(a,a,Rh)}function Ph(a){Oa(a,function(a){Xh(a)})}function Zh(a){return null!=a?oa(a)?$h(a):a:$h("EPSG:3857")}function Qh(a,b,c){a=a.a,b=b.a,a in Nh||(Nh[a]={}),Nh[a][b]=c}function $h(a){var b;return a instanceof Fh?b=a:oa(a)?(b=Mh[a],Eh&&!s(b)&&(b=Jh({code:a,extent:null})),s(b)||(b=null)):b=null,b}function Jh(a){var b=a.code,c=Lh[b];if(!s(c)){var d=new Proj4js.Proj(b),e=d.srsCode,c=Lh[e];s(c)||(a=jc(a),a.code=e,c=new Hh(d,a),Lh[e]=c),Lh[b]=c}return c}function ai(a,b){var c=$h(a),d=$h(b);return Ih(c,d)}function Ih(a,b){var c,d=a.a,e=b.a;if(d in Nh&&e in Nh[d]&&(c=Nh[d][e]),Eh&&!s(c)){var f=Kh(a instanceof Hh?a:Jh({code:d,extent:null})),g=Kh(b instanceof Hh?b:Jh({code:e,extent:null}));c=function(a,b,c){var d=a.length;c=c>1?c:2,s(b)||(b=c>2?a.slice():Array(d));for(var e,h=0;d>h;h+=c)e=new Proj4js.Point(a[h],a[h+1]),e=Proj4js.transform(f,g,e),b[h]=e.x,b[h+1]=e.y;return b},Qh(a,b,c)}return s(c)||(c=bi),c}function bi(a,b){if(s(b)&&a!==b){for(var c=0,d=a.length;d>c;++c)b[c]=a[c];a=b}return a}function Rh(a,b){var c;if(s(b)){c=0;for(var d=a.length;d>c;++c)b[c]=a[c];c=b}else c=a.slice();return c}function H(a){rg.call(this),a=s(a)?a:{};var b={};b.center=s(a.center)?a.center:null,b.projection=Zh(a.projection);var c,d,e;if(s(a.resolutions))c=a.resolutions,d=c[0],e=c[c.length-1],c=kg(c);else{d=a.maxResolution,s(d)||(d=a.projection,e=Zh(d).u(),d=(null===e?360*Dh.degrees/Dh[d.Fa]:Math.max(e[2]-e[0],e[3]-e[1]))/256),c=a.maxZoom,s(c)||(c=28);var f=a.zoomFactor;s(f)||(f=2),e=d/Math.pow(f,c),c=lg(f,d,c)}this.g=d,this.l=e,(s(a.enableRotation)?a.enableRotation:1)?(d=a.constrainRotation,d=s(d)&&!0!==d?!1===d?ng:pa(d)?og(d):ng:pg()):d=mg,this.f=new qg(s(a.extent)?gg(a.extent):hg,c,d),s(a.resolution)?b.resolution=a.resolution:s(a.zoom)&&(b.resolution=this.constrainResolution(this.g,a.zoom)),b.rotation=s(a.rotation)?a.rotation:0,this.H(b)}function ci(a,b){return Math.max(Lg(a)/b[0],Jg(a)/b[1])}function di(a){var b=a.g,c=Math.log(b/a.l)/Math.log(2);return function(a){return b/Math.pow(2,a*c)}}function ei(a){var b=a.g,c=Math.log(b/a.l)/Math.log(2);return function(a){return Math.log(b/a)/Math.log(2)/c}}function fi(a){var b=a.a(),c=a.i(),d=a.b();return a=a.e(),{center:b.slice(),projection:s(c)?c:null,resolution:d,rotation:s(a)?a:0}}function gi(a){return 1-Math.pow(1-a,3)}function hi(a){return 3*a*a-2*a*a*a}function ii(a){return a}function ji(a){return.5>a?hi(2*a):1-hi(2*(a-.5))}function ki(a){var b=a.source,c=s(a.start)?a.start:Aa(),d=b[0],e=b[1],f=s(a.duration)?a.duration:1e3,g=s(a.easing)?a.easing:hi;return function(a,b){if(b.time<c)return b.animate=!0,b.viewHints[0]+=1,!0;if(b.time<c+f){var h=1-g((b.time-c)/f),i=d-b.view2DState.center[0],j=e-b.view2DState.center[1];return b.animate=!0,b.view2DState.center[0]+=h*i,b.view2DState.center[1]+=h*j,b.viewHints[0]+=1,!0}return!1}}function li(a){var b=s(a.rotation)?a.rotation:0,c=s(a.start)?a.start:Aa(),d=s(a.duration)?a.duration:1e3,e=s(a.easing)?a.easing:hi,f=s(a.anchor)?a.anchor:null;return function(a,g){if(g.time<c)return g.animate=!0,g.viewHints[0]+=1,!0;if(g.time<c+d){var h=1-e((g.time-c)/d),h=(b-g.view2DState.rotation)*h;if(g.animate=!0,g.view2DState.rotation+=h,null!==f){var i=g.view2DState.center;i[0]-=f[0],i[1]-=f[1],af(i,h),We(i,f)}return g.viewHints[0]+=1,!0}return!1}}function mi(a){var b=a.resolution,c=s(a.start)?a.start:Aa(),d=s(a.duration)?a.duration:1e3,e=s(a.easing)?a.easing:hi;return function(a,f){if(f.time<c)return f.animate=!0,f.viewHints[0]+=1,!0;if(f.time<c+d){var g=1-e((f.time-c)/d),h=b-f.view2DState.resolution;return f.animate=!0,f.view2DState.resolution+=g*h,f.viewHints[0]+=1,!0}return!1}}function ni(){Je.call(this),this.g=null}function oi(a,b,c,d,e){if(null!=c){var f=b.e(),g=b.a();s(f)&&s(g)&&s(e)&&e>0&&(a.Ha(li({rotation:f,duration:e,easing:gi})),s(d)&&a.Ha(ki({source:g,duration:e,easing:gi}))),b.ie(c,d)}}function pi(a,b,c,d,e){var f=b.b();c=b.constrainResolution(f,c,0),qi(a,b,c,d,e)}function qi(a,b,c,d,e){if(null!=c){var f=b.b(),g=b.a();if(s(f)&&s(g)&&s(e)&&e>0&&(a.Ha(mi({resolution:f,duration:e,easing:gi})),s(d)&&a.Ha(ki({source:g,duration:e,easing:gi}))),null!=d){var h;a=b.a(),e=b.b(),s(a)&&s(e)&&(h=[d[0]-c*(d[0]-a[0])/e,d[1]-c*(d[1]-a[1])/e]),b.ya(h)}b.c(c)}}function ri(){ni.call(this),this.i=!1,this.t={},this.b=[]}function si(a){for(var b=a.length,c=0,d=0,e=0;b>e;e++)c+=a[e].clientX,d+=a[e].clientY;return[c/b,d/b]}function ti(a,b,c,d,e,f){Qd.call(this,a,b),this.vectorContext=c,this.frameState=d,this.context=e,this.glContext=f}function ui(a){this.b=this.d=this.e=this.c=this.a=null,this.f=a}function vi(a){var b=a.e,c=a.d;return a=Pa([b,[b[0],c[1]],c,[c[0],b[1]]],a.a.va,a.a),a[4]=a[0].slice(),new G([a])}function wi(a){null===a.a||null===a.e||null===a.d||a.a.R()}function xi(a,b){Qd.call(this,a),this.coordinate=b}function yi(a){ri.call(this),a=s(a)?a:{},this.c=new ui(s(a.style)?a.style:null),this.a=null,this.e=s(a.condition)?a.condition:Ae}function Di(a){if(!oa(a)){var b=a[0];b!=(0|b)&&(b=b+.5|0);var c=a[1];c!=(0|c)&&(c=c+.5|0);var d=a[2];d!=(0|d)&&(d=d+.5|0),a="rgba("+b+","+c+","+d+","+a[3]+")"}return a}function Ei(a){var b=!1;zi.hasOwnProperty(a)&&(a=zi[a],b=!0);var c,d;if(b||Ai.exec(a))return d=3==a.length-1?1:2,b=parseInt(a.substr(1+0*d,d),16),c=parseInt(a.substr(1+1*d,d),16),a=parseInt(a.substr(1+2*d,d),16),1==d&&(b=(b<<4)+b,c=(c<<4)+c,a=(a<<4)+a),b=[b,c,a,1];if(d=Ci.exec(a))return b=Number(d[1]),c=Number(d[2]),a=Number(d[3]),d=Number(d[4]),b=[b,c,a,d],Gi(b,b);if(d=Bi.exec(a))return b=Number(d[1]),c=Number(d[2]),a=Number(d[3]),b=[b,c,a,1],Gi(b,b);throw Error(a+" is not a valid color")}function Gi(a,b){var c=s(b)?b:[];return c[0]=Vb(a[0]+.5|0,0,255),c[1]=Vb(a[1]+.5|0,0,255),c[2]=Vb(a[2]+.5|0,0,255),c[3]=Vb(a[3],0,1),c}function Ki(a){a=s(a)?a:{},this.a=s(a.color)?a.color:null}function Li(a){this.t=a.opacity,this.n=a.rotateWithView,this.e=a.rotation,this.f=a.scale,this.o=a.Be}function Mi(a){a=s(a)?a:{},this.a=s(a.color)?a.color:null,this.b=a.lineCap,this.c=s(a.lineDash)?a.lineDash:null,this.e=a.lineJoin,this.f=a.miterLimit,this.d=a.width}function Ni(a){a=s(a)?a:{},this.h=wc("CANVAS"),this.d=null,this.b=s(a.fill)?a.fill:null,this.c=a.radius,this.a=s(a.stroke)?a.stroke:null,a=this.h;var b,c;null===this.a?c=0:(b=Di(this.a.a),c=this.a.d,s(c)||(c=1));var d=2*(this.c+c)+1;a.height=d,a.width=d;var e=a.getContext("2d");e.arc(d/2,d/2,this.c,0,2*Math.PI,!0),null!==this.b&&(e.fillStyle=Di(this.b.a),e.fill()),null!==this.a&&(e.strokeStyle=b,e.lineWidth=c,e.stroke()),null===this.b?(a=this.d=wc("CANVAS"),a.height=d,a.width=d,e=a.getContext("2d"),e.arc(d/2,d/2,this.c,0,2*Math.PI,!0),e.fillStyle=Hi,e.fill(),null!==this.a&&(e.strokeStyle=b,e.lineWidth=c,e.stroke())):this.d=a,this.l=[d/2,d/2],this.w=[d,d],Li.call(this,{opacity:1,rotateWithView:!1,rotation:0,scale:1,Be:void 0})}function Oi(a){a=s(a)?a:{},this.c=s(a.fill)?a.fill:null,this.e=s(a.image)?a.image:null,this.b=s(a.stroke)?a.stroke:null,this.d=s(a.text)?a.text:null,this.a=a.zIndex}function I(a){Me.call(this),this.Z=void 0,this.a="geometry",this.f=null,this.e=void 0,this.c=null,z(this,Qe(this.a),this.Kc,!1,this),null!=a?a instanceof Sg?this.pb(a):this.H(a):this.pb(null)}function Pi(){var a=new Ki({color:"rgba(255,255,255,0.4)"}),b=new Mi({color:"#3399CC",width:1.25}),c=[new Oi({image:new Ni({fill:a,stroke:b,radius:5}),fill:a,stroke:b})];return Pi=function(){return c},c}function Qi(a,b){var c=a.e;return s(c)||(c=Pi),c.call(a,b)}function Ri(a){return qa(a)||(a=ma(a)?a:[a],a=ye(a)),a}function Si(){var a={},b=[255,255,255,1],c=[0,153,255,1];return a.Polygon=[new Oi({fill:new Ki({color:[255,255,255,.5]})})],a.MultiPolygon=a.Polygon,a.LineString=[new Oi({stroke:new Mi({color:b,width:5})}),new Oi({stroke:new Mi({color:c,width:3})})],a.MultiLineString=a.LineString,a.Point=[new Oi({image:new Ni({radius:6,fill:new Ki({color:c}),stroke:new Mi({color:b,width:1.5})}),zIndex:1/0})],a.MultiPoint=a.Point,a.GeometryCollection=a.Polygon.concat(a.Point),a}function Ti(a){a=s(a)?a:{},this.g=this.c=this.e=this.d=this.b=this.a=null,this.f=s(a.style)?Ri(a.style):void 0,this.tc(s(a.features)?ma(a.features)?new D(Wa(a.features)):a.features:new D),s(a.map)&&this.setMap(a.map)}function Ui(a){null===a.e||a.e.R()}function Vi(a){if("function"==typeof a.La)return a.La();if(oa(a))return a.split("");if(na(a)){for(var b=[],c=a.length,d=0;c>d;d++)b.push(a[d]);return b}return cc(a)}function Wi(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(na(a)||oa(a))Oa(a,b,c);else{var d;if("function"==typeof a.K)d=a.K();else if("function"!=typeof a.La)if(na(a)||oa(a)){d=[];for(var e=a.length,f=0;e>f;f++)d.push(f)}else d=dc(a);else d=void 0;for(var e=Vi(a),f=e.length,g=0;f>g;g++)b.call(c,e[g],d&&d[g],a)}}function Xi(a){this.d={},this.a=[];var b=arguments.length;if(b>1){if(b%2)throw Error("Uneven number of arguments");for(var c=0;b>c;c+=2)Yi(this,arguments[c],arguments[c+1])}else if(a){a instanceof Xi?(b=a.K(),c=a.La()):(b=dc(a),c=cc(a));for(var d=0;d<b.length;d++)Yi(this,b[d],c[d])}}function Zi(a){if(a.L!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];$i(a.d,d)&&(a.a[c++]=d),b++}a.a.length=c}if(a.L!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],$i(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}function Yi(a,b,c){$i(a.d,b)||(a.L++,a.a.push(b),a.Hd++),a.d[b]=c}function $i(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function bj(a){if(cj){cj=!1;var b=ea.location;if(b){var c=b.href;if(c&&(c=(c=bj(c)[3]||null)&&decodeURIComponent(c))&&c!=b.hostname)throw cj=!0,Error()}}return a.match(aj)}function dj(a){if(a[1]){var b=a[0],c=b.indexOf("#");c>=0&&(a.push(b.substr(c)),a[0]=b=b.substr(0,c)),c=b.indexOf("?"),0>c?a[1]="?":c==b.length-1&&(a[1]=void 0)}return a.join("")}function ej(a,b,c){if(ma(b))for(var d=0;d<b.length;d++)ej(a,String(b[d]),c);else null!=b&&c.push("&",a,""===b?"":"=",encodeURIComponent(String(b)))}function fj(a,b){for(var c in b)ej(c,b[c],a);return a}function gj(a,b){var c;if(a instanceof gj)this.ub=s(b)?b:a.ub,hj(this,a.ob),c=a.Bb,ij(this),this.Bb=c,c=a.Ua,ij(this),this.Ua=c,jj(this,a.Qb),c=a.Pa,ij(this),this.Pa=c,kj(this,a.a.Q()),c=a.tb,ij(this),this.tb=c;else if(a&&(c=bj(String(a)))){this.ub=!!b,hj(this,c[1]||"",!0);var d=c[2]||"";ij(this),this.Bb=d?decodeURIComponent(d):"",d=c[3]||"",ij(this),this.Ua=d?decodeURIComponent(d):"",jj(this,c[4]),d=c[5]||"",ij(this),this.Pa=d?decodeURIComponent(d):"",kj(this,c[6]||"",!0),c=c[7]||"",ij(this),this.tb=c?decodeURIComponent(c):""}else this.ub=!!b,this.a=new lj(null,0,this.ub)}function hj(a,b,c){ij(a),a.ob=c?b?decodeURIComponent(b):"":b,a.ob&&(a.ob=a.ob.replace(/:$/,""))}function jj(a,b){if(ij(a),b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);a.Qb=b}else a.Qb=null}function kj(a,b,c){ij(a),b instanceof lj?(a.a=b,rj(a.a,a.ub)):(c||(b=mj(b,sj)),a.a=new lj(b,0,a.ub))}function tj(a,b,c){ij(a),ma(c)||(c=[String(c)]),uj(a.a,b,c)}function ij(a){if(a.fg)throw Error("Tried to modify a read-only Uri")}function vj(a){return a instanceof gj?a.Q():new gj(a,void 0)}function wj(a,b){a instanceof gj||(a=vj(a)),b instanceof gj||(b=vj(b));var c=a,d=b,e=c.Q(),f=!!d.ob;if(f?hj(e,d.ob):f=!!d.Bb,f){var g=d.Bb;ij(e),e.Bb=g}else f=!!d.Ua;if(f?(g=d.Ua,ij(e),e.Ua=g):f=null!=d.Qb,g=d.Pa,f)jj(e,d.Qb);else if(f=!!d.Pa)if("/"!=g.charAt(0)&&(c.Ua&&!c.Pa?g="/"+g:(c=e.Pa.lastIndexOf("/"),-1!=c&&(g=e.Pa.substr(0,c+1)+g))),".."==g||"."==g)g="";else if(-1!=g.indexOf("./")||-1!=g.indexOf("/.")){for(var c=0==g.lastIndexOf("/",0),g=g.split("/"),h=[],i=0;i<g.length;){var j=g[i++];"."==j?c&&i==g.length&&h.push(""):".."==j?((1<h.length||1==h.length&&""!=h[0])&&h.pop(),c&&i==g.length&&h.push("")):(h.push(j),c=!0)}g=h.join("/")}return f?(c=g,ij(e),e.Pa=c):f=""!==d.a.toString(),f?kj(e,d.a.toString()?decodeURIComponent(d.a.toString()):""):f=!!d.tb,f&&(d=d.tb,ij(e),e.tb=d),e}function mj(a,b){return oa(a)?encodeURI(a).replace(b,xj):null}function xj(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(15&a).toString(16)}function lj(a,b,c){this.a=a||null,this.d=!!c}function yj(a){if(!a.aa&&(a.aa=new Xi,a.L=0,a.a))for(var b=a.a.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=null,f=null;d>=0?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c],e=decodeURIComponent(e.replace(/\+/g," ")),e=zj(a,e),a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}function uj(a,b,c){a.remove(b),0<c.length&&(a.a=null,Yi(a.aa,zj(a,b),Wa(c)),a.L+=c.length)}function zj(a,b){var c=String(b);return a.d&&(c=c.toLowerCase()),c}function rj(a,b){b&&!a.d&&(yj(a),a.a=null,Wi(a.aa,function(a,b){var c=b.toLowerCase();b!=c&&(this.remove(b),uj(this,c,a))},a)),a.d=b}function Aj(a,b,c){Ld.call(this),this.c=a,this.b=c,this.a=b||window,this.d=xa(this.Nd,this)}function Bj(a){if(null!=a.Z){var b=Cj(a),c=Dj(a);b&&!c&&a.a.mozRequestAnimationFrame?re(a.Z):b&&c?c.call(a.a,a.Z):a.a.clearTimeout(a.Z)}a.Z=null}function Cj(a){return a=a.a,a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||null}function Dj(a){return a=a.a,a.cancelRequestAnimationFrame||a.webkitCancelRequestAnimationFrame||a.mozCancelRequestAnimationFrame||a.oCancelRequestAnimationFrame||a.msCancelRequestAnimationFrame||null}function Fj(){var a=ea.MessageChannel;if("undefined"==typeof a&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&(a=function(){var a=document.createElement("iframe");a.style.display="none",a.src="",document.body.appendChild(a);var b=a.contentWindow,a=b.document;a.open(),a.write(""),a.close();var c="callImmediate"+Math.random(),d=b.location.protocol+"//"+b.location.host,a=xa(function(a){(a.origin==d||a.data==c)&&this.port1.onmessage()},this);b.addEventListener("message",a,!1),this.port1={},this.port2={postMessage:function(){b.postMessage(c,d)}}}),"undefined"!=typeof a){var b=new a,c={},d=c;return b.port1.onmessage=function(){c=c.next;var a=c.Kd;c.Kd=null,a()},function(a){d.next={Kd:a},d=d.next,b.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(a){var b=document.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=null,b.parentNode.removeChild(b),b=null,a(),a=null},document.documentElement.appendChild(b)}:function(a){ea.setTimeout(a,0)}}function Gj(a){He.call(this),this.vc=a||window,this.Jc=z(this.vc,"resize",this.Xf,!1,this),this.vb=sc(this.vc||window)}function Hj(a,b,c,d,e){if(!(zb||Bb&&Nb("525")))return!0;if(rb&&e)return Ij(a);if(e&&!d||!c&&(17==b||18==b||rb&&91==b))return!1;if(Bb&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(zb&&d&&b==a)return!1;switch(a){case 13:return!(zb&&zb&&Pb>=9);case 27:return!Bb}return Ij(a)}function Ij(a){if(a>=48&&57>=a||a>=96&&106>=a||a>=65&&90>=a||Bb&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function Jj(a){switch(a){case 61:return 187;case 59:return 186;case 224:return 91;case 0:return 224;default:return a}}function Kj(a,b){He.call(this),a&&Lj(this,a,b)}function Lj(a,b,c){a.Oc&&Rj(a),a.mc=b,a.Nc=z(a.mc,"keypress",a,c),a.pd=z(a.mc,"keydown",a.a,c,a),a.Oc=z(a.mc,"keyup",a.d,c,a)}function Rj(a){a.Nc&&(re(a.Nc),re(a.pd),re(a.Oc),a.Nc=null,a.pd=null,a.Oc=null),a.mc=null,a.ka=-1,a.kb=-1}function Qj(a,b,c,d){d&&Zd(this,d,void 0),this.type="key",this.Ya=a,this.md=b,this.a=c}function Sj(a,b){He.call(this),this.a=a;var c=ra(this.a)&&1==this.a.nodeType?this.a:this.a?this.a.body:null;this.e=!!c&&Wc(c),this.d=z(this.a,Ab?"DOMMouseScroll":"mousewheel",this,b)}function Tj(a,b){return Bb&&(rb||tb)&&0!=a%b?a:a/b}function Uj(a,b,c,d){b&&Zd(this,b,void 0),this.type="mousewheel",this.detail=a,this.b=c,this.a=d}function Vj(a,b){He.call(this),this.a=a,this.state=b}function Wj(a,b){this.f=a,this.e=b,this.a=[],this.d=[],this.b={}}function Xj(a){var b=a.a,c=a.d,d=b[0];return 1==b.length?(b.length=0,c.length=0):(b[0]=b.pop(),c[0]=c.pop(),Yj(a,0)),b=a.e(d),delete a.b[b],d}function Zj(a,b){var c=a.f(b);1/0!=c&&(a.a.push(b),a.d.push(c),a.b[a.e(b)]=!0,ak(a,0,a.a.length-1))}function Yj(a,b){for(var c=a.a,d=a.d,e=c.length,f=c[b],g=d[b],h=b;e>>1>b;){var i=2*b+1,j=2*b+2,i=e>j&&d[j]<d[i]?j:i;c[b]=c[i],d[b]=d[i],b=i}c[b]=f,d[b]=g,ak(a,h,b)}function ak(a,b,c){var d=a.a;a=a.d;for(var e=d[c],f=a[c];c>b;){var g=c-1>>1;if(!(a[g]>f))break;d[c]=d[g],a[c]=a[g],c=g}d[c]=e,a[c]=f}function bk(a){var b,c,d,e=a.f,f=a.a,g=a.d,h=0,i=f.length;for(c=0;i>c;++c)b=f[c],d=e(b),1/0==d?delete a.b[a.e(b)]:(g[h]=d,f[h++]=b);for(f.length=h,g.length=h,e=(a.a.length>>1)-1;e>=0;e--)Yj(a,e)}function ck(a,b){Wj.call(this,function(b){return a.apply(null,b)},function(a){return a[0].c()}),this.i=b,this.c=0}function dk(a){Me.call(this),this.element=s(a.element)?a.element:null,this.A=s(a.target)?pc(a.target):null,this.a=null,this.g=[]
}function ek(a){a=s(a)?a:{},this.h=wc("UL");var b=tc("DIV",{"class":(s(a.className)?a.className:"ol-attribution")+" ol-unselectable"},this.h);dk.call(this,{element:b,target:a.target}),this.i=!0,this.e={},this.c={}}function fk(a){a=s(a)?a:{},this.e=wc("UL");var b=tc("DIV",{"class":(s(a.className)?a.className:"ol-logo")+" ol-unselectable"},this.e);dk.call(this,{element:b,target:a.target}),this.c=!0,this.i={}}function gk(a){a=s(a)?a:{};var b=s(a.className)?a.className:"ol-zoom",c=s(a.delta)?a.delta:1,d=s(a.zoomInLabel)?a.zoomInLabel:"+",e=s(a.zoomOutLabel)?a.zoomOutLabel:"",f=s(a.zoomOutTipLabel)?a.zoomOutTipLabel:"Zoom out",g=tc("SPAN",{role:"tooltip"},s(a.zoomInTipLabel)?a.zoomInTipLabel:"Zoom in"),d=tc("BUTTON",{"class":b+"-in ol-has-tooltip",type:"button"},g,d),g=new Gf(d);Od(this,g),z(g,sf,za(gk.prototype.e,c),!1,this),z(d,["mouseout",Wd],function(){this.blur()},!1),f=tc("SPAN",{role:"tooltip"},f),e=tc("BUTTON",{"class":b+"-out  ol-has-tooltip",type:"button"},f,e),f=new Gf(e),Od(this,f),z(f,sf,za(gk.prototype.e,-c),!1,this),z(e,["mouseout",Wd],function(){this.blur()},!1),b=tc("DIV",b+" ol-unselectable",d,e),dk.call(this,{element:b,target:a.target}),this.c=s(a.duration)?a.duration:250}function hk(a){a=s(a)?a:{};var b=new D;return(s(a.zoom)?a.zoom:1)&&b.push(new gk(s(a.zoomOptions)?a.zoomOptions:void 0)),(s(a.attribution)?a.attribution:1)&&b.push(new ek(s(a.attributionOptions)?a.attributionOptions:void 0)),(s(a.logo)?a.logo:1)&&b.push(new fk(s(a.logoOptions)?a.logoOptions:void 0)),b}function ik(a,b,c){this.e=a,this.b=b,this.f=c,this.a=[],this.d=this.c=0}function jk(a,b){var c=a.e,d=a.d,e=a.b,f=Math.log(a.b/a.d)/a.e;return ki({source:b,duration:f,easing:function(a){return d*(Math.exp(c*a*f)-1)/(e-d)}})}function kk(a){a=s(a)?a:{},this.a=s(a.delta)?a.delta:1,ni.call(this),this.b=s(a.duration)?a.duration:250}function lk(a){ri.call(this),this.a=(s(a)?a:{}).kinetic,this.c=this.e=null,this.h=s(a.condition)?a.condition:cg,this.f=!1}function mk(a){a=s(a)?a:{},ri.call(this),this.c=s(a.condition)?a.condition:ag,this.a=void 0}function nk(a){a=s(a)?a:{},yi.call(this,{condition:s(a.condition)?a.condition:dg,style:s(a.style)?a.style:new Oi({stroke:new Mi({color:[0,0,255,1]})})})}function ok(a){ni.call(this),a=s(a)?a:{},this.a=s(a.condition)?a.condition:Ee(cg,eg),this.b=s(a.pixelDelta)?a.pixelDelta:128}function qk(a){ni.call(this),a=s(a)?a:{},this.b=s(a.condition)?a.condition:eg,this.a=s(a.delta)?a.delta:1,this.c=s(a.duration)?a.duration:100}function rk(a){a=s(a)?a:{},ni.call(this),this.a=0,this.i=s(a.duration)?a.duration:250,this.c=null,this.e=this.b=void 0}function sk(a){ri.call(this),a=s(a)?a:{},this.c=null,this.e=void 0,this.a=!1,this.f=0,this.h=s(a.threshold)?a.threshold:.3}function tk(a){a=s(a)?a:{},ri.call(this),this.c=null,this.f=s(a.duration)?a.duration:400,this.a=void 0,this.e=1}function uk(a){a=s(a)?a:{};var b=new D,c=new ik(-.005,.05,100);return(s(a.altShiftDragRotate)?a.altShiftDragRotate:1)&&b.push(new mk),(s(a.doubleClickZoom)?a.doubleClickZoom:1)&&b.push(new kk({delta:a.zoomDelta,duration:a.zoomDuration})),(s(a.dragPan)?a.dragPan:1)&&b.push(new lk({kinetic:c})),(s(a.pinchRotate)?a.pinchRotate:1)&&b.push(new sk),(s(a.pinchZoom)?a.pinchZoom:1)&&b.push(new tk({duration:a.zoomDuration})),(s(a.keyboard)?a.keyboard:1)&&(b.push(new ok),b.push(new qk({delta:a.zoomDelta,duration:a.zoomDuration}))),(s(a.mouseWheelZoom)?a.mouseWheelZoom:1)&&b.push(new rk({duration:a.zoomDuration})),(s(a.shiftDragZoom)?a.shiftDragZoom:1)&&b.push(new nk),b}function vk(a){Je.call(this),this.l=$h(a.projection),this.O=s(a.extent)?a.extent:s(a.projection)?this.l.u():null,this.f=s(a.attributions)?a.attributions:null,this.w=a.logo,this.i=s(a.state)?a.state:1}function wk(a,b){a.i=b,a.k()}function J(a){Me.call(this),a=jc(a),a.brightness=s(a.brightness)?a.brightness:0,a.contrast=s(a.contrast)?a.contrast:1,a.hue=s(a.hue)?a.hue:0,a.opacity=s(a.opacity)?a.opacity:1,a.saturation=s(a.saturation)?a.saturation:1,a.visible=s(a.visible)?a.visible:!0,a.maxResolution=s(a.maxResolution)?a.maxResolution:1/0,a.minResolution=s(a.minResolution)?a.minResolution:0,this.H(a)}function xk(a){var b=a.c(),c=a.e(),d=a.f(),e=a.l(),f=a.h(),g=a.Ra(),h=a.b(),i=a.g(),j=a.i();return{layer:a,brightness:s(b)?Vb(b,-1,1):0,contrast:s(c)?Math.max(c,0):1,hue:s(d)?d:0,opacity:s(e)?Vb(e,0,1):1,saturation:s(f)?Math.max(f,0):1,Sa:g,visible:s(h)?!!h:!0,maxResolution:s(i)?i:1/0,minResolution:s(j)?Math.max(j,0):0}}function K(a){var b=s(a)?a:{};a=jc(b),delete a.layers,b=b.layers,J.call(this,a),this.a=null,z(this,Qe("layers"),this.Pf,!1,this),s(b)?ma(b)&&(b=new D(Wa(b))):b=new D,this.ba(b)}function yk(a){Fh.call(this,{code:a,units:"m",extent:zk,global:!0})}function Uh(a,b,c){var d=a.length;c=c>1?c:2,s(b)||(b=c>2?a.slice():Array(d));for(var e=0;d>e;e+=c)b[e]=6378137*Math.PI*a[e]/180,b[e+1]=6378137*Math.log(Math.tan(Math.PI*(a[e+1]+90)/360));return b}function Vh(a,b,c){var d=a.length;c=c>1?c:2,s(b)||(b=c>2?a.slice():Array(d));for(var e=0;d>e;e+=c)b[e]=180*a[e]/(6378137*Math.PI),b[e+1]=360*Math.atan(Math.exp(a[e+1]/6378137))/Math.PI-90;return b}function Bk(a,b){Fh.call(this,{code:a,units:"degrees",extent:Ck,axisOrientation:b,global:!0})}function Dk(){Oh(Th),Oh(Wh),Sh()}function M(a){var b=jc(a);delete b.source,J.call(this,b),this.a=a.source,z(this.a,"change",this.bd,!1,this)}function Ek(a,b,c,d,e){He.call(this),this.g=e,this.h=a,this.b=c,this.c=b,this.state=d}function Fk(a,b,c,d,e,f){Ek.call(this,a,b,c,0,d),this.i=e,this.a=new Image,null!==f&&(this.a.crossOrigin=f),this.f={},this.d=null,this.state=0}function Gk(a){0==a.state&&(a.state=1,a.d=[oe(a.a,"error",a.l,!1,a),oe(a.a,"load",a.t,!1,a)],a.a.src=a.i)}function Hk(a){this.minZoom=s(a.minZoom)?a.minZoom:0,this.a=a.resolutions,this.maxZoom=this.a.length-1,this.e=s(a.origin)?a.origin:null,this.g=null,s(a.origins)&&(this.g=a.origins),this.b=null,s(a.tileSizes)&&(this.b=a.tileSizes),this.f=s(a.tileSize)?a.tileSize:null===this.b?256:void 0}function Lk(a,b,c,d){Mk(a,b[0],b[1],c,!1,Ik);var e=Ik.x,f=Ik.y;return Mk(a,b[2],b[3],c,!0,Ik),lb(e,Ik.x,f,Ik.y,d)}function Kk(a,b,c,d){return Lk(a,b,a.ca(c),d)}function Nk(a,b){var c=a.lb(b.a),d=a.ca(b.a),e=a.ia(b.a);return[c[0]+(b.x+.5)*e*d,c[1]+(b.y+.5)*e*d]}function Jk(a,b,c){var d=a.lb(b.a),e=a.ca(b.a);a=a.ia(b.a);var f=d[0]+b.x*a*e;return b=d[1]+b.y*a*e,wg(f,b,f+a*e,b+a*e,c)}function Mk(a,b,c,d,e,f){var g=jg(a.a,d,0),h=d/a.ca(g),i=a.lb(g);return a=a.ia(g),b=h*(b-i[0])/(d*a),c=h*(c-i[1])/(d*a),e?(b=Math.ceil(b)-1,c=Math.ceil(c)-1):(b=Math.floor(b),c=Math.floor(c)),hb(g,b,c,f)}function Ok(a){vk.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection}),this.C=s(a.opaque)?a.opaque:!1,this.tileGrid=s(a.tileGrid)?a.tileGrid:null}function Pk(a,b){var c;if(null===a.tileGrid){if(c=b.i,null===c){c=b.u();for(var d=null===c?360*Dh.degrees/b.f():Math.max(c[2]-c[0],c[3]-c[1]),e=s(void 0)?void 0:256,f=Array((s(void 0)?0/0:42)+1),d=d/e,g=0,h=f.length;h>g;++g)f[g]=d/Math.pow(2,g);c=new Hk({origin:null===c?[0,0]:Fg(c),resolutions:f,tileSize:e}),b.i=c}}else c=a.tileGrid;return c}function Qk(a,b){Ld.call(this),this.e=a,this.a=b}function Rk(a){var b=a.a;b.b()&&1==b.Ra()&&a.e.f.R()}function Sk(a,b){b.vd()&&a.postRenderFunctions.push(za(function(a,b,c){b=sa(a).toString(),a.le(c.usedTiles[b])},b))}function Tk(a,b){if(null!=b){var c,d,e;for(d=0,e=b.length;e>d;++d)c=b[d],a[sa(c).toString()]=c}}function Uk(a,b){var c=b.w;s(c)&&(a.logos[c]="")}function Vk(a,b,c,d){b=sa(b).toString(),c=c.toString(),b in a?c in a[b]?(a=a[b][c],d.a<a.a&&(a.a=d.a),d.c>a.c&&(a.c=d.c),d.b<a.b&&(a.b=d.b),d.d>a.d&&(a.d=d.d)):a[b][c]=d:(a[b]={},a[b][c]=d)}function Wk(a,b,c,d){return function(e,f,g){return e=b.Ib(e,f,g,c,d),a(e)?e:null}}function Xk(a,b,c){return[b*(Math.round(a[0]/b)+c[0]%2/2),b*(Math.round(a[1]/b)+c[1]%2/2)]}function Yk(a,b,c,d,e,f,g,h,i,j){var k=sa(b).toString();k in a.wantedTiles||(a.wantedTiles[k]={});var l=a.wantedTiles[k];a=a.tileQueue;var m,n,o,p,q,r,t=c.minZoom;for(s(h)||(h=0),r=g;r>=t;--r)for(n=Kk(c,f,r),o=c.ca(r),p=n.a;p<=n.c;++p)for(q=n.b;q<=n.d;++q)h>=g-r?(m=b.Ib(r,p,q,d,e),0==m.state&&(l[m.a.toString()]=!0,m.c()in a.b||Zj(a,[m,k,Nk(c,m.a),o])),s(i)&&i.call(j,m)):b.Ge(r,p,q)}function Zk(a){a=s(a)?a:{},this.b=s(a.anchor)?a.anchor:[.5,.5],this.d=s(a.anchorOrigin)?a.anchorOrigin:"top-left",this.c=s(a.anchorXUnits)?a.anchorXUnits:"fraction",this.h=s(a.anchorYUnits)?a.anchorYUnits:"fraction";var b=a.src,c=s(a.crossOrigin)?a.crossOrigin:null,d=$k.gb(),e=d.get(b,c);null===e&&(e=new al(b,c),d.a[c+":"+b]=e,++d.d),this.a=e,this.l=s(a.size)?a.size:null,Li.call(this,{opacity:s(a.opacity)?a.opacity:1,rotation:s(a.rotation)?a.rotation:0,scale:s(a.scale)?a.scale:1,Be:void 0,rotateWithView:s(a.rotateWithView)?a.rotateWithView:!1})}function al(a,b){He.call(this),this.c=null,this.a=new Image,null!==b&&(this.a.crossOrigin=b),this.b=null,this.d=0,this.e=null,this.f=a,this.i=!1}function $k(){this.a={},this.d=0,this.b=32}function bl(a,b,c,d,e,f,g,h){return md(a),0===b&&0===c||od(a,b,c),1==d&&1==e||pd(a,d,e),0!==f&&qd(a,f),0===g&&0===h||od(a,g,h),a}function cl(a,b){return a[0]==b[0]&&a[1]==b[1]&&a[4]==b[4]&&a[5]==b[5]&&a[12]==b[12]&&a[13]==b[13]}function dl(a,b,c){var d=a[1],e=a[5],f=a[13],g=b[0];return b=b[1],c[0]=a[0]*g+a[4]*b+a[12],c[1]=d*g+e*b+f,c}function el(a,b){Ld.call(this),this.f=b,this.b={}}function fl(a){var b=a.view2DState,c=a.coordinateToPixelMatrix;bl(c,a.size[0]/2,a.size[1]/2,1/b.resolution,-1/b.resolution,-b.rotation,-b.center[0],-b.center[1]),a=a.pixelToCoordinateMatrix;var b=c[0],d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],i=c[6],j=c[7],k=c[8],l=c[9],m=c[10],n=c[11],o=c[12],p=c[13],q=c[14],c=c[15],r=b*h-d*g,s=b*i-e*g,t=b*j-f*g,u=d*i-e*h,v=d*j-f*h,w=e*j-f*i,x=k*p-l*o,y=k*q-m*o,z=k*c-n*o,A=l*q-m*p,B=l*c-n*p,C=m*c-n*q,D=r*C-s*B+t*A+u*z-v*y+w*x;0!=D&&(D=1/D,a[0]=(h*C-i*B+j*A)*D,a[1]=(-d*C+e*B-f*A)*D,a[2]=(p*w-q*v+c*u)*D,a[3]=(-l*w+m*v-n*u)*D,a[4]=(-g*C+i*z-j*y)*D,a[5]=(b*C-e*z+f*y)*D,a[6]=(-o*w+q*t-c*s)*D,a[7]=(k*w-m*t+n*s)*D,a[8]=(g*B-h*z+j*x)*D,a[9]=(-b*B+d*z-f*x)*D,a[10]=(o*v-p*t+c*r)*D,a[11]=(-k*v+l*t-n*r)*D,a[12]=(-g*A+h*y-i*x)*D,a[13]=(b*A-d*y+e*x)*D,a[14]=(-o*u+p*s-q*r)*D,a[15]=(k*u-l*s+m*r)*D)}function gl(a,b){var c=sa(b).toString();if(c in a.b)return a.b[c];var d=a.zc(b);return a.b[c]=d}function hl(a){a.postRenderFunctions.push(function(){var a=$k.gb();if(a.d>a.b){var b,c,d=0;for(b in a.a)c=a.a[b],0!==(3&d++)||te(c)||(delete a.a[b],--a.d)}})}function il(a,b){for(var c in a.b)if(!(c in b.layerStates)){b.postRenderFunctions.push(xa(a.w,a));break}}function N(a){M.call(this,a)}function O(a){M.call(this,a)}function P(a){a=s(a)?a:{};var b=jc(a);delete b.style,M.call(this,b),this.Ub=null,this.ra=void 0,s(a.style)&&this.fa(a.style)}function jl(a,b,c,d,e){this.w={},this.b=a,this.l=b,this.g=c,this.f=d,this.Ta=e,this.i=this.a=this.d=this.Qa=this.ba=this.da=null,this.A=this.qb=this.O=this.C=0,this.ea=!1,this.h=this.fa=0,this.Db=!1,this.Ra=0,this.c="",this.n=this.B=this.ra=this.Eb=0,this.V=this.o=this.t=null,this.e=[],this.Sa=id()}function kl(a,b){if(null!==a.i){var c=Tg(b,2,a.f,a.e),d=a.b,e=a.Sa,f=d.globalAlpha;1!=a.A&&(d.globalAlpha=f*a.A);var g=a.fa;a.ea&&(g+=a.Ta);var h,i;for(h=0,i=c.length;i>h;h+=2){var j=c[h]-a.C,k=c[h+1]-a.O;if(a.Db&&(j=j+.5|0,k=k+.5|0),0!==g||1!=a.h){var l=j+a.C,m=k+a.O;bl(e,l,m,a.h,a.h,g,-l,-m),d.setTransform(e[0],e[1],e[4],e[5],e[12],e[13])}d.drawImage(a.i,j,k,a.Ra,a.qb)}0===g&&1==a.h||d.setTransform(1,0,0,1,0,0),1!=a.A&&(d.globalAlpha=f)}}function ll(a,b,c,d){var e=0;if(null!==a.V&&""!==a.c){null===a.t||ml(a,a.t),null===a.o||nl(a,a.o);var f=a.V,g=a.b,h=a.Qa;for(null===h?(g.font=f.font,g.textAlign=f.textAlign,g.textBaseline=f.textBaseline,a.Qa={font:f.font,textAlign:f.textAlign,textBaseline:f.textBaseline}):(h.font!=f.font&&(h.font=g.font=f.font),h.textAlign!=f.textAlign&&(h.textAlign=g.textAlign=f.textAlign),h.textBaseline!=f.textBaseline&&(h.textBaseline=g.textBaseline=f.textBaseline)),b=Tg(b,d,a.f,a.e),f=a.b;c>e;e+=d){if(g=b[e]+a.Eb,h=b[e+1]+a.ra,0!==a.B||1!=a.n){var i=bl(a.Sa,g,h,a.n,a.n,a.B,-g,-h);f.setTransform(i[0],i[1],i[4],i[5],i[12],i[13])}null===a.o||f.strokeText(a.c,g,h),null===a.t||f.fillText(a.c,g,h)}0===a.B&&1==a.n||f.setTransform(1,0,0,1,0,0)}}function pl(a,b,c,d,e){a=a.b,a.moveTo(b[c],b[c+1]);var f;for(f=c+2;d>f;f+=2)a.lineTo(b[f],b[f+1]);return e&&a.lineTo(b[c],b[c+1]),d}function ql(a,b,c,d){var e,f,g=a.b;for(e=0,f=d.length;f>e;++e)c=pl(a,b,c,d[e],!0),g.closePath();return c}function vl(a){var b=Pa(dc(a.w),Number);bb(b);var c,d,e,f,g;for(c=0,d=b.length;d>c;++c)for(e=a.w[b[c].toString()],f=0,g=e.length;g>f;++f)e[f](a)}function ml(a,b){var c=a.b,d=a.da;null===d?(c.fillStyle=b.fillStyle,a.da={fillStyle:b.fillStyle}):d.fillStyle!=b.fillStyle&&(d.fillStyle=c.fillStyle=b.fillStyle)}function nl(a,b){var c=a.b,d=a.ba;null===d?(c.lineCap=b.lineCap,Cd&&c.setLineDash(b.lineDash),c.lineJoin=b.lineJoin,c.lineWidth=b.lineWidth,c.miterLimit=b.miterLimit,c.strokeStyle=b.strokeStyle,a.ba={lineCap:b.lineCap,lineDash:b.lineDash,lineJoin:b.lineJoin,lineWidth:b.lineWidth,miterLimit:b.miterLimit,strokeStyle:b.strokeStyle}):(d.lineCap!=b.lineCap&&(d.lineCap=c.lineCap=b.lineCap),Cd&&!eb(d.lineDash,b.lineDash)&&c.setLineDash(d.lineDash=b.lineDash),d.lineJoin!=b.lineJoin&&(d.lineJoin=c.lineJoin=b.lineJoin),d.lineWidth!=b.lineWidth&&(d.lineWidth=c.lineWidth=b.lineWidth),d.miterLimit!=b.miterLimit&&(d.miterLimit=c.miterLimit=b.miterLimit),d.strokeStyle!=b.strokeStyle&&(d.strokeStyle=c.strokeStyle=b.strokeStyle))}function wl(a,b){Qk.call(this,a,b),this.C=id()}function xl(a,b,c,d,e){var f=a.a;ue(f.ga,b)&&(a=s(e)?e:yl(a,d),a=new jl(c,d.pixelRatio,d.extent,a,d.view2DState.rotation),A(f,new ti(b,f,a,d,c,null)),vl(a))}function yl(a,b){var c=b.view2DState,d=b.pixelRatio;return bl(a.C,d*b.size[0]/2,d*b.size[1]/2,d/c.resolution,-d/c.resolution,-c.rotation,-c.center[0],-c.center[1])}function Al(a){vk.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection,state:a.state}),this.n=s(a.resolutions)?a.resolutions:null}function Bl(a,b){return null===a.n||(b=a.n[jg(a.n,b,0)]),b}function Cl(a,b){wl.call(this,a,b),this.d=null,this.b=id()}function Dl(a,b){wl.call(this,a,b),this.d=this.g=null,this.h=!1,this.w=null,this.A=id(),this.B=0/0,this.i=this.b=null}function Fl(a,b,c){this.Qa=a,this.O=b,this.e=0,this.resolution=c,this.B=this.A=null,this.d=[],this.coordinates=[],this.da=id(),this.a=[],this.V=[],this.c=ug(),this.ba=id()}function Gl(a,b,c,d,e,f){var g,h,i,j=a.coordinates.length,k=a.jd(),l=[b[c],b[c+1]],m=[0/0,0/0],n=!0;for(g=c+e;d>g;g+=e){m[0]=b[g],m[1]=b[g+1],i=k[1];var o=k[2],p=k[3],q=m[0],r=m[1],s=0;q<k[0]?s=16|s:q>o&&(s=4|s),i>r?s|=8:r>p&&(s|=2),0===s&&(s=1),i=s,i!==h?(n&&(a.coordinates[j++]=l[0],a.coordinates[j++]=l[1]),a.coordinates[j++]=m[0],a.coordinates[j++]=m[1],n=!1):1===i?(a.coordinates[j++]=m[0],a.coordinates[j++]=m[1],n=!1):n=!0,l[0]=m[0],l[1]=m[1],h=i}return g===c+e&&(a.coordinates[j++]=l[0],a.coordinates[j++]=l[1]),f&&(a.coordinates[j++]=b[c],a.coordinates[j++]=b[c+1]),j}function Hl(a,b,c){a.A=[0,b,c,0],a.d.push(a.A),a.B=[0,b,c,0],a.a.push(a.B)}function Il(a,b,c,d,e,f,g,h){var i;cl(d,a.da)?i=a.V:(i=Tg(a.coordinates,2,d,a.V),ld(a.da,d)),d=0;var j,k=g.length,l=0;for(a=a.ba;k>d;){var m,n,o,p,q,r=g[d];switch(r[0]){case 0:j=r[2],j=sa(j).toString(),s(w(f,j))?d=r[3]:++d;break;case 1:b.beginPath(),++d;break;case 2:j=i[l],n=i[l+1];var t=i[l+2]-j,r=i[l+3]-n;b.arc(j,n,Math.sqrt(t*t+r*r),0,2*Math.PI,!0),l+=4,++d;break;case 3:b.closePath(),++d;break;case 4:l=r[1],j=r[2],m=r[3],p=r[4]*c;var u=r[5]*c,v=r[6]*c;o=r[7],n=r[9];var t=r[10],x=r[11],y=r[12]*c;for(r[8]&&(n+=e);j>l;l+=2){if(r=i[l]-p,q=i[l+1]-u,x&&(r=r+.5|0,q=q+.5|0),1!=t||0!==n){var z=r+p,A=q+u;bl(a,z,A,t,t,n,-z,-A),b.setTransform(a[0],a[1],a[4],a[5],a[12],a[13])}z=b.globalAlpha,1!=o&&(b.globalAlpha=z*o),b.drawImage(m,r,q,y,v),1!=o&&(b.globalAlpha=z),1==t&&0===n||b.setTransform(1,0,0,1,0,0)}++d;break;case 5:for(l=r[1],j=r[2],p=r[3],u=r[4]*c,v=r[5]*c,n=r[6],t=r[7]*c,m=r[8],o=r[9];j>l;l+=2)r=i[l]+u,q=i[l+1]+v,(1!=t||0!==n)&&(bl(a,r,q,t,t,n,-r,-q),b.setTransform(a[0],a[1],a[4],a[5],a[12],a[13])),o&&b.strokeText(p,r,q),m&&b.fillText(p,r,q),1==t&&0===n||b.setTransform(1,0,0,1,0,0);++d;break;case 6:if(s(h)&&(n=r[1],j=r[2],j=h(n,j)))return j;++d;break;case 7:b.fill(),++d;break;case 8:for(l=r[1],j=r[2],b.moveTo(i[l],i[l+1]),l+=2;j>l;l+=2)b.lineTo(i[l],i[l+1]);++d;break;case 9:b.fillStyle=r[1],++d;break;case 10:b.strokeStyle=r[1],b.lineWidth=r[2]*c,b.lineCap=r[3],b.lineJoin=r[4],b.miterLimit=r[5],Cd&&b.setLineDash(r[6]),++d;break;case 11:b.font=r[1],b.textAlign=r[2],b.textBaseline=r[3],++d;break;case 12:b.stroke(),++d;break;default:++d}}}function Jl(a){var b=a.a;b.reverse();var c,d,e,f=b.length,g=-1;for(c=0;f>c;++c)if(d=b[c],e=d[0],6==e)g=c;else if(0==e){for(d[3]=c,d=a.a,e=c;e>g;){var h=d[g];d[g]=d[e],d[e]=h,++g,--e}g=-1}}function Kl(a,b,c){a.A[3]=a.d.length,a.A=null,a.B[3]=a.a.length,a.B=null,b=[6,b,c],a.d.push(b),a.a.push(b)}function Ll(a,b,c){Fl.call(this,a,b,c),this.i=this.C=null,this.w=this.o=this.n=this.t=this.l=this.h=this.g=this.f=this.b=void 0}function Ml(a,b,c){Fl.call(this,a,b,c),this.b={ac:void 0,Wb:void 0,Xb:null,Yb:void 0,Zb:void 0,$b:void 0,qd:0,strokeStyle:void 0,lineCap:void 0,lineDash:null,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0}}function Nl(a,b,c,d,e){var f=a.coordinates.length;return b=Gl(a,b,c,d,e,!1),f=[8,f,b],a.d.push(f),a.a.push(f),d}function Ol(a){var b=a.b,c=b.strokeStyle,d=b.lineCap,e=b.lineDash,f=b.lineJoin,g=b.lineWidth,h=b.miterLimit;b.ac==c&&b.Wb==d&&eb(b.Xb,e)&&b.Yb==f&&b.Zb==g&&b.$b==h||(b.qd!=a.coordinates.length&&(a.d.push([12]),b.qd=a.coordinates.length),a.d.push([10,c,g,d,f,h,e],[1]),b.ac=c,b.Wb=d,b.Xb=e,b.Yb=f,b.Zb=g,b.$b=h)}function Pl(a,b,c){Fl.call(this,a,b,c),this.b={Md:void 0,ac:void 0,Wb:void 0,Xb:null,Yb:void 0,Zb:void 0,$b:void 0,fillStyle:void 0,strokeStyle:void 0,lineCap:void 0,lineDash:null,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0}}function Ql(a,b,c,d,e){var f=a.b,g=[1];a.d.push(g),a.a.push(g);var h,g=0;for(h=d.length;h>g;++g){var i=d[g],j=a.coordinates.length;c=Gl(a,b,c,i,e,!0),c=[8,j,c],j=[3],a.d.push(c,j),a.a.push(c,j),c=i}return b=[7],a.a.push(b),s(f.fillStyle)&&a.d.push(b),s(f.strokeStyle)&&(f=[12],a.d.push(f),a.a.push(f)),c}function Rl(a){var b=a.b,c=b.fillStyle,d=b.strokeStyle,e=b.lineCap,f=b.lineDash,g=b.lineJoin,h=b.lineWidth,i=b.miterLimit;s(c)&&b.Md!=c&&(a.d.push([9,c]),b.Md=b.fillStyle),!s(d)||b.ac==d&&b.Wb==e&&b.Xb==f&&b.Yb==g&&b.Zb==h&&b.$b==i||(a.d.push([10,d,h,e,g,i,f]),b.ac=d,b.Wb=e,b.Xb=f,b.Yb=g,b.Zb=h,b.$b=i)}function Tl(a,b,c){Fl.call(this,a,b,c),this.C=this.w=this.o=null,this.i="",this.n=this.t=this.l=this.h=0,this.g=this.f=this.b=null}function Ul(a,b,c){this.f=a,this.d=b,this.e=c,this.a={},this.b=rd(1,1),this.c=id()}function Vl(a,b,c,d,e,f,g){var h=Pa(dc(a.a),Number);bb(h);a:{var i=a.d,j=i[0],k=i[1],l=i[2],i=i[3],j=Tg([j,k,j,i,l,i,l,k],2,e);b.save(),b.beginPath(),b.moveTo(j[0],j[1]),b.lineTo(j[2],j[3]),b.lineTo(j[4],j[5]),b.lineTo(j[6],j[7]),b.closePath(),b.clip();for(var m,n,j=0,k=h.length;k>j;++j)for(m=a.a[h[j].toString()],l=0,i=El.length;i>l;++l)if(n=m[El[l]],s(n)&&Mg(c,n.u())&&(n=Il(n,b,d,e,f,g,n.d,void 0)))break a;b.restore()}}function Wl(a,b,c,d,e,f,g,h){var i,j,k,l,m;for(i=0,j=b.length;j>i;++i)for(l in k=a.a[b[i].toString()])if(m=k[l],Mg(d,m.u())&&(m=Il(m,c,1,e,f,g,m.a,h)))return m}function Xl(a,b,c,d,e,f,g){var h=a.c;bl(h,.5,.5,1/c,-1/c,-d,-e[0],-e[1]),c=Pa(dc(a.a),Number),bb(c,function(a,b){return b-a});var i=a.b;return i.clearRect(0,0,1,1),Wl(a,c,i,b,h,d,f,function(a,b){if(0<i.getImageData(0,0,1,1).data[3]){var c=g(a,b);if(c)return c;i.clearRect(0,0,1,1)}})}function Yl(a){for(var b in a.a){var c,d=a.a[b];for(c in d)d[c].Sc()}}function Zl(a,b,c){var d=s(b)?b.toString():"0";return b=a.a[d],s(b)||(b={},a.a[d]=b),d=b[c],s(d)||(d=new $l[c](a.f,a.d,a.e),b[c]=d),d}function am(a,b,c){Ug.call(this),this.ye(a,s(b)?b:0,c)}function bm(a){var b=a.j[a.a]-a.j[0];return a=a.j[a.a+1]-a.j[1],b*b+a*a}function cm(a){Sg.call(this),this.a=s(a)?a:null,dm(this)}function em(a){var b,c,d=[];for(b=0,c=a.length;c>b;++b)d.push(a[b].Q());return d}function fm(a){var b,c;if(null!==a.a)for(b=0,c=a.a.length;c>b;++b)pe(a.a[b],"change",a.k,!1,a)}function dm(a){var b,c;if(null!==a.a)for(b=0,c=a.a.length;c>b;++b)z(a.a[b],"change",a.k,!1,a)}function gm(a,b,c,d,e){var f=0/0,g=0/0,h=(c-b)/d;if(0!==h)if(1==h)f=a[b],g=a[b+1];else if(2==h)f=.5*a[b]+.5*a[b+d],g=.5*a[b+1]+.5*a[b+d+1];else{var i,g=a[b],h=a[b+1],j=0,f=[0];for(i=b+d;c>i;i+=d){var k=a[i],l=a[i+1],j=j+Math.sqrt((k-g)*(k-g)+(l-h)*(l-h));f.push(j),g=k,h=l}c=.5*j;for(var m,g=db,h=0,j=f.length;j>h;)i=h+j>>1,k=g(c,f[i]),k>0?h=i+1:(j=i,m=!k);m=m?h:~h,0>m?(c=(c-f[-m-2])/(f[-m-1]-f[-m-2]),b+=(-m-2)*d,f=a[b]+c*(a[b+d]-a[b]),g=a[b+1]+c*(a[b+d+1]-a[b+1])):(f=a[b+m*d],g=a[b+m*d+1])}return null!=e?(e.push(f,g),e):[f,g]}function hm(a,b,c,d,e,f){if(c==b)return null;if(e<a[b+d-1])return f?(c=a.slice(b,b+d),c[d-1]=e,c):null;if(a[c-1]<e)return f?(c=a.slice(c-d,c),c[d-1]=e,c):null;if(e==a[b+d-1])return a.slice(b,b+d);for(b/=d,c/=d;c>b;)f=b+c>>1,e<a[(f+1)*d-1]?c=f:b=f+1;if(c=a[b*d-1],e==c)return a.slice((b-1)*d,(b-1)*d+d);f=(e-c)/(a[(b+1)*d-1]-c),c=[];var g;for(g=0;d-1>g;++g)c.push(a[(b-1)*d+g]+f*(a[b*d+g]-a[(b-1)*d+g]));return c.push(e),c}function im(a,b,c,d,e,f){var g=0;if(f)return hm(a,g,b[b.length-1],c,d,e);if(d<a[c-1])return e?(a=a.slice(0,c),a[c-1]=d,a):null;if(a[a.length-1]<d)return e?(a=a.slice(a.length-c),a[c-1]=d,a):null;for(e=0,f=b.length;f>e;++e){var h=b[e];if(g!=h){if(d<a[g+c-1])break;if(d<=a[h-1])return hm(a,g,h,c,d,!1);g=h}}return null}function jm(a,b){Ug.call(this),this.c=null,this.t=this.n=this.h=-1,this.P(a,b)}function sl(a){return a.h!=a.d&&(a.c=gm(a.j,0,a.j.length,a.a,a.c),a.h=a.d),a.c}function km(a,b,c){Wg(a,b,c),a.k()}function lm(a,b){Ug.call(this),this.c=[],this.h=this.t=-1,this.P(a,b)}function tl(a){var b=[],c=a.j,d=0,e=a.c;a=a.a;var f,g;for(f=0,g=e.length;g>f;++f){var h=e[f],d=gm(c,d,h,a);ig(b,d),d=h}return b}function mm(a,b,c,d){Wg(a,b,c),a.c=d,a.k()}function nm(a,b){var c,d,e="XY",f=[],g=[];for(c=0,d=b.length;d>c;++c){var h=b[c];0===c&&(e=h.b),ig(f,h.j),g.push(f.length)}mm(a,e,f,g)}function om(a,b){Ug.call(this),this.P(a,b)}function pm(a,b){Ug.call(this),this.c=[],this.t=-1,this.n=null,this.A=this.o=this.w=-1,this.h=null,this.P(a,b)}function ul(a){if(a.t!=a.d){var b,c,d=a.j,e=a.c,f=a.a,g=0,h=[],i=ug();for(b=0,c=e.length;c>b;++b){var j=e[b],i=d,k=j[0],l=f,m=Bg(void 0),i=Eg(m,i,g,k,l);h.push((i[0]+i[2])/2,(i[1]+i[3])/2),g=j[j.length-1]}for(d=Sl(a),e=a.c,f=a.a,b=0,c=[],j=0,i=e.length;i>j;++j)g=e[j],c=th(d,b,g,f,h,2*j,c),b=g[g.length-1];a.n=c,a.t=a.d}return a.n}function Sl(a){if(a.A!=a.d){var b,c=a.j;a:{b=a.c;var d,e;for(d=0,e=b.length;e>d;++d)if(!vh(c,b[d],a.a)){b=!1;break a}b=!0}if(b)a.h=c;else{a.h=c.slice(),b=c=a.h,d=a.c,e=a.a;var f,g,h=0;for(f=0,g=d.length;g>f;++f)h=wh(b,h,d[f],e);c.length=h}a.A=a.d}return a.h}function qm(a,b,c,d){Wg(a,b,c),a.c=d,a.k()}function rm(a,b){var c,d,e,f="XY",g=[],h=[];for(c=0,d=b.length;d>c;++c){var i=b[c];0===c&&(f=i.b);var j=g.length;e=i.c;var k,l;for(k=0,l=e.length;l>k;++k)e[k]+=j;ig(g,i.j),h.push(e)}qm(a,f,g,h)}function sm(a,b){return sa(a)-sa(b)}function tm(a,b,c,d,e,f,g){var h,i,j=!1;return h=c.e,null===h?um(a,b,c,d,e):(i=h.oe(),2==i||3==i?(h.Fe(f,g),2==i&&um(a,b,c,d,e)):(0==i&&h.pe(),h.be(f,g),j=!0)),j}function um(a,b,c,d,e){b=b.M(),null!==b&&(d=b.ha(d),vm[d.G()](a,d,c,e))}function wm(a,b,c,d){this.extent=a,this.height=b,this.a=c,this.value=d}function xm(a,b){return a.extent[0]-b.extent[0]}function ym(a,b){return a.extent[1]-b.extent[1]}function zm(a,b,c,d){for(a=a.a,d=Bg(d);c>b;++b)Dg(d,a[b].extent);return d}function Am(a){var b=Bg(a.extent);a=a.a;var c,d;for(c=0,d=a.length;d>c;++c)Dg(b,a[c].extent)}function Bm(a){this.b=Math.max(4,s(a)?a:9),this.c=Math.max(2,Math.ceil(.4*this.b)),this.a=new wm(ug(),1,[],null),this.d={}}function Cm(a,b,c){var d=b.a;a=a.c;var e=d.length;bb(d,c),c=zm(b,0,a);var f=zm(b,e-a,e),g=Lg(c)+Jg(c)+(Lg(f)+Jg(f));for(b=a;e-a>b;++b)Dg(c,d[b].extent),g+=Lg(c)+Jg(c);for(b=e-a-1;b>=a;--b)Dg(f,d[b].extent),g+=Lg(f)+Jg(f);return g}function Dm(a,b,c){for(var d,e,f,g=[a];0<g.length;)if(a=g.pop(),d=a.a,1==a.height){for(a=0,e=d.length;e>a;++a)if(f=b.call(c,d[a].value))return f}else g.push.apply(g,d)}function Em(a,b,c){Fm(a,b,c,void 0)}function Fm(a,b,c,d){a=[a.a];for(var e;0<a.length;)if(e=a.pop(),Mg(b,e.extent))if(null===e.a){if(e=c.call(d,e.value))return e}else if(Ag(b,e.extent)){if(e=Dm(e,c,d))return e}else a.push.apply(a,e.a)}function Gm(a){var b=[];return a.forEach(function(a){b.push(a)}),b}function Hm(a,b){var c=[];return Fm(a,b,function(a){c.push(a)},void 0),c}function Im(a,b,c){var d=sa(c).toString();Jm(a,b,c,a.a.height-1),a.d[d]=yg(b)}function Jm(a,b,c,d){for(var e=[a.a],f=a.a;null!==f.a&&e.length-1!=d;){var g,h,i=1/0,j=1/0,f=f.a,k=null;for(g=0,h=f.length;h>g;++g){var l=f[g],m=Lg(l.extent)*Jg(l.extent),n=l.extent,o=b,p=Math.min(n[0],o[0]),q=Math.min(n[1],o[1]),r=Math.max(n[2],o[2]),n=Math.max(n[3],o[3]),p=(r-p)*(n-q)-m;j>p?(j=p,i=Math.min(m,i),k=l):p==j&&i>m&&(i=m,k=l)}f=k,e.push(f)}for(d=f,d.a.push(new wm(b,0,null,c)),Dg(d.extent,b),c=e.length-1;c>=0&&e[c].a.length>a.b;--c){for(i=a,j=e,f=c,d=j[f],h=i,k=d,g=Cm(h,k,xm),h=Cm(h,k,ym),h>g&&bb(k.a,xm),k=d,g=i.c,h=k.a.length,m=l=1/0,p=ug(),q=ug(),r=0,n=void 0,n=g;h-g>=n;++n){var p=zm(k,0,n,p),q=zm(k,n,h,q),s=p,t=q,o=Math.max(s[0],t[0]),u=Math.max(s[1],t[1]),v=Math.min(s[2],t[2]),s=Math.min(s[3],t[3]),o=Math.max(0,v-o)*Math.max(0,s-u),u=Lg(p)*Jg(p)+Lg(q)*Jg(q);l>o?(l=o,m=Math.min(u,m),r=n):o==l&&m>u&&(m=u,r=n)}k=d.a.splice(r),k=new wm(ug(),d.height,k,null),Am(d),Am(k),f?j[f-1].a.push(k):(j=k,f=d.height+1,k=Dg(d.extent.slice(),j.extent),i.a=new wm(k,f,[d,j],null))}for(;c>=0;--c)Dg(e[c].extent,b)}function Km(a,b,c){var d=a.a,e=[d];if(b=d.remove(b,c,e))for(c=e.length-1;c>=0;--c)d=e[c],0===d.a.length?c>0?Ua(e[c-1].a,d):a.clear():Am(d);return b}function Lm(a){a=s(a)?a:{},vk.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection,state:a.state}),this.b=new Bm,this.c={},this.t={},s(a.features)&&this.sa(a.features)}function Mm(a,b){var c=sa(b).toString();a.t[c]=[z(b,"change",a.me,!1,a),z(b,"propertychange",a.me,!1,a)],c=b.M(),null===c?a.c[sa(b).toString()]=b:(c=c.u(),Im(a.b,c,b)),A(a,new Nm("addfeature",b))}function Om(a,b,c){a.la([b[0],b[1],b[0],b[1]],function(a){return a.M().rb(b[0],b[1])?c.call(void 0,a):void 0})}function Nm(a,b){Qd.call(this,a),this.feature=b}function Pm(a,b){wl.call(this,a,b),this.b=!1,this.h=-1,this.i=0/0,this.w=ug(),this.d=this.A=null,this.g=rd()}function Qm(a,b){el.call(this,0,b),this.g=rd(),this.a=this.g.canvas,this.a.style.width="100%",this.a.style.height="100%",this.a.className="ol-unselectable",Ac(a,this.a,0),this.d=!0,this.i=id()}function Rm(a,b,c){var d=a.f,e=a.g;if(ue(d.ga,b)){var f=c.view2DState,g=c.pixelRatio;bl(a.i,a.a.width/2,a.a.height/2,g/f.resolution,-g/f.resolution,-f.rotation,-f.center[0],-f.center[1]),a=new jl(e,g,c.extent,a.i,f.rotation),A(d,new ti(b,d,a,c,e,null)),vl(a)}}function Sm(a,b,c){Qk.call(this,a,b),this.target=c}function Tm(a,b){var c=wc("DIV");c.style.position="absolute",Sm.call(this,a,b,c),this.d=null,this.b=kd()}function Um(a,b){var c=wc("DIV");c.style.position="absolute",Sm.call(this,a,b,c),this.b=!0,this.i=1,this.g=0,this.d={}}function Vm(a,b){this.target=wc("DIV"),this.target.style.position="absolute",this.target.style.width="100%",this.target.style.height="100%",this.c=a,this.b=b,this.f=Kg(Jk(a,b)),this.g=a.ca(b.a),this.d={},this.a=null,this.e=kd()}function Wm(a,b,c){var d=b.a,e=d.toString();if(!(e in a.d)){var f=a.c.ia(d.a),g=b.b(a),h=g.style;h.maxWidth="none";var i,j;c>0?(i=wc("DIV"),j=i.style,j.overflow="hidden",j.width=f+"px",j.height=f+"px",h.position="absolute",h.left=-c+"px",h.top=-c+"px",h.width=f+2*c+"px",h.height=f+2*c+"px",i.appendChild(g)):(h.width=f+"px",h.height=f+"px",i=g,j=h),j.position="absolute",j.left=(d.x-a.b.x)*f+"px",j.top=(a.b.y-d.y)*f+"px",null===a.a&&(a.a=document.createDocumentFragment()),a.a.appendChild(i),a.d[e]=b}}function Xm(a){null!==a.a&&(a.target.appendChild(a.a),a.a=null)}function Zm(a,b,c){var d=Kk(a.c,b,a.b.a,c);b=[];for(var e in a.d)c=a.d[e],d.contains(c.a)||b.push(c);var f,d=0;for(f=b.length;f>d;++d)c=b[d],e=c.a.toString(),Bc(c.b(a)),delete a.d[e]}function Ym(a,b){cl(b,a.e)||(wd(a.target,b),ld(a.e,b))}function $m(a,b){el.call(this,0,b),this.a=wc("DIV"),this.a.className="ol-unselectable";var c=this.a.style;c.position="absolute",c.width="100%",c.height="100%",Ac(a,this.a,0),this.d=!0}function an(){}function bn(){this.g=id(),this.d=void 0,this.a=id(),this.c=void 0,this.b=id(),this.f=void 0,this.e=id(),this.h=void 0,this.i=id()}function cn(a,b,c,d,e){var f=!1;if(s(b)&&b!==a.d&&(f=a.a,md(f),f[12]=b,f[13]=b,f[14]=b,f[15]=1,a.d=b,f=!0),s(c)&&c!==a.c){f=a.b,md(f),f[0]=c,f[5]=c,f[10]=c,f[15]=1;var g=-.5*c+.5;f[12]=g,f[13]=g,f[14]=g,f[15]=1,a.c=c,f=!0}return s(d)&&d!==a.f&&(f=Math.cos(d),g=Math.sin(d),jd(a.e,.213+.787*f-.213*g,.213-.213*f+.143*g,.213-.213*f-.787*g,0,.715-.715*f-.715*g,.715+.285*f+.14*g,.715-.715*f+.715*g,0,.072-.072*f+.928*g,.072-.072*f-.283*g,.072+.928*f+.072*g,0,0,0,0,1),a.f=d,f=!0),s(e)&&e!==a.h&&(jd(a.i,.213+.787*e,.213-.213*e,.213-.213*e,0,.715-.715*e,.715+.285*e,.715-.715*e,0,.072-.072*e,.072-.072*e,.072+.928*e,0,0,0,0,1),a.h=e,f=!0),f&&(f=a.g,md(f),s(c)&&nd(f,a.b,f),s(b)&&nd(f,a.a,f),s(e)&&nd(f,a.i,f),s(d)&&nd(f,a.e,f)),a.g}function dn(a){this.a=a}function en(a){this.a=a}function fn(a){this.a=a}function gn(){this.a="precision mediump float;varying vec2 a;uniform mat4 f;uniform float g;uniform sampler2D h;void main(void){vec4 texColor=texture2D(h,a);gl_FragColor.rgb=(f*vec4(texColor.rgb,1.)).rgb;gl_FragColor.a=texColor.a*g;}"}function hn(){this.a="varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}"}function jn(a,b){this.g=a.getUniformLocation(b,"f"),this.c=a.getUniformLocation(b,"g"),this.e=a.getUniformLocation(b,"e"),this.f=a.getUniformLocation(b,"d"),this.b=a.getUniformLocation(b,"h"),this.a=a.getAttribLocation(b,"b"),this.d=a.getAttribLocation(b,"c")}function kn(){this.a="precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}"}function ln(){this.a="varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}"}function mn(a,b){this.c=a.getUniformLocation(b,"f"),this.e=a.getUniformLocation(b,"e"),this.f=a.getUniformLocation(b,"d"),this.b=a.getUniformLocation(b,"g"),this.a=a.getAttribLocation(b,"b"),this.d=a.getAttribLocation(b,"c")}function nn(a){this.a=s(a)?a:[]}function on(a,b,c){if(b!=c){var d,e=a.a,f=e.length;for(d=0;f>d;d+=2)if(b<=e[d])return e.splice(d,0,b,c),void pn(a);e.push(b,c),pn(a)}}function pn(a){a=a.a;var b,c=a.length,d=0;for(b=0;c>b;b+=2)a[b]!=a[b+1]&&(d>0&&a[d-2]<=a[b]&&a[b]<=a[d-1]?a[d-1]=Math.max(a[d-1],a[b+1]):(a[d++]=a[b],a[d++]=a[b+1]));a.length=d}function qn(a,b){var c,d=a.a,e=d.length;for(c=0;e>c;c+=2)b.call(void 0,d[c],d[c+1])}function rn(a,b,c){var d,e=a.a,f=e.length;for(d=0;f>d;d+=2)if(!(c<e[d]||e[d+1]<b)){if(e[d]>c)break;if(b<e[d]){if(c==e[d])break;if(c<e[d+1]){e[d]=Math.max(e[d],c);break}e.splice(d,2),d-=2,f-=2}else if(b==e[d]){if(c<e[d+1]){e[d]=c;break}if(c==e[d+1]){e.splice(d,2);break}e.splice(d,2),d-=2,f-=2}else{if(c<e[d+1]){e.splice(d,2,e[d],b,c,e[d+1]);break}if(c==e[d+1]){e[d+1]=b;break}e[d+1]=b}}pn(a)}function sn(a,b,c){this.d=s(a)?a:[],this.a=[],this.b=new nn,a=s(b)?b:this.d.length,a<this.d.length&&on(this.b,a,this.d.length),this.e=this.f=null,this.c=s(c)?c:35044}function tn(a,b){Qk.call(this,a,b),this.O=new sn([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.g=this.qa=null,this.i=void 0,this.A=id(),this.B=kd(),this.da=new bn,this.l=this.h=null}function un(a,b,c){var d=a.e.c;if(s(a.i)&&a.i==c)d.bindFramebuffer(36160,a.g);else{b.postRenderFunctions.push(za(function(a,b,c){a.isContextLost()||(a.deleteFramebuffer(b),a.deleteTexture(c))},d,a.g,a.qa)),b=d.createTexture(),d.bindTexture(3553,b),d.texImage2D(3553,0,6408,c,c,0,6408,5121,null),d.texParameteri(3553,10240,9729),d.texParameteri(3553,10241,9729);
var e=d.createFramebuffer();d.bindFramebuffer(36160,e),d.framebufferTexture2D(36160,36064,3553,b,0),a.qa=b,a.g=e,a.i=c}}function vn(a,b,c,d){a=a.a,ue(a.ga,b)&&A(a,new ti(b,a,new an,d,null,c))}function wn(a,b){tn.call(this,a,b),this.d=null}function xn(a,b){var c=b.e(),d=a.e.c,e=d.createTexture();return d.bindTexture(3553,e),d.texImage2D(3553,0,6408,6408,5121,c),d.texParameteri(3553,10242,33071),d.texParameteri(3553,10243,33071),d.texParameteri(3553,10241,9729),d.texParameteri(3553,10240,9729),e}function yn(a,b,c,d,e,f,g){b*=e,c*=e,a=a.B,md(a),pd(a,2/b,2/c),qd(a,-f),od(a,g[0]-d[0],g[1]-d[1]),pd(a,(g[2]-g[0])/2,(g[3]-g[1])/2),od(a,1,1)}function zn(){this.a="precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}"}function An(){this.a="varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}"}function Bn(a,b){this.b=a.getUniformLocation(b,"e"),this.c=a.getUniformLocation(b,"d"),this.a=a.getAttribLocation(b,"b"),this.d=a.getAttribLocation(b,"c")}function Cn(a,b){tn.call(this,a,b),this.V=zn.gb(),this.ba=An.gb(),this.d=null,this.C=new sn([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.w=this.b=null,this.o=-1}function Hn(){this.L=0,this.b={},this.d=this.a=null}function Fn(a,b){return a.b.hasOwnProperty(b)}function In(a,b,c){c={Pc:b,xa:null,mb:a.d,Cb:c},null===a.d?a.a=c:a.d.xa=c,a.d=c,a.b[b]=c,++a.L}function Jn(a,b){this.f=a,this.d=b,this.a={},this.c={},this.b={},this.e=null,z(this.f,"webglcontextlost",this.yh,!1,this),z(this.f,"webglcontextrestored",this.zh,!1,this)}function En(a,b){var c=a.d,d=b.d,e=sa(b);if(e in a.a)e=a.a[e],c.bindBuffer(34962,e.buffer),qn(e.Ac,function(a,b){var e=d.slice(a,b);c.bufferSubData(34962,a,new Float32Array(e))}),e.Ac.clear();else{var f=c.createBuffer();c.bindBuffer(34962,f),c.bufferData(34962,new Float32Array(d),b.c);var g=new nn;b.a.push(g),a.a[e]={Jd:b,buffer:f,Ac:g}}}function Kn(a,b){var c=sa(b);if(c in a.c)return a.c[c];var d=a.d,e=d.createShader(b.G());return d.shaderSource(e,b.a),d.compileShader(e),a.c[c]=e}function Dn(a,b,c){var d=sa(b)+"/"+sa(c);if(d in a.b)return a.b[d];var e=a.d,f=e.createProgram();return e.attachShader(f,Kn(a,b)),e.attachShader(f,Kn(a,c)),e.linkProgram(f),a.b[d]=f}function Ln(a,b){el.call(this,0,b),this.a=wc("CANVAS"),this.a.style.width="100%",this.a.style.height="100%",this.a.className="ol-unselectable",Ac(a,this.a,0),this.t=0,this.n=rd(),this.h=!0,this.c=yd(this.a,{antialias:!0,depth:!1,bf:!0,preserveDrawingBuffer:!1,stencil:!0}),this.e=new Jn(this.a,this.c),z(this.a,"webglcontextlost",this.Sg,!1,this),z(this.a,"webglcontextrestored",this.Tg,!1,this),this.d=new Hn,this.l=null,this.i=new Wj(xa(function(a){var b=a[1];a=a[2];var c=b[0]-this.l[0],b=b[1]-this.l[1];return 65536*Math.log(a)+Math.sqrt(c*c+b*b)/a},this),function(a){return a[0].c()}),this.o=xa(function(){if(!this.i.ja()){bk(this.i);var a=Xj(this.i);Gn(this,a[0],a[3],a[4])}},this),this.g=0,Mn(this)}function Gn(a,b,c,d){var e=a.c,f=b.c();if(Fn(a.d,f))a=a.d.get(f),e.bindTexture(3553,a.qa),9729!=a.ce&&(e.texParameteri(3553,10240,9729),a.ce=9729),9729!=a.de&&(e.texParameteri(3553,10240,9729),a.de=9729);else{var g=e.createTexture();if(e.bindTexture(3553,g),d>0){var h=a.n.canvas,i=a.n;a.t!=c?(h.width=c,h.height=c,a.t=c):i.clearRect(0,0,c,c),i.drawImage(b.b(),d,d,c,c,0,0,c,c),e.texImage2D(3553,0,6408,6408,5121,h)}else e.texImage2D(3553,0,6408,6408,5121,b.b());e.texParameteri(3553,10240,9729),e.texParameteri(3553,10241,9729),e.texParameteri(3553,10242,33071),e.texParameteri(3553,10243,33071),In(a.d,f,{qa:g,ce:9729,de:9729})}}function Nn(a,b,c){var d=a.f;ue(d.ga,b)&&A(d,new ti(b,d,new an,c,null,a.e))}function Mn(a){a=a.c,a.activeTexture(33984),a.blendFuncSeparate(770,771,1,771),a.disable(2884),a.disable(2929),a.disable(3089),a.disable(2960)}function Q(a){Me.call(this);var b=Pn(a);this.bd=s(a.pixelRatio)?a.pixelRatio:Ad,this.ad=b.ol3Logo,this.n=new Aj(this.Wh,void 0,this),Od(this,this.n),this.wc=id(),this.Le=id(),this.$c=0,this.l=this.O=this.c=null,this.b=tc("DIV","ol-viewport"),this.b.style.position="relative",this.b.style.overflow="hidden",this.b.style.width="100%",this.b.style.height="100%",this.b.style.msTouchAction="none",Hd&&(this.b.className="ol-touch"),this.fa=tc("DIV","ol-overlaycontainer"),this.b.appendChild(this.fa),this.w=tc("DIV","ol-overlaycontainer-stopevent"),z(this.w,["click","dblclick","mousedown","touchstart","MSPointerDown",Xf,"mousewheel"],Rd),this.b.appendChild(this.w),a=new Pf(this),z(a,cc($f),this.he,!1,this),Od(this,a),this.ea=b.keyboardEventTarget,this.o=new Kj,z(this.o,"key",this.Xd,!1,this),Od(this,this.o),a=new Sj(this.b),z(a,"mousewheel",this.Xd,!1,this),Od(this,a),this.i=b.controls,this.xc=b.deviceOptions,this.g=b.interactions,this.h=b.overlays,this.ba=new b.Yh(this.b,this),Od(this,this.ba),this.Me=new Gj,z(this.Me,"resize",this.C,!1,this),this.V=null,this.A=[],this.Ra=[],this.Ub=new ck(xa(this.xf,this),xa(this.ag,this)),this.skippedFeatureUids_={},z(this,Qe("layergroup"),this.Lf,!1,this),z(this,Qe("view"),this.bg,!1,this),z(this,Qe("size"),this.Zf,!1,this),z(this,Qe("target"),this.$f,!1,this),this.H(b.ii),this.i.forEach(function(a){a.setMap(this)},this),z(this.i,"add",function(a){a.element.setMap(this)},!1,this),z(this.i,"remove",function(a){a.element.setMap(null)},!1,this),this.g.forEach(function(a){a.setMap(this)},this),z(this.g,"add",function(a){a.element.setMap(this)},!1,this),z(this.g,"remove",function(a){a.element.setMap(null)},!1,this),this.h.forEach(function(a){a.setMap(this)},this),z(this.h,"add",function(a){a.element.setMap(this)},!1,this),z(this.h,"remove",function(a){a.element.setMap(null)},!1,this)}function Pn(a){var b=null;s(a.keyboardEventTarget)&&(b=oa(a.keyboardEventTarget)?document.getElementById(a.keyboardEventTarget):a.keyboardEventTarget);var c={},d=s(a.ol3Logo)?a.ol3Logo:!0,e=a.layers instanceof K?a.layers:new K({layers:a.layers});c.layergroup=e,c.target=a.target,c.view=s(a.view)?a.view:new H;var f,e=el;s(a.renderer)?ma(a.renderer)?f=a.renderer:oa(a.renderer)&&(f=[a.renderer]):f=On;var g,h;for(g=0,h=f.length;h>g;++g){var i=f[g];if("canvas"==i){if(Dd){e=Qm;break}}else{if("dom"==i){e=$m;break}if("webgl"==i&&Kd){e=Ln;break}}}return f=s(a.controls)?ma(a.controls)?new D(Wa(a.controls)):a.controls:hk(),g=s(a.deviceOptions)?a.deviceOptions:{},h=s(a.interactions)?ma(a.interactions)?new D(Wa(a.interactions)):a.interactions:uk(),a=s(a.overlays)?ma(a.overlays)?new D(Wa(a.overlays)):a.overlays:new D,{controls:f,deviceOptions:g,interactions:h,keyboardEventTarget:b,ol3Logo:d,overlays:a,Yh:e,ii:c}}function Qn(a,b){Qd.call(this,a),this.feature=b}function Rn(a){ri.call(this),this.w=null,this.B=s(a.source)?a.source:null,this.A=s(a.features)?a.features:null,this.O=s(a.snapTolerance)?a.snapTolerance:12,this.C=s(a.minPointsPerRing)?a.minPointsPerRing:3;var b,c=this.n=a.type;"Point"===c||"MultiPoint"===c?b=Sn:"LineString"===c||"MultiLineString"===c?b=Tn:("Polygon"===c||"MultiPolygon"===c)&&(b=Un),this.a=b,this.c=this.h=this.l=this.f=this.e=null,this.V=4,this.o=new Ti({style:s(a.style)?a.style:Vn()})}function Vn(){var a=Si();return function(b){return a[b.M().G()]}}function Xn(a,b){if(a.a===Sn&&null===a.e)Yn(a,b);else if(null!==a.e){var c,d,e=b.coordinate,f=a.f.M();a.a===Sn?(d=f.D(),d[0]=e[0],d[1]=e[1],f.P(d)):(a.a===Tn?c=f.D():a.a===Un&&(c=a.c[0]),Zn(a,b)&&(e=a.e.slice()),a.l.M().P(e),d=c[c.length-1],d[0]=e[0],d[1]=e[1],a.a===Tn?f.P(c):a.a===Un&&(a.h.M().P(c),f.P(a.c))),$n(a)}return!0}function Zn(a,b){var c=!1;if(null!==a.f){var d=a.f.M(),e=!1,f=[a.e];if(a.a===Tn?e=2<d.D().length:a.a===Un&&(e=d.D()[0].length>a.C,f=[a.c[0][0],a.c[0][a.c[0].length-2]]),e)for(var d=b.map,e=0,g=f.length;g>e;e++){var h=f[e],i=d.f(h),j=b.pixel,c=j[0]-i[0],i=j[1]-i[1];if(c=Math.sqrt(c*c+i*i)<=a.O){a.e=h;break}}}return c}function Yn(a,b){var c=b.coordinate;a.e=c;var d;a.a===Sn?d=new ph(c.slice()):(a.l=new I(new ph(c.slice())),a.a===Tn?d=new jm([c.slice(),c.slice()]):a.a===Un&&(a.h=new I(new jm([c.slice(),c.slice()])),a.c=[[c.slice(),c.slice()]],d=new G(a.c))),a.f=new I(d),$n(a),A(a,new Qn("drawstart",a.f))}function Wn(a){a.e=null;var b=a.f;return null!==b&&(a.f=null,a.l=null,a.h=null,a.o.a.clear()),b}function $n(a){var b=[a.f];null===a.h||b.push(a.h),null===a.l||b.push(a.l),a.o.tc(new D(b))}function R(a){Me.call(this),a=s(a)?a:{},this.a=null,this.c=bi,this.b=void 0,z(this,Qe("projection"),this.Fg,!1,this),z(this,Qe("tracking"),this.Gg,!1,this),s(a.projection)&&this.h($h(a.projection)),s(a.trackingOptions)&&this.l(a.trackingOptions),this.e(s(a.tracking)?a.tracking:!1)}function bo(a,b,c,d,e){Vj.call(this,a,b),this.h=c,this.d=new Image,null!==d&&(this.d.crossOrigin=d),this.f={},this.e=null,this.n=e}function U(a){Me.call(this),this.n=s(a.insertFirst)?a.insertFirst:!0,this.A=s(a.stopEvent)?a.stopEvent:!0,this.o=s(a.offsetX)?a.offsetX:0,this.w=s(a.offsetY)?a.offsetY:0,this.b=wc("DIV"),this.b.style.position="absolute",this.a={yc:"",Qc:"",Wc:"",Yc:"",visible:!0},this.c=null,z(this,Qe("element"),this.Ff,!1,this),z(this,Qe("map"),this.Rf,!1,this),z(this,Qe("position"),this.Uf,!1,this),z(this,Qe("positioning"),this.Vf,!1,this),s(a.element)&&this.Cd(a.element),s(a.position)&&this.h(a.position),s(a.positioning)&&this.l(a.positioning)}function co(a){var b=a.e(),c=a.i();if(s(b)&&null!==b.c&&s(c)){var c=b.f(c),d=b.e(),b=a.b.style,e=a.f();if("bottom-right"==e||"center-right"==e||"top-right"==e){""!==a.a.Qc&&(a.a.Qc=b.left="");var f=Math.round(d[0]-c[0])+"px";a.a.Wc!=f&&(a.a.Wc=b.right=f)}else""!==a.a.Wc&&(a.a.Wc=b.right=""),f=-a.o,("bottom-center"==e||"center-center"==e||"top-center"==e)&&(f+=Sc(a.b).width/2),f=Math.round(c[0]-f)+"px",a.a.Qc!=f&&(a.a.Qc=b.left=f);"bottom-left"==e||"bottom-center"==e||"bottom-right"==e?(""!==a.a.Yc&&(a.a.Yc=b.top=""),c=Math.round(d[1]-c[1])+"px",a.a.yc!=c&&(a.a.yc=b.bottom=c)):(""!==a.a.yc&&(a.a.yc=b.bottom=""),d=-a.w,("center-left"==e||"center-center"==e||"center-right"==e)&&(d+=Sc(a.b).height/2),c=Math.round(c[1]-d)+"px",a.a.Yc!=c&&(a.a.Yc=b.top=c)),a.a.visible||(Vc(a.b,!0),a.a.visible=!0)}else a.a.visible&&(Vc(a.b,!1),a.a.visible=!1)}function fo(){var a=mc().a,b=a.body;return!!(b.webkitRequestFullscreen||b.mozRequestFullScreen&&a.mozFullScreenEnabled||b.msRequestFullscreen&&a.msFullscreenEnabled||b.requestFullscreen&&a.fullscreenEnabled)}function go(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():a.requestFullscreen&&a.requestFullscreen()}function ho(){var a=mc().a;return!!(a.webkitIsFullScreen||a.mozFullScreen||a.msFullscreenElement||a.fullscreenElement)}function io(a){a=s(a)?a:{},this.c=s(a.className)?a.className:"ol-full-screen";var b=tc("SPAN",{role:"tooltip"},s(a.tipLabel)?a.tipLabel:"Toggle full-screen"),c=tc("BUTTON",{"class":this.c+"-"+ho()+" ol-has-tooltip"});c.appendChild(b),b=new Gf(c),Od(this,b),z(b,sf,this.e,!1,this),z(c,["mouseout",Wd],function(){this.blur()},!1),z(ea.document,eo,this.i,!1,this),c=tc("DIV",{"class":this.c+" ol-unselectable "+(fo()?"":"ol-unsupported")},c),dk.call(this,{element:c,target:a.target}),this.h=s(a.keys)?a.keys:!1}function V(a){a=s(a)?a:{};var b=tc("DIV",{"class":s(a.className)?a.className:"ol-mouse-position"});dk.call(this,{element:b,target:a.target}),z(this,Qe("projection"),this.O,!1,this),s(a.coordinateFormat)&&this.w(a.coordinateFormat),s(a.projection)&&this.o($h(a.projection)),this.V=s(a.undefinedHTML)?a.undefinedHTML:"",this.l=b.innerHTML,this.i=this.e=this.c=null}function jo(a,b){var c=a.V;if(null!==b&&null!==a.c){if(null===a.e){var d=a.n();a.e=s(d)?Ih(a.c,d):bi}d=a.a.va(b),null!==d&&(a.e(d,d),c=a.h(),c=s(c)?c(d):d.toString())}s(a.l)&&c==a.l||(a.element.innerHTML=c,a.l=c)}function ko(a){a=s(a)?a:{};var b=s(a.className)?a.className:"ol-scale-line";this.i=tc("DIV",{"class":b+"-inner"}),this.l=tc("DIV",{"class":b+" ol-unselectable"},this.i),this.w=null,this.h=s(a.minWidth)?a.minWidth:64,this.e=!1,this.C=void 0,this.B="",this.c=null,dk.call(this,{element:this.l,target:a.target}),z(this,Qe("units"),this.O,!1,this),this.o(a.units||"metric")}function mo(a){var b=a.w;if(null===b)a.e&&(Vc(a.l,!1),a.e=!1);else{var c=b.center,d=b.projection,b=d.c(b.resolution,c),e=d.Fa,f=a.n();"degrees"!=e||"metric"!=f&&"imperial"!=f?"ft"!=e&&"m"!=e||"degrees"!=f?a.c=null:(null===a.c&&(a.c=Ih(d,$h("EPSG:4326"))),c=Math.cos(Xb(a.c(c)[1])),d=Ch.radius,"ft"==e&&(d/=.3048),b*=180/(Math.PI*c*d)):(a.c=null,c=Math.cos(Xb(c[1])),b*=Math.PI*c*Ch.radius/180),c=a.h*b,e="","degrees"==f?1/60>c?(e="",b*=3600):1>c?(e="",b*=60):e="":"imperial"==f?.9144>c?(e="in",b/=.0254):1609.344>c?(e="ft",b/=.3048):(e="mi",b/=1609.344):"nautical"==f?(b/=1852,e="nm"):"metric"==f?1>c?(e="mm",b*=1e3):1e3>c?e="m":(e="km",b/=1e3):"us"==f&&(.9144>c?(e="in",b*=39.37):1609.344>c?(e="ft",b/=.30480061):(e="mi",b/=1609.3472));for(var g,h,f=3*Math.floor(Math.log(a.h*b)/Math.log(10));g=lo[f%3]*Math.pow(10,Math.floor(f/3)),h=Math.round(g/b),!(h>=a.h);)++f;g+=e,a.B!=g&&(a.i.innerHTML=g,a.B=g),a.C!=h&&(a.i.style.width=h+"px",a.C=h),a.e||(Vc(a.l,!0),a.e=!0)}}function no(a){Ld.call(this),this.d=a,this.a={}}function po(a){$b(a.a,re),a.a={}}function qo(a,b,c){He.call(this),this.target=a,this.handle=b||a,this.d=c||new Hc(0/0,0/0,0/0,0/0),this.b=oc(a),this.a=new no(this),Od(this,this.a),z(this.handle,["touchstart","mousedown"],this.Ce,!1,this)}function so(a){return s(a.e)||(a.e=Wc(a.target)),a.e}function to(a){var b=a.type;"touchstart"==b||"touchmove"==b?Zd(a,a.N.targetTouches[0],a.d):"touchend"!=b&&"touchcancel"!=b||Zd(a,a.N.changedTouches[0],a.d)}function xo(a,b,c){var d=Fc(mc(a.b));return b+=d.x-a.c.x,c+=d.y-a.c.y,a.c=d,a.Jb+=b,a.Kb+=c,b=vo(a,a.Jb),a=wo(a,a.Kb),new Yb(b,a)}function yo(a,b,c,d){a.Fd&&so(a)?a.target.style.right=c+"px":a.target.style.left=c+"px",a.target.style.top=d+"px",A(a,new uo("drag",a,b.clientX,b.clientY,b,c,d))}function vo(a,b){var c=a.d,d=isNaN(c.left)?null:c.left,c=isNaN(c.width)?0:c.width;return Math.min(null!=d?d+c:1/0,Math.max(null!=d?d:-1/0,b))}function wo(a,b){var c=a.d,d=isNaN(c.top)?null:c.top,c=isNaN(c.height)?0:c.height;return Math.min(null!=d?d+c:1/0,Math.max(null!=d?d:-1/0,b))}function uo(a,b,c,d,e,f,g,h){Qd.call(this,a),this.clientX=c,this.clientY=d,this.c=e,this.left=s(f)?f:b.Jb,this.top=s(g)?g:b.Kb,this.b=b,this.a=!!h}function zo(a){a=s(a)?a:{},this.c=void 0,this.i=Ao,this.h=!1;var b=s(a.className)?a.className:"ol-zoomslider";a=tc("DIV",[b+"-thumb","ol-unselectable"]),b=tc("DIV",[b,"ol-unselectable"],a),this.e=new qo(a),Od(this,this.e),z(this.e,["drag","end"],this.n,void 0,this),z(b,"click",this.l,!1,this),z(a,"click",Rd),dk.call(this,{element:b})}function Co(a,b,c){var d=a.e.d,e=0;return e=1===a.i?(b-d.left)/d.width:(c-d.top)/d.height}function Bo(a,b){return b=-1*(Vb(b,0,1)-1),di(a.a.a().Y())(b)}function Do(a){a=s(a)?a:{},this.c=s(a.extent)?a.extent:null;var b=s(a.className)?a.className:"ol-zoom-extent",c=tc("SPAN",{role:"tooltip"},s(a.tipLabel)?a.tipLabel:"Fit to extent"),b=tc("DIV",{"class":b+" ol-unselectable"}),d=tc("BUTTON",{"class":"ol-has-tooltip"});d.appendChild(c),b.appendChild(d),c=new Gf(d),Od(this,c),z(c,sf,this.e,!1,this),z(d,["mouseout",Wd],function(){this.blur()},!1),dk.call(this,{element:b,target:a.target})}function Eo(a){Me.call(this),this.a=a,z(this.a,["change","input"],this.i,!1,this),z(this,Qe("value"),this.h,!1,this),z(this,Qe("checked"),this.g,!1,this)}function Fo(){}function Ko(a,b){return Jo.createElementNS(a,b)}function Lo(a,b){return null===a&&(a=""),Jo.createNode(1,b,a)}function No(a){return Oo(a,!1,[]).join("")}function Oo(a,b,c){if(4==a.nodeType||3==a.nodeType)c.push(b?String(a.nodeValue).replace(/(\r\n|\r|\n)/g,""):a.nodeValue);else for(a=a.firstChild;null!==a;a=a.nextSibling)Oo(a,b,c);return c}function Po(a){return a.localName}function Qo(a){var b=a.localName;return s(b)?b:a.baseName}function So(a){return a instanceof Document}function To(a){return ra(a)&&9==a.nodeType}function Vo(a){return a instanceof Node}function Wo(a){return ra(a)&&s(a.nodeType)}function Yo(a,b,c){return a.getAttributeNS(b,c)||""}function Zo(a,b,c){var d="";return a=$o(a,b,c),s(a)&&(d=a.nodeValue),d}function bp(a,b,c){return a.getAttributeNodeNS(b,c)}function cp(a,b,c){var d=null;a=a.attributes;for(var e,f,g=0,h=a.length;h>g;++g)if(e=a[g],e.namespaceURI==b&&(f=e.prefix?e.prefix+":"+c:c,f==e.nodeName)){d=e;break}return d}function dp(a,b,c,d){a.setAttributeNS(b,c,d)}function ep(a,b,c,d){null===b?a.setAttribute(c,d):(b=a.ownerDocument.createNode(2,c,b),b.nodeValue=d,a.setAttributeNode(b))}function gp(a){return(new DOMParser).parseFromString(a,"application/xml")}function hp(a,b){return function(c,d){var e=a.call(b,c,d);s(e)&&Ya(d[d.length-1],e)}}function ip(a,b){return function(c,d){var e=a.call(b,c,d);s(e)&&d[d.length-1].push(e)}}function jp(a){return function(b,c){var d=a.call(void 0,b,c);s(d)&&(c[c.length-1]=d)}}function kp(a){return function(b,c){var d=a.call(void 0,b,c);s(d)&&ic(c[c.length-1],s(void 0)?void 0:b.localName).push(d)}}function W(a,b){return function(c,d){var e=a.call(void 0,c,d);s(e)&&(d[d.length-1][s(b)?b:c.localName]=e)}}function X(a){return function(b,c,d){a.call(void 0,b,c,d),d[d.length-1].node.appendChild(b)}}function lp(a){var b,c;return function(d,e,f){if(!s(b)){b={};var g={};g[d.localName]=a,b[d.namespaceURI]=g,c=mp(d.localName)}np(b,c,e,f)}}function mp(a,b){return function(c,d,e){return c=d[d.length-1].node,d=a,s(d)||(d=e),e=b,s(b)||(e=c.namespaceURI),Mo(e,d)}}function pp(a,b){for(var c=b.length,d=Array(c),e=0;c>e;++e)d[e]=a[b[e]];return d}function Y(a,b,c){c=s(c)?c:{};var d,e;for(d=0,e=a.length;e>d;++d)c[a[d]]=b;return c}function qp(a,b,c,d){for(b=b.firstElementChild;null!==b;b=b.nextElementSibling){var e=a[b.namespaceURI];s(e)&&(e=e[b.localName],s(e)&&e.call(d,b,c))}}function Z(a,b,c,d,e){return d.push(a),qp(b,c,d,e),d.pop()}function np(a,b,c,d,e,f){for(var g,h,i=(s(e)?e:c).length,j=0;i>j;++j)g=c[j],s(g)&&(h=b.call(f,g,d,s(e)?e[j]:void 0),s(h)&&a[h.namespaceURI][h.localName].call(f,h,g,d))}function rp(a,b,c,d,e,f){e.push(a),np(b,c,d,e,f,void 0),e.pop()}function sp(){}function tp(a,b){var c=up(a,b);return 0<c.length?c[0]:null}function up(a,b){var c,d=[];for(c=b.firstChild;null!==c;c=c.nextSibling)1==c.nodeType&&Ya(d,a.Sb(c));return d}function xp(a){return a=No(a),yp(a)}function yp(a){return(a=/^\s*(true|1)|(false|0)\s*$/.exec(a))?s(a[1])||!1:void 0}function zp(a){if(a=No(a),a=/^\s*(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(Z|(?:([+\-])(\d{2})(?::(\d{2}))?))\s*$/.exec(a)){var b=Date.UTC(parseInt(a[1],10),parseInt(a[2],10)-1,parseInt(a[3],10),parseInt(a[4],10),parseInt(a[5],10),parseInt(a[6],10))/1e3;if("Z"!=a[7]){var c="-"==a[8]?-1:1,b=b+60*c*parseInt(a[9],10);s(a[10])&&(b+=3600*c*parseInt(a[10],10))}return b}}function Ap(a){return a=No(a),Bp(a)}function Bp(a){return(a=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(a))?parseFloat(a[1]):void 0}function Cp(a){return a=No(a),Dp(a)}function Dp(a){return(a=/^\s*(\d+)\s*$/.exec(a))?parseInt(a[1],10):void 0}function Ep(a){return a=No(a),Da(a)}function Fp(a,b){a.appendChild(Jo.createTextNode(b.toPrecision()))}function Gp(a,b){a.appendChild(Jo.createTextNode(b.toString()))}function Hp(a,b){a.appendChild(Jo.createTextNode(b))}function Ip(){}function Kp(a,b,c){return a.push(parseFloat(b.getAttribute("lon")),parseFloat(b.getAttribute("lat"))),"ele"in c?(a.push(w(c,"ele")),hc(c,"ele")):a.push(0),"time"in c?(a.push(w(c,"time")),hc(c,"time")):a.push(0),a}function Lp(a,b){var c=b[b.length-1],d=a.getAttribute("href");null!==d&&(c.link=d),qp(Mp,a,b)}function Np(a,b){var c=Z({flatCoordinates:[]},Op,a,b);if(s(c)){var d=w(c,"flatCoordinates");hc(c,"flatCoordinates");var e=new jm(null);return km(e,"XYZM",d),d=new I(e),d.H(c),d}}function Pp(a,b){var c=Z({flatCoordinates:[],ends:[]},Qp,a,b);if(s(c)){var d=w(c,"flatCoordinates");hc(c,"flatCoordinates");var e=w(c,"ends");hc(c,"ends");var f=new lm(null);return mm(f,"XYZM",d,e),d=new I(f),d.H(c),d}}function Rp(a,b){var c=Z({},Sp,a,b);if(s(c)){var d=Kp([],a,c),d=new ph(d,"XYZM"),d=new I(d);return d.H(c),d}}function Yp(a,b,c){a.setAttribute("href",b),b=w(c[c.length-1],"properties"),rp({node:a},Zp,op,[w(b,"linkText"),w(b,"linkType")],c,$p)}function aq(a,b,c){var d=c[c.length-1],e=d.node.namespaceURI,f=w(d,"properties");switch(fp(a,null,"lat",b[1]),fp(a,null,"lon",b[0]),w(d,"geometryLayout")){case"XYZM":0!==b[3]&&(f.time=b[3]);case"XYZ":0!==b[2]&&(f.ele=b[2]);break;case"XYM":0!==b[2]&&(f.time=b[2])}b=bq[e],d=pp(f,b),rp({node:a,properties:f},cq,op,d,c,b)}function wp(a,b){var c=a.M();return s(c)?Mo(b[b.length-1].node.namespaceURI,jq[c.G()]):void 0}function kq(a){if(a=String(a),/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a)}function lq(){}function mq(a){return ra(a)?a:oa(a)?(a=Gd?JSON.parse(a):kq(a),s(a)?a:null):null}function qq(a){a=s(a)?a:{},this.d=$h(a.defaultProjection?a.defaultProjection:"EPSG:4326")}function oq(a){return null===a?null:rq[a.type](a)}function sq(a){return tq[a.G()](a)}function nq(a){var b=oq(a.geometry),b=new I(b);return s(a.id)&&b.b(a.id),s(a.properties)&&b.H(a.properties),b}function pq(a){var b={type:"Feature"},c=a.Z;return null!=c&&(b.id=c),c=a.M(),null!=c&&(c=sq(c),b.geometry=c),a=a.S(),hc(a,"geometry"),ec(a)||(b.properties=a),b}function uq(a){return a=vq(a),Pa(a,function(a){return a.b.substring(a.d,a.a)})}function wq(a,b,c,d){this.b=a,this.d=b,this.a=c,this.c=d}function vq(a){for(var b,c=RegExp("\r\n|\r|\n","g"),d=0,e=[];b=c.exec(a);)d=new wq(a,d,b.index,b.index+b[0].length),e.push(d),d=c.lastIndex;return d<a.length&&(d=new wq(a,d,a.length,a.length),e.push(d)),e}function xq(){}function zq(a){a=s(a)?a:{},this.a=s(a.altitudeMode)?a.altitudeMode:"none"}function yq(a,b){var c,d,e=a.a,f=uq(b),g={},h=[],i=2e3,j=0,k=1;for(c=0,d=f.length;d>c;++c){var l,m=f[c];if("B"==m.charAt(0)){if(l=Aq.exec(m)){var m=parseInt(l[1],10),n=parseInt(l[2],10),o=parseInt(l[3],10),p=parseInt(l[4],10)+parseInt(l[5],10)/6e4;"S"==l[6]&&(p=-p);var q=parseInt(l[7],10)+parseInt(l[8],10)/6e4;"W"==l[9]&&(q=-q),h.push(q,p),"none"!=e&&h.push("gps"==e?parseInt(l[11],10):"barometric"==e?parseInt(l[12],10):0),h.push(Date.UTC(i,j,k,m,n,o)/1e3)}}else"H"==m.charAt(0)&&((l=Cq.exec(m))?(k=parseInt(l[1],10),j=parseInt(l[2],10)-1,i=2e3+parseInt(l[3],10)):(l=Bq.exec(m))&&(g[l[1]]=Da(l[2]),Cq.exec(m)))}return 0===h.length?null:(f=new jm(null),km(f,"none"==e?"XYM":"XYZM",h),e=new I(f),e.H(g),e)}function Dq(a){function b(a){return ma(a)?a:oa(a)?(!(a in d)&&"#"+a in d&&(a="#"+a),b(d[a])):c}a=s(a)?a:{};var c=s(a.defaultStyle)?a.defaultStyle:Eq,d={};this.a=d,this.d=function(){var a=this.get("Style");return s(a)?a:(a=this.get("styleUrl"),s(a)?b(a):c)}}function Oq(a){return a=No(a),(a=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(a))?(a=a[1],[parseInt(a.substr(6,2),16),parseInt(a.substr(4,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(0,2),16)/255]):void 0}function Pq(a){a=No(a);for(var b,c=[],d=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i;b=d.exec(a);)c.push(parseFloat(b[1]),parseFloat(b[2]),b[3]?parseFloat(b[3]):0),a=a.substr(b[0].length);return""!==a?void 0:c}function Qq(a){var b=No(a);return null!=a.baseURI?wj(a.baseURI,Da(b)).toString():Da(b)}function Rq(a,b){return Z(null,Sq,a,b)}function Tq(a,b){var c=Z({j:[],He:[]},Uq,a,b);if(s(c)){var d,e,f=c.j,c=c.He;for(d=0,e=Math.min(f.length,c.length);e>d;++d)f[4*d+3]=c[d];return c=new jm(null),km(c,"XYZM",f),c}}function Vq(a,b){var c=Z(null,Wq,a,b);if(s(c)){var d=new jm(null);return km(d,"XYZ",c),d}}function Xq(a,b){var c=Z(null,Wq,a,b);if(s(c)){var d=new G(null);return xh(d,"XYZ",c,[c.length]),d}}function Yq(a,b){var c=Z([],Zq,a,b);if(!s(c))return null;if(0===c.length)return new cm(c);var d,e,f,g=!0,h=c[0].G();for(e=1,f=c.length;f>e;++e)if(d=c[e],d.G()!=h){g=!1;break}if(g){if("Point"==h){for(d=c[0],g=d.b,h=d.j,e=1,f=c.length;f>e;++e)d=c[e],ig(h,d.j);return c=new om(null),Wg(c,g,h),c.k(),c}return"LineString"==h?(d=new lm(null),nm(d,c),d):"Polygon"==h?(d=new pm(null),rm(d,c),d):"GeometryCollection"==h?new cm(c):null}return new cm(c)}function $q(a,b){var c=Z(null,Wq,a,b);if(null!=c){var d=new ph(null);return qh(d,"XYZ",c),d}}function ar(a,b){var c=Z([null],br,a,b);if(null!=c&&null!==c[0]){var d,e,f=new G(null),g=c[0],h=[g.length];for(d=1,e=c.length;e>d;++d)ig(g,c[d]),h.push(g.length);return xh(f,"XYZ",g,h),f}}function cr(a,b){var c=Z({},dr,a,b);if(!s(c))return null;var d=w(c,"fillStyle",Iq),e=w(c,"fill");s(e)&&!e&&(d=null);var e=w(c,"imageStyle",Lq),f=w(c,"strokeStyle",Mq),c=w(c,"outline");return s(c)&&!c&&(f=null),[new Oi({fill:d,image:e,stroke:f,text:null,zIndex:void 0})]}function ur(){}function vr(a,b){var c=a.getAttribute("k"),d=a.getAttribute("v");b[b.length-1].uc[c]=d}function Ar(a){this.d=$h((s(a)?a:{}).defaultProjection||"EPSG:4326")}function Br(a,b){var c,d,e,f=[];for(d=0,e=a.length;e>d;++d)c=a[d],d>0&&f.pop(),c=c>=0?b[c]:b[~c].slice().reverse(),f.push.apply(f,c);for(d=0,e=f.length;e>d;++d)f[d]=f[d].slice();return f}function Cr(a,b,c,d){a=a.geometries;var e,f,g=[];for(e=0,f=a.length;f>e;++e)g[e]=Dr(a[e],b,c,d);return g}function Dr(a,b,c,d){var e=a.type,f=Er[e];return b="Point"===e||"MultiPoint"===e?f(a,c,d):f(a,b),c=new I,c.pb(b),s(a.id)&&c.b(a.id),s(a.properties)&&c.H(a.properties),c}function Fr(a,b,c){a[0]=a[0]*b[0]+c[0],a[1]=a[1]*b[1]+c[1]}function Gr(a,b){var c,d=Ro(a),e=b[0],f=w(e,"featureType");if("FeatureCollection"==d)c=Z(null,Hr,a,b);else if("featureMembers"==d||"featureMember"==d){c={};var g={};c[f]="featureMembers"==d?ip(Ir):jp(Ir),g[w(e,"featureNS")]=c,c=Z([],g,a,b)}return s(c)||(c=[]),c}function Jr(a,b){var c=a.firstElementChild.getAttribute("srsName");return b[0].srsName=c,c=Z(null,Kr,a,b),null!=c?c:void 0}function Ir(a,b){var c,d,e=a.getAttribute("fid")||ap(a,"http://www.opengis.net/gml","id"),f={};for(c=a.firstElementChild;null!==c;c=c.nextElementSibling)if(0===c.childNodes.length||1===c.childNodes.length&&3===c.firstChild.nodeType){var g=No(c);/^[\s\xa0]*$/.test(g)&&(g=void 0),f[Ro(c)]=g}else d=Ro(c),f[d]=Jr(c,b);return c=new I(f),s(d)&&c.i(d),e&&c.b(e),c}function Lr(a,b){qp(Mr,a,b)}function Nr(a,b){qp(Or,a,b)}function Pr(a,b){qp(Qr,a,b)}function Rr(a,b){qp(Sr,a,b)}function Tr(a,b){qp(Ur,a,b)}function Vr(a,b){var c=Wr(a,b);if(null!=c){var d=new jm(null);return km(d,"XYZ",c),d}}function Xr(a,b){var c=Z([null],Yr,a,b);if(s(c)&&null!==c[0]){var d,e,f=new G(null),g=c[0],h=[g.length];for(d=1,e=c.length;e>d;++d)ig(g,c[d]),h.push(g.length);return xh(f,"XYZ",g,h),f}}function Zr(a,b){var c=Z([null],$r,a,b);if(s(c)&&null!==c[0]){var d,e,f=new G(null),g=c[0],h=[g.length];for(d=1,e=c.length;e>d;++d)ig(g,c[d]),h.push(g.length);return xh(f,"XYZ",g,h),f}}function as(a,b){var c=Z([null],bs,a,b);if(s(c)){var d=new jm(null);return km(d,"XYZ",c),d}}function Wr(a,b){return Z(null,cs,a,b)}function ds(a,b){var c=No(a).replace(/^\s*|\s*$/g,""),d=w(b[0],"srsName"),e=a.parentNode.getAttribute("srsDimension"),f="enu";null===d||(f=Gh($h(d))),c=c.split(/\s+/),d=2,ka(a.getAttribute("srsDimension"))?ka(a.getAttribute("dimension"))?null===e||(d=Dp(e)):d=Dp(a.getAttribute("dimension")):d=Dp(a.getAttribute("srsDimension"));for(var g,h,i=[],j=0,k=c.length;k>j;j+=d)e=parseFloat(c[j]),g=parseFloat(c[j+1]),h=3===d?parseFloat(c[j+2]):0,"en"===f.substr(0,2)?i.push(e,g,h):i.push(g,e,h);return i}function ns(a,b,c){c=w(c[c.length-1],"srsName"),b=b.D();for(var d,e=b.length,f=Array(e),g=0;e>g;++g){d=b[g];var h=f,i=g,j="enu";null!=c&&(j=Gh($h(c))),h[i]="en"===j.substr(0,2)?d[0]+" "+d[1]:d[1]+" "+d[0]}Hp(a,f.join(" "))}function os(a,b,c){var d=w(c[c.length-1],"srsName");null!=d&&a.setAttribute("srsName",d),d=Mo(a.namespaceURI,"pos"),a.appendChild(d),c=w(c[c.length-1],"srsName"),a="enu",null!=c&&(a=Gh($h(c))),b=b.D(),Hp(d,"en"===a.substr(0,2)?b[0]+" "+b[1]:b[1]+" "+b[0])}function qs(a,b,c){var d=w(c[c.length-1],"srsName");null!=d&&a.setAttribute("srsName",d),d=Mo(a.namespaceURI,"posList"),a.appendChild(d),ns(d,b,c)}function rs(a,b){var c=b[b.length-1],d=c.node,e=w(c,"exteriorWritten");return s(e)||(c.exteriorWritten=!0),Mo(d.namespaceURI,s(e)?"interior":"exterior")}function ss(a,b,c){var d=w(c[c.length-1],"srsName");"PolygonPatch"!==a.nodeName&&null!=d&&a.setAttribute("srsName",d),"Polygon"===a.nodeName||"PolygonPatch"===a.nodeName?(b=b.Ud(),rp({node:a,srsName:d},ts,rs,b,c)):"Surface"===a.nodeName&&(d=Mo(a.namespaceURI,"patches"),a.appendChild(d),a=Mo(d.namespaceURI,"PolygonPatch"),d.appendChild(a),ss(a,b,c))}function us(a,b,c){var d=w(c[c.length-1],"srsName");"LineStringSegment"!==a.nodeName&&null!=d&&a.setAttribute("srsName",d),"LineString"===a.nodeName||"LineStringSegment"===a.nodeName?(d=Mo(a.namespaceURI,"posList"),a.appendChild(d),ns(d,b,c)):"Curve"===a.nodeName&&(d=Mo(a.namespaceURI,"segments"),a.appendChild(d),a=Mo(d.namespaceURI,"LineStringSegment"),d.appendChild(a),us(a,b,c))}function vs(a,b,c){var d=c[c.length-1],e=w(d,"srsName"),d=w(d,"surface");null!=e&&a.setAttribute("srsName",e),b=b.Wd(),rp({node:a,srsName:e,surface:d},ws,xs,b,c)}function ys(a,b,c){var d=c[c.length-1],e=w(d,"srsName"),d=w(d,"curve");null!=e&&a.setAttribute("srsName",e),b=b.ld(),rp({node:a,srsName:e,curve:d},zs,xs,b,c)}function As(a,b,c){var d=Mo(a.namespaceURI,"LinearRing");a.appendChild(d),qs(d,b,c)}function Bs(a,b,c){var d=Cs(b,c);s(d)&&(a.appendChild(d),ss(d,b,c))}function Ds(a,b,c){var d=Cs(b,c);s(d)&&(a.appendChild(d),us(d,b,c))}function Es(a,b,c){var d=jc(c[c.length-1]);d.node=a,rp(d,Fs,Cs,[b],c)}function xs(a,b){return Mo("http://www.opengis.net/gml",Hs[b[b.length-1].node.nodeName])}function Cs(a,b){var c,d=b[b.length-1],e=w(d,"multiSurface"),f=w(d,"surface"),g=w(d,"curve"),d=w(d,"multiCurve");return ma(a)?c="Envelope":(c=a.G(),"MultiPolygon"===c&&!0===e?c="MultiSurface":"Polygon"===c&&!0===f?c="Surface":"LineString"===c&&!0===g?c="Curve":"MultiLineString"===c&&!0===d&&(c="MultiCurve")),Mo("http://www.opengis.net/gml",c)}function Is(a){a=s(a)?a:{},this.b=a.featureType,this.a=a.featureNS,this.d=s(a.schemaLocation)?a.schemaLocation:"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"}function Ls(a){for(a=a.firstChild;null!==a;a=a.nextSibling)if(1==a.nodeType)return Ms(a)}function Ms(a){var b={},c=Dp(a.getAttribute("numberOfFeatures"));return b.numberOfFeatures=c,Z(b,Ns,a,[])}function Js(a){for(a=a.firstChild;null!==a;a=a.nextSibling)if(1==a.nodeType)return Z({},Ks,a,[])}function Ss(a,b){var c=Mo("http://www.opengis.net/ogc","Filter"),d=Mo("http://www.opengis.net/ogc","FeatureId");c.appendChild(d),d.setAttribute("fid",b),a.appendChild(c)}function Vs(a){return a.getAttributeNS("http://www.w3.org/1999/xlink","href")}function Ws(){}function Zs(){this.version=void 0}function Xs(a,b){for(var c=b.firstChild;null!==c;c=c.nextSibling)if(1==c.nodeType)return Ys(a,c);return null}function Ys(a,b){a.version=Da(b.getAttribute("version"));var c=Z({version:a.version},$s,b,[]);return s(c)?c:null}function at(a,b){return Z({},bt,a,b)}function ct(a,b){return Z({},dt,a,b)}function et(a,b){var c=at(a,b);if(s(c)){var d=[Dp(a.getAttribute("width")),Dp(a.getAttribute("height"))];return c.size=d,c}}function ft(a,b){return Z([],gt,a,b)}function vt(a,b){He.call(this),this.a=new no(this);var c=a;b&&(c=oc(a)),this.a.oa(c,"dragenter",this.Ah),c!=a&&this.a.oa(c,"dragover",this.Bh),this.a.oa(a,"dragover",this.Ch),this.a.oa(a,"drop",this.Dh)}function wt(a,b){this.a=[],this.f=a,this.e=b||null}function zt(a,b,c){a.fb=!0,a.b=c,a.nc=!b,At(a)}function yt(a){if(a.fb){if(!a.Dd)throw new Bt(a);a.Dd=!1}}function Ct(a){return Qa(a.a,function(a){return qa(a[1])})}function At(a){a.c&&a.fb&&Ct(a)&&(ea.clearTimeout(a.c),delete a.c),a.d&&(a.d.ed--,delete a.d);for(var b=a.b,c=!1,d=!1;a.a.length&&!a.dd;){var e=a.a.shift(),f=e[0],g=e[1],e=e[2];if(f=a.nc?g:f)try{var h=f.call(e||a.e,b);s(h)&&(a.nc=a.nc&&(h==b||h instanceof Error),a.b=b=h),b instanceof wt&&(d=!0,a.dd=!0)}catch(i){b=i,a.nc=!0,Ct(a)||(c=!0)}}a.b=b,d&&(d=b,h=xa(a.Ld,a,!0),f=xa(a.Ld,a,!1),d.a.push([h,f,void 0]),d.fb&&At(d),b.We=!0),c&&(a.c=ea.setTimeout(Ce(b),0))
}function Bt(a){Ba.call(this),this.a=a}function xt(a){Ba.call(this),this.a=a}function Dt(a,b){Ba.call(this,Ca("Error %s: %s",b,Et(a))),this.code=a}function Et(a){switch(a){case 1:return"File or directory not found";case 2:return"Insecure or disallowed operation";case 3:return"Operation aborted";case 4:return"File or directory not readable";case 5:return"Invalid encoding";case 6:return"Cannot modify file or directory";case 7:return"Invalid state";case 8:return"Invalid line-ending specifier";case 9:return"Invalid modification";case 10:return"Quota exceeded";case 11:return"Invalid filetype";case 12:return"File or directory already exists at specified path";default:return"Unrecognized error"}}function Ft(a,b){Qd.call(this,a.type,b),this.a=a}function Gt(){He.call(this),this.Da=new FileReader,this.Da.onloadstart=xa(this.a,this),this.Da.onprogress=xa(this.a,this),this.Da.onload=xa(this.a,this),this.Da.onabort=xa(this.a,this),this.Da.onerror=xa(this.a,this),this.Da.onloadend=xa(this.a,this)}function Ht(a){var b=new wt;return a.addEventListener("loadend",za(function(a,b){var c=b.Da.result,d=b.getError();null==c||d?(yt(a),zt(a,!1,d)):(yt(a),zt(a,!0,c)),b.bc()},b,a)),b}function It(a){a=s(a)?a:{},ni.call(this),this.c=s(a.formatConstructors)?a.formatConstructors:[],this.e=s(a.reprojectTo)?$h(a.reprojectTo):null,this.b=null,this.a=void 0}function Jt(a,b,c,d,e){Qd.call(this,a,b),this.features=d,this.file=c,this.projection=e}function Lt(a,b){this.x=a,this.y=b}function Mt(a){a=s(a)?a:{},ri.call(this),this.f=s(a.condition)?a.condition:dg,this.a=this.c=void 0,this.e=0}function Nt(a){ri.call(this),this.B=s(a.deleteCondition)?a.deleteCondition:Ee(cg,bg),this.A=this.c=null,this.w=[0,0],this.a=new Bm,this.f=s(a.pixelTolerance)?a.pixelTolerance:10,this.o=!1,this.e=null,this.h=new Ti({style:s(a.style)?a.style:Ot()}),this.n={Point:this.oi,LineString:this.Ie,LinearRing:this.Ie,Polygon:this.pi,MultiPoint:this.mi,MultiLineString:this.li,MultiPolygon:this.ni,GeometryCollection:this.ki},this.l=a.features,this.l.forEach(this.ke,this),z(this.l,"add",this.Gf,!1,this),z(this.l,"remove",this.Hf,!1,this)}function Qt(a,b){var c=a.c;null===c?(c=new I(new ph(b)),a.c=c,a.h.fe(c)):c.M().P(b)}function Pt(a,b,c){function d(a,b){return bf(e,Xe(e,a.$))-bf(e,Xe(e,b.$))}var e=c.va(b),f=c.va([b[0]-a.f,b[1]+a.f]),g=c.va([b[0]+a.f,b[1]-a.f]),f=tg([f,g]),f=Hm(a.a,f);if(0<f.length){f.sort(d);var g=f[0].$,h=Xe(e,g),i=c.f(h);if(Math.sqrt(bf(b,i))<=a.f){for(b=c.f(g[0]),c=c.f(g[1]),b=bf(i,b),c=bf(i,c),a.o=Math.sqrt(Math.min(b,c))<=a.f,a.o&&(h=b>c?g[1]:g[0]),Qt(a,h),c={},c[sa(g)]=!0,b=1,i=f.length;i>b&&(h=f[b].$,$e(g[0],h[0])&&$e(g[1],h[1])||$e(g[0],h[1])&&$e(g[1],h[0]));++b)c[sa(h)]=!0;return void(a.A=c)}}null!==a.c&&(a.h.Rc(a.c),a.c=null)}function Rt(a,b,c,d,e){Em(a.a,b.u(),function(a){a.geometry===b&&(!s(d)||eb(a.depth,d))&&a.index>c&&(a.index+=e)})}function Ot(){var a=Si();return function(){return a.Point}}function St(a){ni.call(this),a=s(a)?a:{},this.e=s(a.condition)?a.condition:bg,this.c=s(a.addCondition)?a.addCondition:ze,this.f=s(a.removeCondition)?a.removeCondition:ze,this.i=s(a.toggleCondition)?a.toggleCondition:dg;var b;if(s(a.layers))if(qa(a.layers))b=a.layers;else{var c=a.layers;b=function(a){return 0<=Na(c,a)}}else b=Ae;this.b=b,this.a=new Ti({style:s(a.style)?a.style:Tt()}),a=this.a.a,z(a,"add",this.Qg,!1,this),z(a,"remove",this.Sh,!1,this)}function Tt(){var a=Si();return Ya(a.Polygon,a.LineString),Ya(a.GeometryCollection,a.LineString),function(b){return a[b.M().G()]}}function $(a){a=s(a)?a:{},P.call(this,a),this.ea=null,z(this,Qe("gradient"),this.$c,!1,this),this.xc(s(a.gradient)?a.gradient:Ut);var b,c=Vt(s(a.radius)?a.radius:8,s(a.blur)?a.blur:15,s(a.shadow)?a.shadow:250),d=Array(256),e=s(a.weight)?a.weight:"weight";b=oa(e)?function(a){return a.get(e)}:e,this.fa(function(a){a=b(a),a=s(a)?Vb(a,0,1):1;var e=255*a|0,f=d[e];return s(f)||(f=[new Oi({image:new Zk({opacity:a,src:c})})],d[e]=f),f}),this.v("renderOrder",null),z(this,"render",this.ad,!1,this)}function Vt(a,b,c){var d=a+b+1,e=2*d,e=rd(e,e);return e.shadowOffsetX=e.shadowOffsetY=c,e.shadowBlur=b,e.shadowColor="#000",e.beginPath(),b=d-c,e.arc(b,b,a,0,2*Math.PI,!0),e.fill(),e.canvas.toDataURL()}function Wt(a){return[a]}function Yt(a){Fh.call(this,{code:a.code,extent:a.extent,global:!1,units:"m"})}function au(){Yt.call(this,{code:"EPSG:2056",extent:bu})}function cu(){Yt.call(this,{code:"EPSG:21781",extent:du})}function eu(a,b){var c=b||{},d=c.document||document,e=wc("SCRIPT"),f={xe:e,Ab:void 0},g=new wt(fu,f),h=null,i=null!=c.timeout?c.timeout:5e3;return i>0&&(h=window.setTimeout(function(){gu(e,!0);var b=new hu(iu,"Timeout reached for loading script "+a);yt(g),zt(g,!1,b)},i),f.Ab=h),e.onload=e.onreadystatechange=function(){e.readyState&&"loaded"!=e.readyState&&"complete"!=e.readyState||(gu(e,c.Ze||!1,h),yt(g),zt(g,!0,null))},e.onerror=function(){gu(e,!0,h);var b=new hu(ju,"Error while loading script "+a);yt(g),zt(g,!1,b)},qc(e,{type:"text/javascript",charset:"UTF-8",src:a}),ku(d).appendChild(e),g}function ku(a){var b=a.getElementsByTagName("HEAD");return b&&0!=b.length?b[0]:a.documentElement}function fu(){if(this&&this.xe){var a=this.xe;a&&"SCRIPT"==a.tagName&&gu(a,!0,this.Ab)}}function gu(a,b,c){null!=c&&ea.clearTimeout(c),a.onload=fa,a.onerror=fa,a.onreadystatechange=fa,b&&window.setTimeout(function(){Bc(a)},0)}function hu(a,b){var c="Jsloader error (code #"+a+")";b&&(c+=": "+b),Ba.call(this,c),this.code=a}function lu(a,b){this.d=new gj(a),this.a=b?b:"callback",this.Ab=5e3}function nu(a,b,c){var d=b||null;b="_"+(mu++).toString(36)+Aa().toString(36),ea._callbacks_||(ea._callbacks_={});var e=a.d.Q();if(d)for(var f in d)d.hasOwnProperty&&!d.hasOwnProperty(f)||tj(e,f,d[f]);c&&(ea._callbacks_[b]=ou(b,c),tj(e,a.a,"_callbacks_."+b)),a=eu(e.toString(),{timeout:a.Ab,Ze:!0}),a.a.push([null,pu(b),void 0]),a.fb&&At(a)}function pu(a){return function(){qu(a,!1)}}function ou(a,b){return function(){qu(a,!0),b.apply(void 0,arguments)}}function qu(a,b){ea._callbacks_[a]&&(b?delete ea._callbacks_[a]:ea._callbacks_[a]=fa)}function ru(a){return function(b){return null===b?void 0:a.replace("{z}",b.a.toString()).replace("{x}",b.x.toString()).replace("{y}",b.y.toString()).replace("{-y}",function(){return((1<<b.a)-b.y-1).toString()})}}function su(a){return tu(Pa(a,ru))}function tu(a){return 1===a.length?a[0]:function(b,c,d){return null===b?void 0:a[Wb((b.x<<b.a)+b.y,a.length)](b,c,d)}}function uu(){}function vu(a,b){var c=new gb(0,0,0);return function(d,e,f){return null===d?void 0:b(a(d,f,c),e,f)}}function wu(a){var b=[],c=/\{(\d)-(\d)\}/.exec(a)||/\{([a-z])-([a-z])\}/.exec(a);if(c){var d,e=c[2].charCodeAt(0);for(d=c[1].charCodeAt(0);e>=d;++d)b.push(a.replace(c[0],String.fromCharCode(d)))}else b.push(a);return b}function xu(a){Hn.call(this),this.c=s(a)?a:2048}function yu(a,b){for(var c,d;a.Ka()>a.c&&(c=a.a.Cb,d=c.a.a.toString(),!(d in b&&b[d].contains(c.a)));)a.pop()}function zu(a){Ok.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,opaque:a.opaque,projection:a.projection,tileGrid:a.tileGrid}),this.tileUrlFunction=s(a.tileUrlFunction)?a.tileUrlFunction:uu,this.crossOrigin=s(a.crossOrigin)?a.crossOrigin:null,this.c=new xu,this.tileLoadFunction=s(a.tileLoadFunction)?a.tileLoadFunction:Au,this.tileClass=s(a.tileClass)?a.tileClass:bo}function Au(a,b){a.b().src=b}function Bu(a){var b,c=Array(a.maxZoom+1),d=2*Ak/256;for(b=0;b<=a.maxZoom;++b)c[b]=d/Math.pow(2,b);Hk.call(this,{minZoom:a.minZoom,origin:[-Ak,Ak],resolutions:c,tileSize:256})}function Cu(a){zu.call(this,{crossOrigin:"anonymous",opaque:!0,projection:$h("EPSG:3857"),state:0,tileLoadFunction:a.tileLoadFunction}),this.b=s(a.culture)?a.culture:"en-us";var b=new gj((zd?"https:":"http:")+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+a.imagerySet);nu(new lu(b,"jsonp"),{include:"ImageryProviders",key:a.key},xa(this.e,this))}function Eu(a,b,c){if(qa(a))c&&(a=xa(a,c));else{if(!a||"function"!=typeof a.handleEvent)throw Error("Invalid listener argument");a=xa(a.handleEvent,a)}return b>2147483647?-1:ea.setTimeout(a,b||0)}function Fu(){}function Gu(a){var b;return(b=a.a)||(b={},Hu(a)&&(b[0]=!0,b[1]=!0),b=a.a=b),b}function Ju(){}function Ku(a){return(a=Hu(a))?new ActiveXObject(a):new XMLHttpRequest}function Hu(a){if(!a.d&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.d=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return a.d}function Lu(a){He.call(this),this.B=new Xi,this.h=a||null,this.a=!1,this.i=this.J=null,this.C=this.n="",this.b=0,this.e="",this.d=this.w=this.t=this.l=!1,this.g=0,this.c=null,this.f=Mu,this.o=this.O=!1}function Pu(a,b){if(a.J)throw Error("[goog.net.XhrIo] Object is active with another request="+a.n+"; newUri="+b);a.n=b,a.e="",a.b=0,a.C="GET",a.l=!1,a.a=!0,a.J=Ku(a.h?a.h:Iu),a.i=Gu(a.h?a.h:Iu),a.J.onreadystatechange=xa(a.A,a);try{a.w=!0,a.J.open("GET",b,!0),a.w=!1}catch(c){return void Qu(a,c)}var d=a.B.Q(),e=Ra(d.K(),Ru),f=ea.FormData&&!1;!(0<=Na(Ou,"GET"))||e||f||Yi(d,"Content-Type","application/x-www-form-urlencoded;charset=utf-8"),Wi(d,function(a,b){this.J.setRequestHeader(b,a)},a),a.f&&(a.J.responseType=a.f),"withCredentials"in a.J&&(a.J.withCredentials=a.O);try{Su(a),0<a.g&&(a.o=zb&&Nb(9)&&pa(a.J.timeout)&&s(a.J.ontimeout),a.o?(a.J.timeout=a.g,a.J.ontimeout=xa(a.Ab,a)):a.c=Eu(a.Ab,a.g,a)),a.t=!0,a.J.send(""),a.t=!1}catch(g){Qu(a,g)}}function Ru(a){return"content-type"==a.toLowerCase()}function Qu(a,b){a.a=!1,a.J&&(a.d=!0,a.J.abort(),a.d=!1),a.e=b,a.b=5,Uu(a),Tu(a)}function Uu(a){a.l||(a.l=!0,A(a,"complete"),A(a,"error"))}function Tu(a,b){if(a.J){Su(a);var c=a.J,d=a.i[0]?fa:null;a.J=null,a.i=null,b||A(a,"ready");try{c.onreadystatechange=d}catch(e){}}}function Su(a){a.J&&a.o&&(a.J.ontimeout=null),pa(a.c)&&(ea.clearTimeout(a.c),a.c=null)}function Xu(a){var b,c=Wu(a);a:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:b=!0;break a;default:b=!1}return b||((c=0===c)&&(a=bj(String(a.n))[1]||null,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),c=!Nu.test(a?a.toLowerCase():"")),b=c),b}function Vu(a){return a.J?a.J.readyState:0}function Wu(a){try{return 2<Vu(a)?a.J.status:-1}catch(b){return-1}}function Yu(a){try{return a.J?a.J.responseText:""}catch(b){return""}}function Zu(a){try{if(!a.J)return null;if("response"in a.J)return a.J.response;switch(a.f){case Mu:case"text":return a.J.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.J)return a.J.mozResponseArrayBuffer}return null}catch(b){return null}}function $u(a){Lm.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection}),this.format=a.format}function av(a,b,c,d){var e=new Lu;e.f="binary"==a.format.G()&&Bd?"arraybuffer":"text",z(e,"complete",function(a){if(a=a.target,Xu(a)){var b,e=this.format.G();if("binary"==e&&Bd)b=Zu(a);else if("json"==e)b=Yu(a);else if("text"==e)b=Yu(a);else if("xml"==e){if(!zb)try{b=a.J?a.J.responseXML:null}catch(f){b=null}null!=b||(b=gp(Yu(a)))}null!=b?c.call(d,this.e(b)):wk(this,2)}else wk(this,2);Pd(a)},!1,a),Pu(e,b)}function bv(a){if($u.call(this,{attributions:a.attributions,extent:a.extent,format:a.format,logo:a.logo,projection:a.projection}),s(a.arrayBuffer)&&this.sa(this.e(a.arrayBuffer)),s(a.doc)&&this.sa(this.e(a.doc)),s(a.node)&&this.sa(this.e(a.node)),s(a.object)&&this.sa(this.e(a.object)),s(a.text)&&this.sa(this.e(a.text)),(s(a.url)||s(a.urls))&&(wk(this,0),s(a.url)&&av(this,a.url,function(a){this.sa(a),wk(this,1)},this),s(a.urls))){a=a.urls;var b,c;for(b=0,c=a.length;c>b;++b)av(this,a[b],function(a){this.sa(a),wk(this,1)},this)}}function cv(a){a=s(a)?a:{},bv.call(this,{attributions:a.attributions,doc:a.doc,extent:a.extent,format:new Ip,logo:a.logo,node:a.node,projection:a.projection,text:a.text,url:a.url,urls:a.urls})}function dv(a){a=s(a)?a:{},bv.call(this,{attributions:a.attributions,extent:a.extent,format:new qq({defaultProjection:a.defaultProjection}),logo:a.logo,object:a.object,projection:a.projection,text:a.text,url:a.url,urls:a.urls})}function ev(a){a=s(a)?a:{},bv.call(this,{format:new zq({altitudeMode:a.altitudeMode}),projection:a.projection,text:a.text,url:a.url,urls:a.urls})}function fv(a,b,c,d,e){Ek.call(this,a,b,c,2,d),this.a=e}function gv(a){Al.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection,resolutions:a.resolutions,state:a.state}),this.o=a.canvasFunction,this.h=null,this.t=0,this.A=s(a.ratio)?a.ratio:1.5}function hv(a){var b=s(a.attributions)?a.attributions:null,c=s(a.crossOrigin)?a.crossOrigin:null,d=a.imageExtent,e=(d[3]-d[1])/a.imageSize[1],f=a.url,g=$h(a.projection);Al.call(this,{attributions:b,extent:a.extent,logo:a.logo,projection:g,resolutions:[e]}),this.b=new Fk(d,e,1,b,f,c)}function iv(a){this.c=a.source,this.Ug=s(a.style)?Ri(a.style):Qi,this.B=id(),this.b=rd(),this.e=[0,0],this.g=null,gv.call(this,{attributions:a.attributions,canvasFunction:xa(this.Xe,this),extent:a.extent,logo:a.logo,projection:a.projection,ratio:a.ratio,resolutions:a.resolutions,state:this.c.i}),z(this.c,"change",this.Xg,void 0,this)}function jv(a){a=s(a)?a:{},Al.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection,resolutions:a.resolutions}),this.V=s(a.crossOrigin)?a.crossOrigin:null,this.e=a.url,this.c=a.params,this.g=!0,kv(this),this.C=a.serverType,this.da=s(a.hidpi)?a.hidpi:!0,this.b=null,this.h=[0,0],this.t=null,this.A=0/0,this.B=0,this.o=s(a.ratio)?a.ratio:1.5}function lv(a,b,c,d,e,f){if(f[a.g?"CRS":"SRS"]=e.a,"STYLES"in a.c||(f.STYLES=new String("")),1!=d)switch(a.C){case"geoserver":f.FORMAT_OPTIONS="dpi:"+(90*d+.5|0);break;case"mapserver":f.MAP_RESOLUTION=90*d;break;case"carmentaserver":case"qgis":f.DPI=90*d}return f.WIDTH=c[0],f.HEIGHT=c[1],c=e.e,f.BBOX=(a.g&&"ne"==c.substr(0,2)?[b[1],b[0],b[3],b[2]]:b).join(","),dj(fj([a.e],f))}function kv(a){a.g=0<=La(w(a.c,"VERSION","1.3.0"),"1.3")}function mv(a){a=s(a)?a:{},bv.call(this,{attributions:a.attributions,doc:a.doc,extent:a.extent,format:new Dq({defaultStyle:a.defaultStyle}),logo:a.logo,node:a.node,projection:a.projection,text:a.text,url:a.url,urls:a.urls})}function nv(a,b,c){return function(d,e,f){return c(a,b,d,e,f)}}function ov(){}function pv(a){Al.call(this,{extent:a.extent,projection:a.projection,resolutions:a.resolutions}),this.t=s(a.crossOrigin)?a.crossOrigin:null,this.b=s(a.displayDpi)?a.displayDpi:96,this.g=s(a.url)?nv(a.url,s(a.params)?a.params:{},xa(this.A,this)):ov,this.o=s(a.hidpi)?a.hidpi:!0,this.h=s(a.metersPerUnit)?a.metersPerUnit:1,this.e=s(a.ratio)?a.ratio:1,this.B=s(a.useOverlay)?a.useOverlay:!1,this.c=null}function qv(a){var b=s(a.projection)?a.projection:"EPSG:3857",c=new Bu({maxZoom:s(a.maxZoom)?a.maxZoom:18});zu.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,extent:a.extent,logo:a.logo,projection:b,tileGrid:c,tileLoadFunction:a.tileLoadFunction,tileUrlFunction:uu}),this.e=c.d({extent:a.extent,wrapX:a.wrapX}),s(a.tileUrlFunction)?this.pc(a.tileUrlFunction):s(a.urls)?this.pc(su(a.urls)):s(a.url)&&this.b(a.url)}function rv(a){a=s(a)?a:{};var b=zd?"https:":"http:";qv.call(this,{attributions:s(a.attributions)?a.attributions:sv,crossOrigin:s(a.crossOrigin)?a.crossOrigin:"anonymous",opaque:!0,maxZoom:a.maxZoom,tileLoadFunction:a.tileLoadFunction,url:s(a.url)?a.url:b+"//{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}function vv(a){a=s(a)?a:{};var b=wv[a.layer];qv.call(this,{attributions:b.attributions,crossOrigin:"anonymous",logo:"//developer.mapquest.com/content/osm/mq_logo.png",maxZoom:b.maxZoom,opaque:!0,tileLoadFunction:a.tileLoadFunction,url:(zd?"https:":"http:")+"//otile{1-4}-s.mqcdn.com/tiles/1.0.0/"+a.layer+"/{z}/{x}/{y}.jpg"})}function yv(a){a=s(a)?a:{},bv.call(this,{attributions:a.attributions,doc:a.doc,extent:a.extent,format:new ur,logo:a.logo,node:a.node,projection:a.projection,reprojectTo:a.reprojectTo,text:a.text,url:a.url})}function zv(a){$u.call(this,{attributions:a.attributions,extent:a.extent,format:a.format,logo:a.logo,projection:a.projection}),this.h=new Bm,this.n=a.loader,this.o=s(a.strategy)?a.strategy:Wt,this.g={}}function Cv(a){var b=a.layer.indexOf("-"),b=-1==b?a.layer:a.layer.slice(0,b),c=Av[a.layer],d=zd?"https:":"http:";qv.call(this,{attributions:Dv,crossOrigin:"anonymous",maxZoom:Bv[b].maxZoom,opaque:c.opaque,tileLoadFunction:a.tileLoadFunction,url:s(a.url)?a.url:d+"//{a-d}.tile.stamen.com/"+a.layer+"/{z}/{x}/{y}."+c.ua})}function Ev(a,b){Vj.call(this,a,2),this.f=a,this.e=b.ia(a.a),this.d={}}function Fv(a){Ok.call(this,{extent:a.extent,opaque:!1,projection:a.projection,tileGrid:a.tileGrid}),this.b=new xu}function Gv(a){zu.call(this,{crossOrigin:a.crossOrigin,projection:$h("EPSG:3857"),state:0,tileLoadFunction:a.tileLoadFunction}),nu(new lu(a.url),void 0,xa(this.b,this))}function Hv(a){$u.call(this,{attributions:a.attributions,extent:a.extent,format:a.format,logo:a.logo,projection:a.projection});var b=a.tileGrid;this.n=a.tileGrid,this.g=uu,this.o=b.d({extent:a.extent}),this.h={},s(a.tileUrlFunction)?(this.g=a.tileUrlFunction,this.k()):s(a.urls)?(this.g=su(a.urls),this.k()):s(a.url)&&(this.g=su(wu(a.url)),this.k())}function Iv(a){a=s(a)?a:{};var b=s(a.params)?a.params:{};zu.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,extent:a.extent,logo:a.logo,opaque:!w(b,"TRANSPARENT",!0),projection:a.projection,tileGrid:a.tileGrid,tileLoadFunction:a.tileLoadFunction,tileUrlFunction:xa(this.fh,this)});var c=a.urls;!s(c)&&s(a.url)&&(c=wu(a.url)),this.n=c,this.g=s(a.gutter)?a.gutter:0,this.b=b,this.h=0/0,this.e=!0,this.t=a.serverType,this.A=s(a.hidpi)?a.hidpi:!0,this.o="",Jv(this),this.B=ug(),Kv(this)}function Lv(a,b,c,d,e,f,g){var h=a.n;if(s(h)&&0!=h.length){if(g.WIDTH=c,g.HEIGHT=c,g[a.e?"CRS":"SRS"]=f.a,"STYLES"in a.b||(g.STYLES=new String("")),1!=e)switch(a.t){case"geoserver":g.FORMAT_OPTIONS="dpi:"+(90*e+.5|0);break;case"mapserver":g.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":g.DPI=90*e}return c=f.e,a.e&&"ne"==c.substr(0,2)&&(c=d[0],d[0]=d[1],d[1]=c,c=d[2],d[2]=d[3],d[3]=c),g.BBOX=d.join(","),dj(fj([1==h.length?h[0]:h[Wb((b.x<<b.a)+b.y,a.n.length)]],g))}}function Jv(a){var b,c=0,d=[];for(b in a.b)d[c++]=b+"-"+a.b[b];a.o=d.join("/")}function Kv(a){a.e=0<=La(w(a.b,"VERSION","1.3.0"),"1.3")}function Mv(a){a=s(a)?a:{},bv.call(this,{attributions:a.attributions,extent:a.extent,format:new Ar({defaultProjection:a.defaultProjection}),logo:a.logo,object:a.object,projection:a.projection,text:a.text,url:a.url})}function Nv(a){this.c=a.matrixIds,Hk.call(this,{origin:a.origin,origins:a.origins,resolutions:a.resolutions,tileSize:a.tileSize,tileSizes:a.tileSizes})}function Ov(a){var b=[],c=[],d=[],e=[],f=$h(a.supportedCRS).f();return bb(a.matrixIds,function(a,b){return b.scaleDenominator-a.scaleDenominator}),Oa(a.matrixIds,function(a){c.push(a.identifier),d.push(a.topLeftCorner),b.push(28e-5*a.scaleDenominator/f),e.push(a.tileWidth)}),new Nv({origins:d,resolutions:b,matrixIds:c,tileSizes:e})}function Qv(a){function b(a){return a=e==Pv?dj(fj([a],g)):a.replace(/\{(\w+?)\}/g,function(a,b){return b in g?g[b]:a}),function(b){if(null!==b){var c={TileMatrix:f.c[b.a],TileCol:b.x,TileRow:b.y};return lc(c,h),b=a,b=e==Pv?dj(fj([b],c)):b.replace(/\{(\w+?)\}/g,function(a,b){return c[b]})}}}var c=s(a.version)?a.version:"1.0.0",d=s(a.format)?a.format:"image/jpeg";this.b=s(a.dimensions)?a.dimensions:{},this.e="",Rv(this);var e=s(a.requestEncoding)?a.requestEncoding:Pv,f=a.tileGrid,g={Layer:a.layer,style:a.style,Style:a.style,TileMatrixSet:a.matrixSet};e==Pv&&lc(g,{Service:"WMTS",Request:"GetTile",Version:c,Format:d});var h=this.b,c=uu,d=a.urls;!s(d)&&s(a.url)&&(d=wu(a.url)),s(d)&&(c=tu(Pa(d,b)));var i=ug(),j=new gb(0,0,0),c=vu(function(b,c){if(f.a.length<=b.a)return null;var d=b.x,e=-b.y-1,g=Jk(f,b),h=c.u(),k=s(a.extent)?a.extent:h;return null!==k&&c.l&&k[0]===h[0]&&k[2]===h[2]&&(g=Math.ceil(Lg(k)/Lg(g)),d=Wb(d,g),j.a=b.a,j.x=d,j.y=b.y,g=Jk(f,j,i)),!Mg(g,k)||Qg(g,k)?null:new gb(b.a,d,e)},c);zu.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,extent:a.extent,logo:a.logo,projection:a.projection,tileGrid:f,tileLoadFunction:a.tileLoadFunction,tileUrlFunction:c})}function Rv(a){var b,c=0,d=[];for(b in a.b)d[c++]=b+"-"+a.b[b];a.e=d.join("/")}function Sv(a){var b=s(a)?a:b;Hk.call(this,{origin:[0,0],resolutions:b.resolutions})}function Tv(a){a=s(a)?a:{};var b=a.size,c=b[0],d=b[1],e=[],f=256;switch(s(a.tierSizeCalculation)?a.tierSizeCalculation:"default"){case"default":for(;c>f||d>f;)e.push([Math.ceil(c/f),Math.ceil(d/f)]),f+=f;break;case"truncated":for(;c>f||d>f;)e.push([Math.ceil(c/f),Math.ceil(d/f)]),c>>=1,d>>=1}e.push([1,1]),e.reverse();for(var f=[1],g=[0],d=1,c=e.length;c>d;d++)f.push(1<<d),g.push(e[d-1][0]*e[d-1][1]+g[d-1]);f.reverse();var f=new Sv({resolutions:f}),h=a.url,b=vu(f.d({extent:[0,0,b[0],b[1]]}),function(a){return null===a?void 0:h+"TileGroup"+((a.x+a.y*e[a.a][0]+g[a.a])/256|0)+"/"+a.a+"-"+a.x+"-"+a.y+".jpg"});zu.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,logo:a.logo,tileClass:Uv,tileGrid:f,tileUrlFunction:b})}function Uv(a,b,c,d,e){bo.call(this,a,b,c,d,e),this.g={}}function Vv(a){a=s(a)?a:{},this.a=a.font,this.b=a.rotation,this.c=a.scale,this.f=a.text,this.g=a.textAlign,this.i=a.textBaseline,this.d=s(a.fill)?a.fill:null,this.e=s(a.stroke)?a.stroke:null,this.h=s(a.offsetX)?a.offsetX:0,this.l=s(a.offsetY)?a.offsetY:0}var l,da=da||{},ea=this,ta="closure_uid_"+(1e9*Math.random()>>>0),ua=0,Aa=Date.now||function(){return+new Date};v(Ba,Error),Ba.prototype.name="CustomError";var Ga=/&/g,Ha=/</g,Ia=/>/g,Ja=/\"/g,Fa=/[&<>\"]/,Ma=Array.prototype,Na=Ma.indexOf?function(a,b,c){return Ma.indexOf.call(a,b,c)}:function(a,b,c){if(c=null==c?0:0>c?Math.max(0,a.length+c):c,oa(a))return oa(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Oa=Ma.forEach?function(a,b,c){Ma.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=oa(a)?a.split(""):a,f=0;d>f;f++)f in e&&b.call(c,e[f],f,a)},Pa=Ma.map?function(a,b,c){return Ma.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=oa(a)?a.split(""):a,g=0;d>g;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Qa=Ma.some?function(a,b,c){return Ma.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=oa(a)?a.split(""):a,f=0;d>f;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};gb.prototype.d=function(a){return s(a)?(a[0]=this.a,a[1]=this.x,a[2]=this.y,a):[this.a,this.x,this.y]},gb.prototype.toString=function(){return ib(this.a,this.x,this.y)},kb.prototype.contains=function(a){return this.a<=a.x&&a.x<=this.c&&this.b<=a.y&&a.y<=this.d};var nb,ob,pb,qb,rb,sb,tb;qb=pb=ob=nb=!1;var wb;if(wb=ub()){var xb=vb();nb=0==wb.lastIndexOf("Opera",0),ob=!nb&&(-1!=wb.indexOf("MSIE")||-1!=wb.indexOf("Trident")),pb=!nb&&-1!=wb.indexOf("WebKit"),qb=!nb&&!pb&&!ob&&"Gecko"==xb.product}var yb=nb,zb=ob,Ab=qb,Bb=pb,Cb,Db=vb();Cb=Db&&Db.platform||"",rb=-1!=Cb.indexOf("Mac"),sb=-1!=Cb.indexOf("Win"),tb=-1!=Cb.indexOf("Linux");var Eb=!!vb()&&-1!=(vb().appVersion||"").indexOf("X11"),Gb;a:{var Hb="",Ib;if(yb&&ea.opera)var Jb=ea.opera.version,Hb="function"==typeof Jb?Jb():Jb;else if(Ab?Ib=/rv\:([^\);]+)(\)|;)/:zb?Ib=/\b(?:MSIE|rv)\s+([^\);]+)(\)|;)/:Bb&&(Ib=/WebKit\/(\S+)/),Ib)var Kb=Ib.exec(ub()),Hb=Kb?Kb[1]:"";if(zb){var Lb=Fb();if(Lb>parseFloat(Hb)){Gb=String(Lb);break a}}Gb=Hb}var Mb={},Ob=ea.document,Pb=Ob&&zb?Fb()||("CSS1Compat"==Ob.compatMode?parseInt(Gb,10):5):void 0,Qb,Rb=!zb||zb&&Pb>=9;!Ab&&!zb||zb&&zb&&Pb>=9||Ab&&Nb("1.9.1"),zb&&Nb("9"),l=Yb.prototype,l.Q=function(){return new Yb(this.x,this.y)},l.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},l.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},l.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},l.scale=function(a,b){var c=pa(b)?b:a;return this.x*=a,this.y*=c,this},l=Zb.prototype,l.Q=function(){return new Zb(this.width,this.height)},l.ja=function(){return!(this.width*this.height)},l.ceil=function(){return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},l.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},l.round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},l.scale=function(a,b){var c=pa(b)?b:a;return this.width*=a,this.height*=c,this};var kc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),rc={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};nc.prototype.appendChild=function(a,b){a.appendChild(b)},nc.prototype.contains=Ec,l=Gc.prototype,l.Q=function(){return new Gc(this.top,this.right,this.bottom,this.left)},l.contains=function(a){return this&&a?a instanceof Gc?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:!1},l.ceil=function(){return this.top=Math.ceil(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this.left=Math.ceil(this.left),this},l.floor=function(){return this.top=Math.floor(this.top),this.right=Math.floor(this.right),this.bottom=Math.floor(this.bottom),this.left=Math.floor(this.left),this},l.round=function(){return this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this.left=Math.round(this.left),this},l.scale=function(a,b){var c=pa(b)?b:a;return this.left*=a,this.right*=a,this.top*=c,this.bottom*=c,this},l=Hc.prototype,l.Q=function(){return new Hc(this.left,this.top,this.width,this.height)},l.contains=function(a){return a instanceof Hc?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height},l.ceil=function(){return this.left=Math.ceil(this.left),this.top=Math.ceil(this.top),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},l.floor=function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},l.round=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.width=Math.round(this.width),this.height=Math.round(this.height),this},l.scale=function(a,b){var c=pa(b)?b:a;return this.left*=a,this.width*=a,this.top*=c,this.height*=c,this};var cd={thin:2,medium:4,thick:6},Rc=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;if(ed.prototype.a=4,ed.prototype.d=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]},ed.prototype.toString=Array.prototype.join,"undefined"==typeof Float32Array&&(ed.BYTES_PER_ELEMENT=4,ed.prototype.BYTES_PER_ELEMENT=ed.prototype.a,ed.prototype.set=ed.prototype.d,ed.prototype.toString=ed.prototype.toString,t("Float32Array",ed)),fd.prototype.a=8,fd.prototype.d=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]},fd.prototype.toString=Array.prototype.join,"undefined"==typeof Float64Array){try{fd.BYTES_PER_ELEMENT=8}catch(gd){}fd.prototype.BYTES_PER_ELEMENT=fd.prototype.a,fd.prototype.set=fd.prototype.d,fd.prototype.toString=fd.prototype.toString,t("Float64Array",fd)}new Float64Array(3),new Float64Array(3),new Float64Array(4),new Float64Array(4),new Float64Array(4),new Float64Array(16);var sd=function(){var a;return function(){if(!s(a))if(ea.getComputedStyle){var b,c=wc("P"),d={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.appendChild(c);for(var e in d)e in c.style&&(c.style[e]="translate(1px,1px)",b=ea.getComputedStyle(c).getPropertyValue(d[e]));Bc(c),a=b&&"none"!==b}else a=!1;return a}}(),td=function(){var a;return function(){if(!s(a))if(ea.getComputedStyle){var b,c=wc("P"),d={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.appendChild(c);for(var e in d)e in c.style&&(c.style[e]="translate3d(1px,1px,1px)",b=ea.getComputedStyle(c).getPropertyValue(d[e]));Bc(c),a=b&&"none"!==b}else a=!1;return a}}(),xd=["experimental-webgl","webgl","webkit-3d","moz-webgl"],zd="https:"===ea.location.protocol,vd=zb&&!Nb("9.0")&&""!==Gb,Ad=ea.devicePixelRatio||1,Bd="ArrayBuffer"in ea,Cd=!1,Dd=function(){if(!("HTMLCanvasElement"in ea))return!1;try{var a=rd();return null===a?!1:(s(a.setLineDash)&&(Cd=!0),!0)}catch(b){return!1}}(),Ed="DeviceOrientationEvent"in ea,Fd="geolocation"in ea.navigator,Gd="JSON"in ea&&"parse"in ea.JSON,Hd="ontouchstart"in ea,Id="PointerEvent"in ea,Jd=!!ea.navigator.msPointerEnabled,Kd=function(){if(!("WebGLRenderingContext"in ea))return!1;try{var a=wc("CANVAS");return!ka(yd(a,{bf:!0}))}catch(b){return!1}}(),Md=0,Nd={};Ld.prototype.qb=!1,Ld.prototype.bc=function(){if(!this.qb&&(this.qb=!0,this.F(),0!=Md)){var a=sa(this);delete Nd[a]}},Ld.prototype.F=function(){if(this.Qa)for(;this.Qa.length;)this.Qa.shift()()},l=Qd.prototype,l.bc=ba(),l.nb=!1,l.Cf=!1,l.we=!0,l.Ma=function(){this.nb=!0},l.preventDefault=function(){this.Cf=!0,this.we=!1};var Td=!zb||zb&&Pb>=9,Ud=!zb||zb&&Pb>=9,Vd=zb&&!Nb("9");!Bb||Nb("528"),Ab&&Nb("1.9b")||zb&&Nb("8")||yb&&Nb("9.5")||Bb&&Nb("528"),Ab&&!Nb("8")||zb&&Nb("9");var Wd=zb?"focusout":"DOMFocusOut";Xd[" "]=fa,v(Yd,Qd);var $d=[1,4,2];l=Yd.prototype,l.target=null,l.relatedTarget=null,l.offsetX=0,l.offsetY=0,l.clientX=0,l.clientY=0,l.screenX=0,l.screenY=0,l.button=0,l.Ya=0,l.md=0,l.lc=!1,l.na=!1,l.Za=!1,l.od=!1,l.Pb=!1,l.N=null,l.Ma=function(){Yd.I.Ma.call(this),this.N.stopPropagation?this.N.stopPropagation():this.N.cancelBubble=!0},l.preventDefault=function(){Yd.I.preventDefault.call(this);var a=this.N;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Vd)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}},l.df=k("N");var be="closure_listenable_"+(1e6*Math.random()|0),de=0,ge={},he={},ie={},je={},xe="__closure_events_fn_"+(1e9*Math.random()>>>0),ze=ye(!1),Ae=ye(!0);Fe.prototype.add=function(a,b,c,d,e){var f=this.a[a];f||(f=this.a[a]=[],this.d++);var g=Ge(f,b,d,e);return g>-1?(a=f[g],c||(a.Fb=!1)):(a=new ee(b,null,this.src,a,!!d,e),a.Fb=c,f.push(a)),a},Fe.prototype.remove=function(a,b,c,d){if(!(a in this.a))return!1;var e=this.a[a];return b=Ge(e,b,c,d),b>-1?(fe(e[b]),Ma.splice.call(e,b,1),0==e.length&&(delete this.a[a],this.d--),!0):!1},v(He,Ld),He.prototype[be]=!0,l=He.prototype,l.xd=null,l.addEventListener=function(a,b,c,d){z(this,a,b,c,d)},l.removeEventListener=function(a,b,c,d){pe(this,a,b,c,d)},l.F=function(){if(He.I.F.call(this),this.ga){var a,b=this.ga,c=0;for(a in b.a){for(var d=b.a[a],e=0;e<d.length;e++)++c,d[e].cb=!0;delete b.a[a],b.d--}}this.xd=null},l.oa=function(a,b,c,d){return this.ga.add(a,b,!1,c,d)},l.Ed=function(a,b,c,d){return this.ga.remove(a,b,c,d)},v(Je,He),l=Je.prototype,l.k=function(){++this.d,A(this,"change")},l.p=function(a,b,c){return z(this,a,b,!1,c)},l.q=function(a,b,c){return oe(this,a,b,!1,c)},l.r=function(a,b,c){pe(this,a,b,!1,c)},l.s=function(a){re(a)},v(Ke,Qd),Le.prototype.transform=function(a,b){this.a=a,this.d=b,this.target.T(this.key)},v(Me,Je);var Ne={},Oe={},Pe={};l=Me.prototype,l.W=function(a,b,c){c=c||a,this.U(a);var d=Qe(c);return this.Eb[a]=z(b,d,function(){Re(this,a)},void 0,this),this.Db[a]=z(b,"beforepropertychange",Te(a,c),void 0,this),b=new Le(b,c),this.da[a]=b,Re(this,a),b},l.get=function(a){var b,c=this.da;if(c.hasOwnProperty(a)){a=c[a],b=a.target;var c=a.key,d=Oe.hasOwnProperty(c)?Oe[c]:Oe[c]="get"+(c.substr(0,1).toUpperCase()+c.substr(1)),d=w(b,d);b=s(d)?d.call(b):b.get(c),b=a.d(b)}else this.t.hasOwnProperty(a)&&(b=this.t[a]);
return b},l.K=function(){var a,b=this.da;if(ec(this.t)){if(ec(b))return[];a=b}else if(ec(b))a=this.t;else{a={};for(var c in this.t)a[c]=!0;for(c in b)a[c]=!0}return dc(a)},l.S=function(){var a,b={};for(a in this.t)b[a]=this.t[a];for(a in this.da)b[a]=this.get(a);return b},l.T=function(a){var b=this.da;b.hasOwnProperty(a)?(a=b[a],a.target.T(a.key)):Re(this,a)},l.v=function(a,b){A(this,new Ke("beforepropertychange",a));var c=this.da;if(c.hasOwnProperty(a)){var d=c[a],c=d.target,e=d.key;b=d.a(b),d=Pe.hasOwnProperty(e)?Pe[e]:Pe[e]="set"+(e.substr(0,1).toUpperCase()+e.substr(1)),d=w(c,d),s(d)?d.call(c,b):c.v(e,b)}else this.t[a]=b,Re(this,a)},l.H=function(a){for(var b in a)this.v(b,a[b])},l.U=function(a){var b=this.Eb,c=b[a];c&&(delete b[a],re(c),b=this.get(a),delete this.da[a],this.t[a]=b),(b=this.Db[a])&&(re(b),delete this.Db[a])},l.X=function(){for(var a in this.Eb)this.U(a)},v(Ue,Qd),v(D,Me),l=D.prototype,l.clear=function(){for(;0<this.xb();)this.pop()},l.wg=function(a){var b,c;for(b=0,c=a.length;c>b;++b)this.push(a[b]);return this},l.forEach=function(a,b){Oa(this.a,a,b)},l.xg=k("a"),l.Sd=function(a){return this.a[a]},l.xb=function(){return this.get("length")},l.Lc=function(a,b){Za(this.a,a,0,b),Ve(this),A(this,new Ue("add",b,this))},l.pop=function(){return this.Uc(this.xb()-1)},l.push=function(a){var b=this.a.length;return this.Lc(b,a),b},l.remove=function(a){var b,c,d=this.a;for(b=0,c=d.length;c>b;++b)if(d[b]===a)return this.Uc(b)},l.Uc=function(a){var b=this.a[a];return Ma.splice.call(this.a,a,1),Ve(this),A(this,new Ue("remove",b,this)),b},l.$h=function(a,b){var c=this.xb();if(c>a)c=this.a[a],this.a[a]=b,A(this,new Ue("remove",c,this)),A(this,new Ue("add",b,this));else{for(;a>c;++c)this.Lc(c,void 0);this.Lc(a,b)}},v(F,Me),F.prototype.F=function(){this.b(!1),F.I.F.call(this)},F.prototype.l=function(a){if(a=a.N,null!=a.alpha){var b=Xb(a.alpha);this.v("alpha",b),"boolean"==typeof a.absolute&&a.absolute?this.v("heading",b):null!=a.webkitCompassHeading&&null!=a.webkitCompassAccuracy&&-1!=a.webkitCompassAccuracy&&this.v("heading",Xb(a.webkitCompassHeading))}null!=a.beta&&this.v("beta",Xb(a.beta)),null!=a.gamma&&this.v("gamma",Xb(a.gamma)),this.k()},F.prototype.e=function(){return this.get("alpha")},F.prototype.getAlpha=F.prototype.e,F.prototype.f=function(){return this.get("beta")},F.prototype.getBeta=F.prototype.f,F.prototype.g=function(){return this.get("gamma")},F.prototype.getGamma=F.prototype.g,F.prototype.i=function(){return this.get("heading")},F.prototype.getHeading=F.prototype.i,F.prototype.c=function(){return this.get("tracking")},F.prototype.getTracking=F.prototype.c,F.prototype.h=function(){if(Ed){var a=this.c();a&&null===this.a?this.a=z(ea,"deviceorientation",this.l,!1,this):a||null===this.a||(re(this.a),this.a=null)}},F.prototype.b=function(a){this.v("tracking",a)},F.prototype.setTracking=F.prototype.b,v(df,Qd),v(ef,Qd);var hf=!1;try{hf=1===new MouseEvent("click",{buttons:1}).buttons}catch(jf){}v(lf,kf),l=lf.prototype,l.ig=function(a){if(!mf(this,a)){1..toString()in this.d&&this.cancel(a);var b=nf(a);this.d[1..toString()]=a,pf(this.a,qf,b,a)}},l.jg=function(a){if(!mf(this,a)){var b=nf(a);pf(this.a,rf,b,a)}},l.mg=function(a){if(!mf(this,a)){var b=w(this.d,1..toString());b&&b.button===a.button&&(b=nf(a),pf(this.a,sf,b,a),hc(this.d,1..toString()))}},l.lg=function(a){if(!mf(this,a)){var b=nf(a);tf(this.a,b,a)}},l.kg=function(a){if(!mf(this,a)){var b=nf(a);uf(this.a,b,a)}},l.cancel=function(a){var b=nf(a);this.a.cancel(b,a),hc(this.d,1..toString())},v(vf,kf),l=vf.prototype,l.rg=function(a){this.d[a.N.pointerId]=a;var b=wf(this,a);pf(this.a,qf,b,a)},l.sg=function(a){var b=wf(this,a);pf(this.a,rf,b,a)},l.vg=function(a){var b=wf(this,a);pf(this.a,sf,b,a),hc(this.d,a.N.pointerId)},l.tg=function(a){var b=wf(this,a);uf(this.a,b,a)},l.ug=function(a){var b=wf(this,a);tf(this.a,b,a)},l.qg=function(a){var b=wf(this,a);this.a.cancel(b,a),hc(this.d,a.N.pointerId)},l.pg=function(a){A(this.a,new ef("lostpointercapture",a,a.N))},l.og=function(a){A(this.a,new ef("gotpointercapture",a,a.N))},v(xf,kf),l=xf.prototype,l.Hh=function(a){yf(this.a,a)},l.Ih=function(a){yf(this.a,a)},l.Lh=function(a){yf(this.a,a)},l.Jh=function(a){yf(this.a,a)},l.Kh=function(a){yf(this.a,a)},l.Gh=function(a){yf(this.a,a)},l.gg=function(a){yf(this.a,a)},l.Df=function(a){yf(this.a,a)},v(zf,kf),l=zf.prototype,l.ve=function(){this.f=0,this.c=void 0},l.ci=function(a,b){var c=of(a,b);return c.pointerId=b.identifier+2,c.bubbles=!0,c.cancelable=!0,c.detail=this.f,c.button=0,c.buttons=1,c.width=b.webkitRadiusX||b.radiusX||0,c.height=b.webkitRadiusY||b.radiusY||0,c.yd=b.webkitForce||b.force||.5,c.Mc=this.b===b.identifier,c.pointerType="touch",c.clientX=b.clientX,c.clientY=b.clientY,c.screenX=b.screenX,c.screenY=b.screenY,c},l.gi=function(a){Bf(this,a);var b,c=bc(this.d);(b=0===c)||((c=1===c)&&(c=1..toString()in this.d),b=c),b&&(this.b=a.N.changedTouches[0].identifier,s(this.c)&&ea.clearTimeout(this.c)),Cf(this,a),this.f++,Af(this,a,this.Fh)},l.Fh=function(a,b){this.d[b.pointerId]={target:b.target,yb:b,re:b.target};var c=this.a;b.bubbles=!0,pf(c,Df,b,a),c=this.a,b.bubbles=!1,pf(c,Ef,b,a),pf(this.a,qf,b,a)},l.fi=function(a){a.preventDefault(),Af(this,a,this.ng)},l.ng=function(a,b){var c=w(this.d,b.pointerId);if(c){var d=c.yb,e=c.re;pf(this.a,rf,b,a),d&&e!==b.target&&(d.relatedTarget=b.target,b.relatedTarget=e,d.target=e,b.target?(uf(this.a,d,a),tf(this.a,b,a)):(b.target=e,b.relatedTarget=null,this.fd(a,b))),c.yb=b,c.re=b.target}},l.ei=function(a){Cf(this,a),Af(this,a,this.hi)},l.hi=function(a,b){pf(this.a,sf,b,a),this.a.yb(b,a);var c=this.a;b.bubbles=!1,pf(c,Ff,b,a),hc(this.d,b.pointerId),b.Mc&&(this.b=void 0,this.c=ea.setTimeout(this.ve,200))},l.di=function(a){Af(this,a,this.fd)},l.fd=function(a,b){this.a.cancel(b,a),this.a.yb(b,a);var c=this.a;b.bubbles=!1,pf(c,Ff,b,a),hc(this.d,b.pointerId),b.Mc&&(this.b=void 0,this.c=ea.setTimeout(this.ve,200))},v(Gf,He),Gf.prototype.e=function(a){var b=this.b[a.type];b&&b(a)},Gf.prototype.yb=function(a,b){a.bubbles=!0,pf(this,Lf,a,b)},Gf.prototype.cancel=function(a,b){pf(this,Mf,a,b)},Gf.prototype.F=function(){for(var a,b=this.a.length,c=0;b>c;c++)a=this.a[c],Jf(this,dc(a.e));Gf.I.F.call(this)};var rf="pointermove",qf="pointerdown",sf="pointerup",Df="pointerover",Lf="pointerout",Ef="pointerenter",Ff="pointerleave",Mf="pointercancel",Kf=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];v(Nf,df),Nf.prototype.preventDefault=function(){Nf.I.preventDefault.call(this),this.a.preventDefault()},Nf.prototype.Ma=function(){Nf.I.Ma.call(this),this.a.Ma()},v(Of,Nf),v(Pf,He),l=Pf.prototype,l.Zd=function(a){Uf(this,a);var b=new Of(Vf,this.d,a);A(this,b),0===this.t&&(Oa(this.b,re),this.b=null,Pd(this.a),this.a=null),!this.i&&0===a.button&&Qf(this,this.f)},l.Tf=function(a){Uf(this,a);var b=new Of(Xf,this.d,a);A(this,b),this.f=a,this.i=!1,null===this.b&&(this.a=new Gf(document),this.b=[z(this.a,Yf,this.Hg,!1,this),z(this.a,Vf,this.Zd,!1,this),z(this.c,Wf,this.Zd,!1,this)]),a.preventDefault()},l.Hg=function(a){if(a.clientX!=this.f.clientX||a.clientY!=this.f.clientY){this.i=!0;var b=new Of(Zf,this.d,a);A(this,b)}a.preventDefault()},l.Qh=function(a){A(this,new Of(a.type,this.d,a))},l.F=function(){null!==this.h&&(re(this.h),this.h=null),null!==this.g&&(re(this.g),this.g=null),null!==this.b&&(Oa(this.b,re),this.b=null),null!==this.a&&(Pd(this.a),this.a=null),null!==this.c&&(Pd(this.c),this.c=null),Pf.I.F.call(this)};var Tf="singleclick",Rf="click",Sf="dblclick",Zf="pointerdrag",Yf="pointermove",Xf="pointerdown",Vf="pointerup",Wf="pointercancel",$f={Di:Tf,si:Rf,ti:Sf,wi:Zf,zi:Yf,vi:Xf,Ci:Vf,Bi:"pointerover",Ai:"pointerout",xi:"pointerenter",yi:"pointerleave",ui:Wf};v(rg,Me),rg.prototype.Y=ca(null),rg.prototype.sd=ca(!1),v(Sg,Je),Sg.prototype.e=function(a,b){var c=s(b)?b:[0/0,0/0];return this.ta(a[0],a[1],c,1/0),c},Sg.prototype.rb=ze,v(Ug,Sg),l=Ug.prototype,l.rb=ze,l.u=function(a){if(this.f!=this.d){var b=this.j,c=this.j.length,d=this.a,e=Bg(this.extent);this.extent=Eg(e,b,0,c,d),this.f=this.d}return Og(this.extent,a)},l.Va=function(){return this.j.slice(0,this.a)},l.Wa=function(){return this.j.slice(this.j.length-this.a)},l.Xa=k("b"),l.ha=function(a){if(this.l!=this.d&&(gc(this.g),this.i=0,this.l=this.d),0>a||0!==this.i&&a<=this.i)return this;var b=a.toString();if(this.g.hasOwnProperty(b))return this.g[b];var c=this.Hb(a);return c.j.length<this.j.length?this.g[b]=c:(this.i=a,this)},l.Hb=function(){return this},l.transform=function(a){null!==this.j&&(a(this.j,this.j,this.a),this.k())},v(nh,Ug),l=nh.prototype,l.Q=function(){var a=new nh(null);return oh(a,this.b,this.j.slice()),a},l.ta=function(a,b,c,d){return d<zg(this.u(),a,b)?d:(this.c!=this.d&&(this.h=Math.sqrt(ch(this.j,0,this.j.length,this.a,0)),this.c=this.d),eh(this.j,0,this.j.length,this.a,this.h,!0,a,b,c,d))},l.Mg=function(){return Zg(this.j,0,this.j.length,this.a)},l.D=function(){return jh(this.j,0,this.j.length,this.a)},l.Hb=function(a){var b=[];return b.length=lh(this.j,0,this.j.length,this.a,a,b,0),a=new nh(null),oh(a,"XY",b),a},l.G=ca("LinearRing"),l.P=function(a,b){null===a?oh(this,"XY",null):(Xg(this,b,a,1),null===this.j&&(this.j=[]),this.j.length=hh(this.j,0,a,this.a),this.k())},v(ph,Ug),l=ph.prototype,l.Q=function(){var a=new ph(null);return qh(a,this.b,this.j.slice()),a},l.ta=function(a,b,c,d){var e=this.j;if(a=ah(a,b,e[0],e[1]),d>a){for(d=this.a,b=0;d>b;++b)c[b]=e[b];return c.length=d,a}return d},l.D=function(){return this.j.slice()},l.u=function(a){if(this.f!=this.d){var b=this.j,c=b[0],b=b[1];this.extent=wg(c,b,c,b,this.extent),this.f=this.d}return Og(this.extent,a)},l.G=ca("Point"),l.P=function(a,b){null===a?qh(this,"XY",null):(Xg(this,b,a,0),null===this.j&&(this.j=[]),this.j.length=gh(this.j,a),this.k())},v(G,Ug),l=G.prototype,l.Te=function(a){null===this.j?this.j=a.j.slice():ig(this.j,a.j),this.c.push(this.j.length),this.k()},l.Q=function(){var a=new G(null);return xh(a,this.b,this.j.slice(),this.c.slice()),a},l.ta=function(a,b,c,d){return d<zg(this.u(),a,b)?d:(this.o!=this.d&&(this.w=Math.sqrt(dh(this.j,0,this.c,this.a,0)),this.o=this.d),fh(this.j,0,this.c,this.a,this.w,!0,a,b,c,d))},l.rb=function(a,b){return sh(yh(this),0,this.c,this.a,a,b)},l.Pg=function(){return $g(yh(this),0,this.c,this.a)},l.D=function(){return kh(this.j,0,this.c,this.a)},l.lf=function(){return new ph(zh(this))},l.qf=function(a){if(0>a||this.c.length<=a)return null;var b=new nh(null);return oh(b,this.b,this.j.slice(0===a?0:this.c[a-1],this.c[a])),b},l.Ud=function(){var a,b,c=this.b,d=this.j,e=this.c,f=[],g=0;for(a=0,b=e.length;b>a;++a){var h=e[a],i=new nh(null);oh(i,c,d.slice(g,h)),f.push(i),g=h}return f},l.Hb=function(a){var b=[],c=[];return b.length=mh(this.j,0,this.c,this.a,Math.sqrt(a),b,0,c),a=new G(null),xh(a,"XY",b,c),a},l.G=ca("Polygon"),l.P=function(a,b){if(null===a)xh(this,"XY",null,this.c);else{Xg(this,b,a,2),null===this.j&&(this.j=[]);var c=ih(this.j,0,a,this.a,this.c);this.j.length=0===c.length?0:c[c.length-1],this.k()}},Ah.prototype.a=function(a,b,c){var d=s(c)?c:32;c=[];var e;for(e=0;d>e;++e){var f=2*Math.PI*e/d,g=Xb(a[1]),h=b/this.radius,i=Math.asin(Math.sin(g)*Math.cos(h)+Math.cos(g)*Math.sin(h)*Math.cos(f));Ya(c,[180*(Xb(a[0])+Math.atan2(Math.sin(f)*Math.sin(h)*Math.cos(g),Math.cos(h)-Math.sin(g)*Math.sin(i)))/Math.PI,180*i/Math.PI])}return c.push(c[0],c[1]),a=new G(null),xh(a,"XY",c,[c.length]),a};var Ch=new Ah(6370997),Dh={},Eh="object"==typeof Proj4js;Dh.degrees=2*Math.PI*Ch.radius/360,Dh.ft=.3048,Dh.m=1,Fh.prototype.d=k("a"),Fh.prototype.u=k("t"),Fh.prototype.b=k("Fa"),Fh.prototype.f=function(){return Dh[this.Fa]},v(Hh,Fh),Hh.prototype.f=function(){var a=this.h.to_meter;return s(a)||(a=Dh[this.Fa]),a},Hh.prototype.c=function(a,b){if("degrees"==this.Fa)return a;null===this.g&&(this.g=Ih(this,Jh({code:"EPSG:4326",extent:null})));var c=[b[0]-a/2,b[1],b[0]+a/2,b[1],b[0],b[1]-a/2,b[0],b[1]+a/2],c=this.g(c,c,2),d=Bh(Ch,c.slice(0,2),c.slice(2,4)),c=Bh(Ch,c.slice(4,6),c.slice(6,8)),d=(d+c)/2;return"ft"==this.Fa&&(d/=.3048),d};var Lh={},Mh={},Nh={};v(H,rg),H.prototype.constrainResolution=function(a,b,c){return this.f.resolution(a,b||0,c||0)},H.prototype.constrainRotation=function(a,b){return this.f.rotation(a,b||0)},H.prototype.a=function(){return this.get("center")},H.prototype.getCenter=H.prototype.a,H.prototype.w=function(a){var b=this.a(),c=this.b();return[b[0]-c*a[0]/2,b[1]-c*a[1]/2,b[0]+c*a[0]/2,b[1]+c*a[1]/2]},H.prototype.i=function(){return this.get("projection")},H.prototype.getProjection=H.prototype.i,H.prototype.b=function(){return this.get("resolution")},H.prototype.getResolution=H.prototype.b,H.prototype.e=function(){return this.get("rotation")},H.prototype.getRotation=H.prototype.e,l=H.prototype,l.Y=function(){return this},l.Bf=function(){var a,b=this.b();if(s(b)){var c,d=0;do{if(c=this.constrainResolution(this.g,d),c==b){a=d;break}++d}while(c>this.l)}return a},l.Qd=function(a,b){if(!Ng(a)){this.ya(Gg(a));var c=ci(a,b),d=this.constrainResolution(c,0,0);c>d&&(d=this.constrainResolution(d,-1,0)),this.c(d)}},l.cf=function(a,b,c){var d=s(c)?c:{};c=s(d.padding)?d.padding:[0,0,0,0];var e=s(d.constrainResolution)?d.constrainResolution:!0,f=s(d.nearest)?d.nearest:!1,g=s(d.minResolution)?d.minResolution:0,h=a.j,i=this.e(),d=Math.cos(-i),i=Math.sin(-i),j=1/0,k=1/0,l=-1/0,m=-1/0;a=a.a;for(var n=0,o=h.length;o>n;n+=a)var p=h[n]*d-h[n+1]*i,q=h[n]*i+h[n+1]*d,j=Math.min(j,p),k=Math.min(k,q),l=Math.max(l,p),m=Math.max(m,q);b=ci([j,k,l,m],[b[0]-c[1]-c[3],b[1]-c[0]-c[2]]),b=isNaN(b)?g:Math.max(b,g),e&&(e=this.constrainResolution(b,0,0),!f&&b>e&&(e=this.constrainResolution(e,-1,0)),b=e),this.c(b),i=-i,f=(j+l)/2+(c[1]-c[3])/2*b,c=(k+m)/2+(c[0]-c[2])/2*b,this.ya([f*d-c*i,c*d+f*i])},l.Ye=function(a,b,c){var d=this.e(),e=Math.cos(-d),d=Math.sin(-d),f=a[0]*e-a[1]*d;a=a[1]*e+a[0]*d;var g=this.b(),f=f+(b[0]/2-c[0])*g;a+=(c[1]-b[1]/2)*g,d=-d,this.ya([f*e-a*d,a*e+f*d])},l.sd=function(){return null!=this.a()&&s(this.b())},l.ie=function(a,b){if(s(b)){var c,d=this.a();s(d)&&(c=[d[0]-b[0],d[1]-b[1]],af(c,a-this.e()),We(c,b)),this.ya(c)}this.n(a)},l.ya=function(a){this.v("center",a)},H.prototype.setCenter=H.prototype.ya,H.prototype.o=function(a){this.v("projection",a)},H.prototype.setProjection=H.prototype.o,H.prototype.c=function(a){this.v("resolution",a)},H.prototype.setResolution=H.prototype.c,H.prototype.n=function(a){this.v("rotation",a)},H.prototype.setRotation=H.prototype.n,H.prototype.A=function(a){a=this.constrainResolution(this.g,a,0),this.c(a)},v(ni,Je),ni.prototype.setMap=function(a){this.g=a},v(ri,ni),l=ri.prototype,l.jb=fa,l.ab=ze,l.$a=ze,l.za=function(a){if(!(a instanceof Of))return!0;var b=!1,c=a.type;return(c===Xf||c===Zf||c===Vf)&&(c=a.c,a.type==Vf?delete this.t[c.pointerId]:a.type==Xf?this.t[c.pointerId]=c:c.pointerId in this.t&&(this.t[c.pointerId]=c),this.b=cc(this.t)),this.i&&(a.type==Zf?this.jb(a):a.type==Vf&&(this.i=this.ab(a))),a.type==Xf&&(this.i=a=this.$a(a),b=this.Xc(a)),!b},l.Xc=ze,v(ti,Qd),v(ui,Ld),ui.prototype.F=function(){this.setMap(null)},ui.prototype.g=function(a){var b=this.b,c=this.f;a.vectorContext.Bc(1/0,function(a){a.Ea(c.c,c.b),a.pa(c.d),a.Gb(b,null)})},ui.prototype.M=k("b"),ui.prototype.setMap=function(a){null!==this.c&&(re(this.c),this.c=null,this.a.R(),this.a=null),this.a=a,null!==this.a&&(this.c=z(a,"postcompose",this.g,!1,this),wi(this))},v(xi,Qd),v(yi,ri),l=yi.prototype,l.jb=function(a){if(fg(a)){var b=this.c;a=a.pixel,b.e=this.a,b.d=a,b.b=vi(b),wi(b)}},l.M=function(){return this.c.M()},l.qe=fa,l.ab=function(a){if(!fg(a))return!0;this.c.setMap(null);var b=a.pixel[0]-this.a[0],c=a.pixel[1]-this.a[1];return b*b+c*c>=64&&(this.qe(a),A(this,new xi("boxend",a.coordinate))),!1},l.$a=function(a){if(fg(a)&&ae(a.a)&&this.e(a)){this.a=a.pixel,this.c.setMap(a.map);var b=this.c,c=this.a;return b.e=this.a,b.d=c,b.b=vi(b),wi(b),A(this,new xi("boxstart",a.coordinate)),!0}return!1},l.Xc=Be;var zi={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Ai=/^#(?:[0-9a-f]{3}){1,2}$/i,Bi=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,Ci=/^(?:rgba)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|1|0\.\d{0,10})\)$/i,Fi=function(){var a={},b=0;return function(c,d){var e;if(a.hasOwnProperty(c))e=a[c];else{if(b>=1024){e=0;for(var f in a)0===(3&e++)&&(delete a[f],--b)}e=Ei(c),a[c]=e,++b}return s(d)&&(d[0]=e[0],d[1]=e[1],d[2]=e[2],d[3]=e[3],e=d),e}}(),Hi=[0,0,0,1],Ii=[],Ji=[0,0,0,1];Ki.prototype.d=k("a"),Li.prototype.g=k("e"),Li.prototype.i=k("f"),l=Mi.prototype,l.lh=k("a"),l.nf=k("b"),l.mh=k("c"),l.of=k("e"),l.rf=k("f"),l.nh=k("d"),v(Ni,Li),l=Ni.prototype,l.jc=k("l"),l.hh=k("b"),l.ne=k("d"),l.qc=k("h"),l.oe=ca(2),l.ih=k("c"),l.Ob=k("w"),l.jh=k("a"),l.be=fa,l.pe=fa,l.Fe=fa,l=Oi.prototype,l.oh=k("c"),l.ph=k("e"),l.qh=k("b"),l.rh=k("d"),l.Af=k("a"),v(I,Me),I.prototype.M=function(){return this.get(this.a)},I.prototype.getGeometry=I.prototype.M,l=I.prototype,l.jf=k("Z"),l.hf=k("a"),l.Dg=k("f"),l.Eg=k("e"),l.Kf=function(){this.k()},l.Kc=function(){null!==this.c&&(re(this.c),this.c=null);var a=this.M();null!=a&&(this.c=z(a,"change",this.Kf,!1,this),this.k())},l.pb=function(a){this.v(this.a,a)},I.prototype.setGeometry=I.prototype.pb,I.prototype.g=function(a){this.f=a,qa(a)||(a=ma(a)?a:[a],a=ye(a)),this.e=a,this.k()},I.prototype.b=function(a){this.Z=a},I.prototype.i=function(a){pe(this,Qe(this.a),this.Kc,!1,this),this.a=a,z(this,Qe(this.a),this.Kc,!1,this),this.Kc()},l=Ti.prototype,l.fe=function(a){this.a.push(a)},l.yg=k("a"),l.ge=function(){Ui(this)},l.If=function(a){a=a.element,this.d[sa(a).toString()]=z(a,"change",this.ge,!1,this),Ui(this)},l.Jf=function(a){a=sa(a.element).toString(),re(this.d[a]),delete this.d[a],Ui(this)},l.Bg=function(a){if(null!==this.a){var b=this.f;s(b)||(b=Qi);var c,d,e,f=a.frameState.view2DState.resolution,g=a.vectorContext;this.a.forEach(function(a){if(e=b(a,f),null!=e)for(d=e.length,c=0;d>c;++c)g.gd(a,e[c])})}},l.Rc=function(a){this.a.remove(a)},l.tc=function(a){null!==this.b&&(Oa(this.b,re),this.b=null),null!==this.d&&(Oa(cc(this.d),re),this.d=null),this.a=a,null!==a&&(this.b=[z(a,"add",this.If,!1,this),z(a,"remove",this.Jf,!1,this)],this.d={},a.forEach(function(a){this.d[sa(a).toString()]=z(a,"change",this.ge,!1,this)},this)),Ui(this)},l.setMap=function(a){null!==this.c&&(re(this.c),this.c=null),Ui(this),this.e=a,null!==a&&(this.c=z(a,"postcompose",this.Bg,!1,this),a.R())},l.Cg=function(a){this.g=a,this.f=Ri(a),Ui(this)},l.zg=k("g"),l.Ag=k("f"),l=Xi.prototype,l.L=0,l.Hd=0,l.Ka=k("L"),l.La=function(){Zi(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.d[this.a[b]]);return a},l.K=function(){return Zi(this),this.a.concat()},l.ja=function(){return 0==this.L},l.clear=function(){this.d={},this.Hd=this.L=this.a.length=0},l.remove=function(a){return $i(this.d,a)?(delete this.d[a],this.L--,this.Hd++,this.a.length>2*this.L&&Zi(this),!0):!1},l.get=function(a,b){return $i(this.d,a)?this.d[a]:b},l.Q=function(){return new Xi(this)};var aj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),cj=Bb;l=gj.prototype,l.ob="",l.Bb="",l.Ua="",l.Qb=null,l.Pa="",l.tb="",l.fg=!1,l.ub=!1,l.toString=function(){var a=[],b=this.ob;if(b&&a.push(mj(b,nj),":"),b=this.Ua){a.push("//");var c=this.Bb;c&&a.push(mj(c,nj),"@"),a.push(encodeURIComponent(String(b))),b=this.Qb,null!=b&&a.push(":",String(b))}return(b=this.Pa)&&(this.Ua&&"/"!=b.charAt(0)&&a.push("/"),a.push(mj(b,"/"==b.charAt(0)?oj:pj))),(b=this.a.toString())&&a.push("?",b),(b=this.tb)&&a.push("#",mj(b,qj)),a.join("")},l.Q=function(){return new gj(this)};var nj=/[#\/\?@]/g,pj=/[\#\?:]/g,oj=/[\#\?]/g,sj=/[\#\?@]/g,qj=/#/g;l=lj.prototype,l.aa=null,l.L=null,l.Ka=function(){return yj(this),this.L},l.add=function(a,b){yj(this),this.a=null,a=zj(this,a);var c=this.aa.get(a);return c||Yi(this.aa,a,c=[]),c.push(b),this.L++,this},l.remove=function(a){return yj(this),a=zj(this,a),$i(this.aa.d,a)?(this.a=null,this.L-=this.aa.get(a).length,this.aa.remove(a)):!1},l.clear=function(){this.aa=this.a=null,this.L=0},l.ja=function(){return yj(this),0==this.L},l.K=function(){yj(this);for(var a=this.aa.La(),b=this.aa.K(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},l.La=function(a){yj(this);var b=[];if(a){var c=a;yj(this),c=zj(this,c),$i(this.aa.d,c)&&(b=Va(b,this.aa.get(zj(this,a))))}else for(a=this.aa.La(),c=0;c<a.length;c++)b=Va(b,a[c]);return b},l.get=function(a,b){var c=a?this.La(a):[];return 0<c.length?String(c[0]):b},l.toString=function(){if(this.a)return this.a;if(!this.aa)return"";for(var a=[],b=this.aa.K(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.La(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f]))),a.push(g)}return this.a=a.join("&")},l.Q=function(){var a=new lj;return a.a=this.a,this.aa&&(a.aa=this.aa.Q(),a.L=this.L),a},v(Aj,Ld),l=Aj.prototype,l.Z=null,l.Gd=!1,l.start=function(){Bj(this),this.Gd=!1;var a=Cj(this),b=Dj(this);a&&!b&&this.a.mozRequestAnimationFrame?(this.Z=z(this.a,"MozBeforePaint",this.d),this.a.mozRequestAnimationFrame(null),this.Gd=!0):this.Z=a&&b?a.call(this.a,this.d):this.a.setTimeout(De(this.d),20)},l.Nd=function(){this.Gd&&this.Z&&re(this.Z),this.Z=null,this.c.call(this.b,Aa())},l.F=function(){Bj(this),Aj.I.F.call(this)};var Ej;v(Gj,He),l=Gj.prototype,l.Jc=null,l.vc=null,l.vb=null,l.F=function(){Gj.I.F.call(this),this.Jc&&(re(this.Jc),this.Jc=null),this.vb=this.vc=null},l.Xf=function(){var a=sc(this.vc||window);a==this.vb||a&&this.vb&&a.width==this.vb.width&&a.height==this.vb.height||(this.vb=a,A(this,"resize"))},v(Kj,He),l=Kj.prototype,l.mc=null,l.Nc=null,l.pd=null,l.Oc=null,l.ka=-1,l.kb=-1,l.cd=!1;var Mj={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},Nj={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},Oj=zb||Bb&&Nb("525"),Pj=rb&&Ab;Kj.prototype.a=function(a){Bb&&(17==this.ka&&!a.lc||18==this.ka&&!a.na||rb&&91==this.ka&&!a.od)&&(this.kb=this.ka=-1),-1==this.ka&&(a.lc&&17!=a.Ya?this.ka=17:a.na&&18!=a.Ya?this.ka=18:a.od&&91!=a.Ya&&(this.ka=91)),Oj&&!Hj(a.Ya,this.ka,a.Za,a.lc,a.na)?this.handleEvent(a):(this.kb=Ab?Jj(a.Ya):a.Ya,Pj&&(this.cd=a.na))},Kj.prototype.d=function(a){this.kb=this.ka=-1,this.cd=a.na},Kj.prototype.handleEvent=function(a){var b,c,d=a.N,e=d.altKey;zb&&"keypress"==a.type?(b=this.kb,c=13!=b&&27!=b?d.keyCode:0):Bb&&"keypress"==a.type?(b=this.kb,c=0<=d.charCode&&63232>d.charCode&&Ij(b)?d.charCode:0):yb?(b=this.kb,c=Ij(b)?d.keyCode:0):(b=d.keyCode||this.kb,c=d.charCode||0,Pj&&(e=this.cd),rb&&63==c&&224==b&&(b=191));var f=b,g=d.keyIdentifier;b?b>=63232&&b in Mj?f=Mj[b]:25==b&&a.Za&&(f=9):g&&g in Nj&&(f=Nj[g]),a=f==this.ka,this.ka=f,d=new Qj(f,c,a,d),d.na=e,A(this,d)},Kj.prototype.F=function(){Kj.I.F.call(this),Rj(this)},v(Qj,Yd),v(Sj,He),Sj.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.N,"mousewheel"==a.type?(c=1,(zb||Bb&&(sb||Nb("532.0")))&&(c=40),d=Tj(-a.wheelDelta,c),s(a.wheelDeltaX)?(b=Tj(-a.wheelDeltaX,c),c=Tj(-a.wheelDeltaY,c)):c=d):(d=a.detail,d>100?d=3:-100>d&&(d=-3),s(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d),pa(this.b)&&(b=Vb(b,-this.b,this.b)),pa(this.c)&&(c=Vb(c,-this.c,this.c)),this.e&&(b=-b),b=new Uj(d,a,b,c),A(this,b)},Sj.prototype.F=function(){Sj.I.F.call(this),re(this.d),this.d=null},v(Uj,Yd),v(Vj,He),Vj.prototype.c=function(){return sa(this).toString()},Vj.prototype.i=k("a"),Wj.prototype.clear=function(){this.a.length=0,this.d.length=0,gc(this.b)},Wj.prototype.Ka=function(){return this.a.length},Wj.prototype.ja=function(){return 0===this.a.length},v(ck,Wj),ck.prototype.g=function(){--this.c,this.i()},v(dk,Me),dk.prototype.F=function(){Bc(this.element),dk.I.F.call(this)},dk.prototype.b=k("a"),dk.prototype.f=fa,dk.prototype.setMap=function(a){null===this.a||Bc(this.element),0!=this.g.length&&(Oa(this.g,re),this.g.length=0),this.a=a,null!==this.a&&((null===this.A?a.w:this.A).appendChild(this.element),this.f!==fa&&this.g.push(z(a,"postrender",this.f,!1,this)),a.R())},v(ek,dk),ek.prototype.f=function(a){if(a=a.b,null===a)this.i&&(Vc(this.element,!1),this.i=!1);else{var b,c,d,e,f,g,h,i,j,k=a.layerStatesArray,l=jc(a.attributions),m={};for(b=0,c=k.length;c>b;b++)if(d=k[b].layer.a,j=sa(d).toString(),i=d.f,null!==i)for(d=0,e=i.length;e>d;d++)if(g=i[d],h=sa(g).toString(),!(h in l)){f=a.usedTiles[j];var n;if(n=s(f))a:if(null===g.a)n=!0;else{var o=n=void 0,p=void 0,q=void 0;for(q in f)if(q in g.a)for(p=f[q],n=0,o=g.a[q].length;o>n;++n)if(g.a[q][n].a<=p.c&&g.a[q][n].c>=p.a&&g.a[q][n].b<=p.d&&g.a[q][n].d>=p.b){n=!0;break a}n=!1}n?(h in m&&delete m[h],l[h]=g):m[h]=g}b=[l,m],a=b[0],b=b[1];for(var r in this.e)r in a?(this.c[r]||(Vc(this.e[r],!0),this.c[r]=!0),delete a[r]):r in b?(this.c[r]&&(Vc(this.e[r],!1),delete this.c[r]),delete b[r]):(Bc(this.e[r]),delete this.e[r],delete this.c[r]);for(r in a)c=wc("LI"),c.innerHTML=a[r].d,this.h.appendChild(c),this.e[r]=c,this.c[r]=!0;for(r in b)c=wc("LI"),c.innerHTML=b[r].d,Vc(c,!1),this.h.appendChild(c),this.e[r]=c;r=!ec(this.c),this.i!=r&&(Vc(this.element,r),this.i=r)}},v(fk,dk),fk.prototype.f=function(a){if(a=a.b,null===a)this.c&&(Vc(this.element,!1),this.c=!1);else{var b;a=a.logos;var c=this.i;for(b in c)b in a||(Bc(c[b]),delete c[b]);for(var d in a)if(!(d in c)){b=new Image,b.src=d;var e=a[d];""===e?e=b:(e=tc("A",{href:e,target:"_blank"}),e.appendChild(b)),b=tc("LI",void 0,e),this.e.appendChild(b),c[d]=b}d=!ec(a),this.c!=d&&(Vc(this.element,d),this.c=d)}},v(gk,dk),gk.prototype.e=function(a,b){b.a.preventDefault();var c=this.a,d=c.a().Y(),e=d.b();s(e)&&(0<this.c&&c.Ha(mi({resolution:e,duration:this.c,easing:gi})),c=d.constrainResolution(e,a),d.c(c))},ik.prototype.update=function(a,b){this.a.push(a,b,Aa())},v(kk,ni),kk.prototype.za=function(a){var b=!1,c=a.a;if(a.type==Sf){var b=a.map,d=a.coordinate,c=c.Za?-this.a:this.a,e=b.a().Y();pi(b,e,c,d,this.b),a.preventDefault(),b=!0}return!b},v(lk,ri),lk.prototype.jb=function(a){var b=si(this.b);if(null!==this.c){this.a&&this.a.update(b[0],b[1]);var c=this.c[0]-b[0],d=b[1]-this.c[1];a=a.map;var e=a.a().Y(),f=fi(e),d=c=[c,d],g=f.resolution;d[0]*=g,d[1]*=g,af(c,f.rotation),We(c,f.center),c=e.f.center(c),a.R(),e.ya(c)}this.c=b},lk.prototype.ab=function(a){a=a.map;var b=a.a().Y();if(0===this.b.length){var c;if((c=!this.f)&&(c=this.a)){c=this.a;var d=Aa()-c.f,e=c.a.length-3;if(c.a[e+2]<d)c=!1;else{for(var f=e-3;f>=0&&c.a[f+2]>d;)f-=3;if(f>=0){var d=c.a[e+2]-c.a[f+2],g=c.a[e]-c.a[f],e=c.a[e+1]-c.a[f+1];c.c=Math.atan2(e,g),c.d=Math.sqrt(g*g+e*e)/d,c=c.d>c.b}else c=!1}}return c&&(c=(this.a.b-this.a.d)/this.a.e,e=this.a.c,f=b.a(),this.e=jk(this.a,f),a.Ha(this.e),f=a.f(f),c=a.va([f[0]-c*Math.cos(e),f[1]-c*Math.sin(e)]),c=b.f.center(c),b.ya(c)),sg(b,-1),a.R(),!1}return this.c=null,!0},lk.prototype.$a=function(a){if(0<this.b.length&&this.h(a)){var b=a.map,c=b.a().Y();return this.c=null,this.i||sg(c,1),b.R(),null!==this.e&&Ua(b.A,this.e)&&(c.ya(a.b.view2DState.center),this.e=null),this.a&&(a=this.a,a.a.length=0,a.c=0,a.d=0),this.f=1<this.b.length,!0}return!1},v(mk,ri),mk.prototype.jb=function(a){if(fg(a)){var b=a.map,c=b.e();if(a=a.pixel,c=Math.atan2(c[1]/2-a[1],a[0]-c[0]/2),s(this.a)){a=c-this.a;var d=b.a().Y(),e=fi(d);b.R(),oi(b,d,e.rotation-a)}this.a=c}},mk.prototype.ab=function(a){if(!fg(a))return!0;a=a.map;var b=a.a();sg(b,-1);var b=b.Y(),c=fi(b).rotation,c=b.constrainRotation(c,0);return oi(a,b,c,void 0,250),!1},mk.prototype.$a=function(a){return fg(a)&&ae(a.a)&&this.c(a)?(a=a.map,sg(a.a(),1),a.R(),this.a=void 0,!0):!1},v(nk,yi),nk.prototype.qe=function(){var a=this.g,b=a.a().Y(),c=this.M().u(),d=Gg(c),c=ci(c,a.e()),c=b.constrainResolution(c,0,void 0);qi(a,b,c,d,200)},v(ok,ni),ok.prototype.za=function(a){var b=!1;if("key"==a.type){var c=a.a.Ya;if(this.a(a)&&(40==c||37==c||39==c||38==c)){var d=a.map,b=d.a(),e=fi(b),f=e.resolution*this.b,g=0,h=0;40==c?h=-f:37==c?g=-f:39==c?g=f:h=f,c=[g,h],af(c,e.rotation),e=b.a(),s(e)&&(s(100)&&d.Ha(ki({source:e,duration:100,easing:ii})),d=b.f.center([e[0]+c[0],e[1]+c[1]]),b.ya(d)),a.preventDefault(),b=!0}}return!b},v(qk,ni),qk.prototype.za=function(a){var b=!1;if("key"==a.type){var c=a.a.md;if(this.b(a)&&(43==c||45==c)){b=a.map,c=43==c?this.a:-this.a,b.R();var d=b.a().Y();pi(b,d,c,void 0,this.c),a.preventDefault(),b=!0}}return!b},v(rk,ni),rk.prototype.za=function(a){var b=!1;if("mousewheel"==a.type){var b=a.map,c=a.a;this.c=a.coordinate,this.a+=c.a,s(this.b)||(this.b=Aa()),c=Math.max(80-(Aa()-this.b),0),ea.clearTimeout(this.e),this.e=ea.setTimeout(xa(this.f,this,b),c),a.preventDefault(),b=!0}return!b},rk.prototype.f=function(a){var b=Vb(this.a,-1,1),c=a.a().Y();
a.R(),pi(a,c,-b,this.c,this.i),this.a=0,this.c=null,this.e=this.b=void 0},v(sk,ri),sk.prototype.jb=function(a){var b=0,c=this.b[0],d=this.b[1],c=Math.atan2(d.clientY-c.clientY,d.clientX-c.clientX);s(this.e)&&(b=c-this.e,this.f+=b,!this.a&&Math.abs(this.f)>this.h&&(this.a=!0)),this.e=c,a=a.map,c=Qc(a.b),d=si(this.b),d[0]-=c.x,d[1]-=c.y,this.c=a.va(d),this.a&&(c=a.a().Y(),d=fi(c),a.R(),oi(a,c,d.rotation+b,this.c))},sk.prototype.ab=function(a){if(2>this.b.length){a=a.map;var b=a.a();if(sg(b,-1),this.a){var b=b.Y(),c=fi(b).rotation,d=this.c,c=b.constrainRotation(c,0);oi(a,b,c,d,250)}return!1}return!0},sk.prototype.$a=function(a){return 2<=this.b.length?(a=a.map,this.c=null,this.e=void 0,this.a=!1,this.f=0,this.i||sg(a.a(),1),a.R(),!0):!1},v(tk,ri),tk.prototype.jb=function(a){var b=1,c=this.b[0],d=this.b[1],e=c.clientX-d.clientX,c=c.clientY-d.clientY,e=Math.sqrt(e*e+c*c);s(this.a)&&(b=this.a/e),this.a=e,1!=b&&(this.e=b),a=a.map;var e=a.a().Y(),c=fi(e),d=Qc(a.b),f=si(this.b);f[0]-=d.x,f[1]-=d.y,this.c=a.va(f),a.R(),qi(a,e,c.resolution*b,this.c)},tk.prototype.ab=function(a){if(2>this.b.length){a=a.map;var b=a.a();sg(b,-1);var b=b.Y(),c=fi(b).resolution,d=this.c,e=this.f,c=b.constrainResolution(c,0,this.e-1);return qi(a,b,c,d,e),!1}return!0},tk.prototype.$a=function(a){return 2<=this.b.length?(a=a.map,this.c=null,this.a=void 0,this.e=1,this.i||sg(a.a(),1),a.R(),!0):!1},v(vk,Je),vk.prototype.Tc=fa,vk.prototype.u=k("O"),vk.prototype.a=k("i"),v(J,Me),J.prototype.c=function(){return this.get("brightness")},J.prototype.getBrightness=J.prototype.c,J.prototype.e=function(){return this.get("contrast")},J.prototype.getContrast=J.prototype.e,J.prototype.f=function(){return this.get("hue")},J.prototype.getHue=J.prototype.f,J.prototype.g=function(){return this.get("maxResolution")},J.prototype.getMaxResolution=J.prototype.g,J.prototype.i=function(){return this.get("minResolution")},J.prototype.getMinResolution=J.prototype.i,J.prototype.l=function(){return this.get("opacity")},J.prototype.getOpacity=J.prototype.l,J.prototype.h=function(){return this.get("saturation")},J.prototype.getSaturation=J.prototype.h,J.prototype.b=function(){return this.get("visible")},J.prototype.getVisible=J.prototype.b,J.prototype.n=function(a){this.v("brightness",a)},J.prototype.setBrightness=J.prototype.n,J.prototype.o=function(a){this.v("contrast",a)},J.prototype.setContrast=J.prototype.o,J.prototype.w=function(a){this.v("hue",a)},J.prototype.setHue=J.prototype.w,J.prototype.A=function(a){this.v("maxResolution",a)},J.prototype.setMaxResolution=J.prototype.A,J.prototype.B=function(a){this.v("minResolution",a)},J.prototype.setMinResolution=J.prototype.B,J.prototype.C=function(a){this.v("opacity",a)},J.prototype.setOpacity=J.prototype.C,J.prototype.O=function(a){this.v("saturation",a)},J.prototype.setSaturation=J.prototype.O,J.prototype.V=function(a){this.v("visible",a)},J.prototype.setVisible=J.prototype.V,v(K,J),l=K.prototype,l.Yd=function(){this.b()&&this.k()},l.Pf=function(){null!==this.a&&(Oa(cc(this.a),re),this.a=null);var a=this.Mb();if(null!=a){this.a={add:z(a,"add",this.Of,!1,this),remove:z(a,"remove",this.Qf,!1,this)};var b,c,d,a=a.a;for(b=0,c=a.length;c>b;b++)d=a[b],this.a[sa(d).toString()]=z(d,["propertychange","change"],this.Yd,!1,this)}this.k()},l.Of=function(a){a=a.element,this.a[sa(a).toString()]=z(a,["propertychange","change"],this.Yd,!1,this),this.k()},l.Qf=function(a){a=sa(a.element).toString(),re(this.a[a]),delete this.a[a],this.k()},l.Mb=function(){return this.get("layers")},K.prototype.getLayers=K.prototype.Mb,K.prototype.ba=function(a){this.v("layers",a)},K.prototype.setLayers=K.prototype.ba,K.prototype.Gc=function(a){var b=s(a)?a:[],c=b.length;this.Mb().forEach(function(a){a.Gc(b)}),a=xk(this);var d,e;for(d=b.length;d>c;c++)e=b[c],e.brightness=Vb(e.brightness+a.brightness,-1,1),e.contrast*=a.contrast,e.hue+=a.hue,e.opacity*=a.opacity,e.saturation*=a.saturation,e.visible=e.visible&&a.visible,e.maxResolution=Math.min(e.maxResolution,a.maxResolution),e.minResolution=Math.max(e.minResolution,a.minResolution);return b},K.prototype.Ra=ca(1),v(yk,Fh);var Ak=6378137*Math.PI,zk=[-Ak,-Ak,Ak,Ak],Th=Pa("EPSG:3857 EPSG:102100 EPSG:102113 EPSG:900913 urn:ogc:def:crs:EPSG:6.18:3:3857 http://www.opengis.net/gml/srs/epsg.xml#3857".split(" "),function(a){return new yk(a)});yk.prototype.c=function(a,b){return a/((Math.exp(b[1]/6378137)+Math.exp(-(b[1]/6378137)))/2)},v(Bk,Fh);var Ck=[-180,-90,180,90],Wh=[new Bk("CRS:84"),new Bk("EPSG:4326","neu"),new Bk("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Bk("urn:ogc:def:crs:OGC:1.3:CRS84"),new Bk("urn:ogc:def:crs:OGC:2:84"),new Bk("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Bk("urn:x-ogc:def:crs:EPSG:4326","neu")];Bk.prototype.c=aa(),v(M,J),M.prototype.Gc=function(a){return a=s(a)?a:[],a.push(xk(this)),a},M.prototype.ba=k("a"),M.prototype.Ra=function(){return this.a.i},M.prototype.bd=function(){this.k()},v(Ek,He),Ek.prototype.u=k("h"),v(Fk,Ek),Fk.prototype.e=function(a){if(s(a)){var b=sa(a);return b in this.f?this.f[b]:(a=ec(this.f)?this.a:this.a.cloneNode(!1),this.f[b]=a)}return this.a},Fk.prototype.l=function(){this.state=3,Oa(this.d,re),this.d=null,A(this,"change")},Fk.prototype.t=function(){this.state=2,Oa(this.d,re),this.d=null,A(this,"change")};var Ik=new gb(0,0,0);l=Hk.prototype,l.Ec=function(a,b,c,d,e){for(e=Jk(this,a,e),a=a.a-1;a>=this.minZoom;){if(b.call(c,a,Kk(this,e,a,d)))return!0;--a}return!1},l.Hc=k("minZoom"),l.lb=function(a){return null===this.e?this.g[a]:this.e},l.ca=function(a){return this.a[a]},l.Ic=function(a,b,c){return a.a<this.maxZoom?(c=Jk(this,a,c),Kk(this,c,a.a+1,b)):null},l.ia=function(a){return s(this.f)?this.f:this.b[a]},v(Ok,vk),l=Ok.prototype,l.vd=ze,l.hd=function(a,b,c,d){var e,f,g,h,i=!0;for(g=d.a;g<=d.c;++g)for(h=d.b;h<=d.d;++h)f=this.hb(c,g,h),a[c]&&a[c][f]||(e=b(c,g,h),null===e?i=!1:(a[c]||(a[c]={}),a[c][f]=e));return i},l.Fc=ca(0),l.hb=ib,l.ma=k("tileGrid"),l.kc=function(a,b,c){return Pk(this,c).ia(a)},l.Ge=fa,v(Qk,Ld),Qk.prototype.f=fa,Qk.prototype.t=function(a){2===a.target.state&&Rk(this)},v(Zk,Li),l=Zk.prototype,l.jc=function(){var a=this.b,b=this.Ob();if("fraction"==this.c||"fraction"==this.h){if(null===b)return null;a=this.b.slice(),"fraction"==this.c&&(a[0]*=b[0]),"fraction"==this.h&&(a[1]*=b[1])}if("top-left"!=this.d){if(null===b)return null;a===this.b&&(a=this.b.slice()),("top-right"==this.d||"bottom-right"==this.d)&&(a[0]=-a[0]+b[0]),("bottom-left"==this.d||"bottom-right"==this.d)&&(a[1]=-a[1]+b[1])}return a},l.qc=function(){return this.a.a},l.oe=function(){return this.a.d},l.ne=function(){var a=this.a;if(null===a.c)if(a.i){var b=a.e[0],c=a.e[1],d=rd(b,c);d.fillRect(0,0,b,c),a.c=d.canvas}else a.c=a.a;return a.c},l.kh=function(){return this.a.f},l.Ob=function(){return null===this.l?this.a.e:this.l},l.be=function(a,b){return z(this.a,"change",a,!1,b)},l.pe=function(){var a=this.a;if(0==a.d){a.d=1,a.b=[oe(a.a,"error",a.g,!1,a),oe(a.a,"load",a.h,!1,a)];try{a.a.src=a.f}catch(b){a.g()}}},l.Fe=function(a,b){pe(this.a,"change",a,!1,b)},v(al,He),al.prototype.g=function(){this.d=3,Oa(this.b,re),this.b=null,A(this,"change")},al.prototype.h=function(){this.d=2,this.e=[this.a.width,this.a.height],Oa(this.b,re),this.b=null;var a=rd(1,1);a.drawImage(this.a,0,0);try{a.getImageData(0,0,1,1)}catch(b){this.i=!0}A(this,"change")},ga($k),$k.prototype.clear=function(){this.a={},this.d=0},$k.prototype.get=function(a,b){var c=b+":"+a;return c in this.a?this.a[c]:null},v(el,Ld),el.prototype.zc=function(a){return new Qk(this,a)},el.prototype.F=function(){$b(this.b,function(a){Pd(a)}),el.I.F.call(this)},el.prototype.Vc=fa,el.prototype.w=function(a,b){for(var c in this.b)if(!(null!==b&&c in b.layerStates)){var d=this.b[c];delete this.b[c],Pd(d)}},v(N,M),v(O,M),O.prototype.ea=function(){return this.get("preload")},O.prototype.getPreload=O.prototype.ea,O.prototype.ra=function(a){this.v("preload",a)},O.prototype.setPreload=O.prototype.ra,O.prototype.fa=function(){return this.get("useInterimTilesOnError")},O.prototype.getUseInterimTilesOnError=O.prototype.fa,O.prototype.Ta=function(a){this.v("useInterimTilesOnError",a)},O.prototype.setUseInterimTilesOnError=O.prototype.Ta,v(P,M),P.prototype.Vb=k("Ub"),P.prototype.wc=k("ra"),P.prototype.fa=function(a){this.Ub=a,this.ra=Ri(a),this.k()},l=jl.prototype,l.Bc=function(a,b){var c=a.toString(),d=this.w[c];s(d)?d.push(b):this.w[c]=[b]},l.dc=function(a){if(Mg(this.g,a.u())){if(null!==this.d||null!==this.a){null===this.d||ml(this,this.d),null===this.a||nl(this,this.a);var b=Yg(a,this.f,this.e),c=b[2]-b[0],d=b[3]-b[1],c=Math.sqrt(c*c+d*d),d=this.b;d.beginPath(),d.arc(b[0],b[1],c,0,2*Math.PI),null===this.d||d.fill(),null===this.a||d.stroke()}""!==this.c&&ll(this,a.ud(),2,2)}},l.gd=function(a,b){var c=a.M();if(null!==c&&Mg(this.g,c.u())){var d=b.a;s(d)||(d=0),this.Bc(d,function(a){a.Ea(b.c,b.b),a.Tb(b.e),a.pa(b.d),rl[c.G()].call(a,c,null)})}},l.Od=function(a,b){var c,d,e=a.a;for(c=0,d=e.length;d>c;++c){var f=e[c];rl[f.G()].call(this,f,b)}},l.ic=function(a){var b=a.j;a=a.a,null===this.i||kl(this,b),""!==this.c&&ll(this,b,b.length,a)},l.gc=function(a){var b=a.j;a=a.a,null===this.i||kl(this,b),""!==this.c&&ll(this,b,b.length,a)},l.ec=function(a){if(Mg(this.g,a.u())){if(null!==this.a){nl(this,this.a);var b=Yg(a,this.f,this.e),c=this.b;c.beginPath(),pl(this,b,0,b.length,!1),c.stroke()}""!==this.c&&(a=sl(a),ll(this,a,2,2))}},l.fc=function(a){var b=a.u();if(Mg(this.g,b)){if(null!==this.a){nl(this,this.a);var b=Yg(a,this.f,this.e),c=this.b;c.beginPath();var d,e,f=a.c,g=0;for(d=0,e=f.length;e>d;++d)g=pl(this,b,g,f[d],!1);c.stroke()}""!==this.c&&(a=tl(a),ll(this,a,a.length,2))}},l.Gb=function(a){if(Mg(this.g,a.u())){var b;if(null!==this.a||null!==this.d){null===this.d||ml(this,this.d),null===this.a||nl(this,this.a),b=Yg(a,this.f,this.e);var c=this.b;c.beginPath(),ql(this,b,0,a.c),null===this.d||c.fill(),null===this.a||c.stroke()}""!==this.c&&(a=zh(a),ll(this,a,2,2))}},l.hc=function(a){if(Mg(this.g,a.u())){var b;if(null!==this.a||null!==this.d){null===this.d||ml(this,this.d),null===this.a||nl(this,this.a),b=Yg(a,this.f,this.e);var c,d,e=this.b,f=a.c,g=0;for(c=0,d=f.length;d>c;++c){var h=f[c];e.beginPath(),g=ql(this,b,g,h),null===this.d||e.fill(),null===this.a||e.stroke()}}""!==this.c&&(a=ul(a),ll(this,a,a.length,2))}},l.Ea=function(a,b){if(null===a)this.d=null;else{var c=a.a;this.d={fillStyle:Di(null===c?Hi:c)}}if(null===b)this.a=null;else{var c=b.a,d=b.b,e=b.c,f=b.e,g=b.d,h=b.f;this.a={lineCap:s(d)?d:"round",lineDash:null!=e?e:Ii,lineJoin:s(f)?f:"round",lineWidth:this.l*(s(g)?g:1),miterLimit:s(h)?h:10,strokeStyle:Di(null===c?Ji:c)}}},l.Tb=function(a){if(null===a)this.i=null;else{var b=a.jc(),c=a.qc(1),d=a.t,e=a.n,f=a.e,g=a.f,h=a.Ob();a=a.o,this.C=b[0],this.O=b[1],this.qb=h[1],this.i=c,this.A=s(d)?d:1,this.ea=s(e)?e:!1,this.fa=s(f)?f:0,this.h=s(g)?g:1,this.Db=s(a)?a:!1,this.Ra=h[0]}},l.pa=function(a){if(null===a)this.c="";else{var b=a.d;null===b?this.t=null:(b=b.a,this.t={fillStyle:Di(null===b?Hi:b)});var c=a.e;if(null===c)this.o=null;else{var b=c.a,d=c.b,e=c.c,f=c.e,g=c.d,c=c.f;this.o={lineCap:s(d)?d:"round",lineDash:null!=e?e:Ii,lineJoin:s(f)?f:"round",lineWidth:this.l*(s(g)?g:1),miterLimit:s(c)?c:10,strokeStyle:Di(null===b?Ji:b)}}var b=a.a,d=a.h,e=a.l,f=a.b,g=a.c,c=a.f,h=a.g;a=a.i,this.V={font:s(b)?b:"10px sans-serif",textAlign:s(h)?h:"center",textBaseline:s(a)?a:"middle"},this.c=s(c)?c:"",this.Eb=s(d)?this.l*d:0,this.ra=s(e)?this.l*e:0,this.B=s(f)?f:0,this.n=this.l*(s(g)?g:1)}};var rl={Point:jl.prototype.ic,LineString:jl.prototype.ec,Polygon:jl.prototype.Gb,MultiPoint:jl.prototype.gc,MultiLineString:jl.prototype.fc,MultiPolygon:jl.prototype.hc,GeometryCollection:jl.prototype.Od,Circle:jl.prototype.dc};v(wl,Qk),wl.prototype.n=function(a,b,c){xl(this,"precompose",c,a,void 0);var d=this.o();if(null!==d){var e=this.l();if(c.globalAlpha=b.opacity,0===a.view2DState.rotation){b=e[13];var f=d.width*e[0],g=d.height*e[5];c.drawImage(d,0,0,+d.width,+d.height,Math.round(e[12]),Math.round(b),Math.round(f),Math.round(g))}else c.setTransform(e[0],e[1],e[4],e[5],e[12],e[13]),c.drawImage(d,0,0),c.setTransform(1,0,0,1,0,0)}xl(this,"postcompose",c,a,void 0)};var zl=function(){var a=null,b=null;return function(c){if(null===a){a=rd(1,1),b=a.createImageData(1,1);var d=b.data;d[0]=42,d[1]=84,d[2]=126,d[3]=255}var d=a.canvas,e=c[0]<=d.width&&c[1]<=d.height;return e||(d.width=c[0],d.height=c[1],d=c[0]-1,c=c[1]-1,a.putImageData(b,d,c),c=a.getImageData(d,c,1,1),e=eb(b.data,c.data)),e}}();v(Al,vk),v(Cl,wl),Cl.prototype.f=function(a,b,c,d){var e=this.a;return e.a.Tc(b.extent,b.view2DState.resolution,b.view2DState.rotation,a,function(a){return c.call(d,a,e)})},Cl.prototype.o=function(){return null===this.d?null:this.d.e()},Cl.prototype.l=k("b"),Cl.prototype.c=function(a){var b=a.pixelRatio,c=a.view2DState,d=c.center,e=c.resolution,f=c.rotation,g=this.a.a,h=a.viewHints;if(h[0]||h[1]||(c=g.Nb(a.extent,e,b,c.projection),null!==c&&(h=c.state,0==h?(oe(c,"change",this.t,!1,this),Gk(c)):2==h&&(this.d=c))),null!==this.d){var c=this.d,h=c.u(),i=c.c,j=c.b,e=b*i/(e*j);bl(this.b,b*a.size[0]/2,b*a.size[1]/2,e,e,f,j*(h[0]-d[0])/i,j*(d[1]-h[3])/i),Tk(a.attributions,c.g),Uk(a,g)}},v(Dl,wl),Dl.prototype.o=k("g"),Dl.prototype.l=k("A"),Dl.prototype.c=function(a){var b,c=a.pixelRatio,d=a.view2DState,e=d.projection,f=this.a,g=f.a,h=Pk(g,e),i=g.Fc(),j=jg(h.a,d.resolution,0),k=g.kc(j,a.pixelRatio,e),l=h.ca(j),m=l/(k/h.ia(j)),n=d.center;l==d.resolution?(n=Xk(n,l,a.size),b=Hg(n,l,d.rotation,a.size)):b=a.extent;var o,p,q=Lk(h,b,l),r=k*(q.c-q.a+1),t=k*(q.d-q.b+1);null===this.g?(p=rd(r,t),this.g=p.canvas,this.d=[r,t],this.w=p,this.h=!zl(this.d)):(o=this.g,p=this.w,this.d[0]<r||this.d[1]<t||this.h&&(this.d[0]>r||this.d[1]>t)?(o.width=r,o.height=t,this.d=[r,t],this.h=!zl(this.d),this.b=null):(r=this.d[0],t=this.d[1],j==this.B&&this.b.a<=q.a&&q.c<=this.b.c&&this.b.b<=q.b&&q.d<=this.b.d||(this.b=null)));var u,v;null===this.b?(r/=k,t/=k,u=q.a-Math.floor((r-(q.c-q.a+1))/2),v=q.b-Math.floor((t-(q.d-q.b+1))/2),this.B=j,this.b=new kb(u,u+r-1,v,v+t-1),this.i=Array(r*t),t=this.b):(t=this.b,r=t.c-t.a+1),o={},o[j]={};var w=[],x=xa(g.hd,g,o,Wk(function(a){return null!==a&&2==a.state},g,c,e)),y=f.fa();s(y)||(y=!0);var z,A,B,C=ug(),D=new kb(0,0,0,0);for(v=q.a;v<=q.c;++v)for(B=q.b;B<=q.d;++B)A=g.Ib(j,v,B,c,e),u=A.state,2==u||4==u||3==u&&!y?o[j][A.a.toString()]=A:(z=h.Ec(A.a,x,null,D,C),z||(w.push(A),z=h.Ic(A.a,D,C),null===z||x(j+1,z)));for(x=0,z=w.length;z>x;++x)A=w[x],v=k*(A.a.x-t.a),B=k*(t.d-A.a.y),p.clearRect(v,B,k,k);w=Pa(dc(o),Number),bb(w);var E,F,G,H,I,J,K=g.C,L=Kg(Jk(h,new gb(j,t.a,t.d),C)),x=0;for(z=w.length;z>x;++x)if(E=w[x],k=g.kc(E,c,e),H=o[E],E==j)for(G in H)A=H[G],F=(A.a.y-t.b)*r+(A.a.x-t.a),this.i[F]!=A&&(v=k*(A.a.x-t.a),B=k*(t.d-A.a.y),u=A.state,4!=u&&(3!=u||y)&&K||p.clearRect(v,B,k,k),2==u&&p.drawImage(A.b(),i,i,k,k,v,B,k,k),this.i[F]=A);else for(G in E=h.ca(E)/l,H)for(A=H[G],F=Jk(h,A.a,C),v=(F[0]-L[0])/m,B=(L[1]-F[3])/m,J=E*k,I=E*k,u=A.state,4!=u&&K||p.clearRect(v,B,J,I),2==u&&p.drawImage(A.b(),i,i,k,k,v,B,J,I),A=Kk(h,F,j,D),u=Math.max(A.a,t.a),B=Math.min(A.c,t.c),v=Math.max(A.b,t.b),A=Math.min(A.d,t.d);B>=u;++u)for(I=v;A>=I;++I)F=(I-t.b)*r+(u-t.a),this.i[F]=void 0;Vk(a.usedTiles,g,j,q),Yk(a,g,h,c,e,b,j,f.ea()),Sk(a,g),Uk(a,g),bl(this.A,c*a.size[0]/2,c*a.size[1]/2,c*m/d.resolution,c*m/d.resolution,d.rotation,(L[0]-n[0])/m,(n[1]-L[1])/m)};var El=["Polygon","LineString","Image","Text"];Fl.prototype.Sc=fa,Fl.prototype.jd=k("O"),Fl.prototype.u=k("c"),v(Ll,Fl),Ll.prototype.ic=function(a,b){if(null!==this.i){Dg(this.c,a.u()),Hl(this,a,b);var c=a.j,d=this.coordinates.length,c=Gl(this,c,0,c.length,a.a,!1);this.d.push([4,d,c,this.i,this.b,this.f,this.g,this.h,this.l,this.t,this.n,this.o,this.w]),this.a.push([4,d,c,this.C,this.b,this.f,this.g,this.h,this.l,this.t,this.n,this.o,this.w]),Kl(this,a,b)}},Ll.prototype.gc=function(a,b){if(null!==this.i){Dg(this.c,a.u()),Hl(this,a,b);var c=a.j,d=this.coordinates.length,c=Gl(this,c,0,c.length,a.a,!1);this.d.push([4,d,c,this.i,this.b,this.f,this.g,this.h,this.l,this.t,this.n,this.o,this.w]),this.a.push([4,d,c,this.C,this.b,this.f,this.g,this.h,this.l,this.t,this.n,this.o,this.w]),Kl(this,a,b)}},Ll.prototype.Sc=function(){Jl(this),this.f=this.b=void 0,this.i=this.C=null,this.w=this.o=this.t=this.l=this.h=this.n=this.g=void 0},Ll.prototype.Tb=function(a){var b=a.jc(),c=a.Ob(),d=a.ne(1),e=a.qc(1);this.b=b[0],this.f=b[1],this.C=d,this.i=e,this.g=c[1],this.h=a.t,this.l=a.n,this.t=a.e,this.n=a.f,this.o=a.o,this.w=c[0]},v(Ml,Fl),l=Ml.prototype,l.jd=function(){var a=this.O;return this.e&&(a=xg(a,this.resolution*(this.e+1)/2)),a},l.ec=function(a,b){var c=this.b,d=c.lineWidth;s(c.strokeStyle)&&s(d)&&(Dg(this.c,a.u()),Ol(this),Hl(this,a,b),this.a.push([10,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash],[1]),c=a.j,Nl(this,c,0,c.length,a.a),this.a.push([12]),Kl(this,a,b))},l.fc=function(a,b){var c=this.b,d=c.lineWidth;if(s(c.strokeStyle)&&s(d)){Dg(this.c,a.u()),Ol(this),Hl(this,a,b),this.a.push([10,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash],[1]);var e,f,c=a.c,d=a.j,g=a.a,h=0;for(e=0,f=c.length;f>e;++e)h=Nl(this,d,h,c[e],g);this.a.push([12]),Kl(this,a,b)}},l.Sc=function(){this.b.qd!=this.coordinates.length&&this.d.push([12]),Jl(this),this.b=null},l.Ea=function(a,b){var c=b.a;this.b.strokeStyle=Di(null===c?Ji:c),c=b.b,this.b.lineCap=s(c)?c:"round",c=b.c,this.b.lineDash=null===c?Ii:c,c=b.e,this.b.lineJoin=s(c)?c:"round",c=b.d,this.b.lineWidth=s(c)?c:1,c=b.f,this.b.miterLimit=s(c)?c:10,this.e=Math.max(this.e,this.b.lineWidth)},v(Pl,Fl),l=Pl.prototype,l.dc=function(a,b){var c=this.b,d=c.strokeStyle;if(s(c.fillStyle)||s(d)){Dg(this.c,a.u()),Rl(this),Hl(this,a,b),this.a.push([9,Di(Hi)]),s(c.strokeStyle)&&this.a.push([10,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash]),d=a.j,Gl(this,d,0,d.length,a.a,!1);var d=[1],e=[2];this.d.push(d,e),this.a.push(d,e),Kl(this,a,b),d=[7],this.a.push(d),s(c.fillStyle)&&this.d.push(d),s(c.strokeStyle)&&(c=[12],this.d.push(c),this.a.push(c))}},l.Gb=function(a,b){var c=this.b,d=c.strokeStyle;(s(c.fillStyle)||s(d))&&(Dg(this.c,a.u()),Rl(this),Hl(this,a,b),this.a.push([9,Di(Hi)]),s(c.strokeStyle)&&this.a.push([10,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash]),c=a.c,d=yh(a),Ql(this,d,0,c,a.a),Kl(this,a,b))},l.hc=function(a,b){var c=this.b,d=c.strokeStyle;if(s(c.fillStyle)||s(d)){Dg(this.c,a.u()),Rl(this),Hl(this,a,b),this.a.push([9,Di(Hi)]),s(c.strokeStyle)&&this.a.push([10,c.strokeStyle,c.lineWidth,c.lineCap,c.lineJoin,c.miterLimit,c.lineDash]);var e,f,c=a.c,d=Sl(a),g=a.a,h=0;for(e=0,f=c.length;f>e;++e)h=Ql(this,d,h,c[e],g);Kl(this,a,b)}},l.Sc=function(){Jl(this),this.b=null;var a=this.Qa;if(0!==a){var b,c,d=this.coordinates;for(b=0,c=d.length;c>b;++b)d[b]=a*Math.round(d[b]/a)}},l.jd=function(){var a=this.O;return this.e&&(a=xg(a,this.resolution*(this.e+1)/2)),a},l.Ea=function(a,b){var c=this.b;if(null===a)c.fillStyle=void 0;else{var d=a.a;c.fillStyle=Di(null===d?Hi:d)}null===b?(c.strokeStyle=void 0,c.lineCap=void 0,c.lineDash=null,c.lineJoin=void 0,c.lineWidth=void 0,c.miterLimit=void 0):(d=b.a,c.strokeStyle=Di(null===d?Ji:d),d=b.b,c.lineCap=s(d)?d:"round",d=b.c,c.lineDash=null===d?Ii:d.slice(),d=b.e,c.lineJoin=s(d)?d:"round",d=b.d,c.lineWidth=s(d)?d:1,d=b.f,c.miterLimit=s(d)?d:10,this.e=Math.max(this.e,c.lineWidth))},v(Tl,Fl),Tl.prototype.eb=function(a,b,c,d,e,f){if(""!==this.i&&null!==this.g&&(null!==this.b||null!==this.f)){if(Eg(this.c,a,b,c,d),null!==this.b){var g=this.b,h=this.o;if(null===h||h.fillStyle!=g.fillStyle){var i=[9,g.fillStyle];this.d.push(i),this.a.push(i),null===h?this.o={fillStyle:g.fillStyle}:h.fillStyle=g.fillStyle}}null!==this.f&&(g=this.f,h=this.w,null===h||h.lineCap!=g.lineCap||h.lineDash!=g.lineDash||h.lineJoin!=g.lineJoin||h.lineWidth!=g.lineWidth||h.miterLimit!=g.miterLimit||h.strokeStyle!=g.strokeStyle)&&(i=[10,g.strokeStyle,g.lineWidth,g.lineCap,g.lineJoin,g.miterLimit,g.lineDash],this.d.push(i),this.a.push(i),null===h?this.w={lineCap:g.lineCap,lineDash:g.lineDash,lineJoin:g.lineJoin,lineWidth:g.lineWidth,miterLimit:g.miterLimit,strokeStyle:g.strokeStyle}:(h.lineCap=g.lineCap,h.lineDash=g.lineDash,h.lineJoin=g.lineJoin,h.lineWidth=g.lineWidth,h.miterLimit=g.miterLimit,h.strokeStyle=g.strokeStyle)),g=this.g,h=this.C,(null===h||h.font!=g.font||h.textAlign!=g.textAlign||h.textBaseline!=g.textBaseline)&&(i=[11,g.font,g.textAlign,g.textBaseline],this.d.push(i),this.a.push(i),null===h?this.C={font:g.font,textAlign:g.textAlign,textBaseline:g.textBaseline}:(h.font=g.font,h.textAlign=g.textAlign,h.textBaseline=g.textBaseline)),Hl(this,e,f),g=this.coordinates.length,a=Gl(this,a,b,c,d,!1),a=[5,g,a,this.i,this.h,this.l,this.t,this.n,null!==this.b,null!==this.f],this.d.push(a),this.a.push(a),Kl(this,e,f)}},Tl.prototype.pa=function(a){if(null===a)this.i="";else{var b=a.d;null===b?this.b=null:(b=b.a,b=Di(null===b?Hi:b),null===this.b?this.b={fillStyle:b}:this.b.fillStyle=b);var c=a.e;if(null===c)this.f=null;else{var b=c.a,d=c.b,e=c.c,f=c.e,g=c.d,c=c.f,d=s(d)?d:"round",e=null!=e?e.slice():Ii,f=s(f)?f:"round",g=s(g)?g:1,c=s(c)?c:10,b=Di(null===b?Ji:b);if(null===this.f)this.f={lineCap:d,lineDash:e,lineJoin:f,lineWidth:g,miterLimit:c,strokeStyle:b};else{var h=this.f;h.lineCap=d,h.lineDash=e,h.lineJoin=f,h.lineWidth=g,h.miterLimit=c,h.strokeStyle=b}}var i=a.a,b=a.h,d=a.l,e=a.b,g=a.c,c=a.f,f=a.g,h=a.i;a=s(i)?i:"10px sans-serif",f=s(f)?f:"center",h=s(h)?h:"middle",null===this.g?this.g={font:a,textAlign:f,textBaseline:h}:(i=this.g,i.font=a,i.textAlign=f,i.textBaseline=h),this.i=s(c)?c:"",this.h=s(b)?b:0,this.l=s(d)?d:0,this.t=s(e)?e:0,this.n=s(g)?g:1}},Ul.prototype.ja=function(){return ec(this.a)};var $l={Image:Ll,LineString:Ml,Polygon:Pl,Text:Tl};v(am,Ug),l=am.prototype,l.Q=function(){var a=new am(null),b=this.j.slice();return Wg(a,this.b,b),a.k(),a},l.ta=function(a,b,c,d){var e=this.j;a-=e[0];var f=b-e[1];if(b=a*a+f*f,d>b){if(0===b)for(d=0;d<this.a;++d)c[d]=e[d];else for(d=this.je()/Math.sqrt(b),c[0]=e[0]+d*a,c[1]=e[1]+d*f,d=2;d<this.a;++d)c[d]=e[d];return c.length=this.a,b}return d},l.rb=function(a,b){var c=this.j,d=a-c[0],c=b-c[1];return d*d+c*c<=bm(this)},l.ud=function(){return this.j.slice(0,this.a)},l.u=function(a){if(this.f!=this.d){var b=this.j,c=b[this.a]-b[0];this.extent=wg(b[0]-c,b[1]-c,b[0]+c,b[1]+c,this.extent),this.f=this.d}return Og(this.extent,a)},l.je=function(){return Math.sqrt(bm(this))},l.ha=function(){return this},l.G=ca("Circle"),l.Jg=function(a){var b=this.a,c=this.j[b]-this.j[0],d=a.slice();for(d[b]=d[0]+c,c=1;b>c;++c)d[b+c]=a[c];Wg(this,this.b,d),this.k()},l.ye=function(a,b,c){if(null===a)Wg(this,"XY",null);else{Xg(this,c,a,0),null===this.j&&(this.j=[]),c=this.j,a=gh(c,a),c[a++]=c[0]+b;var d;for(b=1,d=this.a;d>b;++b)c[a++]=c[b];c.length=a}this.k()},l.ai=function(a){this.j[this.a]=this.j[0]+a,this.k()},v(cm,Sg),l=cm.prototype,l.Q=function(){var a=new cm(null);return a.ze(this.a),a},l.ta=function(a,b,c,d){if(d<zg(this.u(),a,b))return d;var e,f,g=this.a;for(e=0,f=g.length;f>e;++e)d=g[e].ta(a,b,c,d);return d},l.rb=function(a,b){var c,d,e=this.a;for(c=0,d=e.length;d>c;++c)if(e[c].rb(a,b))return!0;return!1},l.u=function(a){if(this.f!=this.d){var b,c,d=Bg(this.extent),e=this.a;for(b=0,c=e.length;c>b;++b)Dg(d,e[b].u());this.extent=d,this.f=this.d}return Og(this.extent,a)},l.gf=function(){return em(this.a)},l.ha=function(a){if(this.l!=this.d&&(gc(this.g),this.i=0,this.l=this.d),0>a||0!==this.i&&a<this.i)return this;var b=a.toString();if(this.g.hasOwnProperty(b))return this.g[b];var c,d,e=[],f=this.a,g=!1;for(c=0,d=f.length;d>c;++c){var h=f[c],i=h.ha(a);e.push(i),i!==h&&(g=!0)}return g?(a=new cm(null),fm(a),a.a=e,dm(a),a.k(),this.g[b]=a):(this.i=a,this)},l.G=ca("GeometryCollection"),l.ja=function(){return 0==this.a.length},l.ze=function(a){a=em(a),fm(this),this.a=a,dm(this),this.k()},l.transform=function(a){var b,c,d=this.a;for(b=0,c=d.length;c>b;++b)d[b].transform(a);this.k()},l.F=function(){fm(this),cm.I.F.call(this)},v(jm,Ug),l=jm.prototype,l.Re=function(a){null===this.j?this.j=a.slice():ig(this.j,a),this.k()},l.Q=function(){var a=new jm(null);return km(a,this.b,this.j.slice()),a},l.ta=function(a,b,c,d){return d<zg(this.u(),a,b)?d:(this.t!=this.d&&(this.n=Math.sqrt(ch(this.j,0,this.j.length,this.a,0)),this.t=this.d),eh(this.j,0,this.j.length,this.a,this.n,!1,a,b,c,d))},l.Kg=function(a,b){return"XYM"!=this.b&&"XYZM"!=this.b?null:hm(this.j,0,this.j.length,this.a,a,s(b)?b:!1)},l.D=function(){return jh(this.j,0,this.j.length,this.a)},l.Lg=function(){var a,b=this.j,c=this.a,d=b[0],e=b[1],f=0;for(a=0+c;a<this.j.length;a+=c)var g=b[a],h=b[a+1],f=f+Math.sqrt((g-d)*(g-d)+(h-e)*(h-e)),d=g,e=h;return f},l.Hb=function(a){var b=[];return b.length=lh(this.j,0,this.j.length,this.a,a,b,0),a=new jm(null),km(a,"XY",b),a},l.G=ca("LineString"),l.P=function(a,b){null===a?km(this,"XY",null):(Xg(this,b,a,1),null===this.j&&(this.j=[]),this.j.length=hh(this.j,0,a,this.a),this.k())},v(lm,Ug),l=lm.prototype,l.Se=function(a){null===this.j?this.j=a.j.slice():ig(this.j,a.j.slice()),this.c.push(this.j.length),this.k()},l.Q=function(){var a=new lm(null);return mm(a,this.b,this.j.slice(),this.c.slice()),a},l.ta=function(a,b,c,d){return d<zg(this.u(),a,b)?d:(this.h!=this.d&&(this.t=Math.sqrt(dh(this.j,0,this.c,this.a,0)),this.h=this.d),fh(this.j,0,this.c,this.a,this.t,!1,a,b,c,d))},l.Ng=function(a,b,c){return"XYM"!=this.b&&"XYZM"!=this.b||0===this.j.length?null:im(this.j,this.c,this.a,a,s(b)?b:!1,s(c)?c:!1)},l.D=function(){return kh(this.j,0,this.c,this.a)},l.pf=function(a){if(0>a||this.c.length<=a)return null;var b=new jm(null);return km(b,this.b,this.j.slice(0===a?0:this.c[a-1],this.c[a])),b},l.ld=function(){var a,b,c=this.j,d=this.c,e=this.b,f=[],g=0;for(a=0,b=d.length;b>a;++a){var h=d[a],i=new jm(null);km(i,e,c.slice(g,h)),f.push(i),g=h}return f},l.Hb=function(a){var b,c,d=[],e=[],f=this.j,g=this.c,h=this.a,i=0,j=0;for(b=0,c=g.length;c>b;++b){var k=g[b],j=lh(f,i,k,h,a,d,j);e.push(j),i=k}return d.length=j,a=new lm(null),mm(a,"XY",d,e),a},l.G=ca("MultiLineString"),l.P=function(a,b){if(null===a)mm(this,"XY",null,this.c);else{Xg(this,b,a,2),null===this.j&&(this.j=[]);var c=ih(this.j,0,a,this.a,this.c);this.j.length=0===c.length?0:c[c.length-1],this.k()}},v(om,Ug),l=om.prototype,l.Ue=function(a){null===this.j?this.j=a.j.slice():ig(this.j,a.j),this.k()},l.Q=function(){var a=new om(null),b=this.j.slice();return Wg(a,this.b,b),a.k(),a},l.ta=function(a,b,c,d){if(d<zg(this.u(),a,b))return d;var e,f,g,h=this.j,i=this.a;for(e=0,f=h.length;f>e;e+=i)if(g=ah(a,b,h[e],h[e+1]),d>g){for(d=g,g=0;i>g;++g)c[g]=h[e+g];c.length=i}return d},l.D=function(){return jh(this.j,0,this.j.length,this.a)},l.tf=function(a){var b=null===this.j?0:this.j.length/this.a;return 0>a||a>=b?null:(b=new ph(null),qh(b,this.b,this.j.slice(a*this.a,(a+1)*this.a)),b)},l.Vd=function(){var a,b,c=this.j,d=this.b,e=this.a,f=[];for(a=0,b=c.length;b>a;a+=e){var g=new ph(null);qh(g,d,c.slice(a,a+e)),f.push(g)}return f},l.G=ca("MultiPoint"),l.P=function(a,b){null===a?Wg(this,"XY",null):(Xg(this,b,a,1),null===this.j&&(this.j=[]),this.j.length=hh(this.j,0,a,this.a)),this.k()},v(pm,Ug),l=pm.prototype,l.Ve=function(a){if(null===this.j)this.j=a.j.slice(),a=a.c.slice(),this.c.push();else{var b=this.j.length;ig(this.j,a.j),a=a.c.slice();var c,d;for(c=0,d=a.length;d>c;++c)a[c]+=b}this.c.push(a),this.k()},l.Q=function(){var a=new pm(null);return qm(a,this.b,this.j.slice(),this.c.slice()),a},l.ta=function(a,b,c,d){if(d<zg(this.u(),a,b))return d;if(this.o!=this.d){var e,f,g=this.c,h=0,i=0;for(e=0,f=g.length;f>e;++e)var j=g[e],i=dh(this.j,h,j,this.a,i),h=j[j.length-1];this.w=Math.sqrt(i),this.o=this.d}g=Sl(this),h=this.c,i=this.a,e=this.w,f=0;var k,l,j=s(void 0)?void 0:[0/0,0/0];for(k=0,l=h.length;l>k;++k){var m=h[k];d=fh(g,f,m,i,e,!0,a,b,c,d,j),f=m[m.length-1]}return d},l.rb=function(a,b){var c;a:{c=Sl(this);var d=this.c,e=0;if(0!==d.length){var f,g;for(f=0,g=d.length;g>f;++f){var h=d[f];if(sh(c,e,h,this.a,a,b)){c=!0;break a}e=h[h.length-1]}}c=!1}return c},l.Og=function(){var a,b,c=Sl(this),d=this.c,e=0,f=0;for(a=0,b=d.length;b>a;++a)var g=d[a],f=f+$g(c,e,g,this.a),e=g[g.length-1];return f},l.D=function(){var a,b,c=this.j,d=this.c,e=this.a,f=0,g=s(void 0)?void 0:[],h=0;for(a=0,b=d.length;b>a;++a){var i=d[a];g[h++]=kh(c,f,i,e,g[h]),f=i[i.length-1]}return g.length=h,g},l.mf=function(){var a=new om(null),b=ul(this).slice();return Wg(a,"XY",b),a.k(),a},l.Hb=function(a){var b=[],c=[],d=this.j,e=this.c,f=this.a;a=Math.sqrt(a);var g,h,i=0,j=0;for(g=0,h=e.length;h>g;++g){var k=e[g],l=[],j=mh(d,i,k,f,a,b,j,l);c.push(l),i=k[k.length-1]}return b.length=j,d=new pm(null),qm(d,"XY",b,c),d},l.uf=function(a){if(0>a||this.c.length<=a)return null;var b;0===a?b=0:(b=this.c[a-1],b=b[b.length-1]),a=this.c[a].slice();var c=a[a.length-1];if(0!==b){var d,e;for(d=0,e=a.length;e>d;++d)a[d]-=b}return d=new G(null),xh(d,this.b,this.j.slice(b,c),a),d},l.Wd=function(){var a,b,c,d,e=this.b,f=this.j,g=this.c,h=[],i=0;for(a=0,b=g.length;b>a;++a){var j=g[a].slice(),k=j[j.length-1];if(0!==i)for(c=0,d=j.length;d>c;++c)j[c]-=i;c=new G(null),xh(c,e,f.slice(i,k),j),h.push(c),i=k}return h},l.G=ca("MultiPolygon"),l.P=function(a,b){if(null===a)qm(this,"XY",null,this.c);else{Xg(this,b,a,3),null===this.j&&(this.j=[]);var c,d,e=this.j,f=this.a,g=this.c,h=0,g=s(g)?g:[],i=0;for(c=0,d=a.length;d>c;++c)h=ih(e,h,a[c],f,g[i]),g[i++]=h,h=h[h.length-1];g.length=i,e=g[g.length-1],this.j.length=0===e.length?0:e[e.length-1],this.k()}};var vm={Point:function(a,b,c,d){var e=c.e;if(null!==e){var f=Zl(a,c.a,"Image");f.Tb(e),f.ic(b,d)}e=c.d,null!==e&&(a=Zl(a,c.a,"Text"),a.pa(e),a.eb(b.D(),0,2,2,b,d))},LineString:function(a,b,c,d){var e=c.b;if(null!==e){var f=Zl(a,c.a,"LineString");f.Ea(null,e),f.ec(b,d)}e=c.d,null!==e&&(a=Zl(a,c.a,"Text"),a.pa(e),a.eb(sl(b),0,2,2,b,d))},Polygon:function(a,b,c,d){var e=c.c,f=c.b;if(null!==e||null!==f){var g=Zl(a,c.a,"Polygon");g.Ea(e,f),g.Gb(b,d)}e=c.d,null!==e&&(a=Zl(a,c.a,"Text"),a.pa(e),a.eb(zh(b),0,2,2,b,d))},MultiPoint:function(a,b,c,d){var e=c.e;if(null!==e){var f=Zl(a,c.a,"Image");f.Tb(e),f.gc(b,d)}e=c.d,null!==e&&(a=Zl(a,c.a,"Text"),a.pa(e),c=b.j,a.eb(c,0,c.length,b.a,b,d))},MultiLineString:function(a,b,c,d){var e=c.b;if(null!==e){var f=Zl(a,c.a,"LineString");f.Ea(null,e),f.fc(b,d)}e=c.d,null!==e&&(a=Zl(a,c.a,"Text"),a.pa(e),c=tl(b),a.eb(c,0,c.length,2,b,d))},MultiPolygon:function(a,b,c,d){var e=c.c,f=c.b;if(null!==f||null!==e){var g=Zl(a,c.a,"Polygon");g.Ea(e,f),g.hc(b,d)}e=c.d,null!==e&&(a=Zl(a,c.a,"Text"),a.pa(e),c=ul(b),a.eb(c,0,c.length,2,b,d))},GeometryCollection:function(a,b,c,d){b=b.a;var e,f;for(e=0,f=b.length;f>e;++e)vm[b[e].G()](a,b[e],c,d)},Circle:function(a,b,c,d){var e=c.c,f=c.b;if(null!==e||null!==f){var g=Zl(a,c.a,"Polygon");g.Ea(e,f),g.dc(b,d)}e=c.d,null!==e&&(a=Zl(a,c.a,"Text"),a.pa(e),a.eb(b.ud(),0,2,2,b,d))}};wm.prototype.remove=function(a,b,c){var d,e,f=this.a,g=f.length;if(1==this.height){for(e=0;g>e;++e)if(d=f[e],d.value===b)return Ma.splice.call(f,e,1),!0}else for(e=0;g>e;++e)if(d=f[e],Ag(d.extent,a)){if(c.push(d),d.remove(a,b,c))return!0;c.pop()}return!1},l=Bm.prototype,l.clear=function(){var a=this.a;a.extent=Bg(this.a.extent),a.height=1,a.a.length=0,a.value=null,gc(this.d)},l.forEach=function(a,b){return Dm(this.a,a,b)},l.u=function(a){return Og(this.a.extent,a)},l.ja=function(){return 0===this.a.a.length},l.remove=function(a){var b=sa(a).toString(),c=this.d[b];return delete this.d[b],Km(this,c,a)},l.update=function(a,b){var c=sa(b).toString(),d=this.d[c];Cg(d,a)||(Km(this,d,b),Jm(this,a,b,this.a.height-1),this.d[c]=yg(a,d))},v(Lm,vk),l=Lm.prototype,l.Aa=function(a){Mm(this,a),this.k()},l.Ga=function(a){this.sa(a),this.k()},l.sa=function(a){var b,c;for(b=0,c=a.length;c>b;++b)Mm(this,a[b])},l.clear=function(){this.b.forEach(this.Bd,this),this.b.clear(),$b(this.c,this.Bd,this),gc(this.c),this.k()},l.Ia=function(a,b){return this.b.forEach(a,b)},l.la=function(a,b,c){return Fm(this.b,a,b,c)},l.Dc=function(a,b,c,d){return this.la(a,c,d)},l.Ba=function(){var a=Gm(this.b);return ec(this.c)||Ya(a,cc(this.c)),a
},l.wa=function(a){var b=[];return Om(this,a,function(a){b.push(a)}),b},l.Ja=function(a){var b=a[0],c=a[1],d=null,e=[0/0,0/0],f=1/0,g=[-1/0,-1/0,1/0,1/0];return Fm(this.b,g,function(a){var h=a.M(),i=f;f=h.ta(b,c,e,f),i>f&&(d=a,a=Math.sqrt(f),g[0]=b-a,g[1]=c-a,g[2]=b+a,g[3]=c+a)},void 0),d},l.u=function(){return this.b.u()},l.me=function(a){a=a.target;var b=sa(a).toString(),c=a.M();null===c?b in this.c||(this.b.remove(a),this.c[b]=a):(c=c.u(),b in this.c?(delete this.c[b],Im(this.b,c,a)):this.b.update(c,a)),this.k()},l.ja=function(){return this.b.ja()&&ec(this.c)},l.rd=fa,l.Oa=function(a){var b=sa(a).toString();b in this.c?delete this.c[b]:this.b.remove(a),this.Bd(a),this.k()},l.Bd=function(a){var b=sa(a).toString();Oa(this.t[b],re),delete this.t[b],A(this,new Nm("removefeature",a))},v(Nm,Qd),v(Pm,wl),Pm.prototype.n=function(a,b,c){var d=yl(this,a);xl(this,"precompose",c,a,d);var e=this.d;if(null!==e&&!e.ja()){var f;ue(this.a.ga,"render")?(this.g.canvas.width=c.canvas.width,this.g.canvas.height=c.canvas.height,f=this.g):f=c,f.globalAlpha=b.opacity,Vl(e,f,a.extent,a.pixelRatio,d,a.view2DState.rotation,a.skippedFeatureUids_),f!=c&&(xl(this,"render",f,a,d),c.drawImage(f.canvas,0,0))}xl(this,"postcompose",c,a,d)},Pm.prototype.f=function(a,b,c,d){if(null!==this.d){var e=this.a;return Xl(this.d,b.extent,b.view2DState.resolution,b.view2DState.rotation,a,b.skippedFeatureUids_,function(a,b){return c.call(d,b,e)})}},Pm.prototype.B=function(){Rk(this)},Pm.prototype.c=function(a){var b=this.a,c=b.a;if(Tk(a.attributions,c.f),Uk(a,c),this.b||!a.viewHints[0]&&!a.viewHints[1]){var d=a.extent,e=a.view2DState,f=e.projection,g=e.resolution,h=a.pixelRatio;if(a=b.d,e=b.get("renderOrder"),s(e)||(e=sm),this.b||this.i!=g||this.h!=a||this.A!=e||!Ag(this.w,d)){var i=this.w,j=Lg(d)/4,k=Jg(d)/4;i[0]=d[0]-j,i[1]=d[1]-k,i[2]=d[2]+j,i[3]=d[3]+k,Pd(this.d),this.d=null,this.b=!1;var l=b.ra;s(l)||(l=Qi);var m=new Ul(g/(2*h),i,g);if(c.rd(i,g,f),b=function(a){var b=l(a,g);if(null!=b){var c,d,e=g*g/(4*h*h),f=!1;for(c=0,d=b.length;d>c;++c)f=tm(m,a,b[c],e,a,this.B,this)||f;a=f}else a=!1;this.b=this.b||a},null===e)c.Dc(i,g,b,this);else{var n=[];c.Dc(i,g,function(a){n.push(a)},this),bb(n,e),Oa(n,b,this)}Yl(m),this.i=g,this.h=a,this.A=e,this.d=m}}},v(Qm,el),Qm.prototype.zc=function(a){return a instanceof N?new Cl(this,a):a instanceof O?new Dl(this,a):a instanceof P?new Pm(this,a):null},Qm.prototype.Vc=function(a){if(null===a)this.d&&(Vc(this.a,!1),this.d=!1);else{var b=this.g,c=a.size[0]*a.pixelRatio,d=a.size[1]*a.pixelRatio;this.a.width!=c||this.a.height!=d?(this.a.width=c,this.a.height=d):b.clearRect(0,0,this.a.width,this.a.height),fl(a),Rm(this,"precompose",a);var e,f,g,h,c=a.layerStatesArray,d=a.view2DState.resolution;for(e=0,f=c.length;f>e;++e)h=c[e],g=h.layer,g=gl(this,g),!h.visible||1!=h.Sa||d>=h.maxResolution||d<h.minResolution||(g.c(a,h),g.n(a,h,b));Rm(this,"postcompose",a),this.d||(Vc(this.a,!0),this.d=!0),il(this,a),hl(a)}},v(Sm,Qk),v(Tm,Sm),Tm.prototype.f=function(a,b,c,d){var e=this.a;return e.a.Tc(b.extent,b.view2DState.resolution,b.view2DState.rotation,a,function(a){return c.call(d,a,e)})},Tm.prototype.c=function(a){var b=a.view2DState,c=b.center,d=b.resolution,e=b.rotation,f=this.d,g=this.a.a,h=a.viewHints;if(h[0]||h[1]||(b=g.Nb(a.extent,d,a.pixelRatio,b.projection),null!==b&&(h=b.state,0==h?(oe(b,"change",this.t,!1,this),Gk(b)):2==h&&(f=b))),null!==f){var h=f.u(),i=f.c,b=id();bl(b,a.size[0]/2,a.size[1]/2,i/d,i/d,e,(h[0]-c[0])/i,(c[1]-h[3])/i),f!=this.d&&(c=f.e(this),c.style.maxWidth="none",c.style.position="absolute",yc(this.target),this.target.appendChild(c),this.d=f),cl(b,this.b)||(wd(this.target,b),ld(this.b,b)),Tk(a.attributions,f.g),Uk(a,g)}},v(Um,Sm),Um.prototype.c=function(a,b){if(b.visible){var c,d=a.pixelRatio,e=a.view2DState,f=e.projection,g=this.a,h=g.a,i=Pk(h,f),j=h.Fc(),k=jg(i.a,e.resolution,0),l=i.ca(k),m=e.center;l==e.resolution?(m=Xk(m,l,a.size),c=Hg(m,l,e.rotation,a.size)):c=a.extent;var l=Lk(i,c,l),n={};n[k]={};var o=xa(h.hd,h,n,Wk(function(a){return null!==a&&2==a.state},h,d,f)),p=g.fa();s(p)||(p=!0);var q,r,t,u,v=ug(),w=new kb(0,0,0,0);for(t=l.a;t<=l.c;++t)for(u=l.b;u<=l.d;++u)q=h.Ib(k,t,u,d,f),r=q.state,2==r?n[k][q.a.toString()]=q:4==r||3==r&&!p||(r=i.Ec(q.a,o,null,w,v),r||(q=i.Ic(q.a,w,v),null===q||o(k+1,q)));var x;if(this.g!=h.d){for(x in this.d)p=this.d[+x],Bc(p.target);this.d={},this.g=h.d}v=Pa(dc(n),Number),bb(v);var y,o={};for(t=0,u=v.length;u>t;++t){x=v[t],x in this.d?p=this.d[x]:(p=Mk(i,m[0],m[1],i.ca(x),!1,void 0),p=new Vm(i,p),o[x]=!0,this.d[x]=p),x=n[x];for(y in x)Wm(p,x[y],j);Xm(p)}for(j=Pa(dc(this.d),Number),bb(j),t=id(),y=0,v=j.length;v>y;++y)if(x=j[y],p=this.d[x],x in n)if(q=p.g,u=p.f,bl(t,a.size[0]/2,a.size[1]/2,q/e.resolution,q/e.resolution,e.rotation,(u[0]-m[0])/q,(m[1]-u[1])/q),Ym(p,t),x in o){for(x-=1;x>=0;--x)if(x in this.d){zc(p.target,this.d[x].target);break}0>x&&Ac(this.target,p.target,0)}else a.viewHints[0]||a.viewHints[1]||Zm(p,c,w);else Bc(p.target),delete this.d[x];b.opacity!=this.i&&(Uc(this.target,b.opacity),this.i=b.opacity),b.visible&&!this.b&&(Vc(this.target,!0),this.b=!0),Vk(a.usedTiles,h,k,l),Yk(a,h,i,d,f,c,k,g.ea()),Sk(a,h),Uk(a,h)}else this.b&&(Vc(this.target,!1),this.b=!1)},v($m,el),$m.prototype.zc=function(a){if(a instanceof N)a=new Tm(this,a);else{if(!(a instanceof O))return null;a=new Um(this,a)}return a},$m.prototype.Vc=function(a){if(null===a)this.d&&(Vc(this.a,!1),this.d=!1);else{var b;b=function(a,b){Ac(this.a,a,b)};var c,d,e,f,g=a.layerStatesArray;for(c=0,d=g.length;d>c;++c)f=g[c],e=f.layer,e=gl(this,e),b.call(this,e.target,c),1==f.Sa&&e.c(a,f);b=a.layerStates;for(var h in this.b)h in b||(e=this.b[h],Bc(e.target));this.d||(Vc(this.a,!0),this.d=!0),fl(a),il(this,a),hl(a)}},l=an.prototype,l.Bc=ba(),l.dc=ba(),l.gd=ba(),l.Od=ba(),l.ic=ba(),l.ec=ba(),l.fc=ba(),l.gc=ba(),l.hc=ba(),l.Gb=ba(),l.eb=ba(),l.Ea=ba(),l.Tb=ba(),l.pa=ba(),v(en,dn),en.prototype.G=ca(35632),v(fn,dn),fn.prototype.G=ca(35633),v(gn,en),ga(gn),v(hn,fn),ga(hn),v(kn,en),ga(kn),v(ln,fn),ga(ln),nn.prototype.clear=function(){this.a.length=0},nn.prototype.ja=function(){return 0===this.a.length},sn.prototype.add=function(a){var b,c=a.length;a:{b=this.b.a;var d,e,f,g=b.length,h=-1;for(e=0;g>e;e+=2){if(f=b[e+1]-b[e],f==c){b=b[e];break a}f>c&&(-1==h||d>f)&&(h=b[e],d=f)}b=h}for(rn(this.b,b,b+c),g=0;c>g;++g)this.d[b+g]=a[g];for(a=0,g=this.a.length;g>a;++a)on(this.a[a],b,b+c);return b},sn.prototype.Ka=function(){var a,b=this.b.a,c=b.length,d=0;for(a=0;c>a;a+=2)d+=b[a+1]-b[a];return this.d.length-d},sn.prototype.remove=function(a,b){var c,d;for(on(this.b,b,b+a),c=0,d=this.a.length;d>c;++c)rn(this.a[c],b,b+a)},v(tn,Qk),tn.prototype.n=function(){this.g=this.qa=null,this.i=void 0},v(wn,tn),wn.prototype.f=function(a,b,c,d){var e=this.a;return e.a.Tc(b.extent,b.view2DState.resolution,b.view2DState.rotation,a,function(a){return c.call(d,a,e)})},wn.prototype.c=function(a){var b=this.e.c,c=a.view2DState,d=c.center,e=c.resolution,f=c.rotation,g=this.d,h=this.qa,i=this.a.a,j=a.viewHints;j[0]||j[1]||(c=i.Nb(a.extent,e,a.pixelRatio,c.projection),null!==c&&(j=c.state,0==j?(oe(c,"change",this.t,!1,this),Gk(c)):2==j&&(g=c,h=xn(this,c),null===this.qa||a.postRenderFunctions.push(za(function(a,b){a.isContextLost()||a.deleteTexture(b)},b,this.qa))))),null!==g&&(b=this.e.e.f,yn(this,b.width,b.height,d,e,f,g.u()),d=this.A,md(d),pd(d,1,-1),od(d,0,-1),this.d=g,this.qa=h,Tk(a.attributions,g.g),Uk(a,i))},v(zn,en),ga(zn),v(An,fn),ga(An),v(Cn,tn),Cn.prototype.F=function(){var a=this.e.e,b=a.d,c=sa(this.C),d=a.a[c];Ua(d.Jd.a,d.Ac),b.isContextLost()||b.deleteBuffer(d.buffer),delete a.a[c],Cn.I.F.call(this)},Cn.prototype.n=function(){Cn.I.n.call(this),this.d=null},Cn.prototype.c=function(a){var b,c=this.e,d=c.e,e=c.c,f=a.view2DState,g=f.projection,h=this.a,i=h.a,j=Pk(i,g),k=jg(j.a,f.resolution,0),l=j.ca(k),m=i.kc(k,a.pixelRatio,g),n=m/j.ia(k),o=l/n,p=i.Fc(),q=f.center;if(l==f.resolution?(q=Xk(q,l,a.size),b=Hg(q,l,f.rotation,a.size)):b=a.extent,l=Lk(j,b,l),null!==this.b&&this.b.a==l.a&&this.b.b==l.b&&this.b.c==l.c&&this.b.d==l.d&&this.o==i.d)o=this.w;else{var r=[l.c-l.a+1,l.d-l.b+1],r=Math.max(r[0]*m,r[1]*m),t=Math.pow(2,Math.ceil(Math.log(r)/Math.LN2)),r=o*t,u=j.lb(k),v=u[0]+l.a*m*o,o=u[1]+l.b*m*o,o=[v,o,v+r,o+r];un(this,a,t),e.viewport(0,0,t,t),e.clearColor(0,0,0,0),e.clear(16384),e.disable(3042),t=Dn(d,this.V,this.ba),d.wd(t),null===this.d&&(this.d=new Bn(e,t)),En(d,this.C),e.enableVertexAttribArray(this.d.a),e.vertexAttribPointer(this.d.a,2,5126,!1,16,0),e.enableVertexAttribArray(this.d.d),e.vertexAttribPointer(this.d.d,2,5126,!1,16,8),e.uniform1i(this.d.b,0),d={},d[k]={};var w=xa(i.hd,i,d,Wk(function(a){return null!==a&&2==a.state&&Fn(c.d,a.c())},i,n,g)),x=h.fa();s(x)||(x=!0);var y,z,A,t=!0,v=ug(),B=new kb(0,0,0,0);for(z=l.a;z<=l.c;++z)for(A=l.b;A<=l.d;++A){if(u=i.Ib(k,z,A,n,g),y=u.state,2==y){if(Fn(c.d,u.c())){d[k][u.a.toString()]=u;continue}}else if(4==y||3==y&&!x)continue;t=!1,y=j.Ec(u.a,w,null,B,v),y||(u=j.Ic(u.a,B,v),null===u||w(k+1,u))}w=Pa(dc(d),Number),bb(w);var C,D,E,F,x=new Float32Array(4),B=0;for(z=w.length;z>B;++B)for(D in E=d[w[B]])u=E[D],C=Jk(j,u.a,v),A=2*(C[2]-C[0])/r,y=2*(C[3]-C[1])/r,F=2*(C[0]-o[0])/r-1,C=2*(C[1]-o[1])/r-1,hd(x,A,y,F,C),e.uniform4fv(this.d.c,x),Gn(c,u,m,p*n),e.drawArrays(5,0,4);t?(this.b=l,this.w=o,this.o=i.d):(this.w=this.b=null,this.o=-1,a.animate=!0)}Vk(a.usedTiles,i,k,l);var G=c.i;Yk(a,i,j,n,g,b,k,h.ea(),function(a){var b;(b=2!=a.state)||(b=Fn(c.d,a.c()))||(b=a.c()in G.b),b||Zj(G,[a,Nk(j,a.a),j.ca(a.a.a),m,p*n])},this),Sk(a,i),Uk(a,i),e=this.A,md(e),od(e,(q[0]-o[0])/(o[2]-o[0]),(q[1]-o[1])/(o[3]-o[1])),0!==f.rotation&&qd(e,f.rotation),pd(e,a.size[0]*f.resolution/(o[2]-o[0]),a.size[1]*f.resolution/(o[3]-o[1])),od(e,-.5,-.5)},l=Hn.prototype,l.clear=function(){this.L=0,this.b={},this.d=this.a=null},l.forEach=function(a,b){for(var c=this.a;null!==c;)a.call(b,c.Cb,c.Pc,this),c=c.xa},l.get=function(a){return a=this.b[a],a===this.d?a.Cb:(a===this.a?(this.a=this.a.xa,this.a.mb=null):(a.xa.mb=a.mb,a.mb.xa=a.xa),a.xa=null,a.mb=this.d,this.d=this.d.xa=a,a.Cb)},l.Ka=k("L"),l.K=function(){var a,b=Array(this.L),c=0;for(a=this.d;null!==a;a=a.mb)b[c++]=a.Pc;return b},l.La=function(){var a,b=Array(this.L),c=0;for(a=this.d;null!==a;a=a.mb)b[c++]=a.Cb;return b},l.pop=function(){var a=this.a;return delete this.b[a.Pc],null!==a.xa&&(a.xa.mb=null),this.a=a.xa,null===this.a&&(this.d=null),--this.L,a.Cb},l=Jn.prototype,l.F=function(){$b(this.a,function(a){Ua(a.Jd.a,a.Ac)});var a=this.d;a.isContextLost()||($b(this.a,function(b){a.deleteBuffer(b.buffer)}),$b(this.b,function(b){a.deleteProgram(b)}),$b(this.c,function(b){a.deleteShader(b)}))},l.xh=k("d"),l.yh=function(){gc(this.a),gc(this.c),gc(this.b),this.e=null},l.zh=ba(),l.wd=function(a){return a==this.e?!1:(this.d.useProgram(a),this.e=a,!0)},v(Ln,el),l=Ln.prototype,l.zc=function(a){return a instanceof N?new wn(this,a):a instanceof O?new Cn(this,a):null},l.F=function(){var a=this.c;a.isContextLost()||this.d.forEach(function(b){null===b||a.deleteTexture(b.qa)}),Pd(this.e),Ln.I.F.call(this)},l.af=function(a,b){for(var c,d=this.c;1024<this.d.Ka()-this.g;){if(c=this.d.a.Cb,null===c){if(+this.d.a.Pc==b.index)break;--this.g}else d.deleteTexture(c.qa);this.d.pop()}},l.Sg=function(a){a.preventDefault(),this.d.clear(),this.g=0,$b(this.b,function(a){a.n()})},l.Tg=function(){Mn(this),this.f.R()},l.Vc=function(a){var b=this.e,c=this.c;if(c.isContextLost())return!1;if(null===a)return this.h&&(Vc(this.a,!1),this.h=!1),!1;this.l=a.focus,In(this.d,(-a.index).toString(),null),++this.g;var d,e,f,g=[],h=a.layerStatesArray,i=a.view2DState.resolution;for(d=0,e=h.length;e>d;++d)f=h[d],f.visible&&1==f.Sa&&i<f.maxResolution&&i>=f.minResolution&&g.push(f);for(d=0,e=g.length;e>d;++d)f=g[d],h=gl(this,f.layer),h.c(a,f);for(d=a.size[0]*a.pixelRatio,e=a.size[1]*a.pixelRatio,(this.a.width!=d||this.a.height!=e)&&(this.a.width=d,this.a.height=e),c.bindFramebuffer(36160,null),c.clearColor(0,0,0,0),c.clear(16384),c.enable(3042),c.viewport(0,0,this.a.width,this.a.height),Nn(this,"precompose",a),d=0,e=g.length;e>d;++d){f=g[d],c=h=gl(this,f.layer),h=a,i=b,vn(c,"precompose",i,h),En(i,c.O);var j=i.d,k=f.brightness||1!=f.contrast||f.hue||1!=f.saturation,l=void 0,m=void 0;k?(l=gn.gb(),m=hn.gb()):(l=kn.gb(),m=ln.gb()),l=Dn(i,l,m),m=void 0,k?null===c.h?(m=new jn(j,l),c.h=m):m=c.h:null===c.l?(m=new mn(j,l),c.l=m):m=c.l,i.wd(l)&&(j.enableVertexAttribArray(m.a),j.vertexAttribPointer(m.a,2,5126,!1,16,0),j.enableVertexAttribArray(m.d),j.vertexAttribPointer(m.d,2,5126,!1,16,8),j.uniform1i(m.b,0)),j.uniformMatrix4fv(m.f,!1,c.A),j.uniformMatrix4fv(m.e,!1,c.B),k&&j.uniformMatrix4fv(m.g,!1,cn(c.da,f.brightness,f.contrast,f.hue,f.saturation)),j.uniform1f(m.c,f.opacity),j.bindTexture(3553,c.qa),j.drawArrays(5,0,4),vn(c,"postcompose",i,h)}this.h||(Vc(this.a,!0),this.h=!0),fl(a),1024<this.d.Ka()-this.g&&a.postRenderFunctions.push(xa(this.af,this)),this.i.ja()||(a.postRenderFunctions.push(this.o),a.animate=!0),Nn(this,"postcompose",a),il(this,a),hl(a)};var On=["canvas","webgl","dom"];v(Q,Me),l=Q.prototype,l.Ne=function(a){this.i.push(a)},l.Oe=function(a){this.g.push(a)},l.Pe=function(a){this.ib().Mb().push(a)},l.Qe=function(a){this.h.push(a)},l.Ha=function(){this.R(),Array.prototype.push.apply(this.A,arguments)},l.F=function(){Bc(this.b),Q.I.F.call(this)},l.td=function(a,b,c,d,e){if(null!==this.c){a=this.va(a);a:{var f=this.ba,g=this.c;c=s(c)?c:null,d=s(d)?d:Ae,e=s(e)?e:null;var h,i=f.f.ib().Gc();for(h=i.length-1;h>=0;--h){var j=i[h],k=j.layer;if(j.visible&&d.call(e,k)&&(j=gl(f,k).f(a,g,b,c))){b=j;break a}}b=void 0}return b}},l.Td=function(a){return this.va(this.kd(a))},l.kd=function(a){if(s(a.changedTouches)){a=a.changedTouches.item(0);var b=Qc(this.b);return[a.clientX-b.x,a.clientY-b.y]}return a=Pc(a,this.b),[a.x,a.y]},l.oc=function(){return this.get("target")},Q.prototype.getTarget=Q.prototype.oc,l=Q.prototype,l.va=function(a){var b=this.c;return null===b?null:(a=a.slice(),dl(b.pixelToCoordinateMatrix,a,a))},l.ef=k("i"),l.sf=k("h"),l.kf=k("g"),l.ib=function(){return this.get("layergroup")},Q.prototype.getLayerGroup=Q.prototype.ib,Q.prototype.Ke=function(){var a=this.ib();return s(a)?a.Mb():void 0},Q.prototype.f=function(a){var b=this.c;return null===b?null:(a=a.slice(0,2),dl(b.coordinateToPixelMatrix,a,a))},Q.prototype.e=function(){return this.get("size")},Q.prototype.getSize=Q.prototype.e,Q.prototype.a=function(){return this.get("view")},Q.prototype.getView=Q.prototype.a,l=Q.prototype,l.zf=k("b"),l.xf=function(a,b,c,d){var e=this.c;return null!==e&&b in e.wantedTiles&&e.wantedTiles[b][a.a.toString()]?(a=c[0]-e.focus[0],c=c[1]-e.focus[1],65536*Math.log(d)+Math.sqrt(a*a+c*c)/d):1/0},l.Xd=function(a,b){var c=new Nf(b||a.type,this,a);this.he(c)},l.he=function(a){if(null!==this.c){this.V=a.coordinate,a.b=this.c;var b,c=this.g.a;if(!1!==A(this,a))for(b=c.length-1;b>=0&&c[b].za(a);b--);}},l.Wf=function(){var a=this.c,b=this.Ub;if(!b.ja()){var c=16,d=c,e=0;if(null!==a){var e=a.viewHints,f=this.xc;e[0]&&(c=!1===f.loadTilesWhileAnimating?0:8,d=2),e[1]&&(c=!1===f.loadTilesWhileInteracting?0:8,d=2),e=bc(a.wantedTiles)}if(c*=e,d*=e,b.c<c){for(bk(b),c=Math.min(c-b.c,d,b.Ka()),d=0;c>d;++d)e=Xj(b)[0],oe(e,"change",b.g,!1,b),0==e.state&&(e.state=1,e.e=[oe(e.d,"error",e.l,!1,e),oe(e.d,"load",e.t,!1,e)],e.n(e,e.h));b.c+=c}}for(b=this.Ra,c=0,d=b.length;d>c;++c)b[c](this,a);b.length=0},l.Zf=function(){this.R()},l.$f=function(){var a=this.oc(),a=s(a)?pc(a):null;Rj(this.o),null===a?Bc(this.b):(a.appendChild(this.b),Lj(this.o,null===this.ea?a:this.ea)),this.C()},l.ag=function(){this.R()},l.cg=function(){this.R()},l.bg=function(){null!==this.O&&(re(this.O),this.O=null);var a=this.a();null!=a&&(this.O=z(a,"propertychange",this.cg,!1,this)),this.R()},l.Mf=function(){this.R()},l.Nf=function(){this.R()},l.Lf=function(){if(null!==this.l){for(var a=this.l.length,b=0;a>b;++b)re(this.l[b]);this.l=null}a=this.ib(),null!=a&&(this.l=[z(a,"propertychange",this.Nf,!1,this),z(a,"change",this.Mf,!1,this)]),this.R()},l.Xh=function(){var a=this.n;Bj(a),a.Nd()},l.R=function(){null!=this.n.Z||this.n.start()},l.Rh=function(a){return s(this.i.remove(a))?a:void 0},l.Th=function(a){var b;return s(this.g.remove(a))&&(b=a),b},l.Uh=function(a){return this.ib().Mb().remove(a)},l.Vh=function(a){return s(this.h.remove(a))?a:void 0},l.Wh=function(a){var b,c,d,e=this.e();b=this.a();var f=s(b)?this.a().Y():void 0,g=null;if(s(e)&&0<e[0]&&0<e[1]&&s(f)&&f.sd()){var g=Wa(b.h),h=this.ib().Gc(),i={};for(b=0,c=h.length;c>b;++b)i[sa(h[b].layer)]=h[b];d=fi(f),g={animate:!1,attributions:{},coordinateToPixelMatrix:this.wc,extent:null,focus:null===this.V?d.center:this.V,index:this.$c++,layerStates:i,layerStatesArray:h,logos:{},pixelRatio:this.bd,pixelToCoordinateMatrix:this.Le,postRenderFunctions:[],size:e,skippedFeatureUids_:this.skippedFeatureUids_,tileQueue:this.Ub,time:a,usedTiles:{},view2DState:d,viewHints:g,wantedTiles:{}},this.ad&&(g.logos["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC"]="http://ol3js.org/")}for(a=this.A,b=e=0,c=a.length;c>b;++b)f=a[b],f(this,g)&&(a[e++]=f);a.length=e,null!==g&&(g.extent=Hg(d.center,d.resolution,d.rotation,g.size)),this.c=g,this.ba.Vc(g),null!==g&&(g.animate&&this.R(),Array.prototype.push.apply(this.Ra,g.postRenderFunctions),0!==this.A.length||g.animate||g.viewHints[0]||g.viewHints[1]||A(this,new df("moveend",this))),A(this,new df("postrender",this,g)),b=d=this.Wf,this&&(b=xa(d,this)),qa(ea.setImmediate)?ea.setImmediate(b):(Ej||(Ej=Fj()),Ej(b))},l.Ae=function(a){this.v("layergroup",a)},Q.prototype.setLayerGroup=Q.prototype.Ae,Q.prototype.B=function(a){this.v("size",a)},Q.prototype.setSize=Q.prototype.B,Q.prototype.ra=function(a){this.v("target",a)},Q.prototype.setTarget=Q.prototype.ra,Q.prototype.Sa=function(a){this.v("view",a)},Q.prototype.setView=Q.prototype.Sa,Q.prototype.Ta=function(a){a=sa(a).toString(),this.skippedFeatureUids_[a]=!0,this.R()},Q.prototype.C=function(){var a=this.oc(),a=s(a)?pc(a):null;null===a?this.B(void 0):(a=Xc(a),this.B([a.width,a.height]))},Q.prototype.Vb=function(a){a=sa(a).toString(),delete this.skippedFeatureUids_[a],this.R()},Dk(),v(Qn,Qd),v(Rn,ri),Rn.prototype.setMap=function(a){null===a&&Wn(this),this.o.setMap(a),Rn.I.setMap.call(this,a)},Rn.prototype.za=function(a){var b;if(b=a.map,Ec(document,b.b)&&"none"!=b.b.style.display){var c=b.e();null==c||0>=c[0]||0>=c[1]?b=!1:(b=b.a(),b=s(b)&&b.sd()?!0:!1)}else b=!1;return b?(b=!0,a.type===Yf?b=Xn(this,a):a.type===Sf&&(b=!1),Rn.I.za.call(this,a)&&b):!0},Rn.prototype.$a=function(a){return this.w=a.pixel,!0},Rn.prototype.ab=function(a){var b=this.w,c=a.pixel,d=b[0]-c[0],b=b[1]-c[1],c=!0;if(d*d+b*b<=this.V){if(Xn(this,a),null===this.e)Yn(this,a);else if(this.a===Sn||Zn(this,a)){a=Wn(this);var e,d=a.M();this.a===Sn?e=d.D():this.a===Tn?(e=d.D(),e.pop(),d.P(e)):this.a===Un&&(this.c[0].pop(),this.c[0].push(this.c[0][0]),d.P(this.c),e=d.D()),"MultiPoint"===this.n?a.pb(new om([e])):"MultiLineString"===this.n?a.pb(new lm([e])):"MultiPolygon"===this.n&&a.pb(new pm([e])),null===this.A||this.A.push(a),null===this.B||this.B.Aa(a),A(this,new Qn("drawend",a))}else e=a.coordinate,a=this.f.M(),this.a===Tn?(this.e=e.slice(),d=a.D(),d.push(e.slice()),a.P(d)):this.a===Un&&(this.c[0].push(e.slice()),a.P(this.c)),$n(this);c=!1}return c};var Sn="Point",Tn="LineString",Un="Polygon",ao=new Ah(6378137);v(R,Me),l=R.prototype,l.F=function(){this.e(!1),R.I.F.call(this)},l.Fg=function(){var a=this.g();null!=a&&(this.c=Ih($h("EPSG:4326"),a),null===this.a||this.v("position",this.c(this.a)))},l.Gg=function(){if(Fd){var a=this.i();a&&!s(this.b)?this.b=ea.navigator.geolocation.watchPosition(xa(this.Mh,this),xa(this.Nh,this),this.f()):!a&&s(this.b)&&(ea.navigator.geolocation.clearWatch(this.b),this.b=void 0)}},l.Mh=function(a){a=a.coords,this.v("accuracy",a.accuracy),this.v("altitude",null===a.altitude?void 0:a.altitude),this.v("altitudeAccuracy",null===a.altitudeAccuracy?void 0:a.altitudeAccuracy),this.v("heading",null===a.heading?void 0:Xb(a.heading)),null===this.a?this.a=[a.longitude,a.latitude]:(this.a[0]=a.longitude,this.a[1]=a.latitude);var b=this.c(this.a);this.v("position",b),this.v("speed",null===a.speed?void 0:a.speed),a=ao.a(this.a,a.accuracy),a.transform(this.c),this.v("accuracyGeometry",a),this.k()},l.Nh=function(a){a.type="error",A(this,a)},l.Rd=function(){return this.get("accuracy")},R.prototype.getAccuracy=R.prototype.Rd,R.prototype.n=function(){return this.get("accuracyGeometry")||null},R.prototype.getAccuracyGeometry=R.prototype.n,R.prototype.o=function(){return this.get("altitude")},R.prototype.getAltitude=R.prototype.o,R.prototype.w=function(){return this.get("altitudeAccuracy")},R.prototype.getAltitudeAccuracy=R.prototype.w,R.prototype.B=function(){return this.get("heading")},R.prototype.getHeading=R.prototype.B,R.prototype.C=function(){return this.get("position")},R.prototype.getPosition=R.prototype.C,R.prototype.g=function(){return this.get("projection")},R.prototype.getProjection=R.prototype.g,R.prototype.A=function(){return this.get("speed")},R.prototype.getSpeed=R.prototype.A,R.prototype.i=function(){return this.get("tracking")},R.prototype.getTracking=R.prototype.i,R.prototype.f=function(){return this.get("trackingOptions")},R.prototype.getTrackingOptions=R.prototype.f,R.prototype.h=function(a){this.v("projection",a)},R.prototype.setProjection=R.prototype.h,R.prototype.e=function(a){this.v("tracking",a)},R.prototype.setTracking=R.prototype.e,R.prototype.l=function(a){this.v("trackingOptions",a)},R.prototype.setTrackingOptions=R.prototype.l,v(bo,Vj),bo.prototype.b=function(a){if(s(a)){var b=sa(a);return b in this.f?this.f[b]:(a=ec(this.f)?this.d:this.d.cloneNode(!1),this.f[b]=a)}return this.d},bo.prototype.c=k("h"),bo.prototype.l=function(){this.state=3,Oa(this.e,re),this.e=null,A(this,"change")},bo.prototype.t=function(){s(this.d.naturalWidth)||(this.d.naturalWidth=this.d.width,this.d.naturalHeight=this.d.height),this.state=this.d.naturalWidth&&this.d.naturalHeight?2:4,Oa(this.e,re),this.e=null,A(this,"change")},v(U,Me),U.prototype.g=function(){return this.get("element")},U.prototype.getElement=U.prototype.g,U.prototype.e=function(){return this.get("map")},U.prototype.getMap=U.prototype.e,U.prototype.i=function(){return this.get("position")},U.prototype.getPosition=U.prototype.i,U.prototype.f=function(){return this.get("positioning")},U.prototype.getPositioning=U.prototype.f,l=U.prototype,l.Ff=function(){yc(this.b);var a=this.g();null!=a&&xc(this.b,a)},l.Rf=function(){null!==this.c&&(Bc(this.b),re(this.c),this.c=null);var a=this.e();null!=a&&(this.c=z(a,"postrender",this.Ig,!1,this),co(this),a=this.A?a.w:a.fa,this.n?Ac(a,this.b,0):xc(a,this.b))},l.Ig=function(){co(this)},l.Uf=function(){co(this)},l.Vf=function(){co(this)},l.Cd=function(a){this.v("element",a)},U.prototype.setElement=U.prototype.Cd,U.prototype.setMap=function(a){this.v("map",a)},U.prototype.setMap=U.prototype.setMap,U.prototype.h=function(a){this.v("position",a)},U.prototype.setPosition=U.prototype.h,U.prototype.l=function(a){this.v("positioning",a)},U.prototype.setPositioning=U.prototype.l;var eo=Bb?"webkitfullscreenchange":Ab?"mozfullscreenchange":zb?"MSFullscreenChange":"fullscreenchange";v(io,dk),io.prototype.e=function(a){fo()&&(a.a.preventDefault(),a=this.a,null!==a&&(ho()?(a=mc().a,a.webkitCancelFullScreen?a.webkitCancelFullScreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.msExitFullscreen?a.msExitFullscreen():a.exitFullscreen&&a.exitFullscreen()):(a=a.oc(),a=pc(a),this.h?a.mozRequestFullScreenWithKeys?a.mozRequestFullScreenWithKeys():a.webkitRequestFullscreen?a.webkitRequestFullscreen():go(a):go(a))))},io.prototype.i=function(){var a=this.c+"-true",b=this.c+"-false",c=Cc(this.element),d=this.a;ho()?Ub(c,b,a):Ub(c,a,b),null===d||d.C()},v(V,dk),V.prototype.f=function(a){a=a.b,null===a?this.c=null:this.c!=a.view2DState.projection&&(this.c=a.view2DState.projection,this.e=null),jo(this,this.i)},V.prototype.O=function(){this.e=null},V.prototype.h=function(){return this.get("coordinateFormat")},V.prototype.getCoordinateFormat=V.prototype.h,V.prototype.n=function(){return this.get("projection")},V.prototype.getProjection=V.prototype.n,V.prototype.B=function(a){a=Pc(a,this.a.b),this.i=[a.x,a.y],jo(this,this.i)},V.prototype.C=function(){jo(this,null),this.i=null},V.prototype.setMap=function(a){V.I.setMap.call(this,a),null!==a&&(a=a.b,this.g.push(z(a,"mousemove",this.B,!1,this),z(a,"mouseout",this.C,!1,this)))},V.prototype.w=function(a){this.v("coordinateFormat",a)},V.prototype.setCoordinateFormat=V.prototype.w,V.prototype.o=function(a){this.v("projection",a)},V.prototype.setProjection=V.prototype.o,v(ko,dk);var lo=[1,2,5];ko.prototype.n=function(){return this.get("units")},ko.prototype.getUnits=ko.prototype.n,ko.prototype.f=function(a){a=a.b,this.w=null===a?null:a.view2DState,mo(this)},ko.prototype.O=function(){mo(this)},ko.prototype.o=function(a){this.v("units",a)},ko.prototype.setUnits=ko.prototype.o,v(no,Ld);var oo=[];no.prototype.oa=function(a,b,c,d,e){ma(b)||(oo[0]=b,b=oo);for(var f=0;f<b.length;f++){var g=z(a,b[f],c||this,d||!1,e||this.d||this);this.a[g.key]=g}return this},no.prototype.Ed=function(a,b,c,d,e){if(ma(b))for(var f=0;f<b.length;f++)this.Ed(a,b[f],c,d,e);else{a:if(e=e||this.d||this,d=!!d,c=ke(c||this),ce(a))a=a.ga.a[b],b=-1,a&&(b=Ge(a,c,d,e)),e=b>-1?a[b]:null;else{if(a=qe(a,b,d))for(b=0;b<a.length;b++)if(!a[b].cb&&a[b].Na==c&&a[b].capture==d&&a[b].wb==e){e=a[b];break a}e=null}e&&(re(e),delete this.a[e.key])}return this},no.prototype.F=function(){no.I.F.call(this),po(this)},no.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},v(qo,He);var ro=zb||Ab&&Nb("1.9.3");l=qo.prototype,l.clientX=0,l.clientY=0,l.screenX=0,l.screenY=0,l.De=0,l.Ee=0,l.Jb=0,l.Kb=0,l.Pd=!0,l.sb=!1,l.$d=0,l.hg=0,l.dg=!1,l.Fd=!1,l.F=function(){qo.I.F.call(this),pe(this.handle,["touchstart","mousedown"],this.Ce,!1,this),po(this.a),ro&&this.b.releaseCapture(),this.handle=this.target=null},l.Ce=function(a){var b="mousedown"==a.type;if(!this.Pd||this.sb||b&&!ae(a))A(this,"earlycancel");else{if(to(a),0==this.$d){if(!A(this,new uo("start",this,a.clientX,a.clientY,a)))return;this.sb=!0,a.preventDefault()}else a.preventDefault();var b=this.b,c=b.documentElement,d=!ro;this.a.oa(b,["touchmove","mousemove"],this.Sf,d),this.a.oa(b,["touchend","mouseup"],this.Cc,d),ro?(c.setCapture(!1),this.a.oa(c,"losecapture",this.Cc)):this.a.oa(b?b.parentWindow||b.defaultView:window,"blur",this.Cc),zb&&this.dg&&this.a.oa(b,"dragstart",Sd),this.f&&this.a.oa(this.f,"scroll",this.Eh,d),this.clientX=this.De=a.clientX,this.clientY=this.Ee=a.clientY,this.screenX=a.screenX,this.screenY=a.screenY,this.Fd?(a=this.target,b=a.offsetLeft,c=a.offsetParent,c||"fixed"!=Jc(a,"position")||(c=oc(a).documentElement),c?(Ab?(d=ad(c),b+=d.left):zb&&Pb>=8&&(d=ad(c),b-=d.left),a=Wc(c)?c.clientWidth-(b+a.offsetWidth):b):a=b):a=this.target.offsetLeft,this.Jb=a,this.Kb=this.target.offsetTop,this.c=Fc(mc(this.b)),this.hg=Aa()}},l.Cc=function(a,b){if(po(this.a),ro&&this.b.releaseCapture(),this.sb){to(a),this.sb=!1;var c=vo(this,this.Jb),d=wo(this,this.Kb);A(this,new uo("end",this,a.clientX,a.clientY,a,c,d,b||"touchcancel"==a.type))}else A(this,"earlycancel")},l.Sf=function(a){if(this.Pd){to(a);var b=(this.Fd&&so(this)?-1:1)*(a.clientX-this.clientX),c=a.clientY-this.clientY;if(this.clientX=a.clientX,this.clientY=a.clientY,this.screenX=a.screenX,this.screenY=a.screenY,!this.sb){var d=this.De-this.clientX,e=this.Ee-this.clientY;if(d*d+e*e>this.$d){if(!A(this,new uo("start",this,a.clientX,a.clientY,a)))return void(this.qb||this.Cc(a));this.sb=!0}}c=xo(this,b,c),b=c.x,c=c.y,this.sb&&A(this,new uo("beforedrag",this,a.clientX,a.clientY,a,b,c))&&(yo(this,a,b,c),a.preventDefault())}},l.Eh=function(a){var b=xo(this,0,0);a.clientX=this.clientX,a.clientY=this.clientY,yo(this,a,b.x,b.y)},v(uo,Qd),v(zo,dk);var Ao=0;zo.prototype.setMap=function(a){zo.I.setMap.call(this,a),null===a||a.R()},zo.prototype.f=function(a){if(null!==a.b){if(!this.h){var b,c=this.element,d=Cc(c),c=Xc(c);b=Oc(d);var e=Sc(d);b=new Hc(b.x,b.y,e.width,e.height);var e=$c(d,"margin"),f=ad(d),d=c.width-e.left-e.right-f.left-f.right-b.width;b=c.height-e.top-e.bottom-f.top-f.bottom-b.height,c.width>c.height?(this.i=1,c=new Hc(0,0,d,0)):(this.i=Ao,c=new Hc(0,0,0,b)),this.e.d=c||new Hc(0/0,0/0,0/0,0/0),this.h=!0}a=a.b.view2DState.resolution,a!==this.c&&(this.c=a,a=-1*(ei(this.a.a().Y())(a)-1),c=this.e,d=Cc(this.element),1==this.i?Kc(d,c.d.left+c.d.width*a):Kc(d,c.d.left,c.d.top+c.d.height*a))}},zo.prototype.l=function(a){var b=this.a,c=b.a().Y();a=Bo(this,Co(this,a.offsetX,a.offsetY)),b.Ha(mi({resolution:a,duration:200,easing:gi})),a=c.constrainResolution(a),c.c(a)},zo.prototype.n=function(a){var b=this.a,c=b.a().Y();"drag"===a.type?(a=Bo(this,Co(this,a.left,a.top)),a!==this.c&&(this.c=a,c.c(a))):(b.Ha(mi({resolution:this.c,duration:200,easing:gi})),a=c.constrainResolution(this.c),c.c(a))},v(Do,dk),Do.prototype.e=function(a){a.a.preventDefault(),a=this.a;var b=a.a().Y(),c=null===this.c?b.i().u():this.c;b.Qd(c,a.e())},v(Eo,Me),Eo.prototype.b=function(){return this.get("checked")},Eo.prototype.getChecked=Eo.prototype.b,Eo.prototype.c=function(){return this.get("value")},Eo.prototype.getValue=Eo.prototype.c,Eo.prototype.f=function(a){this.v("value",a)},Eo.prototype.setValue=Eo.prototype.f,Eo.prototype.e=function(a){this.v("checked",a)},Eo.prototype.setChecked=Eo.prototype.e,Eo.prototype.i=function(){var a=this.a;"checkbox"===a.type||"radio"===a.type?this.e(a.checked):this.f(a.value)},Eo.prototype.g=function(){this.a.checked=this.b()},Eo.prototype.h=function(){this.a.value=this.c()};var Go;a:{if(!document.implementation||!document.implementation.createDocument){if("undefined"!=typeof ActiveXObject){var Ho=new ActiveXObject("MSXML2.DOMDocument");if(Ho){Ho.resolveExternals=!1,Ho.validateOnParse=!1;try{Ho.setProperty("ProhibitDTD",!0),Ho.setProperty("MaxXMLSize",2048),Ho.setProperty("MaxElementDepth",256)}catch(Io){}}if(Ho){Go=Ho;break a}}throw Error("Your browser does not support creating new documents")}Go=document.implementation.createDocument("","",null)}var Jo=Go,Mo=document.implementation&&document.implementation.createDocument?Ko:Lo,Ro=zb?Qo:Po,Uo=zb?To:So,Xo=zb?Wo:Vo,ap=document.implementation&&document.implementation.createDocument?Yo:Zo,$o=document.implementation&&document.implementation.createDocument?bp:cp,fp=document.implementation&&document.implementation.createDocument?dp:ep,op=mp();v(sp,Fo),l=sp.prototype,l.G=ca("xml"),l.Rb=function(a){return Uo(a)?tp(this,a):Xo(a)?this.ue(a):oa(a)?(a=gp(a),tp(this,a)):null},l.bb=function(a){return Uo(a)?up(this,a):Xo(a)?this.Sb(a):oa(a)?(a=gp(a),up(this,a)):[]
},l.zd=function(a){return Uo(a)?this.e(a):Xo(a)?this.h(a):oa(a)?(a=gp(a),this.e(a)):null},l.Ca=function(a){return Uo(a)?this.rc(a):Xo(a)?this.sc(a):oa(a)?(a=gp(a),this.rc(a)):null},l.Id=function(a){return this.l(a)},l.Zc=function(a){var b=Mo("http://www.topografix.com/GPX/1/1","gpx");return rp({node:b},vp,wp,a,[]),b},v(Ip,sp);var Jp=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Tp={rte:Np,trk:Pp,wpt:Rp},Up=Y(Jp,{rte:ip(Np),trk:ip(Pp),wpt:ip(Rp)},void 0),Mp=Y(Jp,{text:W(Ep,"linkText"),type:W(Ep,"linkType")},void 0),Op=Y(Jp,{name:W(Ep),cmt:W(Ep),desc:W(Ep),src:W(Ep),link:Lp,number:W(Cp),type:W(Ep),rtept:function(a,b){var c=Z({},Vp,a,b);s(c)&&Kp(w(b[b.length-1],"flatCoordinates"),a,c)}},void 0),Vp=Y(Jp,{ele:W(Ap),time:W(zp)},void 0),Qp=Y(Jp,{name:W(Ep),cmt:W(Ep),desc:W(Ep),src:W(Ep),link:Lp,number:W(Cp),type:W(Ep),trkseg:function(a,b){var c=b[b.length-1];qp(Wp,a,b),w(c,"ends").push(w(c,"flatCoordinates").length)}},void 0),Wp=Y(Jp,{trkpt:function(a,b){var c=Z({},Xp,a,b);s(c)&&Kp(w(b[b.length-1],"flatCoordinates"),a,c)}},void 0),Xp=Y(Jp,{ele:W(Ap),time:W(zp)},void 0),Sp=Y(Jp,{ele:W(Ap),time:W(zp),magvar:W(Ap),geoidheight:W(Ap),name:W(Ep),cmt:W(Ep),desc:W(Ep),src:W(Ep),link:Lp,sym:W(Ep),type:W(Ep),fix:W(Ep),sat:W(Cp),hdop:W(Ap),vdop:W(Ap),pdop:W(Ap),ageofdgpsdata:W(Ap),dgpsid:W(Cp)},void 0);Ip.prototype.ue=function(a){if(!(0<=Na(Jp,a.namespaceURI)))return null;var b=Tp[a.localName];return s(b)?(a=b(a,[]),s(a)?a:null):null},Ip.prototype.Sb=function(a){return 0<=Na(Jp,a.namespaceURI)&&"gpx"==a.localName&&(a=Z([],Up,a,[]),s(a))?a:[]},Ip.prototype.rc=function(){return $h("EPSG:4326")},Ip.prototype.sc=function(){return $h("EPSG:4326")};var $p=["text","type"],Zp=Y(Jp,{text:X(Hp),type:X(Hp)}),dq=Y(Jp,"name cmt desc src link number type rtept".split(" ")),eq=Y(Jp,{name:X(Hp),cmt:X(Hp),desc:X(Hp),src:X(Hp),link:X(Yp),number:X(Gp),type:X(Hp),rtept:lp(X(aq))}),fq=Y(Jp,"name cmt desc src link number type trkseg".split(" ")),iq=Y(Jp,{name:X(Hp),cmt:X(Hp),desc:X(Hp),src:X(Hp),link:X(Yp),number:X(Gp),type:X(Hp),trkseg:lp(X(function(a,b,c){rp({node:a,geometryLayout:b.b,properties:{}},gq,hq,b.D(),c)}))}),hq=mp("trkpt"),gq=Y(Jp,{trkpt:X(aq)}),bq=Y(Jp,"ele time magvar geoidheight name cmt desc src link sym type fix sat hdop vdop pdop ageofdgpsdata dgpsid".split(" ")),cq=Y(Jp,{ele:X(Fp),time:X(function(a,b){var c=new Date(1e3*b),c=c.getUTCFullYear()+"-"+Ka(c.getUTCMonth()+1)+"-"+Ka(c.getUTCDate())+"T"+Ka(c.getUTCHours())+":"+Ka(c.getUTCMinutes())+":"+Ka(c.getUTCSeconds())+"Z";a.appendChild(Jo.createTextNode(c))}),magvar:X(Fp),geoidheight:X(Fp),name:X(Hp),cmt:X(Hp),desc:X(Hp),src:X(Hp),link:X(Yp),sym:X(Hp),type:X(Hp),fix:X(Hp),sat:X(Gp),hdop:X(Fp),vdop:X(Fp),pdop:X(Fp),ageofdgpsdata:X(Fp),dgpsid:X(Gp)}),jq={Point:"wpt",LineString:"rte",MultiLineString:"trk"},vp=Y(Jp,{rte:X(function(a,b,c){var d=b.S();a={node:a,properties:d},b=b.M(),s(b)&&(a.geometryLayout=b.b,b=b.D(),d.rtept=b),b=dq[c[c.length-1].node.namespaceURI],d=pp(d,b),rp(a,eq,op,d,c,b)}),trk:X(function(a,b,c){var d=b.S();a={node:a,properties:d},b=b.M(),s(b)&&(b=b.ld(),d.trkseg=b),b=fq[c[c.length-1].node.namespaceURI],d=pp(d,b),rp(a,iq,op,d,c,b)}),wpt:X(function(a,b,c){var d=c[c.length-1],e=b.S();d.properties=e,b=b.M(),s(b)&&(d.geometryLayout=b.b,aq(a,b.D(),c))})});v(lq,Fo),l=lq.prototype,l.G=ca("json"),l.Rb=function(a){return nq(mq(a))},l.bb=function(a){return this.a(mq(a))},l.zd=function(a){return a=mq(a),oq(a)},l.Ca=function(a){return this.b(mq(a))},l.Id=function(a){return pq(a)},l.Zc=function(a){var b,c,d=[];for(b=0,c=a.length;c>b;++b)d.push(pq(a[b]));return{type:"FeatureCollection",features:d}},v(qq,lq);var rq={Point:function(a){return new ph(a.coordinates)},LineString:function(a){return new jm(a.coordinates)},Polygon:function(a){return new G(a.coordinates)},MultiPoint:function(a){return new om(a.coordinates)},MultiLineString:function(a){return new lm(a.coordinates)},MultiPolygon:function(a){return new pm(a.coordinates)},GeometryCollection:function(a){return a=Pa(a.geometries,oq),new cm(a)}},tq={Point:function(a){return{type:"Point",coordinates:a.D()}},LineString:function(a){return{type:"LineString",coordinates:a.D()}},Polygon:function(a){return{type:"Polygon",coordinates:a.D()}},MultiPoint:function(a){return{type:"MultiPoint",coordinates:a.D()}},MultiLineString:function(a){return{type:"MultiLineString",coordinates:a.D()}},MultiPolygon:function(a){return{type:"MultiPolygon",coordinates:a.D()}},GeometryCollection:function(a){return{type:"GeometryCollection",geometries:Pa(a.a,sq)}},Circle:function(){return{type:"GeometryCollection",geometries:[]}}};qq.prototype.a=function(a){if("Feature"==a.type)return[nq(a)];if("FeatureCollection"==a.type){var b=[];a=a.features;var c,d;for(c=0,d=a.length;d>c;++c)b.push(nq(a[c]));return b}return[]},qq.prototype.Ca=function(a){return a=a.crs,null!=a?"name"==a.type?$h(a.properties.name):"EPSG"==a.type?$h("EPSG:"+a.properties.code):null:this.d},v(xq,Fo),l=xq.prototype,l.G=ca("text"),l.Rb=function(a){return yq(this,oa(a)?a:"")},l.bb=function(a){return a=yq(this,oa(a)?a:""),null===a?[]:[a]},l.zd=function(a){return this.d(oa(a)?a:"")},l.Ca=function(){return $h("EPSG:4326")},l.Id=function(a){return this.b(a)},l.Zc=function(a){return this.c(a)},v(zq,xq);var Aq=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,Bq=/^H.([A-Z]{3}).*?:(.*)/,Cq=/^HFDTE(\d{2})(\d{2})(\d{2})/;v(Dq,sp);var Fq=["http://www.google.com/kml/ext/2.2"],Gq=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Hq=[255,255,255,1],Iq=new Ki({color:Hq}),Jq=[2,20],Kq=[32,32],Lq=new Zk({anchor:Jq,anchorXUnits:"pixels",anchorYUnits:"pixels",crossOrigin:"anonymous",rotation:0,scale:1,size:Kq,src:"https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png"}),Mq=new Mi({color:Hq,width:1}),Eq=[new Oi({fill:Iq,image:Lq,text:null,stroke:Mq,zIndex:0})],Nq={fraction:"fraction",pixels:"pixels"},er=Y(Gq,{value:jp(Ep)},void 0),gr=Y(Gq,{Data:function(a,b){var c=a.getAttribute("name");if(null!==c){var d=Z(void 0,er,a,b);s(d)&&(b[b.length-1][c]=d)}},SchemaData:function(a,b){qp(fr,a,b)}},void 0),Sq=Y(Gq,{coordinates:jp(Pq)},void 0),br=Y(Gq,{innerBoundaryIs:function(a,b){var c=Z(void 0,hr,a,b);s(c)&&b[b.length-1].push(c)},outerBoundaryIs:function(a,b){var c=Z(void 0,ir,a,b);s(c)&&(b[b.length-1][0]=c)}},void 0),jr=Y(Fq,{coord:function(a,b){var c=b[b.length-1].j,d=No(a);(d=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(d))?c.push(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3]),0):c.push(0,0,0,0)}},void 0),Uq=Y(Gq,{when:function(a,b){var c=b[b.length-1].He,d=No(a);if(d=/^\s*(\d{4})($|-(\d{2})($|-(\d{2})($|T(\d{2}):(\d{2}):(\d{2})(Z|(?:([+\-])(\d{2})(?::(\d{2}))?)))))\s*$/.exec(d)){var e=Date.UTC(parseInt(d[1],10),s(d[3])?parseInt(d[3],10)-1:0,s(d[5])?parseInt(d[5],10):1,s(d[7])?parseInt(d[7],10):0,s(d[8])?parseInt(d[8],10):0,s(d[9])?parseInt(d[9],10):0);if(s(d[10])&&"Z"!=d[10]){var f="-"==d[11]?-1:1,e=e+60*f*parseInt(d[12],10);s(d[13])&&(e+=3600*f*parseInt(d[13],10))}c.push(e)}else c.push(0)}},jr),Wq=Y(Gq,{coordinates:jp(Pq)},void 0),kr=Y(Gq,{href:W(Qq)},void 0),lr=Y(Gq,{Icon:W(function(a,b){var c=Z({},kr,a,b);return s(c)?c:null}),heading:W(Ap),hotSpot:W(function(a){var b=a.getAttribute("xunits"),c=a.getAttribute("yunits");return{x:parseFloat(a.getAttribute("x")),qi:Nq[b],y:parseFloat(a.getAttribute("y")),ri:Nq[c]}}),scale:W(function(a){return a=Ap(a),s(a)?Math.sqrt(a):void 0})},void 0),hr=Y(Gq,{LinearRing:jp(Rq)},void 0),mr=Y(Gq,{color:W(Oq),width:W(Ap)},void 0),Zq=Y(Gq,{LineString:ip(Vq),LinearRing:ip(Xq),MultiGeometry:ip(Yq),Point:ip($q),Polygon:ip(ar)},void 0),nr=Y(Fq,{Track:ip(Tq)},void 0),ir=Y(Gq,{LinearRing:jp(Rq)},void 0),or=Y(Gq,{Style:W(cr),key:W(Ep),styleUrl:W(function(a){var b=Da(No(a));return null!=a.baseURI?wj(a.baseURI,b).toString():b})},void 0),qr={ExtendedData:function(a,b){qp(gr,a,b)},MultiGeometry:W(Yq,"geometry"),LineString:W(Vq,"geometry"),LinearRing:W(Xq,"geometry"),Point:W($q,"geometry"),Polygon:W(ar,"geometry"),Style:W(cr),StyleMap:function(a,b){var c=Z(void 0,pr,a,b);if(s(c)){var d=b[b.length-1];ma(c)?d.Style=c:oa(c)&&(d.styleUrl=c)}},address:W(Ep),description:W(Ep),name:W(Ep),open:W(xp),phoneNumber:W(Ep),styleUrl:W(Qq),visibility:W(xp)},rr=Y(Fq,{MultiTrack:W(function(a,b){var c=Z([],nr,a,b);if(s(c)){var d=new lm(null);return nm(d,c),d}},"geometry"),Track:W(Tq,"geometry")},void 0),sr=Y(Gq,qr,rr),tr=Y(Gq,{color:W(Oq),fill:W(xp),outline:W(xp)},void 0),fr=Y(Gq,{SimpleData:function(a,b){var c=a.getAttribute("name");if(null!==c){var d=Ep(a);b[b.length-1][c]=d}}},void 0),dr=Y(Gq,{IconStyle:function(a,b){var c=Z({},lr,a,b);if(s(c)){var d,e=b[b.length-1];d=w(w(c,"Icon",{}),"href"),d=s(d)?d:"https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png";var f,g,h,i=w(c,"hotSpot");s(i)?(f=[i.x,i.y],g=i.qi,h=i.ri):"https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png"===d?(f=Jq,h=g="pixels"):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(d)&&(f=[.5,0],h=g="fraction");var j,i=w(c,"heading");s(i)&&(j=Xb(i));var k,c=w(c,"scale");"https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png"==d&&(k=Kq),f=new Zk({anchor:f,anchorOrigin:"bottom-left",anchorXUnits:g,anchorYUnits:h,crossOrigin:"anonymous",rotation:j,scale:c,size:k,src:d}),e.imageStyle=f}},LineStyle:function(a,b){var c=Z({},mr,a,b);s(c)&&(b[b.length-1].strokeStyle=new Mi({color:w(c,"color",Hq),width:w(c,"width",1)}))},PolyStyle:function(a,b){var c=Z({},tr,a,b);if(s(c)){var d=b[b.length-1];d.fillStyle=new Ki({color:w(c,"color",Hq)});var e=w(c,"fill");s(e)&&(d.fill=e),c=w(c,"outline"),s(c)&&(d.outline=c)}}},void 0),pr=Y(Gq,{Pair:function(a,b){var c=Z({},or,a,b);if(s(c)){var d=w(c,"key");s(d)&&"normal"==d&&(d=w(c,"styleUrl"),s(d)&&(b[b.length-1]=d),c=w(c,"Style"),s(c)&&(b[b.length-1]=c))}}},void 0);l=Dq.prototype,l.te=function(a,b){Ro(a);var c;return c={Folder:hp(this.te,this),Placemark:ip(this.Ad,this),Style:xa(this.Ph,this),StyleMap:xa(this.Oh,this)},c=Y(Gq,c,void 0),c=Z([],c,a,b,this),s(c)?c:void 0},l.Ad=function(a,b){var c=Z({geometry:null},sr,a,b);if(s(c)){var d=new I,e=a.getAttribute("id");return null===e||d.b(e),d.H(c),d.g(this.d),d}},l.Ph=function(a,b){var c=a.getAttribute("id");if(null!==c){var d=cr(a,b);s(d)&&(c=null!=a.baseURI?wj(a.baseURI,"#"+c).toString():"#"+c,this.a[c]=d)}},l.Oh=function(a,b){var c=a.getAttribute("id");if(null!==c){var d=Z(void 0,pr,a,b);s(d)&&(c=null!=a.baseURI?wj(a.baseURI,"#"+c).toString():"#"+c,this.a[c]=d)}},l.ue=function(a){return 0<=Na(Gq,a.namespaceURI)?(a=this.Ad(a,[]),s(a)?a:null):null},l.Sb=function(a){if(!(0<=Na(Gq,a.namespaceURI)))return[];var b;if(b=Ro(a),"Document"==b||"Folder"==b)return b=this.te(a,[]),s(b)?b:[];if("Placemark"==b)return b=this.Ad(a,[]),s(b)?[b]:[];if("kml"==b){for(b=[],a=a.firstElementChild;null!==a;a=a.nextElementSibling){var c=this.Sb(a);s(c)&&Ya(b,c)}return b}return[]},l.rc=function(){return $h("EPSG:4326")},l.sc=function(){return $h("EPSG:4326")},v(ur,sp);var wr=[null],xr=Y(wr,{nd:function(a,b){b[b.length-1].Lb.push(a.getAttribute("ref"))},tag:vr},void 0),zr=Y(wr,{node:function(a,b){var c=b[b.length-1],d=a.getAttribute("id"),e=[parseFloat(a.getAttribute("lon")),parseFloat(a.getAttribute("lat"))];c.ee[d]=e;var f=Z({uc:{}},yr,a,b);ec(f.uc)||(e=new ph(e),e=new I(e),e.b(d),e.H(f.uc),c.features.push(e))},way:function(a,b){for(var c=a.getAttribute("id"),d=Z({Lb:[],uc:{}},xr,a,b),e=b[b.length-1],f=[],g=0,h=d.Lb.length;h>g;g++)Ya(f,w(e.ee,d.Lb[g]));d.Lb[0]==d.Lb[d.Lb.length-1]?(g=new G(null),xh(g,"XY",f,[f.length])):(g=new jm(null),km(g,"XY",f)),f=new I(g),f.b(c),f.H(d.uc),e.features.push(f)}},void 0),yr=Y(wr,{tag:vr},void 0);ur.prototype.Sb=function(a){return"osm"==a.localName&&(a=Z({ee:{},features:[]},zr,a,[]),s(a.features))?a.features:[]},ur.prototype.rc=function(){return $h("EPSG:4326")},ur.prototype.sc=function(){return $h("EPSG:4326")},v(Ar,lq),Ar.prototype.a=function(a){if("Topology"==a.type){var b,c=null,d=null;s(a.transform)&&(b=a.transform,c=b.scale,d=b.translate);var e=a.arcs;if(s(b)){b=c;var f,g,h=d;for(f=0,g=e.length;g>f;++f)for(var i=e[f],j=b,k=h,l=0,m=0,n=void 0,o=void 0,p=void 0,o=0,p=i.length;p>o;++o)n=i[o],l+=n[0],m+=n[1],n[0]=l,n[1]=m,Fr(n,j,k)}for(b=[],a=cc(a.objects),h=0,f=a.length;f>h;++h)"GeometryCollection"===a[h].type?(g=a[h],b.push.apply(b,Cr(g,e,c,d))):(g=a[h],b.push(Dr(g,e,c,d)));return b}return[]},Ar.prototype.Ca=k("d");var Er={Point:function(a,b,c){return a=a.coordinates,null===b||null===c||Fr(a,b,c),new ph(a)},LineString:function(a,b){var c=Br(a.arcs,b);return new jm(c)},Polygon:function(a,b){var c,d,e=[];for(c=0,d=a.arcs.length;d>c;++c)e[c]=Br(a.arcs[c],b);return new G(e)},MultiPoint:function(a,b,c){a=a.coordinates;var d,e;if(null!==b&&null!==c)for(d=0,e=a.length;e>d;++d)Fr(a[d],b,c);return new om(a)},MultiLineString:function(a,b){var c,d,e=[];for(c=0,d=a.arcs.length;d>c;++c)e[c]=Br(a.arcs[c],b);return new lm(e)},MultiPolygon:function(a,b){var c,d,e,f,g,h,i=[];for(g=0,h=a.arcs.length;h>g;++g){for(c=a.arcs[g],d=[],e=0,f=c.length;f>e;++e)d[e]=Br(c[e],b);i[g]=d}return new pm(i)}},Hr={"http://www.opengis.net/gml":{featureMember:ip(Gr),featureMembers:jp(Gr)}},Kr={"http://www.opengis.net/gml":{Point:jp(function(a,b){var c=Wr(a,b);if(null!=c){var d=new ph(null);return qh(d,"XYZ",c),d}}),MultiPoint:jp(function(a,b){var c=Z([],es,a,b);return s(c)?new om(c):void 0}),LineString:jp(Vr),MultiLineString:jp(function(a,b){var c=Z([],fs,a,b);if(s(c)){var d=new lm(null);return nm(d,c),d}}),LinearRing:jp(function(a,b){var c=Wr(a,b);if(s(c)){var d=new nh(null);return oh(d,"XYZ",c),d}}),Polygon:jp(Xr),MultiPolygon:jp(function(a,b){var c=Z([],gs,a,b);if(s(c)){var d=new pm(null);return rm(d,c),d}}),Surface:jp(Zr),MultiSurface:jp(function(a,b){var c=Z([],hs,a,b);if(s(c)){var d=new pm(null);return rm(d,c),d}}),Curve:jp(as),MultiCurve:jp(function(a,b){var c=Z([],is,a,b);if(s(c)){var d=new lm(null);return nm(d,c),d}}),Envelope:jp(function(a,b){var c=Z([null],js,a,b);return wg(c[1][0],c[1][1],c[2][0],c[2][1])})}},cs={"http://www.opengis.net/gml":{pos:jp(function(a,b){for(var c,d=No(a),e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*/,f=[];c=e.exec(d);)f.push(parseFloat(c[1])),d=d.substr(c[0].length);if(""===d){if(d=w(b[0],"srsName"),e="enu",null===d||(e=Gh($h(d))),"neu"===e)for(d=0,e=f.length;e>d;d+=3)c=f[d],f[d]=f[d+1],f[d+1]=c;return d=f.length,2==d&&f.push(0),0===d?void 0:f}}),posList:jp(ds)}},Yr={"http://www.opengis.net/gml":{interior:function(a,b){var c=Z(void 0,ks,a,b);s(c)&&b[b.length-1].push(c)},exterior:function(a,b){var c=Z(void 0,ks,a,b);s(c)&&(b[b.length-1][0]=c)}}},es={"http://www.opengis.net/gml":{pointMember:ip(Lr),pointMembers:ip(Lr)}},fs={"http://www.opengis.net/gml":{lineStringMember:ip(Nr),lineStringMembers:ip(Nr)}},is={"http://www.opengis.net/gml":{curveMember:ip(Pr),curveMembers:ip(Pr)}},hs={"http://www.opengis.net/gml":{surfaceMember:ip(Rr),surfaceMembers:ip(Rr)}},gs={"http://www.opengis.net/gml":{polygonMember:ip(Tr),polygonMembers:ip(Tr)}},Mr={"http://www.opengis.net/gml":{Point:ip(Wr)}},Or={"http://www.opengis.net/gml":{LineString:ip(Vr)}},Qr={"http://www.opengis.net/gml":{LineString:ip(Vr),Curve:ip(as)}},Sr={"http://www.opengis.net/gml":{Polygon:ip(Xr),Surface:ip(Zr)}},Ur={"http://www.opengis.net/gml":{Polygon:ip(Xr)}},$r={"http://www.opengis.net/gml":{patches:jp(function(a,b){return Z([null],ls,a,b)})}},bs={"http://www.opengis.net/gml":{segments:jp(function(a,b){return Z([null],ms,a,b)})}},js={"http://www.opengis.net/gml":{lowerCorner:ip(ds),upperCorner:ip(ds)}},ls={"http://www.opengis.net/gml":{PolygonPatch:jp(function(a,b){return Z([null],Yr,a,b)})}},ms={"http://www.opengis.net/gml":{LineStringSegment:jp(function(a,b){return Z([null],cs,a,b)})}},ks={"http://www.opengis.net/gml":{LinearRing:jp(function(a,b){var c=Z(null,cs,a,b);return null!=c?c:void 0})}},ps={"http://www.opengis.net/gml":{lowerCorner:X(Hp),upperCorner:X(Hp)}},ws={"http://www.opengis.net/gml":{surfaceMember:X(Bs),polygonMember:X(Bs)}},Gs={"http://www.opengis.net/gml":{pointMember:X(function(a,b,c){var d=Mo(a.namespaceURI,"Point");a.appendChild(d),os(d,b,c)})}},zs={"http://www.opengis.net/gml":{lineStringMember:X(Ds),curveMember:X(Ds)}},ts={"http://www.opengis.net/gml":{exterior:X(As),interior:X(As)}},Fs={"http://www.opengis.net/gml":{Curve:X(us),MultiCurve:X(ys),Point:X(os),MultiPoint:X(function(a,b,c){var d=w(c[c.length-1],"srsName");null!=d&&a.setAttribute("srsName",d),b=b.Vd(),rp({node:a,srsName:d},Gs,mp("pointMember"),b,c)}),LineString:X(us),MultiLineString:X(ys),LinearRing:X(qs),Polygon:X(ss),MultiPolygon:X(vs),Surface:X(ss),MultiSurface:X(vs),Envelope:X(function(a,b,c){var d=w(c[c.length-1],"srsName");s(d)&&a.setAttribute("srsName",d),rp({node:a},ps,op,[b[0]+" "+b[1],b[2]+" "+b[3]],c,["lowerCorner","upperCorner"])})}},Hs={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};v(Is,sp),Is.prototype.Sb=function(a){return a=Z([],Hr,a,[{featureType:this.b,featureNS:this.a}]),s(a)||(a=[]),a},Is.prototype.f=function(a){return Uo(a)?Js(a):Xo(a)?Z({},Ks,a,[]):oa(a)?(a=gp(a),Js(a)):void 0},Is.prototype.c=function(a){return Uo(a)?Ls(a):Xo(a)?Ms(a):oa(a)?(a=gp(a),Ls(a)):void 0};var Ns={"http://www.opengis.net/gml":{boundedBy:W(Jr,"bounds")}},Os={"http://www.opengis.net/wfs":{totalInserted:W(Cp),totalUpdated:W(Cp),totalDeleted:W(Cp)}},Ps={"http://www.opengis.net/ogc":{FeatureId:ip(function(a){return a.getAttribute("fid")})}},Qs={"http://www.opengis.net/wfs":{Feature:function(a,b){qp(Ps,a,b)}}},Ks={"http://www.opengis.net/wfs":{TransactionSummary:W(function(a,b){return Z({},Os,a,b)},"transactionSummary"),InsertResults:W(function(a,b){return Z([],Qs,a,b)},"insertIds")}},Rs={"http://www.opengis.net/wfs":{PropertyName:X(Hp)}},Ts={"http://www.opengis.net/wfs":{Insert:X(function(a,b,c){var d=c[c.length-1],d=Mo(w(d,"featureNS"),w(d,"featureType"));a.appendChild(d),a=b.Z,s(a)&&d.setAttribute("fid",a),a=c[c.length-1];var e=w(a,"featureNS"),f=b.a;s(a.zb)||(a.zb={},a.zb[e]={});var g=b.S();b=[];var h,i=[];for(h in g){var j=g[h];null!==j&&(b.push(h),i.push(j),h==f?h in a.zb[e]||(a.zb[e][h]=X(Es)):h in a.zb[e]||(a.zb[e][h]=X(Hp)))}h=jc(a),h.node=d,rp(h,a.zb,mp(void 0,e),i,c,b)}),Update:X(function(a,b,c){var d=c[c.length-1];if(a.setAttribute("typeName",w(d,"featurePrefix")+":"+w(d,"featureType")),d=b.Z,s(d)){for(var e=b.K(),f=[],g=0,h=e.length;h>g;g++){var i=b.get(e[g]);s(i)&&f.push({name:e[g],value:i})}rp({node:a},Ts,mp("Property"),f,c),Ss(a,d)}}),Delete:X(function(a,b,c){c=c[c.length-1],a.setAttribute("typeName",w(c,"featurePrefix")+":"+w(c,"featureType")),b=b.Z,s(b)&&Ss(a,b)}),Property:X(function(a,b,c){var d=Mo("http://www.opengis.net/wfs","Name");a.appendChild(d),Hp(d,b.name),null!=b.value&&(d=Mo("http://www.opengis.net/wfs","Value"),a.appendChild(d),b.value instanceof Sg?Es(d,b.value,c):Hp(d,b.value))}),Native:X(function(a,b){s(b.ji)&&a.setAttribute("vendorId",b.ji),s(b.Zh)&&a.setAttribute("safeToIgnore",b.Zh),s(b.value)&&Hp(a,b.value)})}},Us={"http://www.opengis.net/wfs":{Query:X(function(a,b,c){var d=c[c.length-1],e=w(d,"featurePrefix"),f=w(d,"featureNS"),g=w(d,"propertyNames"),h=w(d,"srsName");a.setAttribute("typeName",(s(e)?e+":":"")+b),s(h)&&a.setAttribute("srsName",h),s(f)&&a.setAttribute("xmlns:"+e,f),b=jc(d),b.node=a,rp(b,Rs,mp("PropertyName"),g,c),d=w(d,"bbox"),s(d)&&(g=Mo("http://www.opengis.net/ogc","Filter"),b=w(c[c.length-1],"geometryName"),e=Mo("http://www.opengis.net/ogc","BBOX"),g.appendChild(e),f=Mo("http://www.opengis.net/ogc","PropertyName"),Hp(f,b),e.appendChild(f),Es(e,d,c),a.appendChild(g))})}};Is.prototype.g=function(a){var b=Mo("http://www.opengis.net/wfs","GetFeature");b.setAttribute("service","WFS"),b.setAttribute("version","1.1.0"),s(a)&&(s(a.handle)&&b.setAttribute("handle",a.handle),s(a.outputFormat)&&b.setAttribute("outputFormat",a.outputFormat),s(a.maxFeatures)&&b.setAttribute("maxFeatures",a.maxFeatures),s(a.resultType)&&b.setAttribute("resultType",a.resultType),s(a.bi)&&b.setAttribute("startIndex",a.bi),s(a.count)&&b.setAttribute("count",a.count)),fp(b,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.d);var c=a.featureTypes;a=[{node:b,srsName:a.srsName,featureNS:s(a.featureNS)?a.featureNS:this.a,featurePrefix:a.featurePrefix,geometryName:a.geometryName,bbox:a.bbox,se:s(a.se)?a.se:[]}];var d=jc(a[a.length-1]);return d.node=b,rp(d,Us,mp("Query"),c,a),b},Is.prototype.i=function(a,b,c,d){var e=[],f=Mo("http://www.opengis.net/wfs","Transaction");return f.setAttribute("service","WFS"),f.setAttribute("version","1.1.0"),s(d)&&s(d.handle)&&f.setAttribute("handle",d.handle),fp(f,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.d),null!=a&&rp({node:f,featureNS:d.featureNS,featureType:d.featureType},Ts,mp("Insert"),a,e),null!=b&&rp({node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:d.featurePrefix},Ts,mp("Update"),b,e),null!=c&&rp({node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:d.featurePrefix},Ts,mp("Delete"),c,e),s(d.nativeElements)&&rp({node:f,featureNS:d.featureNS,featureType:d.featureType,featurePrefix:d.featurePrefix},Ts,mp("Native"),d.nativeElements,e),f},Is.prototype.rc=function(a){for(a=a.firstChild;null!==a;a=a.nextSibling)if(1==a.nodeType)return this.sc(a);return null},Is.prototype.sc=function(a){if(a=a.firstElementChild.firstElementChild,null!=a)for(a=a.firstElementChild;null!==a;a=a.nextElementSibling)if(0!==a.childNodes.length&&(1!==a.childNodes.length||3!==a.firstChild.nodeType)){var b=[{}];return Jr(a,b),$h(b.pop().srsName)}return null},Ws.prototype.a=function(a){return Uo(a)?Xs(this,a):Xo(a)?Ys(this,a):oa(a)?(a=gp(a),Xs(this,a)):null},v(Zs,Ws);var ht=[null,"http://www.opengis.net/wms"],$s=Y(ht,{Service:W(function(a,b){return Z({},it,a,b)}),Capability:W(function(a,b){return Z({},jt,a,b)})},void 0),jt=Y(ht,{Request:W(function(a,b){return Z({},kt,a,b)}),Exception:W(function(a,b){return Z([],lt,a,b)}),Layer:W(function(a,b){return Z({},mt,a,b)})},void 0),it=Y(ht,{Name:W(Ep),Title:W(Ep),Abstract:W(Ep),KeywordList:W(ft),OnlineResource:W(Vs),ContactInformation:W(function(a,b){return Z({},nt,a,b)}),Fees:W(Ep),AccessConstraints:W(Ep),LayerLimit:W(Cp),MaxWidth:W(Cp),MaxHeight:W(Cp)},void 0),nt=Y(ht,{ContactPersonPrimary:W(function(a,b){return Z({},ot,a,b)}),ContactPosition:W(Ep),ContactAddress:W(function(a,b){return Z({},pt,a,b)}),ContactVoiceTelephone:W(Ep),ContactFacsimileTelephone:W(Ep),ContactElectronicMailAddress:W(Ep)},void 0),ot=Y(ht,{ContactPerson:W(Ep),ContactOrganization:W(Ep)},void 0),pt=Y(ht,{AddressType:W(Ep),Address:W(Ep),City:W(Ep),StateOrProvince:W(Ep),PostCode:W(Ep),Country:W(Ep)},void 0),lt=Y(ht,{Format:ip(Ep)},void 0),mt=Y(ht,{Name:W(Ep),Title:W(Ep),Abstract:W(Ep),KeywordList:W(ft),CRS:kp(Ep),EX_GeographicBoundingBox:W(function(a,b){var c=Z({},qt,a,b);if(s(c)){var d=w(c,"westBoundLongitude"),e=w(c,"southBoundLatitude"),f=w(c,"eastBoundLongitude"),c=w(c,"northBoundLatitude");return s(d)&&s(e)&&s(f)&&s(c)?[d,e,f,c]:void 0}}),BoundingBox:kp(function(a){var b=[Bp(a.getAttribute("minx")),Bp(a.getAttribute("miny")),Bp(a.getAttribute("maxx")),Bp(a.getAttribute("maxy"))],c=[Bp(a.getAttribute("resx")),Bp(a.getAttribute("resy"))];return{crs:a.getAttribute("CRS"),extent:b,res:c}}),Dimension:kp(function(a){return{name:a.getAttribute("name"),units:a.getAttribute("units"),unitSymbol:a.getAttribute("unitSymbol"),"default":a.getAttribute("default"),multipleValues:yp(a.getAttribute("multipleValues")),nearestValue:yp(a.getAttribute("nearestValue")),current:yp(a.getAttribute("current")),values:Ep(a)}}),Attribution:W(function(a,b){return Z({},rt,a,b)}),AuthorityURL:kp(function(a,b){var c=at(a,b);if(s(c)){var d=a.getAttribute("name");return c.name=d,c}}),Identifier:kp(Ep),MetadataURL:kp(function(a,b){var c=at(a,b);if(s(c)){var d=a.getAttribute("type");return c.type=d,c}}),DataURL:kp(at),FeatureListURL:kp(at),Style:kp(function(a,b){return Z({},st,a,b)}),MinScaleDenominator:W(Ap),MaxScaleDenominator:W(Ap),Layer:kp(function(a,b){var c=b[b.length-1],d=Z({},mt,a,b);if(s(d)){var e=yp(a.getAttribute("queryable"));return s(e)||(e=w(c,"queryable")),d.queryable=s(e)?e:!1,e=Dp(a.getAttribute("cascaded")),s(e)||(e=w(c,"cascaded")),d.cascaded=e,e=yp(a.getAttribute("opaque")),s(e)||(e=w(c,"opaque")),d.opaque=s(e)?e:!1,e=yp(a.getAttribute("noSubsets")),s(e)||(e=w(c,"noSubsets")),d.noSubsets=s(e)?e:!1,e=Bp(a.getAttribute("fixedWidth")),s(e)||(e=w(c,"fixedWidth")),d.fixedWidth=e,e=Bp(a.getAttribute("fixedHeight")),s(e)||(e=w(c,"fixedHeight")),d.fixedHeight=e,Oa(["Style","CRS","AuthorityURL"],function(a){s(w(c,a))&&ic(d,a)}),Oa("EX_GeographicBoundingBox BoundingBox Dimension Attribution MinScaleDenominator MaxScaleDenominator".split(" "),function(a){s(w(d,a))||(d[a]=w(c,a))}),d}})},void 0),rt=Y(ht,{Title:W(Ep),OnlineResource:W(Vs),LogoURL:W(et)},void 0),qt=Y(ht,{westBoundLongitude:W(Ap),eastBoundLongitude:W(Ap),southBoundLatitude:W(Ap),northBoundLatitude:W(Ap)},void 0),kt=Y(ht,{GetCapabilities:W(ct),GetMap:W(ct),GetFeatureInfo:W(ct)},void 0),dt=Y(ht,{Format:kp(Ep),DCPType:kp(function(a,b){return Z({},tt,a,b)})},void 0),tt=Y(ht,{HTTP:W(function(a,b){return Z({},ut,a,b)})},void 0),ut=Y(ht,{Get:W(at),Post:W(at)},void 0),st=Y(ht,{Name:W(Ep),Title:W(Ep),Abstract:W(Ep),LegendURL:kp(et),StyleSheetURL:W(at),StyleURL:W(at)},void 0),bt=Y(ht,{Format:W(Ep),OnlineResource:W(Vs)},void 0),gt=Y(ht,{Keyword:ip(Ep)},void 0);v(vt,He),l=vt.prototype,l.cc=!1,l.F=function(){vt.I.F.call(this),this.a.bc()},l.Ah=function(a){var b=a.N.dataTransfer;(this.cc=!(!b||!(b.types&&(0<=Na(b.types,"Files")||0<=Na(b.types,"public.file-url"))||b.files&&0<b.files.length)))&&a.preventDefault()},l.Bh=function(a){this.cc&&(a.preventDefault(),a.N.dataTransfer.dropEffect="none")},l.Ch=function(a){this.cc&&(a.preventDefault(),a.Ma(),a=a.N.dataTransfer,a.effectAllowed="all",a.dropEffect="copy")},l.Dh=function(a){this.cc&&(a.preventDefault(),a.Ma(),a=new Yd(a.N),a.type="drop",A(this,a))},l=wt.prototype,l.fb=!1,l.nc=!1,l.dd=!1,l.We=!1,l.Dd=!1,l.ed=0,l.cancel=function(a){if(this.fb)this.b instanceof wt&&this.b.cancel();else{if(this.d){var b=this.d;delete this.d,a?b.cancel(a):(b.ed--,0>=b.ed&&b.cancel())}this.f?this.f.call(this.e,this):this.Dd=!0,this.fb||(a=new xt(this),yt(this),zt(this,!1,a))}},l.Ld=function(a,b){this.dd=!1,zt(this,a,b)},v(Bt,Ba),Bt.prototype.message="Deferred has already fired",Bt.prototype.name="AlreadyCalledError",v(xt,Ba),xt.prototype.message="Deferred was canceled",xt.prototype.name="CanceledError",v(Dt,Ba),v(Ft,Qd),v(Gt,He),Gt.prototype.getError=function(){return this.Da.error&&new Dt(this.Da.error.code,"reading file")},Gt.prototype.a=function(a){A(this,new Ft(a,this))},Gt.prototype.F=function(){Gt.I.F.call(this),delete this.Da},v(It,ni),l=It.prototype,l.F=function(){s(this.a)&&re(this.a),It.I.F.call(this)},l.Ef=function(a){a=a.N.dataTransfer.files;var b,c,d;for(b=0,c=a.length;c>b;++b){d=a[b];var e;e=d;var f=new Gt,g=Ht(f);f.Da.readAsText(e,""),e=g,d=za(this.Yf,d),e.a.push([d,null,this]),e.fb&&At(e)}},l.Yf=function(a,b){var c=this.g,d=this.e;null===d&&(d=c.a().Y().i());var e,f,c=this.c,g=[];for(e=0,f=c.length;f>e;++e){var h,i=new c[e];try{h=i.bb(b)}catch(j){h=null}if(null!==h){var k,l,i=i.Ca(b),i=ai(i,d);for(k=0,l=h.length;l>k;++k){var m=h[k],n=m.M();null===n||n.transform(i),g.push(m)}}}A(this,new Jt(Kt,this,a,g,d))},l.za=Ae,l.setMap=function(a){s(this.a)&&(re(this.a),this.a=void 0),null!==this.b&&(Pd(this.b),this.b=null),It.I.setMap.call(this,a),null!==a&&(this.b=new vt(a.b),this.a=z(this.b,"drop",this.Ef,!1,this))};var Kt="addfeatures";v(Jt,Qd),v(Lt,Yb),Lt.prototype.Q=function(){return new Lt(this.x,this.y)},Lt.prototype.scale=Yb.prototype.scale,Lt.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},v(Mt,ri),Mt.prototype.jb=function(a){if(fg(a)){var b=a.map,c=b.e();a=a.pixel,a=new Lt(a[0]-c[0]/2,c[1]/2-a[1]),c=Math.atan2(a.y,a.x),a=Math.sqrt(a.x*a.x+a.y*a.y);var d=b.a().Y(),e=fi(d);b.R(),s(this.c)&&oi(b,d,e.rotation-(c-this.c)),this.c=c,s(this.a)&&qi(b,d,this.a*(e.resolution/a)),s(this.a)&&(this.e=this.a/a),this.a=a}},Mt.prototype.ab=function(a){if(!fg(a))return!0;a=a.map;var b=a.a();sg(b,-1);var b=b.Y(),c=fi(b),d=this.e-1,e=c.rotation,e=b.constrainRotation(e,0);return oi(a,b,e,void 0,void 0),c=c.resolution,c=b.constrainResolution(c,0,d),qi(a,b,c,void 0,400),this.e=0,!1},Mt.prototype.$a=function(a){return fg(a)&&this.f(a)?(sg(a.map.a(),1),this.a=this.c=void 0,!0):!1},Mt.prototype.Xc=Be,v(Nt,ri),l=Nt.prototype,l.ke=function(a){var b=a.M();s(this.n[b.G()])&&this.n[b.G()].call(this,a,b),a=this.g,null===a||Pt(this,this.w,a)},l.setMap=function(a){this.h.setMap(a),Nt.I.setMap.call(this,a)},l.Gf=function(a){this.ke(a.element)},l.Hf=function(a){var b=a.element;a=this.a;var c,d=[];for(Em(a,b.M().u(),function(a){b===a.feature&&d.push(a)}),c=d.length-1;c>=0;--c)a.remove(d[c]);null!==this.c&&0===this.l.xb()&&(this.h.Rc(this.c),this.c=null)},l.oi=function(a,b){var c=b.D(),c={feature:a,geometry:b,$:[c,c]};Im(this.a,b.u(),c)},l.mi=function(a,b){var c,d,e,f=b.D();for(d=0,e=f.length;e>d;++d)c=f[d],c={feature:a,geometry:b,depth:[d],index:d,$:[c,c]},Im(this.a,b.u(),c)},l.Ie=function(a,b){var c,d,e,f,g=b.D();for(c=0,d=g.length-1;d>c;++c)e=g.slice(c,c+2),f={feature:a,geometry:b,index:c,$:e},Im(this.a,tg(e),f)},l.li=function(a,b){var c,d,e,f,g,h,i,j=b.D();for(f=0,g=j.length;g>f;++f)for(c=j[f],d=0,e=c.length-1;e>d;++d)h=c.slice(d,d+2),i={feature:a,geometry:b,depth:[f],index:d,$:h},Im(this.a,tg(h),i)},l.pi=function(a,b){var c,d,e,f,g,h,i,j=b.D();for(f=0,g=j.length;g>f;++f)for(c=j[f],d=0,e=c.length-1;e>d;++d)h=c.slice(d,d+2),i={feature:a,geometry:b,depth:[f],index:d,$:h},Im(this.a,tg(h),i)},l.ni=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=b.D();for(h=0,i=m.length;i>h;++h)for(j=m[h],f=0,g=j.length;g>f;++f)for(c=j[f],d=0,e=c.length-1;e>d;++d)k=c.slice(d,d+2),l={feature:a,geometry:b,depth:[f,h],index:d,$:k},Im(this.a,tg(k),l)},l.ki=function(a,b){var c,d=b.a;for(c=0;c<d.length;++c)this.n[d[c].G()].call(this,a,d[c])},l.$a=function(a){Pt(this,a.pixel,a.map),this.e=[];var b=this.c;if(null!==b){a=[];var b=b.M().D(),c=tg([b]),d=[];Fm(this.a,c,function(a){d.push(a)},void 0);for(var c={},e=0,f=d.length;f>e;++e){var g=d[e],h=g.$;sa(g.feature)in c||(c[sa(g.feature)]=!0),$e(h[0],b)?this.e.push([g,0]):$e(h[1],b)?this.e.push([g,1]):sa(h)in this.A&&a.push([g,b])}for(e=a.length-1;e>=0;--e)this.eg.apply(this,a[e])}return null!==this.c},l.jb=function(a){a=a.coordinate;for(var b=0,c=this.e.length;c>b;++b){var d=this.e[b],e=d[0],f=e.depth,g=e.geometry,h=g.D(),i=e.$,d=d[1];switch(g.G()){case"Point":h=a,i[0]=i[1]=a;break;case"MultiPoint":h[e.index]=a,i[0]=i[1]=a;break;case"LineString":h[e.index+d]=a,i[d]=a;break;case"MultiLineString":h[f[0]][e.index+d]=a,i[d]=a;break;case"Polygon":h[f[0]][e.index+d]=a,i[d]=a;break;case"MultiPolygon":h[f[1]][f[0]][e.index+d]=a,i[d]=a}g.P(h),Qt(this,a)}},l.ab=function(){for(var a,b=this.e.length-1;b>=0;--b)a=this.e[b][0],this.a.update(tg(a.$),a);return!1},l.za=function(a){var b,c=a.map.a();if(Wa(c.h)[1]||a.type!=Yf||(this.w=a.pixel,Pt(this,a.pixel,a.map)),null!==this.c&&this.o&&this.B(a)){this.c.M(),b=this.e;var d,e,f,g,h,i,j,k,l,c={},m=!1;for(h=b.length-1;h>=0;--h)if(f=b[h],k=f[0],g=k.geometry,e=g.D(),l=sa(k.feature),d=j=i=void 0,0===f[1]?(j=k,i=k.index):1==f[1]&&(d=k,i=k.index+1),l in c||(c[l]=[d,j,i]),f=c[l],s(d)&&(f[0]=d),s(j)&&(f[1]=j),s(f[0])&&s(f[1])){switch(d=e,m=!1,j=i-1,g.G()){case"MultiLineString":e[k.depth[0]].splice(i,1),m=!0;break;case"LineString":e.splice(i,1),m=!0;break;case"MultiPolygon":d=d[k.depth[1]];case"Polygon":d=d[k.depth[0]],4<d.length&&(i==d.length-1&&(i=0),d.splice(i,1),m=!0,0===i&&(d.pop(),d.push(d[0]),j=d.length-1))}m&&(this.a.remove(f[0]),this.a.remove(f[1]),g.P(e),e={depth:k.depth,feature:k.feature,geometry:k.geometry,index:j,$:[f[0].$[0],f[1].$[1]]},Im(this.a,tg(e.$),e),Rt(this,g,i,k.depth,-1),this.h.Rc(this.c),this.c=null)}b=m}return Nt.I.za.call(this,a)&&!b},l.eg=function(a,b){var c,d=a.$,e=a.feature,f=a.geometry,g=a.depth,h=a.index;switch(f.G()){case"MultiLineString":c=f.D(),c[g[0]].splice(h+1,0,b);
break;case"Polygon":c=f.D(),c[g[0]].splice(h+1,0,b);break;case"MultiPolygon":c=f.D(),c[g[1]][g[0]].splice(h+1,0,b);break;case"LineString":c=f.D(),c.splice(h+1,0,b);break;default:return}f.P(c),c=this.a,c.remove(a),Rt(this,f,h,g,1);var i={$:[d[0],b],feature:e,geometry:f,depth:g,index:h};Im(c,tg(i.$),i),this.e.push([i,1]),d={$:[b,d[1]],feature:e,geometry:f,depth:g,index:h+1},Im(c,tg(d.$),d),this.e.push([d,0])},l.Xc=Be,v(St,ni),l=St.prototype,l.Rg=function(){return this.a.a},l.za=function(a){if(!this.e(a))return!0;var b=this.c(a),c=this.f(a),d=this.i(a),e=a.map,f=this.a.a;return b||c||d?e.td(a.pixel,function(a){var e=Na(f.a,a);-1==e?(b||d)&&f.push(a):(c||d)&&f.Uc(e)},void 0,this.b):(a=e.td(a.pixel,aa(),void 0,this.b),s(a)&&1==f.xb()&&f.Sd(0)==a||(0!==f.xb()&&f.clear(),s(a)&&f.push(a))),!1},l.setMap=function(a){var b=this.g,c=this.a.a;null===b||c.forEach(b.Vb,b),St.I.setMap.call(this,a),this.a.setMap(a),null===a||c.forEach(a.Ta,a)},l.Qg=function(a){a=a.element;var b=this.g;null===b||b.Ta(a)},l.Sh=function(a){a=a.element;var b=this.g;null===b||b.Vb(a)},v($,P);var Ut=["#00f","#0ff","#0f0","#ff0","#f00"];$.prototype.Ta=function(){return this.get("gradient")},$.prototype.getGradient=$.prototype.Ta,$.prototype.$c=function(){for(var a=this.Ta(),b=rd(1,256),c=b.createLinearGradient(0,0,1,256),d=1/(a.length-1),e=0,f=a.length;f>e;++e)c.addColorStop(e*d,a[e]);b.fillStyle=c,b.fillRect(0,0,1,256),this.ea=b.getImageData(0,0,1,256).data},$.prototype.ad=function(a){a=a.context;var b,c,d,e=a.canvas,e=a.getImageData(0,0,e.width,e.height),f=e.data;for(b=0,c=f.length;c>b;b+=4)(d=4*f[b+3])&&(f[b]=this.ea[d],f[b+1]=this.ea[d+1],f[b+2]=this.ea[d+2]);a.putImageData(e,0,0)},$.prototype.xc=function(a){this.v("gradient",a)},$.prototype.setGradient=$.prototype.xc;var Xt=new function(a,b){this.b=a,this.c=b,this.e=this.b*(1-this.c),this.a=2*b-b*b,this.d=Math.sqrt(this.a)}(6377397.155,1/299.15281285);v(Yt,Fh);var Zt=Xb(169028.66/3600),$t=Math.sin(Zt);Math.log(Math.tan(Math.PI/4+Math.asin($t/Math.sqrt(1+Xt.a*Math.pow(Math.cos(Zt),4)/(1-Xt.a)))/2)),Math.log(Math.tan(Math.PI/4+Zt/2)),Math.log((1+Xt.d*$t)/(1-Xt.d*$t)),Yt.prototype.c=aa(),v(au,Yt);var bu=[2485869.5728,1076443.1884,2837076.5648,1299941.7864];v(cu,Yt);var du=[485869.5728,76443.1884,837076.5648,299941.7864],ju=0,iu=1;v(hu,Ba);var mu=0;lu.prototype.cancel=function(a){a&&(a.$e&&a.$e.cancel(),a.Z&&qu(a.Z,!1))},v(xu,Hn),v(zu,Ok),l=zu.prototype,l.vd=function(){return this.c.Ka()>this.c.c},l.le=function(a){yu(this.c,a)},l.Ib=function(a,b,c,d,e){var f=this.hb(a,b,c);return Fn(this.c,f)?this.c.get(f):(a=new gb(a,b,c),d=this.tileUrlFunction(a,d,e),d=new this.tileClass(a,s(d)?0:4,s(d)?d:"",this.crossOrigin,this.tileLoadFunction),In(this.c,f,d),d)},l.pc=function(a){this.c.clear(),this.tileUrlFunction=a,this.k()},l.Ge=function(a,b,c){a=this.hb(a,b,c),Fn(this.c,a)&&this.c.get(a)},v(Bu,Hk),Bu.prototype.d=function(a){a=s(a)?a:{};var b=this.minZoom,c=this.maxZoom,d=s(a.wrapX)?a.wrapX:!0,e=new gb(0,0,0),f=null;if(s(a.extent)){var g,f=Array(c+1);for(g=0;c>=g;++g)f[g]=b>g?null:Kk(this,a.extent,g)}return function(a,g,h){if(g=a.a,b>g||g>c)return null;var i=Math.pow(2,g),j=a.x;if(d)j=Wb(j,i);else if(0>j||j>=i)return null;return a=a.y,-i>a||a>-1||null!==f&&(e.a=g,e.x=j,e.y=a,!f[g].contains(e))?null:hb(g,j,-a-1,h)}},Bu.prototype.Ic=function(a,b){return a.a<this.maxZoom?lb(2*a.x,2*(a.x+1),2*a.y,2*(a.y+1),b):null},Bu.prototype.Ec=function(a,b,c,d){for(d=lb(0,a.x,0,a.y,d),a=a.a-1;a>=this.minZoom;--a)if(d.a=d.c>>=1,d.b=d.d>>=1,b.call(c,a,d))return!0;return!1},v(Cu,zu);var Du=new mb({html:'<a class="ol-attribution-bing-tos" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a>'});Cu.prototype.e=function(a){if(200!=a.statusCode||"OK"!=a.statusDescription||"ValidCredentials"!=a.authenticationResultCode||1!=a.resourceSets.length||1!=a.resourceSets[0].resources.length)wk(this,2);else{var b=a.brandLogoUri,c=a.resourceSets[0].resources[0],d=new Bu({minZoom:c.zoomMin,maxZoom:c.zoomMax,tileSize:c.imageWidth});this.tileGrid=d;var e=this.b;if(this.tileUrlFunction=vu(d.d(),tu(Pa(c.imageUrlSubdomains,function(a){var b=c.imageUrl.replace("{subdomain}",a).replace("{culture}",e);return function(a){return null===a?void 0:b.replace("{quadkey}",jb(a))}}))),c.imageryProviders){var f=Ih($h("EPSG:4326"),this.l);a=Pa(c.imageryProviders,function(a){var b=a.attribution,c={};return Oa(a.coverageAreas,function(a){var b=a.zoomMin,e=a.zoomMax;a=a.bbox,a=Rg([a[1],a[0],a[3],a[2]],f);var g,h;for(g=b;e>=g;++g)h=g.toString(),b=Kk(d,a,g),h in c?c[h].push(b):c[h]=[b]}),new mb({html:b,tileRanges:c})}),a.push(Du),this.f=a}this.w=b,wk(this,1)}},Fu.prototype.a=null;var Iu;v(Ju,Fu),Iu=new Ju,v(Lu,He);var Mu="",Nu=/^https?$/i,Ou=["POST","PUT"];Lu.prototype.Ab=function(){"undefined"!=typeof da&&this.J&&(this.e="Timed out after "+this.g+"ms, aborting",this.b=8,A(this,"timeout"),this.J&&this.a&&(this.a=!1,this.d=!0,this.J.abort(),this.d=!1,this.b=8,A(this,"complete"),A(this,"abort"),Tu(this)))},Lu.prototype.F=function(){this.J&&(this.a&&(this.a=!1,this.d=!0,this.J.abort(),this.d=!1),Tu(this,!0)),Lu.I.F.call(this)},Lu.prototype.A=function(){if(!this.qb&&this.a&&"undefined"!=typeof da&&(!this.i[1]||4!=Vu(this)||2!=Wu(this)))if(this.t&&4==Vu(this))Eu(this.A,0,this);else if(A(this,"readystatechange"),4==Vu(this)){this.a=!1;try{if(Xu(this))A(this,"complete"),A(this,"success");else{this.b=6;var a;try{a=2<Vu(this)?this.J.statusText:""}catch(b){a=""}this.e=a+" ["+Wu(this)+"]",Uu(this)}}finally{Tu(this)}}},v($u,Lm),$u.prototype.e=function(a){var b=this.format,c=b.bb(a);if(a=b.Ca(a),b=this.l,null!==b&&null!==a&&a!==b&&(a.Fa!=b.Fa||Ih(a,b)!==Rh)){a=ai(a,b);var d,b=0;for(d=c.length;d>b;++b){var e=c[b].M();null===e||e.transform(a)}}return c},v(bv,$u),v(cv,bv),v(dv,bv),v(ev,bv),v(fv,Ek),fv.prototype.e=k("a"),v(gv,Al),gv.prototype.Nb=function(a,b,c,d){b=Bl(this,b);var e=this.h;return null!==e&&this.t==this.d&&e.c==b&&e.b==c&&Ag(e.u(),a)?e:(a=a.slice(),Pg(a,this.A),d=this.o(a,b,c,[Lg(a)/b*c,Jg(a)/b*c],d),null===d||(e=new fv(a,b,c,this.f,d)),this.h=e,this.t=this.d,e)},v(hv,Al),hv.prototype.Nb=function(a){return Mg(a,this.b.u())?this.b:null},v(iv,gv),l=iv.prototype,l.Xe=function(a,b,c,d){var e=new Ul(b/(2*c),a,b),f=!1;return this.c.Dc(a,b,function(a){var d;if(!(d=f))if(d=this.Ug(a,b),null!=d){var g,h,i=b*b/(4*c*c),j=!1;for(g=0,h=d.length;h>g;++g)j=tm(e,a,d[g],i,a,this.Wg,this)||j;d=j}else d=!1;f=d},this),Yl(e),f?null:(this.e[0]!=d[0]||this.e[1]!=d[1]?(this.b.canvas.width=d[0],this.b.canvas.height=d[1],this.e[0]=d[0],this.e[1]=d[1]):this.b.clearRect(0,0,d[0],d[1]),d=bl(this.B,d[0]/2,d[1]/2,c/b,-c/b,0,-Gg(a)[0],-Gg(a)[1]),Vl(e,this.b,a,c,d,0,{}),this.g=e,this.b.canvas)},l.Tc=function(a,b,c,d,e){return null===this.g?void 0:Xl(this.g,a,b,0,d,{},function(a,b){return e(b)})},l.Vg=k("c"),l.Wg=function(){this.k()},l.Xg=function(){wk(this,this.c.i)},v(jv,Al),l=jv.prototype,l.Yg=function(a,b,c,d){if(s(this.e)&&null!==this.b&&b==this.A&&(c===this.t||(c.Fa!=this.t.Fa?0:Ih(c,this.t)===Rh))){var e=this.b.u(),f=this.b.b,g={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:w(this.c,"LAYERS")};return lc(g,this.c,d),b/=f,d=Math.floor((e[3]-a[1])/b),g[this.g?"I":"X"]=Math.floor((a[0]-e[0])/b),g[this.g?"J":"Y"]=d,lv(this,e,this.h,f,c,g)}},l.Zg=k("c"),l.Nb=function(a,b,c,d){if(!s(this.e))return null;b=Bl(this,b),1==c||this.da&&s(this.C)||(c=1);var e=this.b;if(null!==e&&this.B==this.d&&e.c==b&&e.b==c&&Ag(e.u(),a))return e;e={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0},lc(e,this.c),a=a.slice();var f=(a[0]+a[2])/2,g=(a[1]+a[3])/2;if(1!=this.o){var h=this.o*Lg(a)/2,i=this.o*Jg(a)/2;a[0]=f-h,a[1]=g-i,a[2]=f+h,a[3]=g+i}var h=b/c,i=Math.ceil(Lg(a)/h),j=Math.ceil(Jg(a)/h);return a[0]=f-h*i/2,a[2]=f+h*i/2,a[1]=g-h*j/2,a[3]=g+h*j/2,this.h[0]=i,this.h[1]=j,e=lv(this,a,this.h,c,d,e),this.b=new Fk(a,b,c,this.f,e,this.V),this.t=d,this.A=b,this.B=this.d,this.b},l.$g=k("e"),l.ah=function(a){a!=this.e&&(this.e=a,this.b=null,this.k())},l.bh=function(a){lc(this.c,a),kv(this),this.b=null,this.k()},v(mv,bv),v(pv,Al),pv.prototype.Nb=function(a,b,c,d){b=Bl(this,b),c=this.o?c:1;var e=this.c;return null!==e&&e.c==b&&e.b==c&&Ag(e.u(),a)?e:(1!=this.e&&(a=a.slice(),Pg(a,this.e)),d=this.g(a,[Lg(a)/b*c,Jg(a)/b*c],d),this.c=e=s(d)?new Fk(a,b,c,this.f,d,this.t):null)},pv.prototype.A=function(a,b,c,d){var e;e=this.h;var f=Lg(c),g=Jg(c),h=d[0],i=d[1],j=.0254/this.b;return e=i*f>h*g?f*e/(h*j):g*e/(i*j),c=Gg(c),d={OPERATION:this.B?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol.source.MapGuide source",CLIP:"1",SETDISPLAYDPI:this.b,SETDISPLAYWIDTH:Math.round(d[0]),SETDISPLAYHEIGHT:Math.round(d[1]),SETVIEWSCALE:e,SETVIEWCENTERX:c[0],SETVIEWCENTERY:c[1]},lc(d,b),dj(fj([a],d))},v(qv,zu),qv.prototype.pc=function(a){qv.I.pc.call(this,vu(this.e,a))},qv.prototype.b=function(a){this.pc(su(wu(a)))},v(rv,qv);var tv=new mb({html:'Data &copy; <a href="http://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="http://www.openstreetmap.org/copyright">ODbL</a>'}),uv=new mb({html:'Tiles &copy; <a href="http://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA</a>'}),sv=[uv,tv];v(vv,qv);var xv=new mb({html:'Tiles Courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a>'}),wv={osm:{maxZoom:28,attributions:[xv,tv]},sat:{maxZoom:18,attributions:[xv,new mb({html:"Portions Courtesy NASA/JPL-Caltech and U.S. Depart. of Agriculture, Farm Service Agency"})]},hyb:{maxZoom:18,attributions:[xv,tv]}};v(yv,bv),v(zv,$u),zv.prototype.sa=function(a){var b,c,d=[];for(b=0,c=a.length;c>b;++b){var e=a[b],f=e.Z;f in this.g||(d.push(e),this.g[f]=!0)}zv.I.sa.call(this,d)},zv.prototype.rd=function(a,b,c){var d=this.h;a=this.o(a,b);var e,f;for(e=0,f=a.length;f>e;++e){var g=a[e];Fm(d,g,function(a){return Ag(a.extent,g)},void 0)||(this.n.call(this,g,b,c),Im(d,g,{extent:g.slice()}))}};var Av={terrain:{ua:"jpg",opaque:!0},"terrain-background":{ua:"jpg",opaque:!0},"terrain-labels":{ua:"png",opaque:!1},"terrain-lines":{ua:"png",opaque:!1},"toner-background":{ua:"png",opaque:!0},toner:{ua:"png",opaque:!0},"toner-hybrid":{ua:"png",opaque:!1},"toner-labels":{ua:"png",opaque:!1},"toner-lines":{ua:"png",opaque:!1},"toner-lite":{ua:"png",opaque:!0},watercolor:{ua:"jpg",opaque:!0}},Bv={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:3,maxZoom:16}};v(Cv,qv);var Dv=[new mb({html:'Map tiles by <a href="http://stamen.com/">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.'}),tv];v(Ev,Vj),Ev.prototype.b=function(a){if(a=s(a)?sa(a):-1,a in this.d)return this.d[a];var b=this.e,c=rd(b,b);return c.strokeStyle="black",c.strokeRect(.5,.5,b+.5,b+.5),c.fillStyle="black",c.textAlign="center",c.textBaseline="middle",c.font="24px sans-serif",c.fillText(this.f.toString(),b/2,b/2),this.d[a]=c.canvas},v(Fv,Ok),Fv.prototype.vd=function(){return this.b.Ka()>this.b.c},Fv.prototype.le=function(a){yu(this.b,a)},Fv.prototype.Ib=function(a,b,c){var d=this.hb(a,b,c);return Fn(this.b,d)?this.b.get(d):(a=new Ev(new gb(a,b,c),this.tileGrid),In(this.b,d,a),a)},v(Gv,zu),Gv.prototype.b=function(a){var b,c=$h("EPSG:4326");if(s(a.bounds)){var d=Ih(c,this.l);this.O=b=Rg(a.bounds,d)}var e=a.minzoom||0,d=a.maxzoom||22,f=new Bu({maxZoom:d,minZoom:e});if(this.tileGrid=f,this.tileUrlFunction=vu(f.d({extent:b}),su(a.tiles)),s(a.attribution)){c=s(b)?b:c.u(),b={};for(var g;d>=e;++e)g=e.toString(),b[g]=[Kk(f,c,e)];this.f=[new mb({html:a.attribution,tileRanges:b})]}wk(this,1)},v(Hv,$u),Hv.prototype.clear=function(){gc(this.h)},Hv.prototype.Dc=function(a,b,c,d){var e=this.n,f=this.h;b=jg(e.a,b,0),a=Kk(e,a,b);for(var g,e=a.a;e<=a.c;++e)for(g=a.b;g<=a.d;++g){var h=f[b+"/"+e+"/"+g];if(s(h)){var i,j;for(i=0,j=h.length;j>i;++i){var k=c.call(d,h[i]);if(k)return k}}}},Hv.prototype.Ba=function(){var a,b=this.h,c=[];for(a in b)Ya(c,b[a]);return c},Hv.prototype.rd=function(a,b,c){var d=this.o,e=this.n,f=this.g,g=this.h;b=jg(e.a,b,0),a=Kk(e,a,b);var h,i,e=new gb(b,0,0);for(h=a.a;h<=a.c;++h)for(i=a.b;i<=a.d;++i){var j=b+"/"+h+"/"+i;if(!(j in g)){e.a=b,e.x=h,e.y=i,d(e,c,e);var k=f(e,1,c);s(k)&&(g[j]=[],av(this,k,za(function(a,b){g[a]=b,wk(this,1)},j),this))}}},v(Iv,zu),l=Iv.prototype,l.dh=function(a,b,c,d){var e=this.h;if(!isNaN(this.h)){var f=this.tileGrid;if(null===f&&(f=Pk(this,c)),b=Mk(f,a[0],a[1],b,!1,void 0),!(f.a.length<=b.a)){var g=f.ca(b.a),h=Jk(f,b,this.B),f=f.ia(b.a),i=this.g;return 0!==i&&(f+=2*i,h=xg(h,g*i,h)),1!=e&&(f=f*e+.5|0),i={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:w(this.b,"LAYERS")},lc(i,this.b,d),d=Math.floor((h[3]-a[1])/(g/e)),i[this.e?"I":"X"]=Math.floor((a[0]-h[0])/(g/e)),i[this.e?"J":"Y"]=d,Lv(this,b,f,h,e,c,i)}}},l.Fc=k("g"),l.hb=function(a,b,c){return this.o+Iv.I.hb.call(this,a,b,c)},l.eh=k("b"),l.kc=function(a,b,c){return a=Iv.I.kc.call(this,a,b,c),1!=b&&this.A&&s(this.t)?a*b+.5|0:a},l.yf=k("n"),l.fh=function(a,b,c){var d=this.tileGrid;if(null===d&&(d=Pk(this,c)),!(d.a.length<=a.a)){1==b||this.A&&s(this.t)||(b=1);var e=d.ca(a.a),f=Jk(d,a,this.B),d=d.ia(a.a),g=this.g;if(0!==g&&(d+=2*g,f=xg(f,e*g,f)),e=this.u(),null===e||Mg(f,e)&&!Qg(f,e))return 1!=b&&(d=d*b+.5|0),e={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0},lc(e,this.b),this.h=b,Lv(this,a,d,f,b,c,e)}},l.gh=function(a){lc(this.b,a),Jv(this),Kv(this),this.k()},v(Mv,bv),v(Nv,Hk),Nv.prototype.i=k("c");var Pv="KVP";v(Qv,zu),Qv.prototype.g=k("b"),Qv.prototype.hb=function(a,b,c){return this.e+Qv.I.hb.call(this,a,b,c)},Qv.prototype.h=function(a){lc(this.b,a),Rv(this),this.k()},v(Sv,Hk),Sv.prototype.d=function(a){a=s(a)?a:{};var b=this.minZoom,c=this.maxZoom,d=new gb(0,0,0),e=null;if(s(a.extent)){var f,e=Array(c+1);for(f=0;c>=f;++f)e[f]=b>f?null:Kk(this,a.extent,f)}return function(a,f,g){if(f=a.a,b>f||f>c)return null;var h=Math.pow(2,f),i=a.x;return 0>i||i>=h?null:(a=a.y,-h>a||a>-1||null!==e&&(d.a=f,d.x=i,d.y=-a-1,!e[f].contains(d))?null:hb(f,i,-a-1,g))}},v(Tv,zu),v(Uv,bo),Uv.prototype.b=function(a){var b=s(a)?sa(a).toString():"";if(b in this.g)return this.g[b];if(a=Uv.I.b.call(this,a),2==this.state){if(256==a.width&&256==a.height)return this.g[b]=a;var c=rd(256,256);return c.drawImage(a,0,0),this.g[b]=c.canvas}return a},l=Vv.prototype,l.ff=k("a"),l.sh=k("d"),l.th=k("b"),l.uh=k("c"),l.vh=k("e"),l.wh=k("f"),l.vf=k("g"),l.wf=k("i"),t("ol.Attribution",mb),t("ol.BrowserFeature.DEVICE_PIXEL_RATIO",Ad),t("ol.BrowserFeature.HAS_CANVAS",Dd),t("ol.BrowserFeature.HAS_DEVICE_ORIENTATION",Ed),t("ol.BrowserFeature.HAS_GEOLOCATION",Fd),t("ol.BrowserFeature.HAS_TOUCH",Hd),t("ol.Collection",D),D.prototype.bindTo=D.prototype.W,D.prototype.clear=D.prototype.clear,D.prototype.dispatchChangeEvent=D.prototype.k,D.prototype.extend=D.prototype.wg,D.prototype.forEach=D.prototype.forEach,D.prototype.get=D.prototype.get,D.prototype.getArray=D.prototype.xg,D.prototype.getAt=D.prototype.Sd,D.prototype.getKeys=D.prototype.K,D.prototype.getLength=D.prototype.xb,D.prototype.getProperties=D.prototype.S,D.prototype.insertAt=D.prototype.Lc,D.prototype.notify=D.prototype.T,D.prototype.on=D.prototype.p,D.prototype.once=D.prototype.q,D.prototype.pop=D.prototype.pop,D.prototype.push=D.prototype.push,D.prototype.remove=D.prototype.remove,D.prototype.removeAt=D.prototype.Uc,D.prototype.set=D.prototype.v,D.prototype.setAt=D.prototype.$h,D.prototype.setValues=D.prototype.H,D.prototype.un=D.prototype.r,D.prototype.unByKey=D.prototype.s,D.prototype.unbind=D.prototype.U,D.prototype.unbindAll=D.prototype.X,t("ol.DeviceOrientation",F),F.prototype.bindTo=F.prototype.W,F.prototype.dispatchChangeEvent=F.prototype.k,F.prototype.get=F.prototype.get,F.prototype.getAlpha=F.prototype.e,F.prototype.getBeta=F.prototype.f,F.prototype.getGamma=F.prototype.g,F.prototype.getHeading=F.prototype.i,F.prototype.getKeys=F.prototype.K,F.prototype.getProperties=F.prototype.S,F.prototype.getTracking=F.prototype.c,F.prototype.notify=F.prototype.T,F.prototype.on=F.prototype.p,F.prototype.once=F.prototype.q,F.prototype.set=F.prototype.v,F.prototype.setTracking=F.prototype.b,F.prototype.setValues=F.prototype.H,F.prototype.un=F.prototype.r,F.prototype.unByKey=F.prototype.s,F.prototype.unbind=F.prototype.U,F.prototype.unbindAll=F.prototype.X,t("ol.Feature",I),I.prototype.bindTo=I.prototype.W,I.prototype.dispatchChangeEvent=I.prototype.k,I.prototype.get=I.prototype.get,I.prototype.getGeometry=I.prototype.M,I.prototype.getGeometryName=I.prototype.hf,I.prototype.getId=I.prototype.jf,I.prototype.getKeys=I.prototype.K,I.prototype.getProperties=I.prototype.S,I.prototype.getStyle=I.prototype.Dg,I.prototype.getStyleFunction=I.prototype.Eg,I.prototype.notify=I.prototype.T,I.prototype.on=I.prototype.p,I.prototype.once=I.prototype.q,I.prototype.set=I.prototype.v,I.prototype.setGeometry=I.prototype.pb,I.prototype.setGeometryName=I.prototype.i,I.prototype.setId=I.prototype.b,I.prototype.setStyle=I.prototype.g,I.prototype.setValues=I.prototype.H,I.prototype.un=I.prototype.r,I.prototype.unByKey=I.prototype.s,I.prototype.unbind=I.prototype.U,I.prototype.unbindAll=I.prototype.X,t("ol.FeatureOverlay",Ti),Ti.prototype.addFeature=Ti.prototype.fe,Ti.prototype.getFeatures=Ti.prototype.yg,Ti.prototype.getStyle=Ti.prototype.zg,Ti.prototype.getStyleFunction=Ti.prototype.Ag,Ti.prototype.removeFeature=Ti.prototype.Rc,Ti.prototype.setFeatures=Ti.prototype.tc,Ti.prototype.setMap=Ti.prototype.setMap,Ti.prototype.setStyle=Ti.prototype.Cg,t("ol.Geolocation",R),R.prototype.bindTo=R.prototype.W,R.prototype.dispatchChangeEvent=R.prototype.k,R.prototype.get=R.prototype.get,R.prototype.getAccuracy=R.prototype.Rd,R.prototype.getAccuracyGeometry=R.prototype.n,R.prototype.getAltitude=R.prototype.o,R.prototype.getAltitudeAccuracy=R.prototype.w,R.prototype.getHeading=R.prototype.B,R.prototype.getKeys=R.prototype.K,R.prototype.getPosition=R.prototype.C,R.prototype.getProjection=R.prototype.g,R.prototype.getProperties=R.prototype.S,R.prototype.getSpeed=R.prototype.A,R.prototype.getTracking=R.prototype.i,R.prototype.getTrackingOptions=R.prototype.f,R.prototype.notify=R.prototype.T,R.prototype.on=R.prototype.p,R.prototype.once=R.prototype.q,R.prototype.set=R.prototype.v,R.prototype.setProjection=R.prototype.h,R.prototype.setTracking=R.prototype.e,R.prototype.setTrackingOptions=R.prototype.l,R.prototype.setValues=R.prototype.H,R.prototype.un=R.prototype.r,R.prototype.unByKey=R.prototype.s,R.prototype.unbind=R.prototype.U,R.prototype.unbindAll=R.prototype.X,bo.prototype.getImage=bo.prototype.b,bo.prototype.getTileCoord=bo.prototype.i,t("ol.Kinetic",ik),t("ol.Map",Q),Q.prototype.addControl=Q.prototype.Ne,Q.prototype.addInteraction=Q.prototype.Oe,Q.prototype.addLayer=Q.prototype.Pe,Q.prototype.addOverlay=Q.prototype.Qe,Q.prototype.beforeRender=Q.prototype.Ha,Q.prototype.bindTo=Q.prototype.W,Q.prototype.dispatchChangeEvent=Q.prototype.k,Q.prototype.forEachFeatureAtPixel=Q.prototype.td,Q.prototype.get=Q.prototype.get,Q.prototype.getControls=Q.prototype.ef,Q.prototype.getCoordinateFromPixel=Q.prototype.va,Q.prototype.getEventCoordinate=Q.prototype.Td,Q.prototype.getEventPixel=Q.prototype.kd,Q.prototype.getInteractions=Q.prototype.kf,Q.prototype.getKeys=Q.prototype.K,Q.prototype.getLayerGroup=Q.prototype.ib,Q.prototype.getLayers=Q.prototype.Ke,Q.prototype.getOverlays=Q.prototype.sf,Q.prototype.getPixelFromCoordinate=Q.prototype.f,Q.prototype.getProperties=Q.prototype.S,Q.prototype.getSize=Q.prototype.e,Q.prototype.getTarget=Q.prototype.oc,Q.prototype.getView=Q.prototype.a,Q.prototype.getViewport=Q.prototype.zf,Q.prototype.notify=Q.prototype.T,Q.prototype.on=Q.prototype.p,Q.prototype.once=Q.prototype.q,Q.prototype.removeControl=Q.prototype.Rh,Q.prototype.removeInteraction=Q.prototype.Th,Q.prototype.removeLayer=Q.prototype.Uh,Q.prototype.removeOverlay=Q.prototype.Vh,Q.prototype.render=Q.prototype.R,Q.prototype.renderSync=Q.prototype.Xh,Q.prototype.set=Q.prototype.v,Q.prototype.setLayerGroup=Q.prototype.Ae,Q.prototype.setSize=Q.prototype.B,Q.prototype.setTarget=Q.prototype.ra,Q.prototype.setValues=Q.prototype.H,Q.prototype.setView=Q.prototype.Sa,Q.prototype.un=Q.prototype.r,Q.prototype.unByKey=Q.prototype.s,Q.prototype.unbind=Q.prototype.U,Q.prototype.unbindAll=Q.prototype.X,Q.prototype.updateSize=Q.prototype.C,Nf.prototype.preventDefault=Nf.prototype.preventDefault,Nf.prototype.stopPropagation=Nf.prototype.Ma,Of.prototype.preventDefault=Of.prototype.preventDefault,Of.prototype.stopPropagation=Of.prototype.Ma,t("ol.Object",Me),Me.prototype.bindTo=Me.prototype.W,Me.prototype.dispatchChangeEvent=Me.prototype.k,Me.prototype.get=Me.prototype.get,Me.prototype.getKeys=Me.prototype.K,Me.prototype.getProperties=Me.prototype.S,Me.prototype.notify=Me.prototype.T,Me.prototype.on=Me.prototype.p,Me.prototype.once=Me.prototype.q,Me.prototype.set=Me.prototype.v,Me.prototype.setValues=Me.prototype.H,Me.prototype.un=Me.prototype.r,Me.prototype.unByKey=Me.prototype.s,Me.prototype.unbind=Me.prototype.U,Me.prototype.unbindAll=Me.prototype.X,t("ol.Observable",Je),Je.prototype.dispatchChangeEvent=Je.prototype.k,Je.prototype.on=Je.prototype.p,Je.prototype.once=Je.prototype.q,Je.prototype.un=Je.prototype.r,Je.prototype.unByKey=Je.prototype.s,t("ol.Overlay",U),U.prototype.bindTo=U.prototype.W,U.prototype.dispatchChangeEvent=U.prototype.k,U.prototype.get=U.prototype.get,U.prototype.getElement=U.prototype.g,U.prototype.getKeys=U.prototype.K,U.prototype.getMap=U.prototype.e,U.prototype.getPosition=U.prototype.i,U.prototype.getPositioning=U.prototype.f,U.prototype.getProperties=U.prototype.S,U.prototype.notify=U.prototype.T,U.prototype.on=U.prototype.p,U.prototype.once=U.prototype.q,U.prototype.set=U.prototype.v,U.prototype.setElement=U.prototype.Cd,U.prototype.setMap=U.prototype.setMap,U.prototype.setPosition=U.prototype.h,U.prototype.setPositioning=U.prototype.l,U.prototype.setValues=U.prototype.H,U.prototype.un=U.prototype.r,U.prototype.unByKey=U.prototype.s,U.prototype.unbind=U.prototype.U,U.prototype.unbindAll=U.prototype.X,Ah.prototype.circle=Ah.prototype.a,Vj.prototype.getTileCoord=Vj.prototype.i,gb.prototype.getZXY=gb.prototype.d,rg.prototype.bindTo=rg.prototype.W,rg.prototype.dispatchChangeEvent=rg.prototype.k,rg.prototype.get=rg.prototype.get,rg.prototype.getKeys=rg.prototype.K,rg.prototype.getProperties=rg.prototype.S,rg.prototype.notify=rg.prototype.T,rg.prototype.on=rg.prototype.p,rg.prototype.once=rg.prototype.q,rg.prototype.set=rg.prototype.v,rg.prototype.setValues=rg.prototype.H,rg.prototype.un=rg.prototype.r,rg.prototype.unByKey=rg.prototype.s,rg.prototype.unbind=rg.prototype.U,rg.prototype.unbindAll=rg.prototype.X,t("ol.View2D",H),H.prototype.bindTo=H.prototype.W,H.prototype.calculateExtent=H.prototype.w,H.prototype.centerOn=H.prototype.Ye,H.prototype.constrainResolution=H.prototype.constrainResolution,H.prototype.constrainRotation=H.prototype.constrainRotation,H.prototype.dispatchChangeEvent=H.prototype.k,H.prototype.fitExtent=H.prototype.Qd,H.prototype.fitGeometry=H.prototype.cf,H.prototype.get=H.prototype.get,H.prototype.getCenter=H.prototype.a,H.prototype.getKeys=H.prototype.K,H.prototype.getProjection=H.prototype.i,H.prototype.getProperties=H.prototype.S,H.prototype.getResolution=H.prototype.b,H.prototype.getRotation=H.prototype.e,H.prototype.getView2D=H.prototype.Y,H.prototype.getZoom=H.prototype.Bf,H.prototype.notify=H.prototype.T,H.prototype.on=H.prototype.p,H.prototype.once=H.prototype.q,H.prototype.rotate=H.prototype.ie,H.prototype.set=H.prototype.v,H.prototype.setCenter=H.prototype.ya,H.prototype.setProjection=H.prototype.o,H.prototype.setResolution=H.prototype.c,H.prototype.setRotation=H.prototype.n,H.prototype.setValues=H.prototype.H,H.prototype.setZoom=H.prototype.A,H.prototype.un=H.prototype.r,H.prototype.unByKey=H.prototype.s,H.prototype.unbind=H.prototype.U,H.prototype.unbindAll=H.prototype.X,t("ol.animation.bounce",function(a){var b=a.resolution,c=s(a.start)?a.start:Aa(),d=s(a.duration)?a.duration:1e3,e=s(a.easing)?a.easing:ji;return function(a,f){if(f.time<c)return f.animate=!0,f.viewHints[0]+=1,!0;if(f.time<c+d){var g=e((f.time-c)/d),h=b-f.view2DState.resolution;return f.animate=!0,f.view2DState.resolution+=g*h,f.viewHints[0]+=1,!0}return!1}}),t("ol.animation.pan",ki),t("ol.animation.rotate",li),t("ol.animation.zoom",mi),t("ol.color.asArray",function(a){return ma(a)?a:Fi(a)}),t("ol.color.asString",Di),t("ol.control.Attribution",ek),ek.prototype.bindTo=ek.prototype.W,ek.prototype.dispatchChangeEvent=ek.prototype.k,ek.prototype.get=ek.prototype.get,ek.prototype.getKeys=ek.prototype.K,ek.prototype.getMap=ek.prototype.b,ek.prototype.getProperties=ek.prototype.S,ek.prototype.notify=ek.prototype.T,ek.prototype.on=ek.prototype.p,ek.prototype.once=ek.prototype.q,ek.prototype.set=ek.prototype.v,ek.prototype.setMap=ek.prototype.setMap,ek.prototype.setValues=ek.prototype.H,ek.prototype.un=ek.prototype.r,ek.prototype.unByKey=ek.prototype.s,ek.prototype.unbind=ek.prototype.U,ek.prototype.unbindAll=ek.prototype.X,t("ol.control.Control",dk),dk.prototype.bindTo=dk.prototype.W,dk.prototype.dispatchChangeEvent=dk.prototype.k,dk.prototype.get=dk.prototype.get,dk.prototype.getKeys=dk.prototype.K,dk.prototype.getMap=dk.prototype.b,dk.prototype.getProperties=dk.prototype.S,dk.prototype.notify=dk.prototype.T,dk.prototype.on=dk.prototype.p,dk.prototype.once=dk.prototype.q,dk.prototype.set=dk.prototype.v,dk.prototype.setMap=dk.prototype.setMap,dk.prototype.setValues=dk.prototype.H,dk.prototype.un=dk.prototype.r,dk.prototype.unByKey=dk.prototype.s,dk.prototype.unbind=dk.prototype.U,dk.prototype.unbindAll=dk.prototype.X,t("ol.control.FullScreen",io),io.prototype.bindTo=io.prototype.W,io.prototype.dispatchChangeEvent=io.prototype.k,io.prototype.get=io.prototype.get,io.prototype.getKeys=io.prototype.K,io.prototype.getMap=io.prototype.b,io.prototype.getProperties=io.prototype.S,io.prototype.notify=io.prototype.T,io.prototype.on=io.prototype.p,io.prototype.once=io.prototype.q,io.prototype.set=io.prototype.v,io.prototype.setMap=io.prototype.setMap,io.prototype.setValues=io.prototype.H,io.prototype.un=io.prototype.r,io.prototype.unByKey=io.prototype.s,io.prototype.unbind=io.prototype.U,io.prototype.unbindAll=io.prototype.X,t("ol.control.Logo",fk),fk.prototype.bindTo=fk.prototype.W,fk.prototype.dispatchChangeEvent=fk.prototype.k,fk.prototype.get=fk.prototype.get,fk.prototype.getKeys=fk.prototype.K,fk.prototype.getMap=fk.prototype.b,fk.prototype.getProperties=fk.prototype.S,fk.prototype.notify=fk.prototype.T,fk.prototype.on=fk.prototype.p,fk.prototype.once=fk.prototype.q,fk.prototype.set=fk.prototype.v,fk.prototype.setMap=fk.prototype.setMap,fk.prototype.setValues=fk.prototype.H,fk.prototype.un=fk.prototype.r,fk.prototype.unByKey=fk.prototype.s,fk.prototype.unbind=fk.prototype.U,fk.prototype.unbindAll=fk.prototype.X,t("ol.control.MousePosition",V),V.prototype.bindTo=V.prototype.W,V.prototype.dispatchChangeEvent=V.prototype.k,V.prototype.get=V.prototype.get,V.prototype.getCoordinateFormat=V.prototype.h,V.prototype.getKeys=V.prototype.K,V.prototype.getMap=V.prototype.b,V.prototype.getProjection=V.prototype.n,V.prototype.getProperties=V.prototype.S,V.prototype.notify=V.prototype.T,V.prototype.on=V.prototype.p,V.prototype.once=V.prototype.q,V.prototype.set=V.prototype.v,V.prototype.setCoordinateFormat=V.prototype.w,V.prototype.setMap=V.prototype.setMap,V.prototype.setProjection=V.prototype.o,V.prototype.setValues=V.prototype.H,V.prototype.un=V.prototype.r,V.prototype.unByKey=V.prototype.s,V.prototype.unbind=V.prototype.U,V.prototype.unbindAll=V.prototype.X,t("ol.control.ScaleLine",ko),ko.prototype.bindTo=ko.prototype.W,ko.prototype.dispatchChangeEvent=ko.prototype.k,ko.prototype.get=ko.prototype.get,ko.prototype.getKeys=ko.prototype.K,ko.prototype.getMap=ko.prototype.b,ko.prototype.getProperties=ko.prototype.S,ko.prototype.getUnits=ko.prototype.n,ko.prototype.notify=ko.prototype.T,ko.prototype.on=ko.prototype.p,ko.prototype.once=ko.prototype.q,ko.prototype.set=ko.prototype.v,ko.prototype.setMap=ko.prototype.setMap,ko.prototype.setUnits=ko.prototype.o,ko.prototype.setValues=ko.prototype.H,ko.prototype.un=ko.prototype.r,ko.prototype.unByKey=ko.prototype.s,ko.prototype.unbind=ko.prototype.U,ko.prototype.unbindAll=ko.prototype.X,t("ol.control.Zoom",gk),gk.prototype.bindTo=gk.prototype.W,gk.prototype.dispatchChangeEvent=gk.prototype.k,gk.prototype.get=gk.prototype.get,gk.prototype.getKeys=gk.prototype.K,gk.prototype.getMap=gk.prototype.b,gk.prototype.getProperties=gk.prototype.S,gk.prototype.notify=gk.prototype.T,gk.prototype.on=gk.prototype.p,gk.prototype.once=gk.prototype.q,gk.prototype.set=gk.prototype.v,gk.prototype.setMap=gk.prototype.setMap,gk.prototype.setValues=gk.prototype.H,gk.prototype.un=gk.prototype.r,gk.prototype.unByKey=gk.prototype.s,gk.prototype.unbind=gk.prototype.U,gk.prototype.unbindAll=gk.prototype.X,t("ol.control.ZoomSlider",zo),zo.prototype.bindTo=zo.prototype.W,zo.prototype.dispatchChangeEvent=zo.prototype.k,zo.prototype.get=zo.prototype.get,zo.prototype.getKeys=zo.prototype.K,zo.prototype.getMap=zo.prototype.b,zo.prototype.getProperties=zo.prototype.S,zo.prototype.notify=zo.prototype.T,zo.prototype.on=zo.prototype.p,zo.prototype.once=zo.prototype.q,zo.prototype.set=zo.prototype.v,zo.prototype.setValues=zo.prototype.H,zo.prototype.un=zo.prototype.r,zo.prototype.unByKey=zo.prototype.s,zo.prototype.unbind=zo.prototype.U,zo.prototype.unbindAll=zo.prototype.X,t("ol.control.ZoomToExtent",Do),Do.prototype.bindTo=Do.prototype.W,Do.prototype.dispatchChangeEvent=Do.prototype.k,Do.prototype.get=Do.prototype.get,Do.prototype.getKeys=Do.prototype.K,Do.prototype.getMap=Do.prototype.b,Do.prototype.getProperties=Do.prototype.S,Do.prototype.notify=Do.prototype.T,Do.prototype.on=Do.prototype.p,Do.prototype.once=Do.prototype.q,Do.prototype.set=Do.prototype.v,Do.prototype.setMap=Do.prototype.setMap,Do.prototype.setValues=Do.prototype.H,Do.prototype.un=Do.prototype.r,Do.prototype.unByKey=Do.prototype.s,Do.prototype.unbind=Do.prototype.U,Do.prototype.unbindAll=Do.prototype.X,t("ol.control.defaults",hk),t("ol.coordinate.add",We),t("ol.coordinate.createStringXY",function(a){return function(b){return cf(b,a)}}),t("ol.coordinate.format",Ze),t("ol.coordinate.fromProjectedArray",function(a,b){var c=b.charAt(0);return"n"===c||"s"===c?[a[1],a[0]]:a}),t("ol.coordinate.rotate",af),t("ol.coordinate.toStringHDMS",function(a){return s(a)?Ye(a[1],"NS")+" "+Ye(a[0],"EW"):""}),t("ol.coordinate.toStringXY",cf),t("ol.dom.Input",Eo),Eo.prototype.bindTo=Eo.prototype.W,Eo.prototype.dispatchChangeEvent=Eo.prototype.k,Eo.prototype.get=Eo.prototype.get,Eo.prototype.getChecked=Eo.prototype.b,Eo.prototype.getKeys=Eo.prototype.K,Eo.prototype.getProperties=Eo.prototype.S,Eo.prototype.getValue=Eo.prototype.c,Eo.prototype.notify=Eo.prototype.T,Eo.prototype.on=Eo.prototype.p,Eo.prototype.once=Eo.prototype.q,Eo.prototype.set=Eo.prototype.v,Eo.prototype.setChecked=Eo.prototype.e,Eo.prototype.setValue=Eo.prototype.f,Eo.prototype.setValues=Eo.prototype.H,Eo.prototype.un=Eo.prototype.r,Eo.prototype.unByKey=Eo.prototype.s,Eo.prototype.unbind=Eo.prototype.U,Eo.prototype.unbindAll=Eo.prototype.X,t("ol.easing.bounce",function(a){return 1/2.75>a?a*=7.5625*a:2/2.75>a?(a-=1.5/2.75,a=7.5625*a*a+.75):2.5/2.75>a?(a-=2.25/2.75,a=7.5625*a*a+.9375):(a-=2.625/2.75,a=7.5625*a*a+.984375),a}),t("ol.easing.easeIn",function(a){return a*a*a}),t("ol.easing.easeOut",gi),t("ol.easing.elastic",function(a){return Math.pow(2,-10*a)*Math.sin(2*(a-.075)*Math.PI/.3)+1}),t("ol.easing.inAndOut",hi),t("ol.easing.linear",ii),t("ol.easing.upAndDown",ji),t("ol.events.condition.altKeyOnly",function(a){return a=a.a,a.na&&!a.Pb&&!a.Za}),t("ol.events.condition.altShiftKeysOnly",ag),t("ol.events.condition.always",Ae),t("ol.events.condition.never",ze),t("ol.events.condition.noModifierKeys",cg),t("ol.events.condition.platformModifierKeyOnly",function(a){return a=a.a,!a.na&&a.Pb&&!a.Za}),t("ol.events.condition.shiftKeyOnly",dg),t("ol.events.condition.targetNotEditable",eg),t("ol.extent.boundingExtent",tg),t("ol.extent.buffer",xg),t("ol.extent.containsCoordinate",function(a,b){return a[0]<=b[0]&&b[0]<=a[2]&&a[1]<=b[1]&&b[1]<=a[3]
}),t("ol.extent.containsExtent",Ag),t("ol.extent.createEmpty",ug),t("ol.extent.equals",Cg),t("ol.extent.extend",Dg),t("ol.extent.getBottomLeft",Fg),t("ol.extent.getBottomRight",function(a){return[a[2],a[1]]}),t("ol.extent.getCenter",Gg),t("ol.extent.getHeight",Jg),t("ol.extent.getSize",function(a){return[a[2]-a[0],a[3]-a[1]]}),t("ol.extent.getTopLeft",Kg),t("ol.extent.getTopRight",function(a){return[a[2],a[3]]}),t("ol.extent.getWidth",Lg),t("ol.extent.intersects",Mg),t("ol.extent.isEmpty",Ng),t("ol.extent.transform",Rg),t("ol.format.GPX",Ip),Ip.prototype.readFeature=Ip.prototype.Rb,Ip.prototype.readFeatures=Ip.prototype.bb,Ip.prototype.readProjection=Ip.prototype.Ca,Ip.prototype.writeFeatures=Ip.prototype.Zc,t("ol.format.GeoJSON",qq),qq.prototype.readFeature=qq.prototype.Rb,qq.prototype.readFeatures=qq.prototype.bb,qq.prototype.readGeometry=qq.prototype.zd,qq.prototype.readProjection=qq.prototype.Ca,qq.prototype.writeFeature=qq.prototype.Id,qq.prototype.writeFeatures=qq.prototype.Zc,t("ol.format.IGC",zq),zq.prototype.readFeature=zq.prototype.Rb,zq.prototype.readFeatures=zq.prototype.bb,zq.prototype.readProjection=zq.prototype.Ca,t("ol.format.KML",Dq),Dq.prototype.readFeature=Dq.prototype.Rb,Dq.prototype.readFeatures=Dq.prototype.bb,Dq.prototype.readProjection=Dq.prototype.Ca,t("ol.format.OSMXML",ur),t("ol.format.TopoJSON",Ar),Ar.prototype.readFeatures=Ar.prototype.bb,Ar.prototype.readProjection=Ar.prototype.Ca,t("ol.format.WFS",Is),Is.prototype.readFeatureCollectionMetadata=Is.prototype.c,Is.prototype.readTransactionResponse=Is.prototype.f,Is.prototype.writeGetFeature=Is.prototype.g,Is.prototype.writeTransaction=Is.prototype.i,t("ol.format.WMSCapabilities",Zs),Zs.prototype.read=Zs.prototype.a,t("ol.geom.Circle",am),am.prototype.clone=am.prototype.Q,am.prototype.dispatchChangeEvent=am.prototype.k,am.prototype.getCenter=am.prototype.ud,am.prototype.getClosestPoint=am.prototype.e,am.prototype.getExtent=am.prototype.u,am.prototype.getFirstCoordinate=am.prototype.Va,am.prototype.getLastCoordinate=am.prototype.Wa,am.prototype.getLayout=am.prototype.Xa,am.prototype.getRadius=am.prototype.je,am.prototype.getSimplifiedGeometry=am.prototype.ha,am.prototype.getType=am.prototype.G,am.prototype.on=am.prototype.p,am.prototype.once=am.prototype.q,am.prototype.setCenter=am.prototype.Jg,am.prototype.setCenterAndRadius=am.prototype.ye,am.prototype.setRadius=am.prototype.ai,am.prototype.un=am.prototype.r,am.prototype.unByKey=am.prototype.s,t("ol.geom.Geometry",Sg),Sg.prototype.dispatchChangeEvent=Sg.prototype.k,Sg.prototype.getClosestPoint=Sg.prototype.e,Sg.prototype.getExtent=Sg.prototype.u,Sg.prototype.on=Sg.prototype.p,Sg.prototype.once=Sg.prototype.q,Sg.prototype.un=Sg.prototype.r,Sg.prototype.unByKey=Sg.prototype.s,t("ol.geom.GeometryCollection",cm),cm.prototype.clone=cm.prototype.Q,cm.prototype.dispatchChangeEvent=cm.prototype.k,cm.prototype.getClosestPoint=cm.prototype.e,cm.prototype.getExtent=cm.prototype.u,cm.prototype.getGeometries=cm.prototype.gf,cm.prototype.getSimplifiedGeometry=cm.prototype.ha,cm.prototype.getType=cm.prototype.G,cm.prototype.on=cm.prototype.p,cm.prototype.once=cm.prototype.q,cm.prototype.setGeometries=cm.prototype.ze,cm.prototype.un=cm.prototype.r,cm.prototype.unByKey=cm.prototype.s,t("ol.geom.LineString",jm),jm.prototype.appendCoordinate=jm.prototype.Re,jm.prototype.clone=jm.prototype.Q,jm.prototype.dispatchChangeEvent=jm.prototype.k,jm.prototype.getClosestPoint=jm.prototype.e,jm.prototype.getCoordinateAtM=jm.prototype.Kg,jm.prototype.getCoordinates=jm.prototype.D,jm.prototype.getExtent=jm.prototype.u,jm.prototype.getFirstCoordinate=jm.prototype.Va,jm.prototype.getLastCoordinate=jm.prototype.Wa,jm.prototype.getLayout=jm.prototype.Xa,jm.prototype.getLength=jm.prototype.Lg,jm.prototype.getSimplifiedGeometry=jm.prototype.ha,jm.prototype.getType=jm.prototype.G,jm.prototype.on=jm.prototype.p,jm.prototype.once=jm.prototype.q,jm.prototype.setCoordinates=jm.prototype.P,jm.prototype.transform=jm.prototype.transform,jm.prototype.un=jm.prototype.r,jm.prototype.unByKey=jm.prototype.s,t("ol.geom.LinearRing",nh),nh.prototype.clone=nh.prototype.Q,nh.prototype.dispatchChangeEvent=nh.prototype.k,nh.prototype.getArea=nh.prototype.Mg,nh.prototype.getClosestPoint=nh.prototype.e,nh.prototype.getCoordinates=nh.prototype.D,nh.prototype.getExtent=nh.prototype.u,nh.prototype.getFirstCoordinate=nh.prototype.Va,nh.prototype.getLastCoordinate=nh.prototype.Wa,nh.prototype.getLayout=nh.prototype.Xa,nh.prototype.getSimplifiedGeometry=nh.prototype.ha,nh.prototype.getType=nh.prototype.G,nh.prototype.on=nh.prototype.p,nh.prototype.once=nh.prototype.q,nh.prototype.setCoordinates=nh.prototype.P,nh.prototype.transform=nh.prototype.transform,nh.prototype.un=nh.prototype.r,nh.prototype.unByKey=nh.prototype.s,t("ol.geom.MultiLineString",lm),lm.prototype.appendLineString=lm.prototype.Se,lm.prototype.clone=lm.prototype.Q,lm.prototype.dispatchChangeEvent=lm.prototype.k,lm.prototype.getClosestPoint=lm.prototype.e,lm.prototype.getCoordinateAtM=lm.prototype.Ng,lm.prototype.getCoordinates=lm.prototype.D,lm.prototype.getExtent=lm.prototype.u,lm.prototype.getFirstCoordinate=lm.prototype.Va,lm.prototype.getLastCoordinate=lm.prototype.Wa,lm.prototype.getLayout=lm.prototype.Xa,lm.prototype.getLineString=lm.prototype.pf,lm.prototype.getLineStrings=lm.prototype.ld,lm.prototype.getSimplifiedGeometry=lm.prototype.ha,lm.prototype.getType=lm.prototype.G,lm.prototype.on=lm.prototype.p,lm.prototype.once=lm.prototype.q,lm.prototype.setCoordinates=lm.prototype.P,lm.prototype.transform=lm.prototype.transform,lm.prototype.un=lm.prototype.r,lm.prototype.unByKey=lm.prototype.s,t("ol.geom.MultiPoint",om),om.prototype.appendPoint=om.prototype.Ue,om.prototype.clone=om.prototype.Q,om.prototype.dispatchChangeEvent=om.prototype.k,om.prototype.getClosestPoint=om.prototype.e,om.prototype.getCoordinates=om.prototype.D,om.prototype.getExtent=om.prototype.u,om.prototype.getFirstCoordinate=om.prototype.Va,om.prototype.getLastCoordinate=om.prototype.Wa,om.prototype.getLayout=om.prototype.Xa,om.prototype.getPoint=om.prototype.tf,om.prototype.getPoints=om.prototype.Vd,om.prototype.getSimplifiedGeometry=om.prototype.ha,om.prototype.getType=om.prototype.G,om.prototype.on=om.prototype.p,om.prototype.once=om.prototype.q,om.prototype.setCoordinates=om.prototype.P,om.prototype.transform=om.prototype.transform,om.prototype.un=om.prototype.r,om.prototype.unByKey=om.prototype.s,t("ol.geom.MultiPolygon",pm),pm.prototype.appendPolygon=pm.prototype.Ve,pm.prototype.clone=pm.prototype.Q,pm.prototype.dispatchChangeEvent=pm.prototype.k,pm.prototype.getArea=pm.prototype.Og,pm.prototype.getClosestPoint=pm.prototype.e,pm.prototype.getCoordinates=pm.prototype.D,pm.prototype.getExtent=pm.prototype.u,pm.prototype.getFirstCoordinate=pm.prototype.Va,pm.prototype.getInteriorPoints=pm.prototype.mf,pm.prototype.getLastCoordinate=pm.prototype.Wa,pm.prototype.getLayout=pm.prototype.Xa,pm.prototype.getPolygon=pm.prototype.uf,pm.prototype.getPolygons=pm.prototype.Wd,pm.prototype.getSimplifiedGeometry=pm.prototype.ha,pm.prototype.getType=pm.prototype.G,pm.prototype.on=pm.prototype.p,pm.prototype.once=pm.prototype.q,pm.prototype.setCoordinates=pm.prototype.P,pm.prototype.transform=pm.prototype.transform,pm.prototype.un=pm.prototype.r,pm.prototype.unByKey=pm.prototype.s,t("ol.geom.Point",ph),ph.prototype.clone=ph.prototype.Q,ph.prototype.dispatchChangeEvent=ph.prototype.k,ph.prototype.getClosestPoint=ph.prototype.e,ph.prototype.getCoordinates=ph.prototype.D,ph.prototype.getFirstCoordinate=ph.prototype.Va,ph.prototype.getLastCoordinate=ph.prototype.Wa,ph.prototype.getLayout=ph.prototype.Xa,ph.prototype.getSimplifiedGeometry=ph.prototype.ha,ph.prototype.getType=ph.prototype.G,ph.prototype.on=ph.prototype.p,ph.prototype.once=ph.prototype.q,ph.prototype.setCoordinates=ph.prototype.P,ph.prototype.transform=ph.prototype.transform,ph.prototype.un=ph.prototype.r,ph.prototype.unByKey=ph.prototype.s,t("ol.geom.Polygon",G),G.prototype.appendLinearRing=G.prototype.Te,G.prototype.clone=G.prototype.Q,G.prototype.dispatchChangeEvent=G.prototype.k,G.prototype.getArea=G.prototype.Pg,G.prototype.getClosestPoint=G.prototype.e,G.prototype.getCoordinates=G.prototype.D,G.prototype.getExtent=G.prototype.u,G.prototype.getFirstCoordinate=G.prototype.Va,G.prototype.getInteriorPoint=G.prototype.lf,G.prototype.getLastCoordinate=G.prototype.Wa,G.prototype.getLayout=G.prototype.Xa,G.prototype.getLinearRing=G.prototype.qf,G.prototype.getLinearRings=G.prototype.Ud,G.prototype.getSimplifiedGeometry=G.prototype.ha,G.prototype.getType=G.prototype.G,G.prototype.on=G.prototype.p,G.prototype.once=G.prototype.q,G.prototype.setCoordinates=G.prototype.P,G.prototype.transform=G.prototype.transform,G.prototype.un=G.prototype.r,G.prototype.unByKey=G.prototype.s,t("ol.geom.SimpleGeometry",Ug),Ug.prototype.dispatchChangeEvent=Ug.prototype.k,Ug.prototype.getClosestPoint=Ug.prototype.e,Ug.prototype.getExtent=Ug.prototype.u,Ug.prototype.getFirstCoordinate=Ug.prototype.Va,Ug.prototype.getLastCoordinate=Ug.prototype.Wa,Ug.prototype.getLayout=Ug.prototype.Xa,Ug.prototype.getSimplifiedGeometry=Ug.prototype.ha,Ug.prototype.on=Ug.prototype.p,Ug.prototype.once=Ug.prototype.q,Ug.prototype.transform=Ug.prototype.transform,Ug.prototype.un=Ug.prototype.r,Ug.prototype.unByKey=Ug.prototype.s,t("ol.inherits",v),t("ol.interaction.DoubleClickZoom",kk),kk.prototype.dispatchChangeEvent=kk.prototype.k,kk.prototype.on=kk.prototype.p,kk.prototype.once=kk.prototype.q,kk.prototype.un=kk.prototype.r,kk.prototype.unByKey=kk.prototype.s,t("ol.interaction.DragAndDrop",It),It.prototype.dispatchChangeEvent=It.prototype.k,It.prototype.on=It.prototype.p,It.prototype.once=It.prototype.q,It.prototype.un=It.prototype.r,It.prototype.unByKey=It.prototype.s,t("ol.interaction.DragBox",yi),yi.prototype.dispatchChangeEvent=yi.prototype.k,yi.prototype.getGeometry=yi.prototype.M,yi.prototype.on=yi.prototype.p,yi.prototype.once=yi.prototype.q,yi.prototype.un=yi.prototype.r,yi.prototype.unByKey=yi.prototype.s,t("ol.interaction.DragPan",lk),lk.prototype.dispatchChangeEvent=lk.prototype.k,lk.prototype.on=lk.prototype.p,lk.prototype.once=lk.prototype.q,lk.prototype.un=lk.prototype.r,lk.prototype.unByKey=lk.prototype.s,t("ol.interaction.DragRotate",mk),mk.prototype.dispatchChangeEvent=mk.prototype.k,mk.prototype.on=mk.prototype.p,mk.prototype.once=mk.prototype.q,mk.prototype.un=mk.prototype.r,mk.prototype.unByKey=mk.prototype.s,t("ol.interaction.DragRotateAndZoom",Mt),Mt.prototype.dispatchChangeEvent=Mt.prototype.k,Mt.prototype.on=Mt.prototype.p,Mt.prototype.once=Mt.prototype.q,Mt.prototype.un=Mt.prototype.r,Mt.prototype.unByKey=Mt.prototype.s,t("ol.interaction.DragZoom",nk),nk.prototype.dispatchChangeEvent=nk.prototype.k,nk.prototype.getGeometry=nk.prototype.M,nk.prototype.on=nk.prototype.p,nk.prototype.once=nk.prototype.q,nk.prototype.un=nk.prototype.r,nk.prototype.unByKey=nk.prototype.s,t("ol.interaction.Draw",Rn),Rn.prototype.dispatchChangeEvent=Rn.prototype.k,Rn.prototype.on=Rn.prototype.p,Rn.prototype.once=Rn.prototype.q,Rn.prototype.un=Rn.prototype.r,Rn.prototype.unByKey=Rn.prototype.s,ni.prototype.dispatchChangeEvent=ni.prototype.k,ni.prototype.on=ni.prototype.p,ni.prototype.once=ni.prototype.q,ni.prototype.un=ni.prototype.r,ni.prototype.unByKey=ni.prototype.s,t("ol.interaction.KeyboardPan",ok),ok.prototype.dispatchChangeEvent=ok.prototype.k,ok.prototype.on=ok.prototype.p,ok.prototype.once=ok.prototype.q,ok.prototype.un=ok.prototype.r,ok.prototype.unByKey=ok.prototype.s,t("ol.interaction.KeyboardZoom",qk),qk.prototype.dispatchChangeEvent=qk.prototype.k,qk.prototype.on=qk.prototype.p,qk.prototype.once=qk.prototype.q,qk.prototype.un=qk.prototype.r,qk.prototype.unByKey=qk.prototype.s,t("ol.interaction.Modify",Nt),Nt.prototype.dispatchChangeEvent=Nt.prototype.k,Nt.prototype.on=Nt.prototype.p,Nt.prototype.once=Nt.prototype.q,Nt.prototype.un=Nt.prototype.r,Nt.prototype.unByKey=Nt.prototype.s,t("ol.interaction.MouseWheelZoom",rk),rk.prototype.dispatchChangeEvent=rk.prototype.k,rk.prototype.on=rk.prototype.p,rk.prototype.once=rk.prototype.q,rk.prototype.un=rk.prototype.r,rk.prototype.unByKey=rk.prototype.s,t("ol.interaction.PinchRotate",sk),sk.prototype.dispatchChangeEvent=sk.prototype.k,sk.prototype.on=sk.prototype.p,sk.prototype.once=sk.prototype.q,sk.prototype.un=sk.prototype.r,sk.prototype.unByKey=sk.prototype.s,t("ol.interaction.PinchZoom",tk),tk.prototype.dispatchChangeEvent=tk.prototype.k,tk.prototype.on=tk.prototype.p,tk.prototype.once=tk.prototype.q,tk.prototype.un=tk.prototype.r,tk.prototype.unByKey=tk.prototype.s,ri.prototype.dispatchChangeEvent=ri.prototype.k,ri.prototype.on=ri.prototype.p,ri.prototype.once=ri.prototype.q,ri.prototype.un=ri.prototype.r,ri.prototype.unByKey=ri.prototype.s,t("ol.interaction.Select",St),St.prototype.dispatchChangeEvent=St.prototype.k,St.prototype.getFeatures=St.prototype.Rg,St.prototype.on=St.prototype.p,St.prototype.once=St.prototype.q,St.prototype.setMap=St.prototype.setMap,St.prototype.un=St.prototype.r,St.prototype.unByKey=St.prototype.s,t("ol.interaction.defaults",uk),J.prototype.bindTo=J.prototype.W,J.prototype.dispatchChangeEvent=J.prototype.k,J.prototype.get=J.prototype.get,J.prototype.getBrightness=J.prototype.c,J.prototype.getContrast=J.prototype.e,J.prototype.getHue=J.prototype.f,J.prototype.getKeys=J.prototype.K,J.prototype.getMaxResolution=J.prototype.g,J.prototype.getMinResolution=J.prototype.i,J.prototype.getOpacity=J.prototype.l,J.prototype.getProperties=J.prototype.S,J.prototype.getSaturation=J.prototype.h,J.prototype.getVisible=J.prototype.b,J.prototype.notify=J.prototype.T,J.prototype.on=J.prototype.p,J.prototype.once=J.prototype.q,J.prototype.set=J.prototype.v,J.prototype.setBrightness=J.prototype.n,J.prototype.setContrast=J.prototype.o,J.prototype.setHue=J.prototype.w,J.prototype.setMaxResolution=J.prototype.A,J.prototype.setMinResolution=J.prototype.B,J.prototype.setOpacity=J.prototype.C,J.prototype.setSaturation=J.prototype.O,J.prototype.setValues=J.prototype.H,J.prototype.setVisible=J.prototype.V,J.prototype.un=J.prototype.r,J.prototype.unByKey=J.prototype.s,J.prototype.unbind=J.prototype.U,J.prototype.unbindAll=J.prototype.X,t("ol.layer.Group",K),K.prototype.bindTo=K.prototype.W,K.prototype.dispatchChangeEvent=K.prototype.k,K.prototype.get=K.prototype.get,K.prototype.getBrightness=K.prototype.c,K.prototype.getContrast=K.prototype.e,K.prototype.getHue=K.prototype.f,K.prototype.getKeys=K.prototype.K,K.prototype.getMaxResolution=K.prototype.g,K.prototype.getMinResolution=K.prototype.i,K.prototype.getOpacity=K.prototype.l,K.prototype.getProperties=K.prototype.S,K.prototype.getSaturation=K.prototype.h,K.prototype.getVisible=K.prototype.b,K.prototype.notify=K.prototype.T,K.prototype.on=K.prototype.p,K.prototype.once=K.prototype.q,K.prototype.set=K.prototype.v,K.prototype.setBrightness=K.prototype.n,K.prototype.setContrast=K.prototype.o,K.prototype.setHue=K.prototype.w,K.prototype.setMaxResolution=K.prototype.A,K.prototype.setMinResolution=K.prototype.B,K.prototype.setOpacity=K.prototype.C,K.prototype.setSaturation=K.prototype.O,K.prototype.setValues=K.prototype.H,K.prototype.setVisible=K.prototype.V,K.prototype.un=K.prototype.r,K.prototype.unByKey=K.prototype.s,K.prototype.unbind=K.prototype.U,K.prototype.unbindAll=K.prototype.X,t("ol.layer.Heatmap",$),$.prototype.bindTo=$.prototype.W,$.prototype.dispatchChangeEvent=$.prototype.k,$.prototype.get=$.prototype.get,$.prototype.getBrightness=$.prototype.c,$.prototype.getContrast=$.prototype.e,$.prototype.getHue=$.prototype.f,$.prototype.getKeys=$.prototype.K,$.prototype.getMaxResolution=$.prototype.g,$.prototype.getMinResolution=$.prototype.i,$.prototype.getOpacity=$.prototype.l,$.prototype.getProperties=$.prototype.S,$.prototype.getSaturation=$.prototype.h,$.prototype.getSource=$.prototype.ba,$.prototype.getStyle=$.prototype.Vb,$.prototype.getStyleFunction=$.prototype.wc,$.prototype.getVisible=$.prototype.b,$.prototype.notify=$.prototype.T,$.prototype.on=$.prototype.p,$.prototype.once=$.prototype.q,$.prototype.set=$.prototype.v,$.prototype.setBrightness=$.prototype.n,$.prototype.setContrast=$.prototype.o,$.prototype.setHue=$.prototype.w,$.prototype.setMaxResolution=$.prototype.A,$.prototype.setMinResolution=$.prototype.B,$.prototype.setOpacity=$.prototype.C,$.prototype.setSaturation=$.prototype.O,$.prototype.setStyle=$.prototype.fa,$.prototype.setValues=$.prototype.H,$.prototype.setVisible=$.prototype.V,$.prototype.un=$.prototype.r,$.prototype.unByKey=$.prototype.s,$.prototype.unbind=$.prototype.U,$.prototype.unbindAll=$.prototype.X,t("ol.layer.Image",N),N.prototype.bindTo=N.prototype.W,N.prototype.dispatchChangeEvent=N.prototype.k,N.prototype.get=N.prototype.get,N.prototype.getBrightness=N.prototype.c,N.prototype.getContrast=N.prototype.e,N.prototype.getHue=N.prototype.f,N.prototype.getKeys=N.prototype.K,N.prototype.getMaxResolution=N.prototype.g,N.prototype.getMinResolution=N.prototype.i,N.prototype.getOpacity=N.prototype.l,N.prototype.getProperties=N.prototype.S,N.prototype.getSaturation=N.prototype.h,N.prototype.getSource=N.prototype.ba,N.prototype.getVisible=N.prototype.b,N.prototype.notify=N.prototype.T,N.prototype.on=N.prototype.p,N.prototype.once=N.prototype.q,N.prototype.set=N.prototype.v,N.prototype.setBrightness=N.prototype.n,N.prototype.setContrast=N.prototype.o,N.prototype.setHue=N.prototype.w,N.prototype.setMaxResolution=N.prototype.A,N.prototype.setMinResolution=N.prototype.B,N.prototype.setOpacity=N.prototype.C,N.prototype.setSaturation=N.prototype.O,N.prototype.setValues=N.prototype.H,N.prototype.setVisible=N.prototype.V,N.prototype.un=N.prototype.r,N.prototype.unByKey=N.prototype.s,N.prototype.unbind=N.prototype.U,N.prototype.unbindAll=N.prototype.X,t("ol.layer.Layer",M),M.prototype.bindTo=M.prototype.W,M.prototype.dispatchChangeEvent=M.prototype.k,M.prototype.get=M.prototype.get,M.prototype.getBrightness=M.prototype.c,M.prototype.getContrast=M.prototype.e,M.prototype.getHue=M.prototype.f,M.prototype.getKeys=M.prototype.K,M.prototype.getMaxResolution=M.prototype.g,M.prototype.getMinResolution=M.prototype.i,M.prototype.getOpacity=M.prototype.l,M.prototype.getProperties=M.prototype.S,M.prototype.getSaturation=M.prototype.h,M.prototype.getSource=M.prototype.ba,M.prototype.getVisible=M.prototype.b,M.prototype.notify=M.prototype.T,M.prototype.on=M.prototype.p,M.prototype.once=M.prototype.q,M.prototype.set=M.prototype.v,M.prototype.setBrightness=M.prototype.n,M.prototype.setContrast=M.prototype.o,M.prototype.setHue=M.prototype.w,M.prototype.setMaxResolution=M.prototype.A,M.prototype.setMinResolution=M.prototype.B,M.prototype.setOpacity=M.prototype.C,M.prototype.setSaturation=M.prototype.O,M.prototype.setValues=M.prototype.H,M.prototype.setVisible=M.prototype.V,M.prototype.un=M.prototype.r,M.prototype.unByKey=M.prototype.s,M.prototype.unbind=M.prototype.U,M.prototype.unbindAll=M.prototype.X,t("ol.layer.Tile",O),O.prototype.bindTo=O.prototype.W,O.prototype.dispatchChangeEvent=O.prototype.k,O.prototype.get=O.prototype.get,O.prototype.getBrightness=O.prototype.c,O.prototype.getContrast=O.prototype.e,O.prototype.getHue=O.prototype.f,O.prototype.getKeys=O.prototype.K,O.prototype.getMaxResolution=O.prototype.g,O.prototype.getMinResolution=O.prototype.i,O.prototype.getOpacity=O.prototype.l,O.prototype.getProperties=O.prototype.S,O.prototype.getSaturation=O.prototype.h,O.prototype.getSource=O.prototype.ba,O.prototype.getVisible=O.prototype.b,O.prototype.notify=O.prototype.T,O.prototype.on=O.prototype.p,O.prototype.once=O.prototype.q,O.prototype.set=O.prototype.v,O.prototype.setBrightness=O.prototype.n,O.prototype.setContrast=O.prototype.o,O.prototype.setHue=O.prototype.w,O.prototype.setMaxResolution=O.prototype.A,O.prototype.setMinResolution=O.prototype.B,O.prototype.setOpacity=O.prototype.C,O.prototype.setSaturation=O.prototype.O,O.prototype.setValues=O.prototype.H,O.prototype.setVisible=O.prototype.V,O.prototype.un=O.prototype.r,O.prototype.unByKey=O.prototype.s,O.prototype.unbind=O.prototype.U,O.prototype.unbindAll=O.prototype.X,t("ol.layer.Vector",P),P.prototype.bindTo=P.prototype.W,P.prototype.dispatchChangeEvent=P.prototype.k,P.prototype.get=P.prototype.get,P.prototype.getBrightness=P.prototype.c,P.prototype.getContrast=P.prototype.e,P.prototype.getHue=P.prototype.f,P.prototype.getKeys=P.prototype.K,P.prototype.getMaxResolution=P.prototype.g,P.prototype.getMinResolution=P.prototype.i,P.prototype.getOpacity=P.prototype.l,P.prototype.getProperties=P.prototype.S,P.prototype.getSaturation=P.prototype.h,P.prototype.getSource=P.prototype.ba,P.prototype.getStyle=P.prototype.Vb,P.prototype.getStyleFunction=P.prototype.wc,P.prototype.getVisible=P.prototype.b,P.prototype.notify=P.prototype.T,P.prototype.on=P.prototype.p,P.prototype.once=P.prototype.q,P.prototype.set=P.prototype.v,P.prototype.setBrightness=P.prototype.n,P.prototype.setContrast=P.prototype.o,P.prototype.setHue=P.prototype.w,P.prototype.setMaxResolution=P.prototype.A,P.prototype.setMinResolution=P.prototype.B,P.prototype.setOpacity=P.prototype.C,P.prototype.setSaturation=P.prototype.O,P.prototype.setStyle=P.prototype.fa,P.prototype.setValues=P.prototype.H,P.prototype.setVisible=P.prototype.V,P.prototype.un=P.prototype.r,P.prototype.unByKey=P.prototype.s,P.prototype.unbind=P.prototype.U,P.prototype.unbindAll=P.prototype.X,t("ol.loadingstrategy.all",function(){return[[-1/0,-1/0,1/0,1/0]]}),t("ol.loadingstrategy.bbox",Wt),t("ol.loadingstrategy.createTile",function(a){return function(b,c){var d=jg(a.a,c,0),e=Kk(a,b,d),f=[],d=new gb(d,0,0);for(d.x=e.a;d.x<=e.c;++d.x)for(d.y=e.b;d.y<=e.d;++d.y)f.push(Jk(a,d));return f}}),t("ol.proj.CH",Yt),Yt.prototype.getCode=Yt.prototype.d,Yt.prototype.getExtent=Yt.prototype.u,Yt.prototype.getUnits=Yt.prototype.b,t("ol.proj.EPSG2056",au),au.prototype.getCode=au.prototype.d,au.prototype.getExtent=au.prototype.u,au.prototype.getUnits=au.prototype.b,t("ol.proj.EPSG21781",cu),cu.prototype.getCode=cu.prototype.d,cu.prototype.getExtent=cu.prototype.u,cu.prototype.getUnits=cu.prototype.b,t("ol.proj.EPSG3857",yk),yk.prototype.getCode=yk.prototype.d,yk.prototype.getExtent=yk.prototype.u,yk.prototype.getUnits=yk.prototype.b,t("ol.proj.EPSG4326",Bk),Bk.prototype.getCode=Bk.prototype.d,Bk.prototype.getExtent=Bk.prototype.u,Bk.prototype.getUnits=Bk.prototype.b,t("ol.proj.METERS_PER_UNIT[undefined]",Dh[void 0]),t("ol.proj.Projection",Fh),Fh.prototype.getCode=Fh.prototype.d,Fh.prototype.getExtent=Fh.prototype.u,Fh.prototype.getUnits=Fh.prototype.b,t("ol.proj.addProjection",Xh),t("ol.proj.common.add",Dk),t("ol.proj.configureProj4jsProjection",function(a){return Jh(a)}),t("ol.proj.get",$h),t("ol.proj.getTransform",ai),t("ol.proj.getTransformFromProjections",Ih),t("ol.proj.transform",function(a,b,c){return ai(b,c)(a)}),t("ol.proj.transformWithProjections",function(a,b,c){return Ih(b,c)(a)}),jl.prototype.drawAsync=jl.prototype.Bc,jl.prototype.drawCircleGeometry=jl.prototype.dc,jl.prototype.drawFeature=jl.prototype.gd,jl.prototype.drawLineStringGeometry=jl.prototype.ec,jl.prototype.drawMultiLineStringGeometry=jl.prototype.fc,jl.prototype.drawMultiPointGeometry=jl.prototype.gc,jl.prototype.drawMultiPolygonGeometry=jl.prototype.hc,jl.prototype.drawPointGeometry=jl.prototype.ic,jl.prototype.drawPolygonGeometry=jl.prototype.Gb,jl.prototype.setFillStrokeStyle=jl.prototype.Ea,jl.prototype.setImageStyle=jl.prototype.Tb,jl.prototype.setTextStyle=jl.prototype.pa,t("ol.source.BingMaps",Cu),Cu.prototype.dispatchChangeEvent=Cu.prototype.k,Cu.prototype.getState=Cu.prototype.a,Cu.prototype.getTileGrid=Cu.prototype.ma,Cu.prototype.on=Cu.prototype.p,Cu.prototype.once=Cu.prototype.q,Cu.prototype.un=Cu.prototype.r,Cu.prototype.unByKey=Cu.prototype.s,t("ol.source.BingMaps.TOS_ATTRIBUTION",Du),$u.prototype.addFeature=$u.prototype.Aa,$u.prototype.addFeatures=$u.prototype.Ga,$u.prototype.dispatchChangeEvent=$u.prototype.k,$u.prototype.forEachFeature=$u.prototype.Ia,$u.prototype.forEachFeatureInExtent=$u.prototype.la,$u.prototype.getClosestFeatureToCoordinate=$u.prototype.Ja,$u.prototype.getExtent=$u.prototype.u,$u.prototype.getFeatures=$u.prototype.Ba,$u.prototype.getFeaturesAtCoordinate=$u.prototype.wa,$u.prototype.getState=$u.prototype.a,$u.prototype.on=$u.prototype.p,$u.prototype.once=$u.prototype.q,$u.prototype.removeFeature=$u.prototype.Oa,$u.prototype.un=$u.prototype.r,$u.prototype.unByKey=$u.prototype.s,t("ol.source.GPX",cv),cv.prototype.addFeature=cv.prototype.Aa,cv.prototype.addFeatures=cv.prototype.Ga,cv.prototype.dispatchChangeEvent=cv.prototype.k,cv.prototype.forEachFeature=cv.prototype.Ia,cv.prototype.forEachFeatureInExtent=cv.prototype.la,cv.prototype.getClosestFeatureToCoordinate=cv.prototype.Ja,cv.prototype.getExtent=cv.prototype.u,cv.prototype.getFeatures=cv.prototype.Ba,cv.prototype.getFeaturesAtCoordinate=cv.prototype.wa,cv.prototype.getState=cv.prototype.a,cv.prototype.on=cv.prototype.p,cv.prototype.once=cv.prototype.q,cv.prototype.removeFeature=cv.prototype.Oa,cv.prototype.un=cv.prototype.r,cv.prototype.unByKey=cv.prototype.s,t("ol.source.GeoJSON",dv),dv.prototype.addFeature=dv.prototype.Aa,dv.prototype.addFeatures=dv.prototype.Ga,dv.prototype.dispatchChangeEvent=dv.prototype.k,dv.prototype.forEachFeature=dv.prototype.Ia,dv.prototype.forEachFeatureInExtent=dv.prototype.la,dv.prototype.getClosestFeatureToCoordinate=dv.prototype.Ja,dv.prototype.getExtent=dv.prototype.u,dv.prototype.getFeatures=dv.prototype.Ba,dv.prototype.getFeaturesAtCoordinate=dv.prototype.wa,dv.prototype.getState=dv.prototype.a,dv.prototype.on=dv.prototype.p,dv.prototype.once=dv.prototype.q,dv.prototype.removeFeature=dv.prototype.Oa,dv.prototype.un=dv.prototype.r,dv.prototype.unByKey=dv.prototype.s,t("ol.source.IGC",ev),ev.prototype.addFeature=ev.prototype.Aa,ev.prototype.addFeatures=ev.prototype.Ga,ev.prototype.dispatchChangeEvent=ev.prototype.k,ev.prototype.forEachFeature=ev.prototype.Ia,ev.prototype.forEachFeatureInExtent=ev.prototype.la,ev.prototype.getClosestFeatureToCoordinate=ev.prototype.Ja,ev.prototype.getExtent=ev.prototype.u,ev.prototype.getFeatures=ev.prototype.Ba,ev.prototype.getFeaturesAtCoordinate=ev.prototype.wa,ev.prototype.getState=ev.prototype.a,ev.prototype.on=ev.prototype.p,ev.prototype.once=ev.prototype.q,ev.prototype.removeFeature=ev.prototype.Oa,ev.prototype.un=ev.prototype.r,ev.prototype.unByKey=ev.prototype.s,Al.prototype.dispatchChangeEvent=Al.prototype.k,Al.prototype.getState=Al.prototype.a,Al.prototype.on=Al.prototype.p,Al.prototype.once=Al.prototype.q,Al.prototype.un=Al.prototype.r,Al.prototype.unByKey=Al.prototype.s,t("ol.source.ImageCanvas",gv),gv.prototype.dispatchChangeEvent=gv.prototype.k,gv.prototype.getState=gv.prototype.a,gv.prototype.on=gv.prototype.p,gv.prototype.once=gv.prototype.q,gv.prototype.un=gv.prototype.r,gv.prototype.unByKey=gv.prototype.s,t("ol.source.ImageStatic",hv),hv.prototype.dispatchChangeEvent=hv.prototype.k,hv.prototype.getState=hv.prototype.a,hv.prototype.on=hv.prototype.p,hv.prototype.once=hv.prototype.q,hv.prototype.un=hv.prototype.r,hv.prototype.unByKey=hv.prototype.s,t("ol.source.ImageVector",iv),iv.prototype.dispatchChangeEvent=iv.prototype.k,iv.prototype.getSource=iv.prototype.Vg,iv.prototype.getState=iv.prototype.a,iv.prototype.on=iv.prototype.p,iv.prototype.once=iv.prototype.q,iv.prototype.un=iv.prototype.r,iv.prototype.unByKey=iv.prototype.s,t("ol.source.ImageWMS",jv),jv.prototype.dispatchChangeEvent=jv.prototype.k,jv.prototype.getGetFeatureInfoUrl=jv.prototype.Yg,jv.prototype.getParams=jv.prototype.Zg,jv.prototype.getState=jv.prototype.a,jv.prototype.getUrl=jv.prototype.$g,jv.prototype.on=jv.prototype.p,jv.prototype.once=jv.prototype.q,jv.prototype.setUrl=jv.prototype.ah,jv.prototype.un=jv.prototype.r,jv.prototype.unByKey=jv.prototype.s,jv.prototype.updateParams=jv.prototype.bh,t("ol.source.KML",mv),mv.prototype.addFeature=mv.prototype.Aa,mv.prototype.addFeatures=mv.prototype.Ga,mv.prototype.dispatchChangeEvent=mv.prototype.k,mv.prototype.forEachFeature=mv.prototype.Ia,mv.prototype.forEachFeatureInExtent=mv.prototype.la,mv.prototype.getClosestFeatureToCoordinate=mv.prototype.Ja,mv.prototype.getExtent=mv.prototype.u,mv.prototype.getFeatures=mv.prototype.Ba,mv.prototype.getFeaturesAtCoordinate=mv.prototype.wa,mv.prototype.getState=mv.prototype.a,mv.prototype.on=mv.prototype.p,mv.prototype.once=mv.prototype.q,mv.prototype.removeFeature=mv.prototype.Oa,mv.prototype.un=mv.prototype.r,mv.prototype.unByKey=mv.prototype.s,t("ol.source.MapGuide",pv),pv.prototype.dispatchChangeEvent=pv.prototype.k,pv.prototype.getState=pv.prototype.a,pv.prototype.on=pv.prototype.p,pv.prototype.once=pv.prototype.q,pv.prototype.un=pv.prototype.r,pv.prototype.unByKey=pv.prototype.s,t("ol.source.MapQuest",vv),vv.prototype.dispatchChangeEvent=vv.prototype.k,vv.prototype.getState=vv.prototype.a,vv.prototype.getTileGrid=vv.prototype.ma,vv.prototype.on=vv.prototype.p,vv.prototype.once=vv.prototype.q,vv.prototype.setUrl=vv.prototype.b,vv.prototype.un=vv.prototype.r,vv.prototype.unByKey=vv.prototype.s,t("ol.source.OSM",rv),rv.prototype.dispatchChangeEvent=rv.prototype.k,rv.prototype.getState=rv.prototype.a,rv.prototype.getTileGrid=rv.prototype.ma,rv.prototype.on=rv.prototype.p,rv.prototype.once=rv.prototype.q,rv.prototype.setUrl=rv.prototype.b,rv.prototype.un=rv.prototype.r,rv.prototype.unByKey=rv.prototype.s,t("ol.source.OSM.DATA_ATTRIBUTION",tv),t("ol.source.OSM.TILE_ATTRIBUTION",uv),t("ol.source.OSMXML",yv),yv.prototype.addFeature=yv.prototype.Aa,yv.prototype.addFeatures=yv.prototype.Ga,yv.prototype.dispatchChangeEvent=yv.prototype.k,yv.prototype.forEachFeature=yv.prototype.Ia,yv.prototype.forEachFeatureInExtent=yv.prototype.la,yv.prototype.getClosestFeatureToCoordinate=yv.prototype.Ja,yv.prototype.getExtent=yv.prototype.u,yv.prototype.getFeatures=yv.prototype.Ba,yv.prototype.getFeaturesAtCoordinate=yv.prototype.wa,yv.prototype.getState=yv.prototype.a,yv.prototype.on=yv.prototype.p,yv.prototype.once=yv.prototype.q,yv.prototype.removeFeature=yv.prototype.Oa,yv.prototype.un=yv.prototype.r,yv.prototype.unByKey=yv.prototype.s,t("ol.source.ServerVector",zv),zv.prototype.addFeature=zv.prototype.Aa,zv.prototype.addFeatures=zv.prototype.Ga,zv.prototype.dispatchChangeEvent=zv.prototype.k,zv.prototype.forEachFeature=zv.prototype.Ia,zv.prototype.forEachFeatureInExtent=zv.prototype.la,zv.prototype.getClosestFeatureToCoordinate=zv.prototype.Ja,zv.prototype.getExtent=zv.prototype.u,zv.prototype.getFeatures=zv.prototype.Ba,zv.prototype.getFeaturesAtCoordinate=zv.prototype.wa,zv.prototype.getState=zv.prototype.a,zv.prototype.on=zv.prototype.p,zv.prototype.once=zv.prototype.q,zv.prototype.readFeatures=zv.prototype.e,zv.prototype.removeFeature=zv.prototype.Oa,zv.prototype.un=zv.prototype.r,zv.prototype.unByKey=zv.prototype.s,vk.prototype.dispatchChangeEvent=vk.prototype.k,vk.prototype.getState=vk.prototype.a,vk.prototype.on=vk.prototype.p,vk.prototype.once=vk.prototype.q,vk.prototype.un=vk.prototype.r,vk.prototype.unByKey=vk.prototype.s,t("ol.source.Stamen",Cv),Cv.prototype.dispatchChangeEvent=Cv.prototype.k,Cv.prototype.getState=Cv.prototype.a,Cv.prototype.getTileGrid=Cv.prototype.ma,Cv.prototype.on=Cv.prototype.p,Cv.prototype.once=Cv.prototype.q,Cv.prototype.setUrl=Cv.prototype.b,Cv.prototype.un=Cv.prototype.r,Cv.prototype.unByKey=Cv.prototype.s,t("ol.source.StaticVector",bv),bv.prototype.addFeature=bv.prototype.Aa,bv.prototype.addFeatures=bv.prototype.Ga,bv.prototype.dispatchChangeEvent=bv.prototype.k,bv.prototype.forEachFeature=bv.prototype.Ia,bv.prototype.forEachFeatureInExtent=bv.prototype.la,bv.prototype.getClosestFeatureToCoordinate=bv.prototype.Ja,bv.prototype.getExtent=bv.prototype.u,bv.prototype.getFeatures=bv.prototype.Ba,bv.prototype.getFeaturesAtCoordinate=bv.prototype.wa,bv.prototype.getState=bv.prototype.a,bv.prototype.on=bv.prototype.p,bv.prototype.once=bv.prototype.q,bv.prototype.removeFeature=bv.prototype.Oa,bv.prototype.un=bv.prototype.r,bv.prototype.unByKey=bv.prototype.s,t("ol.source.Tile",Ok),Ok.prototype.dispatchChangeEvent=Ok.prototype.k,Ok.prototype.getState=Ok.prototype.a,Ok.prototype.getTileGrid=Ok.prototype.ma,Ok.prototype.on=Ok.prototype.p,Ok.prototype.once=Ok.prototype.q,Ok.prototype.un=Ok.prototype.r,Ok.prototype.unByKey=Ok.prototype.s,t("ol.source.TileDebug",Fv),Fv.prototype.dispatchChangeEvent=Fv.prototype.k,Fv.prototype.getState=Fv.prototype.a,Fv.prototype.getTileGrid=Fv.prototype.ma,Fv.prototype.on=Fv.prototype.p,Fv.prototype.once=Fv.prototype.q,Fv.prototype.un=Fv.prototype.r,Fv.prototype.unByKey=Fv.prototype.s,t("ol.source.TileImage",zu),zu.prototype.dispatchChangeEvent=zu.prototype.k,zu.prototype.getState=zu.prototype.a,zu.prototype.getTileGrid=zu.prototype.ma,zu.prototype.on=zu.prototype.p,zu.prototype.once=zu.prototype.q,zu.prototype.un=zu.prototype.r,zu.prototype.unByKey=zu.prototype.s,t("ol.source.TileJSON",Gv),Gv.prototype.dispatchChangeEvent=Gv.prototype.k,Gv.prototype.getState=Gv.prototype.a,Gv.prototype.getTileGrid=Gv.prototype.ma,Gv.prototype.on=Gv.prototype.p,Gv.prototype.once=Gv.prototype.q,Gv.prototype.un=Gv.prototype.r,Gv.prototype.unByKey=Gv.prototype.s,t("ol.source.TileVector",Hv),Hv.prototype.dispatchChangeEvent=Hv.prototype.k,Hv.prototype.getFeaturesAtCoordinate=Hv.prototype.wa,Hv.prototype.getState=Hv.prototype.a,Hv.prototype.on=Hv.prototype.p,Hv.prototype.once=Hv.prototype.q,Hv.prototype.un=Hv.prototype.r,Hv.prototype.unByKey=Hv.prototype.s,t("ol.source.TileWMS",Iv),Iv.prototype.dispatchChangeEvent=Iv.prototype.k,Iv.prototype.getGetFeatureInfoUrl=Iv.prototype.dh,Iv.prototype.getParams=Iv.prototype.eh,Iv.prototype.getState=Iv.prototype.a,Iv.prototype.getTileGrid=Iv.prototype.ma,Iv.prototype.getUrls=Iv.prototype.yf,Iv.prototype.on=Iv.prototype.p,Iv.prototype.once=Iv.prototype.q,Iv.prototype.un=Iv.prototype.r,Iv.prototype.unByKey=Iv.prototype.s,Iv.prototype.updateParams=Iv.prototype.gh,t("ol.source.TopoJSON",Mv),Mv.prototype.addFeature=Mv.prototype.Aa,Mv.prototype.addFeatures=Mv.prototype.Ga,Mv.prototype.dispatchChangeEvent=Mv.prototype.k,Mv.prototype.forEachFeature=Mv.prototype.Ia,Mv.prototype.forEachFeatureInExtent=Mv.prototype.la,Mv.prototype.getClosestFeatureToCoordinate=Mv.prototype.Ja,Mv.prototype.getExtent=Mv.prototype.u,Mv.prototype.getFeatures=Mv.prototype.Ba,Mv.prototype.getFeaturesAtCoordinate=Mv.prototype.wa,Mv.prototype.getState=Mv.prototype.a,Mv.prototype.on=Mv.prototype.p,Mv.prototype.once=Mv.prototype.q,Mv.prototype.removeFeature=Mv.prototype.Oa,Mv.prototype.un=Mv.prototype.r,Mv.prototype.unByKey=Mv.prototype.s,t("ol.source.Vector",Lm),Lm.prototype.addFeature=Lm.prototype.Aa,Lm.prototype.addFeatures=Lm.prototype.Ga,Lm.prototype.dispatchChangeEvent=Lm.prototype.k,Lm.prototype.forEachFeature=Lm.prototype.Ia,Lm.prototype.forEachFeatureInExtent=Lm.prototype.la,Lm.prototype.getClosestFeatureToCoordinate=Lm.prototype.Ja,Lm.prototype.getExtent=Lm.prototype.u,Lm.prototype.getFeatures=Lm.prototype.Ba,Lm.prototype.getFeaturesAtCoordinate=Lm.prototype.wa,Lm.prototype.getState=Lm.prototype.a,Lm.prototype.on=Lm.prototype.p,Lm.prototype.once=Lm.prototype.q,Lm.prototype.removeFeature=Lm.prototype.Oa,Lm.prototype.un=Lm.prototype.r,Lm.prototype.unByKey=Lm.prototype.s,t("ol.source.WMTS",Qv),Qv.prototype.dispatchChangeEvent=Qv.prototype.k,Qv.prototype.getDimensions=Qv.prototype.g,Qv.prototype.getState=Qv.prototype.a,Qv.prototype.getTileGrid=Qv.prototype.ma,Qv.prototype.on=Qv.prototype.p,Qv.prototype.once=Qv.prototype.q,Qv.prototype.un=Qv.prototype.r,Qv.prototype.unByKey=Qv.prototype.s,Qv.prototype.updateDimensions=Qv.prototype.h,t("ol.source.WMTS.optionsFromCapabilities",function(a,b){var c=Ra(a.contents.layers,function(a){return a.identifier==b
}),d=c.tileMatrixSetLinks[0].tileMatrixSet,e=c.formats[0],f=Sa(c.styles,function(a){return a.isDefault});0>f&&(f=0);var f=c.styles[f].identifier,g={};Oa(c.dimensions,function(a){var b=a.identifier,c=a["default"];s(c)||(c=a.values[0]),g[b]=c});var h,i,j=a.contents.tileMatrixSets[d],k=Ov(j),j=$h(j.supportedCRS),l=a.operationsMetadata.GetTile.dcp.http.get;switch(dc(l[0].constraints.GetEncoding.allowedValues)[0]){case"REST":case"RESTful":i="REST",h=c.resourceUrls.tile[e];break;case"KVP":i=Pv,h=[],Oa(l,function(a){a.constraints.GetEncoding.allowedValues.hasOwnProperty(Pv)&&h.push(a.url)})}return{urls:h,layer:b,matrixSet:d,format:e,projection:j,requestEncoding:i,tileGrid:k,style:f,dimensions:g}}),t("ol.source.XYZ",qv),qv.prototype.dispatchChangeEvent=qv.prototype.k,qv.prototype.getState=qv.prototype.a,qv.prototype.getTileGrid=qv.prototype.ma,qv.prototype.on=qv.prototype.p,qv.prototype.once=qv.prototype.q,qv.prototype.setUrl=qv.prototype.b,qv.prototype.un=qv.prototype.r,qv.prototype.unByKey=qv.prototype.s,t("ol.source.Zoomify",Tv),Tv.prototype.dispatchChangeEvent=Tv.prototype.k,Tv.prototype.getState=Tv.prototype.a,Tv.prototype.getTileGrid=Tv.prototype.ma,Tv.prototype.on=Tv.prototype.p,Tv.prototype.once=Tv.prototype.q,Tv.prototype.un=Tv.prototype.r,Tv.prototype.unByKey=Tv.prototype.s,t("ol.sphere.WGS84",ao),t("ol.style.Circle",Ni),Ni.prototype.getAnchor=Ni.prototype.jc,Ni.prototype.getFill=Ni.prototype.hh,Ni.prototype.getImage=Ni.prototype.qc,Ni.prototype.getRadius=Ni.prototype.ih,Ni.prototype.getRotation=Ni.prototype.g,Ni.prototype.getScale=Ni.prototype.i,Ni.prototype.getSize=Ni.prototype.Ob,Ni.prototype.getStroke=Ni.prototype.jh,t("ol.style.Fill",Ki),Ki.prototype.getColor=Ki.prototype.d,t("ol.style.Icon",Zk),Zk.prototype.getAnchor=Zk.prototype.jc,Zk.prototype.getImage=Zk.prototype.qc,Zk.prototype.getRotation=Zk.prototype.g,Zk.prototype.getScale=Zk.prototype.i,Zk.prototype.getSize=Zk.prototype.Ob,Zk.prototype.getSrc=Zk.prototype.kh,t("ol.style.Image",Li),Li.prototype.getRotation=Li.prototype.g,Li.prototype.getScale=Li.prototype.i,t("ol.style.Stroke",Mi),Mi.prototype.getColor=Mi.prototype.lh,Mi.prototype.getLineCap=Mi.prototype.nf,Mi.prototype.getLineDash=Mi.prototype.mh,Mi.prototype.getLineJoin=Mi.prototype.of,Mi.prototype.getMiterLimit=Mi.prototype.rf,Mi.prototype.getWidth=Mi.prototype.nh,t("ol.style.Style",Oi),Oi.prototype.getFill=Oi.prototype.oh,Oi.prototype.getImage=Oi.prototype.ph,Oi.prototype.getStroke=Oi.prototype.qh,Oi.prototype.getText=Oi.prototype.rh,Oi.prototype.getZIndex=Oi.prototype.Af,t("ol.style.Text",Vv),Vv.prototype.getFill=Vv.prototype.sh,Vv.prototype.getFont=Vv.prototype.ff,Vv.prototype.getRotation=Vv.prototype.th,Vv.prototype.getScale=Vv.prototype.uh,Vv.prototype.getStroke=Vv.prototype.vh,Vv.prototype.getText=Vv.prototype.wh,Vv.prototype.getTextAlign=Vv.prototype.vf,Vv.prototype.getTextBaseline=Vv.prototype.wf,t("ol.tilegrid.TileGrid",Hk),Hk.prototype.getMinZoom=Hk.prototype.Hc,Hk.prototype.getOrigin=Hk.prototype.lb,Hk.prototype.getResolution=Hk.prototype.ca,Hk.prototype.getTileSize=Hk.prototype.ia,t("ol.tilegrid.WMTS",Nv),Nv.prototype.getMatrixIds=Nv.prototype.i,Nv.prototype.getMinZoom=Nv.prototype.Hc,Nv.prototype.getOrigin=Nv.prototype.lb,Nv.prototype.getResolution=Nv.prototype.ca,Nv.prototype.getTileSize=Nv.prototype.ia,t("ol.tilegrid.XYZ",Bu),Bu.prototype.getMinZoom=Bu.prototype.Hc,Bu.prototype.getOrigin=Bu.prototype.lb,Bu.prototype.getResolution=Bu.prototype.ca,Bu.prototype.getTileSize=Bu.prototype.ia,t("ol.tilegrid.Zoomify",Sv),Sv.prototype.getMinZoom=Sv.prototype.Hc,Sv.prototype.getOrigin=Sv.prototype.lb,Sv.prototype.getResolution=Sv.prototype.ca,Sv.prototype.getTileSize=Sv.prototype.ia,t("ol.webgl.Context",Jn),Jn.prototype.getGL=Jn.prototype.xh,Jn.prototype.useProgram=Jn.prototype.wd}(),$.extend(haika,{map:{map:null,created:!1,features:[],init:function(){return $(".map_setting").click(function(a){return function(){return"block"===$(".haika_container").css("display")?(a.created||(a.set(),a.created=!0),$(".haika_container").hide(),$(document.body).css("background","#333333"),a.redraw(),$(".map_container").show(),$("#map_query").focus()):($(document.body).css("background","#FFFFFF"),$(".haika_container").show(),$(".map_container").hide())}}(this))},redraw:function(){var a,b,c,d;if(this.features.length>0){for(d=this.features,b=0,c=d.length;c>b;b++)a=d[b],this.map.data.remove(a);return this.features=this.map.data.addGeoJson(this.createGeoJson())}},save:function(a,b){return $("#canvas_lon").val(b),$("#canvas_lat").val(a),haika.options.lon=b,haika.options.lat=a,haika.save()},set:function(){var a;return this.map=new google.maps.Map(document.getElementById("map"),{zoom:20,maxZoom:28,center:{lat:haika.options.lat,lng:haika.options.lon}}),a={fillColor:"orange",strokeWeight:1},this.map.data.setStyle(a),this.features=this.map.data.addGeoJson(haika.map.createGeoJson()),google.maps.event.addListener(this.map,"dragend",function(a){return function(){var b,c;return log(a.map.getCenter()),c=a.map.getCenter().lng(),b=a.map.getCenter().lat(),a.save(b,c),a.redraw()}}(this)),$("#map_search").submit(function(a){return function(){var b,c;return b=$("#map_query").val(),c=new google.maps.Geocoder,c.geocode({address:b},function(b,c){return c===google.maps.GeocoderStatus.OK?(a.map.setCenter(b[0].geometry.location),a.save(b[0].geometry.location.lat(),b[0].geometry.location.lng()),a.redraw()):alert(": "+c)}),!1}}(this)),$("#canvas_lat").change(function(){return haika.options.lat=parseFloat($(this).val()),haika.save()}),$("#canvas_lon").change(function(){return haika.options.lon=parseFloat($(this).val()),haika.save()}),$("#canvas_angle").change(function(a){return function(){return a.redraw()}}(this)),$("#canvas_angle").slider({tooltip:"always",step:1,min:0,max:360,value:haika.options.angle,formatter:function(a){return function(b){return haika.options.angle=parseFloat(b),haika.save(),a.redraw(),b+""}}(this)}),$("#geojson_scale").slider({tooltip:"always",step:1,min:0,max:400,value:100*haika.options.geojson_scale,formatter:function(a){return function(b){return haika.options.geojson_scale=parseFloat(b)/100,haika.save(),a.redraw(),b+"%"}}(this)})},createGeoJson:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(f=this.translateGeoJSON(),e=[],f&&f.features.length>0)for(o=f.features,k=0,m=o.length;m>k;k++)if(h=o[k],"floor"!==h.properties.type){for(c=[],p=h.geometry.coordinates[0],l=0,n=p.length;n>l;l++)g=p[l],i=g[0],j=g[1],b=ol.proj.transform([i,j],"EPSG:3857","EPSG:4326"),c.push(b);"merge_floor"===h.properties.type&&(log(h.properties),h.properties.type="floor"),d={type:"Feature",geometry:{type:"Polygon",coordinates:[c]},properties:h.properties},e.push(d)}return a={type:"FeatureCollection",features:e}},translateGeoJSON:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;for(d=this.toGeoJSON(),d=this.mergeGeoJson(d),c=[],o=d.features,k=0,m=o.length;m>k;k++){if(h=o[k],f=proj4("EPSG:4326","EPSG:3857",[this.options.lon,this.options.lat])){for(b=[],p=h.geometry.coordinates[0],l=0,n=p.length;n>l;l++)e=p[l],i=e[0]*this.options.geojson_scale,j=e[1]*this.options.geojson_scale,g=fabric.util.rotatePoint(new fabric.Point(i,j),new fabric.Point(0,0),fabric.util.degreesToRadians(-this.options.angle)),a=[f[0]+g.x,f[1]+g.y],b.push(a);h.geometry.coordinates=[b]}c.push(h)}return d.features=c,d},mergeGeoJson:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;if(j=[],a&&a.features.length>0){for(w=a.features,m=0,q=w.length;q>m;m++)if(g=w[m],"floor"===g.properties.type){for(i=[],log(g.geometry.coordinates[0]),x=g.geometry.coordinates[0],n=0,r=x.length;r>n;n++)f=x[n],h={X:f[0],Y:f[1]},i.push(h);j.push([i])}for(log(j),c=new ClipperLib.Clipper,o=0,s=j.length;s>o;o++)i=j[o],c.AddPaths(i,ClipperLib.PolyType.ptSubject,!0);for(k=new ClipperLib.Paths,l=c.Execute(ClipperLib.ClipType.ctUnion,k,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero),log(k),p=0,t=k.length;t>p;p++){for(i=k[p],b=[],d=!0,v=0,u=i.length;u>v;v++)h=i[v],d&&(e=[h.X,h.Y],d=!1),b.push([h.X,h.Y]);b.push(e),a.features.push({type:"Feature",geometry:{type:"Polygon",coordinates:[b]},properties:{type:"merge_floor",fill:"#FFFFFF",stroke:"#FFFFFF"}})}}return a}}}),haika.map.init();